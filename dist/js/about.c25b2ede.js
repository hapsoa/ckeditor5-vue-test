(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["about"],{"001a":function(t,e,n){"use strict";function r(t){return t&&"object"===typeof t&&"default"in t?t["default"]:t}Object.defineProperty(e,"__esModule",{value:!0});var i=n("b7b7"),o=r(n("c23d")),a={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},s=function(t){function e(n,r,i){var o=t.call(this,r)||this;return Object.setPrototypeOf(o,e.prototype),o.code=n,o.details=i,o}return i.__extends(e,t),e}(Error);function u(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function c(t,e,n){var r=u(t),i=r,o=void 0;try{var c=e.error;if(c){var l=c.status;if("string"===typeof l){if(!a[l])return new s("internal","internal");r=a[l]}i=l;var h=c.message;"string"===typeof h&&(i=h),o=c.details,void 0!==o&&(o=n.decode(o))}}catch(f){}return"ok"===r?null:new s(r,i,o)}var l=function(){function t(t){this.app=t}return t.prototype.getAuthToken=function(){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.app.INTERNAL.getToken()];case 1:return t=e.sent(),t?[2,t.accessToken]:[2,void 0];case 2:return e.sent(),[2,void 0];case 3:return[2]}})})},t.prototype.getInstanceIdToken=function(){return i.__awaiter(this,void 0,void 0,function(){var t,e;return i.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),this.app.messaging?(t=this.app.messaging(),[4,t.getToken()]):[2,void 0];case 1:return e=n.sent(),e?[2,e]:[2,void 0];case 2:return n.sent(),[2,void 0];case 3:return[2]}})})},t.prototype.getContext=function(){return i.__awaiter(this,void 0,void 0,function(){var t,e;return i.__generator(this,function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getInstanceIdToken()];case 2:return e=n.sent(),[2,{authToken:t,instanceIdToken:e}]}})})},t}(),h="type.googleapis.com/google.protobuf.Int64Value",f="type.googleapis.com/google.protobuf.UInt64Value";function d(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}var p=function(){function t(){}return t.prototype.encode=function(t){var e=this;if(null===t||void 0===t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"===typeof t&&isFinite(t))return t;if(!0===t||!1===t)return t;if("[object String]"===Object.prototype.toString.call(t))return t;if(Array.isArray(t))return t.map(function(t){return e.encode(t)});if("function"===typeof t||"object"===typeof t)return d(t,function(t){return e.encode(t)});throw new Error("Data cannot be encoded in JSON: "+t)},t.prototype.decode=function(t){var e=this;if(null===t)return t;if(t["@type"])switch(t["@type"]){case h:case f:var n=parseFloat(t.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+t);return n;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(function(t){return e.decode(t)}):"function"===typeof t||"object"===typeof t?d(t,function(t){return e.decode(t)}):t},t}(),v=function(){function t(t,e){void 0===e&&(e="us-central1"),this.app_=t,this.region_=e,this.serializer=new p,this.emulatorOrigin=null,this.contextProvider=new l(t)}return Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!0,configurable:!0}),t.prototype._url=function(t){var e=this.app_.options.projectId,n=this.region_;if(null!==this.emulatorOrigin){var r=this.emulatorOrigin;return r+"/"+e+"/"+n+"/"+t}return"https://"+n+"-"+e+".cloudfunctions.net/"+t},t.prototype.useFunctionsEmulator=function(t){this.emulatorOrigin=t},t.prototype.httpsCallable=function(t){var e=this,n=function(n){return e.call(t,n)};return n},t.prototype.postJSON=function(t,e,n){return i.__awaiter(this,void 0,void 0,function(){var r,o;return i.__generator(this,function(i){switch(i.label){case 0:n.append("Content-Type","application/json"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,fetch(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 2:return r=i.sent(),[3,4];case 3:return i.sent(),[2,{status:0,json:null}];case 4:o=null,i.label=5;case 5:return i.trys.push([5,7,,8]),[4,r.json()];case 6:return o=i.sent(),[3,8];case 7:return i.sent(),[3,8];case 8:return[2,{status:r.status,json:o}]}})})},t.prototype.call=function(t,e){return i.__awaiter(this,void 0,void 0,function(){var n,r,o,a,u,l,h,f;return i.__generator(this,function(i){switch(i.label){case 0:return n=this._url(t),e=this.serializer.encode(e),r={data:e},o=new Headers,[4,this.contextProvider.getContext()];case 1:return a=i.sent(),a.authToken&&o.append("Authorization","Bearer "+a.authToken),a.instanceIdToken&&o.append("Firebase-Instance-ID-Token",a.instanceIdToken),[4,this.postJSON(n,r,o)];case 2:if(u=i.sent(),l=c(u.status,u.json,this.serializer),l)throw l;if(!u.json)throw new s("internal","Response is not valid JSON object.");if(h=u.json.data,"undefined"===typeof h&&(h=u.json.result),"undefined"===typeof h)throw new s("internal","Response is missing data field.");return f=this.serializer.decode(h),[2,{data:f}]}})})},t}(),y="functions";function g(t,e,n){return new v(t,n)}function m(t){var e={Functions:v};t.INTERNAL.registerService(y,g,e,void 0,!0)}m(o),e.registerFunctions=m},"02f4":function(t,e,n){var r=n("4588"),i=n("be13");t.exports=function(t){return function(e,n){var o,a,s=String(i(e)),u=r(n),c=s.length;return u<0||u>=c?t?"":void 0:(o=s.charCodeAt(u),o<55296||o>56319||u+1===c||(a=s.charCodeAt(u+1))<56320||a>57343?t?s.charAt(u):o:t?s.slice(u,u+2):a-56320+(o-55296<<10)+65536)}}},"0390":function(t,e,n){"use strict";var r=n("02f4")(!0);t.exports=function(t,e,n){return e+(n?r(t,e).length:1)}},"03cc":function(t,e,n){t.exports=n("e5b8")},"0524":function(t,e){t.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 4.5V3h16v1.5zm4.5 3V12h7V7.5h-7zM5.758 6h8.484c.419 0 .758.407.758.91v5.681c0 .502-.34.909-.758.909H5.758c-.419 0-.758-.407-.758-.91V6.91c0-.503.34-.91.758-.91zM2 16.5V15h16v1.5z"/></svg>'},"0544":function(t,e,n){n("7075")("WeakMap")},"07d8":function(t,e,n){"use strict";var r=n("5aee"),i=n("9f79"),o="Set";t.exports=n("ada4")(o,function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return r.def(i(this,o),t=0===t?0:t,t)}},r)},"09fa":function(t,e,n){var r=n("4588"),i=n("9def");t.exports=function(t){if(void 0===t)return 0;var e=r(t),n=i(e);if(e!==n)throw RangeError("Wrong length!");return n}},"0a06":function(t,e,n){},"0a0d":function(t,e,n){t.exports=n("e829")},"0a49":function(t,e,n){var r=n("9b43"),i=n("626a"),o=n("4bf8"),a=n("9def"),s=n("cd1c");t.exports=function(t,e){var n=1==t,u=2==t,c=3==t,l=4==t,h=6==t,f=5==t||h,d=e||s;return function(e,s,p){for(var v,y,g=o(e),m=i(g),b=r(s,p,3),w=a(m.length),_=0,k=n?d(e,w):u?d(e,0):void 0;w>_;_++)if((f||_ in m)&&(v=m[_],y=b(v,_,g),t))if(n)k[_]=y;else if(y)switch(t){case 3:return!0;case 5:return v;case 6:return _;case 2:k.push(v)}else if(l)return!1;return h?-1:c||l?l:k}}},"0b3e":function(t){t.exports={a:"11.2.0"}},"0b64":function(t,e,n){var r=n("f772"),i=n("9003"),o=n("5168")("species");t.exports=function(t){var e;return i(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!i(e.prototype)||(e=void 0),r(e)&&(e=e[o],null===e&&(e=void 0))),void 0===e?Array:e}},"0bfb":function(t,e,n){"use strict";var r=n("cb7c");t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},"0db1":function(t,e){t.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 4.5V3h16v1.5zm0 3V6h5.674v1.5zm0 3V9h5.674v1.5zm0 3V12h5.674v1.5zm8.5-6V12h6V7.5h-6zM9.682 6h7.636c.377 0 .682.407.682.91v5.68c0 .503-.305.91-.682.91H9.682c-.377 0-.682-.407-.682-.91V6.91c0-.503.305-.91.682-.91zM2 16.5V15h16v1.5z"/></svg>'},"0f88":function(t,e,n){var r,i=n("7726"),o=n("32e9"),a=n("ca5a"),s=a("typed_array"),u=a("view"),c=!(!i.ArrayBuffer||!i.DataView),l=c,h=0,f=9,d="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");while(h<f)(r=i[d[h++]])?(o(r.prototype,s,!0),o(r.prototype,u,!0)):l=!1;t.exports={ABV:c,CONSTR:l,TYPED:s,VIEW:u}},1033:function(t,e){t.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.586 14.633l.021.004c-.036.335.095.655.393.962.082.083.173.15.274.201h1.474a.6.6 0 1 1 0 1.2H5.304a.6.6 0 0 1 0-1.2h1.15c.474-.07.809-.182 1.005-.334.157-.122.291-.32.404-.597l2.416-9.55a1.053 1.053 0 0 0-.281-.823 1.12 1.12 0 0 0-.442-.296H8.15a.6.6 0 0 1 0-1.2h6.443a.6.6 0 1 1 0 1.2h-1.195c-.376.056-.65.155-.823.296-.215.175-.423.439-.623.79l-2.366 9.347z"/></svg>'},1169:function(t,e,n){var r=n("2d95");t.exports=Array.isArray||function(t){return"Array"==r(t)}},1173:function(t,e){t.exports=function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!");return t}},"11e9":function(t,e,n){var r=n("52a7"),i=n("4630"),o=n("6821"),a=n("6a99"),s=n("69a8"),u=n("c69a"),c=Object.getOwnPropertyDescriptor;e.f=n("9e1e")?c:function(t,e){if(t=o(t),e=a(e,!0),u)try{return c(t,e)}catch(n){}if(s(t,e))return i(!r.f.call(t,e),t[e])}},1271:function(t,e,n){n("ce7e")("getOwnPropertyNames",function(){return n("0395").f})},1414:function(t,e){t.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.91 10.54c.26-.23.64-.21.88.03l3.36 3.14 2.23-2.06a.64.64 0 0 1 .87 0l2.52 2.97V4.5H3.2v10.12l3.71-4.08zm10.27-7.51c.6 0 1.09.47 1.09 1.05v11.84c0 .59-.49 1.06-1.09 1.06H2.79c-.6 0-1.09-.47-1.09-1.06V4.08c0-.58.49-1.05 1.1-1.05h14.38zm-5.22 5.56a1.96 1.96 0 1 1 3.4-1.96 1.96 1.96 0 0 1-3.4 1.96z"/></svg>'},"14b9":function(t,e,n){var r=n("5ca1");r(r.P,"String",{repeat:n("9744")})},"153a":function(t,e,n){"use strict";var r=n("901e"),i=n("9f79"),o="WeakSet";n("ada4")(o,function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return r.def(i(this,o),t,!0)}},r,!1,!0)},1805:function(t,e){t.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.077 15l.991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184zm4.919 10.562l-1.414 1.414a.75.75 0 1 1-1.06-1.06l1.414-1.415-1.415-1.414a.75.75 0 0 1 1.061-1.06l1.414 1.414 1.414-1.415a.75.75 0 0 1 1.061 1.061l-1.414 1.414 1.414 1.415a.75.75 0 0 1-1.06 1.06l-1.415-1.414z"/></svg>'},"18ce":function(t,e){t.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.972 16.615a.997.997 0 0 1-.744-.292l-4.596-4.596a1 1 0 1 1 1.414-1.414l3.926 3.926 9.937-9.937a1 1 0 0 1 1.414 1.415L7.717 16.323a.997.997 0 0 1-.745.292z"/></svg>'},"18ea":function(t,e,n){},"1a1b":function(t,e){t.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M18 4.5V3H2v1.5h16zm0 3V6h-5.674v1.5H18zm0 3V9h-5.674v1.5H18zm0 3V12h-5.674v1.5H18zm-8.5-6V12h-6V7.5h6zm.818-1.5H2.682C2.305 6 2 6.407 2 6.91v5.68c0 .503.305.91.682.91h7.636c.377 0 .682-.407.682-.91V6.91c0-.503-.305-.91-.682-.91zM18 16.5V15H2v1.5h16z"/></svg>'},"1af3":function(t,e,n){},"1af6":function(t,e,n){var r=n("63b6");r(r.S,"Array",{isArray:n("9003")})},"1b81":function(t,e,n){t.exports=n("9b9a")},"1cb7":function(t,e,n){var r=n("bf0b"),i=n("53e2"),o=n("07e3"),a=n("63b6"),s=n("f772"),u=n("e4ae");function c(t,e){var n,a,l=arguments.length<3?t:arguments[2];return u(t)===l?t[e]:(n=r.f(t,e))?o(n,"value")?n.value:void 0!==n.get?n.get.call(l):void 0:s(a=i(t))?c(a,e,l):void 0}a(a.S,"Reflect",{get:c})},"20d6":function(t,e,n){"use strict";var r=n("5ca1"),i=n("0a49")(6),o="findIndex",a=!0;o in[]&&Array(1)[o](function(){a=!1}),r(r.P+r.F*a,"Array",{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")(o)},"20fd":function(t,e,n){"use strict";var r=n("d9f6"),i=n("aebd");t.exports=function(t,e,n){e in t?r.f(t,e,i(0,n)):t[e]=n}},"214f":function(t,e,n){"use strict";n("b0c5");var r=n("2aba"),i=n("32e9"),o=n("79e5"),a=n("be13"),s=n("2b4c"),u=n("520a"),c=s("species"),l=!o(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),h=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();t.exports=function(t,e,n){var f=s(t),d=!o(function(){var e={};return e[f]=function(){return 7},7!=""[t](e)}),p=d?!o(function(){var e=!1,n=/a/;return n.exec=function(){return e=!0,null},"split"===t&&(n.constructor={},n.constructor[c]=function(){return n}),n[f](""),!e}):void 0;if(!d||!p||"replace"===t&&!l||"split"===t&&!h){var v=/./[f],y=n(a,f,""[t],function(t,e,n,r,i){return e.exec===u?d&&!i?{done:!0,value:v.call(e,n,r)}:{done:!0,value:t.call(n,e,r)}:{done:!1}}),g=y[0],m=y[1];r(String.prototype,t,g),i(RegExp.prototype,f,2==e?function(t,e){return m.call(t,this,e)}:function(t){return m.call(t,this)})}}},2260:function(t,e,n){},"24c5":function(t,e,n){"use strict";var r,i,o,a,s=n("b8e3"),u=n("e53d"),c=n("d864"),l=n("40c3"),h=n("63b6"),f=n("f772"),d=n("79aa"),p=n("1173"),v=n("a22a"),y=n("f201"),g=n("4178").set,m=n("aba2")(),b=n("656e"),w=n("4439"),_=n("bc13"),k=n("cd78"),E="Promise",T=u.TypeError,S=u.process,C=S&&S.versions,O=C&&C.v8||"",A=u[E],I="process"==l(S),x=function(){},P=i=b.f,N=!!function(){try{var t=A.resolve(1),e=(t.constructor={})[n("5168")("species")]=function(t){t(x,x)};return(I||"function"==typeof PromiseRejectionEvent)&&t.then(x)instanceof e&&0!==O.indexOf("6.6")&&-1===_.indexOf("Chrome/66")}catch(r){}}(),R=function(t){var e;return!(!f(t)||"function"!=typeof(e=t.then))&&e},D=function(t,e){if(!t._n){t._n=!0;var n=t._c;m(function(){var r=t._v,i=1==t._s,o=0,a=function(e){var n,o,a,s=i?e.ok:e.fail,u=e.resolve,c=e.reject,l=e.domain;try{s?(i||(2==t._h&&L(t),t._h=1),!0===s?n=r:(l&&l.enter(),n=s(r),l&&(l.exit(),a=!0)),n===e.promise?c(T("Promise-chain cycle")):(o=R(n))?o.call(n,u,c):u(n)):c(r)}catch(h){l&&!a&&l.exit(),c(h)}};while(n.length>o)a(n[o++]);t._c=[],t._n=!1,e&&!t._h&&j(t)})}},j=function(t){g.call(u,function(){var e,n,r,i=t._v,o=M(t);if(o&&(e=w(function(){I?S.emit("unhandledRejection",i,t):(n=u.onunhandledrejection)?n({promise:t,reason:i}):(r=u.console)&&r.error&&r.error("Unhandled promise rejection",i)}),t._h=I||M(t)?2:1),t._a=void 0,o&&e.e)throw e.v})},M=function(t){return 1!==t._h&&0===(t._a||t._c).length},L=function(t){g.call(u,function(){var e;I?S.emit("rejectionHandled",t):(e=u.onrejectionhandled)&&e({promise:t,reason:t._v})})},F=function(t){var e=this;e._d||(e._d=!0,e=e._w||e,e._v=t,e._s=2,e._a||(e._a=e._c.slice()),D(e,!0))},V=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw T("Promise can't be resolved itself");(e=R(t))?m(function(){var r={_w:n,_d:!1};try{e.call(t,c(V,r,1),c(F,r,1))}catch(i){F.call(r,i)}}):(n._v=t,n._s=1,D(n,!1))}catch(r){F.call({_w:n,_d:!1},r)}}};N||(A=function(t){p(this,A,E,"_h"),d(t),r.call(this);try{t(c(V,this,1),c(F,this,1))}catch(e){F.call(this,e)}},r=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},r.prototype=n("5c95")(A.prototype,{then:function(t,e){var n=P(y(this,A));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=I?S.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&D(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new r;this.promise=t,this.resolve=c(V,t,1),this.reject=c(F,t,1)},b.f=P=function(t){return t===A||t===a?new o(t):i(t)}),h(h.G+h.W+h.F*!N,{Promise:A}),n("45f2")(A,E),n("4c95")(E),a=n("584a")[E],h(h.S+h.F*!N,E,{reject:function(t){var e=P(this),n=e.reject;return n(t),e.promise}}),h(h.S+h.F*(s||!N),E,{resolve:function(t){return k(s&&this===a?A:this,t)}}),h(h.S+h.F*!(N&&n("4ee1")(function(t){A.all(t)["catch"](x)})),E,{all:function(t){var e=this,n=P(e),r=n.resolve,i=n.reject,o=w(function(){var n=[],o=0,a=1;v(t,!1,function(t){var s=o++,u=!1;n.push(void 0),a++,e.resolve(t).then(function(t){u||(u=!0,n[s]=t,--a||r(n))},i)}),--a||r(n)});return o.e&&i(o.v),n.promise},race:function(t){var e=this,n=P(e),r=n.reject,i=w(function(){v(t,!1,function(t){e.resolve(t).then(n.resolve,r)})});return i.e&&r(i.v),n.promise}})},2609:function(t,e){t.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7.3 17.37l-.061.088a1.518 1.518 0 0 1-.934.535l-4.178.663-.806-4.153a1.495 1.495 0 0 1 .187-1.058l.056-.086L8.77 2.639c.958-1.351 2.803-1.076 4.296-.03 1.497 1.047 2.387 2.693 1.433 4.055L7.3 17.37zM9.14 4.728l-5.545 8.346 3.277 2.294 5.544-8.346L9.14 4.728zM6.07 16.512l-3.276-2.295.53 2.73 2.746-.435zM9.994 3.506L13.271 5.8c.316-.452-.16-1.333-1.065-1.966-.905-.634-1.895-.78-2.212-.328zM8 18.5L9.375 17H19v1.5H8z"/></svg>'},"268f":function(t,e,n){t.exports=n("fde4")},"26ee":function(t,e,n){"use strict";var r=n("5ea3"),i="object"==typeof self&&self&&self.Object===Object&&self,o=r["a"]||i||Function("return this")();e["a"]=o},"28a5":function(t,e,n){"use strict";var r=n("aae3"),i=n("cb7c"),o=n("ebd6"),a=n("0390"),s=n("9def"),u=n("5f1b"),c=n("520a"),l=Math.min,h=[].push,f="split",d="length",p="lastIndex",v=!!function(){try{return new RegExp("x","y")}catch(t){}}();n("214f")("split",2,function(t,e,n,y){var g;return g="c"=="abbc"[f](/(b)*/)[1]||4!="test"[f](/(?:)/,-1)[d]||2!="ab"[f](/(?:ab)*/)[d]||4!="."[f](/(.?)(.?)/)[d]||"."[f](/()()/)[d]>1||""[f](/.?/)[d]?function(t,e){var i=String(this);if(void 0===t&&0===e)return[];if(!r(t))return n.call(i,t,e);var o,a,s,u=[],l=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),f=0,v=void 0===e?4294967295:e>>>0,y=new RegExp(t.source,l+"g");while(o=c.call(y,i)){if(a=y[p],a>f&&(u.push(i.slice(f,o.index)),o[d]>1&&o.index<i[d]&&h.apply(u,o.slice(1)),s=o[0][d],f=a,u[d]>=v))break;y[p]===o.index&&y[p]++}return f===i[d]?!s&&y.test("")||u.push(""):u.push(i.slice(f)),u[d]>v?u.slice(0,v):u}:"0"[f](void 0,0)[d]?function(t,e){return void 0===t&&0===e?[]:n.call(this,t,e)}:n,[function(n,r){var i=t(this),o=void 0==n?void 0:n[e];return void 0!==o?o.call(n,i,r):g.call(String(i),n,r)},function(t,e){var r=y(g,t,this,e,g!==n);if(r.done)return r.value;var c=i(t),h=String(this),f=o(c,RegExp),d=c.unicode,p=(c.ignoreCase?"i":"")+(c.multiline?"m":"")+(c.unicode?"u":"")+(v?"y":"g"),m=new f(v?c:"^(?:"+c.source+")",p),b=void 0===e?4294967295:e>>>0;if(0===b)return[];if(0===h.length)return null===u(m,h)?[h]:[];var w=0,_=0,k=[];while(_<h.length){m.lastIndex=v?_:0;var E,T=u(m,v?h:h.slice(_));if(null===T||(E=l(s(m.lastIndex+(v?0:_)),h.length))===w)_=a(h,_,d);else{if(k.push(h.slice(w,_)),k.length===b)return k;for(var S=1;S<=T.length-1;S++)if(k.push(T[S]),k.length===b)return k;_=w=E}}return k.push(h.slice(w)),k}]})},"2a21":function(t,e,n){},"2b8e":function(t,e){t.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm2.286 4c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75z"/></svg>'},"2d7d":function(t,e,n){t.exports=n("5037")},"2e66":function(t,e,n){"use strict";n.r(e),n.d(e,"registerStorage",function(){return De});var r=n("c23d"),i=n.n(r),o="https://firebasestorage.googleapis.com",a="https://firebasestorage.googleapis.com",s="/v0",u="/v0",c="storageBucket",l=12e4,h=6e4,f=-9007199254740991,d=function(){function t(t,e){this.code_=v(t),this.message_="Firebase Storage: "+e,this.serverResponse_=null,this.name_="FirebaseError"}return t.prototype.codeProp=function(){return this.code},t.prototype.codeEquals=function(t){return v(t)===this.codeProp()},t.prototype.serverResponseProp=function(){return this.serverResponse_},t.prototype.setServerResponseProp=function(t){this.serverResponse_=t},Object.defineProperty(t.prototype,"name",{get:function(){return this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"code",{get:function(){return this.code_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"message",{get:function(){return this.message_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverResponse",{get:function(){return this.serverResponse_},enumerable:!0,configurable:!0}),t}(),p={UNKNOWN:"unknown",OBJECT_NOT_FOUND:"object-not-found",BUCKET_NOT_FOUND:"bucket-not-found",PROJECT_NOT_FOUND:"project-not-found",QUOTA_EXCEEDED:"quota-exceeded",UNAUTHENTICATED:"unauthenticated",UNAUTHORIZED:"unauthorized",RETRY_LIMIT_EXCEEDED:"retry-limit-exceeded",INVALID_CHECKSUM:"invalid-checksum",CANCELED:"canceled",INVALID_EVENT_NAME:"invalid-event-name",INVALID_URL:"invalid-url",INVALID_DEFAULT_BUCKET:"invalid-default-bucket",NO_DEFAULT_BUCKET:"no-default-bucket",CANNOT_SLICE_BLOB:"cannot-slice-blob",SERVER_FILE_WRONG_SIZE:"server-file-wrong-size",NO_DOWNLOAD_URL:"no-download-url",INVALID_ARGUMENT:"invalid-argument",INVALID_ARGUMENT_COUNT:"invalid-argument-count",APP_DELETED:"app-deleted",INVALID_ROOT_OPERATION:"invalid-root-operation",INVALID_FORMAT:"invalid-format",INTERNAL_ERROR:"internal-error"};function v(t){return"storage/"+t}function y(){var t="An unknown error occurred, please check the error payload for server response.";return new d(p.UNKNOWN,t)}function g(t){return new d(p.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function m(t){return new d(p.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function b(){var t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new d(p.UNAUTHENTICATED,t)}function w(t){return new d(p.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function _(){return new d(p.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function k(){return new d(p.CANCELED,"User canceled the upload/download.")}function E(t){return new d(p.INVALID_URL,"Invalid URL '"+t+"'.")}function T(t){return new d(p.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function S(){return new d(p.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function C(){return new d(p.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function O(){return new d(p.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function A(t,e,n){return new d(p.INVALID_ARGUMENT,"Invalid argument in `"+e+"` at index "+t+": "+n)}function I(t,e,n,r){var i,o;return t===e?(i=t,o=1===t?"argument":"arguments"):(i="between "+t+" and "+e,o="arguments"),new d(p.INVALID_ARGUMENT_COUNT,"Invalid argument count in `"+n+"`: Expected "+i+" "+o+", received "+r+".")}function x(){return new d(p.APP_DELETED,"The Firebase app was deleted.")}function P(t){return new d(p.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function N(t,e){return new d(p.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function R(t){throw new d(p.INTERNAL_ERROR,"Internal error: "+t)}var D={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};function j(t){switch(t){case D.RAW:case D.BASE64:case D.BASE64URL:case D.DATA_URL:return;default:throw"Expected one of the event types: ["+D.RAW+", "+D.BASE64+", "+D.BASE64URL+", "+D.DATA_URL+"]."}}var M=function(){function t(t,e){this.data=t,this.contentType=e||null}return t}();function L(t,e){switch(t){case D.RAW:return new M(F(e));case D.BASE64:case D.BASE64URL:return new M(B(t,e));case D.DATA_URL:return new M(q(e),W(e))}throw y()}function F(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|63&r);else if(55296==(64512&r)){var i=n<t.length-1&&56320==(64512&t.charCodeAt(n+1));if(i){var o=r,a=t.charCodeAt(++n);r=65536|(1023&o)<<10|1023&a,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else e.push(239,191,189)}else 56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function V(t){var e;try{e=decodeURIComponent(t)}catch(n){throw N(D.DATA_URL,"Malformed data URL.")}return F(e)}function B(t,e){switch(t){case D.BASE64:var n=-1!==e.indexOf("-"),r=-1!==e.indexOf("_");if(n||r){var i=n?"-":"_";throw N(t,"Invalid character '"+i+"' found: is it base64url encoded?")}break;case D.BASE64URL:var o=-1!==e.indexOf("+"),a=-1!==e.indexOf("/");if(o||a){i=o?"+":"/";throw N(t,"Invalid character '"+i+"' found: is it base64 encoded?")}e=e.replace(/-/g,"+").replace(/_/g,"/");break}var s;try{s=atob(e)}catch(l){throw N(t,"Invalid character found")}for(var u=new Uint8Array(s.length),c=0;c<s.length;c++)u[c]=s.charCodeAt(c);return u}var U=function(){function t(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw N(D.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n=e[1]||null;null!=n&&(this.base64=K(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=t.substring(t.indexOf(",")+1)}return t}();function q(t){var e=new U(t);return e.base64?B(D.BASE64,e.rest):V(e.rest)}function W(t){var e=new U(t);return e.contentType}function K(t,e){var n=t.length>=e.length;return!!n&&t.substring(t.length-e.length)===e}var H,z={STATE_CHANGED:"state_changed"},G={RUNNING:"running",PAUSING:"pausing",PAUSED:"paused",SUCCESS:"success",CANCELING:"canceling",CANCELED:"canceled",ERROR:"error"},Q={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Y(t){switch(t){case G.RUNNING:case G.PAUSING:case G.CANCELING:return Q.RUNNING;case G.PAUSED:return Q.PAUSED;case G.SUCCESS:return Q.SUCCESS;case G.CANCELED:return Q.CANCELED;case G.ERROR:return Q.ERROR;default:return Q.ERROR}}function X(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function J(t,e){for(var n in t)X(t,n)&&e(n,t[n])}function $(t){if(null==t)return{};var e={};return J(t,function(t,n){e[t]=n}),e}function Z(t){return new Promise(t)}function tt(t){return Promise.resolve(t)}function et(t){return Promise.reject(t)}function nt(t){return null!=t}function rt(t){return void 0!==t}function it(t){return"function"===typeof t}function ot(t){return"object"===typeof t}function at(t){return ot(t)&&null!==t}function st(t){return ot(t)&&!Array.isArray(t)}function ut(t){return"string"===typeof t||t instanceof String}function ct(t){return"number"===typeof t||t instanceof Number}function lt(t){return ht()&&t instanceof Blob}function ht(){return"undefined"!==typeof Blob}(function(t){t[t["NO_ERROR"]=0]="NO_ERROR",t[t["NETWORK_ERROR"]=1]="NETWORK_ERROR",t[t["ABORT"]=2]="ABORT"})(H||(H={}));var ft=function(){function t(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=H.NO_ERROR,this.sendPromise_=Z(function(e,n){t.xhr_.addEventListener("abort",function(n){t.errorCode_=H.ABORT,e(t)}),t.xhr_.addEventListener("error",function(n){t.errorCode_=H.NETWORK_ERROR,e(t)}),t.xhr_.addEventListener("load",function(n){e(t)})})}return t.prototype.send=function(t,e,n,r){var i=this;if(this.sent_)throw R("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),nt(r)){var o=r;J(o,function(t,e){i.xhr_.setRequestHeader(t,e.toString())})}return nt(n)?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw R("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw R("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}},t.prototype.getResponseText=function(){if(!this.sent_)throw R("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){nt(this.xhr_.upload)&&this.xhr_.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){nt(this.xhr_.upload)&&this.xhr_.upload.removeEventListener("progress",t)},t}(),dt=function(){function t(){}return t.prototype.createXhrIo=function(){return new ft},t}();function pt(t){var e;try{e=JSON.parse(t)}catch(n){return null}return st(e)?e:null}var vt=function(){function t(t,e){this.bucket=t,this.path_=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!0,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o"},t.makeFromBucketSpec=function(e){var n;try{n=t.makeFromUrl(e)}catch(r){return new t(e,"")}if(""===n.path)return n;throw T(e)},t.makeFromUrl=function(e){var n=null,r="([A-Za-z0-9.\\-_]+)";function i(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}var o="(/(.*))?$",a="(/([^?#]*).*)?$",s=new RegExp("^gs://"+r+o,"i"),u={bucket:1,path:3};function c(t){t.path_=decodeURIComponent(t.path)}for(var l="v[A-Za-z0-9_]+",h=new RegExp("^https?://firebasestorage\\.googleapis\\.com/"+l+"/b/"+r+"/o"+a,"i"),f={bucket:1,path:3},d=[{regex:s,indices:u,postModify:i},{regex:h,indices:f,postModify:c}],p=0;p<d.length;p++){var v=d[p],y=v.regex.exec(e);if(y){var g=y[v.indices.bucket],m=y[v.indices.path];m||(m=""),n=new t(g,m),v.postModify(n);break}}if(null==n)throw E(e);return n},t}();function yt(t){if(0==t.length)return null;var e=t.lastIndexOf("/");if(-1===e)return"";var n=t.slice(0,e);return n}function gt(t,e){var n=e.split("/").filter(function(t){return t.length>0}).join("/");return 0===t.length?n:t+"/"+n}function mt(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function bt(t){return o+s+t}function wt(t){return a+s+t}function _t(t){return o+u+t}function kt(t){var e=encodeURIComponent,n="?";return J(t,function(t,r){var i=e(t)+"="+e(r);n=n+i+"&"}),n=n.slice(0,-1),n}function Et(t,e){return e}var Tt=function(){function t(t,e,n,r){this.server=t,this.local=e||t,this.writable=!!n,this.xform=r||Et}return t}(),St=null;function Ct(t){var e=ut(t);return!e||t.length<2?t:(t=t,mt(t))}function Ot(){if(St)return St;var t=[];function e(t,e){return Ct(e)}t.push(new Tt("bucket")),t.push(new Tt("generation")),t.push(new Tt("metageneration")),t.push(new Tt("name","fullPath",!0));var n=new Tt("name");function r(t,e){return nt(e)?+e:e}n.xform=e,t.push(n);var i=new Tt("size");return i.xform=r,t.push(i),t.push(new Tt("timeCreated")),t.push(new Tt("updated")),t.push(new Tt("md5Hash",null,!0)),t.push(new Tt("cacheControl",null,!0)),t.push(new Tt("contentDisposition",null,!0)),t.push(new Tt("contentEncoding",null,!0)),t.push(new Tt("contentLanguage",null,!0)),t.push(new Tt("contentType",null,!0)),t.push(new Tt("metadata","customMetadata",!0)),St=t,St}function At(t,e){function n(){var n=t["bucket"],r=t["fullPath"],i=new vt(n,r);return e.makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function It(t,e,n){for(var r={type:"file"},i=n.length,o=0;o<i;o++){var a=n[o];r[a.local]=a.xform(r,e[a.server])}return At(r,t),r}function xt(t,e,n){var r=pt(e);if(null===r)return null;var i=r;return It(t,i,n)}function Pt(t,e){var n=pt(e);if(null===n)return null;if(!ut(n["downloadTokens"]))return null;var r=n["downloadTokens"];if(0===r.length)return null;var i=encodeURIComponent,o=r.split(","),a=o.map(function(e){var n=t["bucket"],r=t["fullPath"],o="/b/"+i(n)+"/o/"+i(r),a=wt(o),s=kt({alt:"media",token:e});return a+s});return a[0]}function Nt(t,e){for(var n={},r=e.length,i=0;i<r;i++){var o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}function Rt(t){var e=t&&ot(t);if(!e)throw"Expected Metadata object.";for(var n in t){var r=t[n];if("customMetadata"===n){if(!ot(r))throw"Expected object for 'customMetadata' mapping."}else if(at(r))throw"Mapping for '"+n+"' cannot be an object."}}function Dt(t,e,n){for(var r=e.length,i=e.length,o=0;o<e.length;o++)if(e[o].optional){r=o;break}var a=r<=n.length&&n.length<=i;if(!a)throw I(r,i,t,n.length);for(o=0;o<n.length;o++)try{e[o].validator(n[o])}catch(s){throw s instanceof Error?A(o,t,s.message):A(o,t,s)}}var jt=function(){function t(t,e){var n=this;this.validator=function(e){n.optional&&!rt(e)||t(e)},this.optional=!!e}return t}();function Mt(t,e){return function(n){t(n),e(n)}}function Lt(t,e){function n(t){if(!ut(t))throw"Expected string."}var r;return r=t?Mt(n,t):n,new jt(r,e)}function Ft(){function t(t){var e=t instanceof Uint8Array||t instanceof ArrayBuffer||ht()&&t instanceof Blob;if(!e)throw"Expected Blob or File."}return new jt(t)}function Vt(t){return new jt(Rt,t)}function Bt(){function t(t){var e=ct(t)&&t>=0;if(!e)throw"Expected a number 0 or greater."}return new jt(t)}function Ut(t,e){function n(e){var n=null===e||nt(e)&&e instanceof Object;if(!n)throw"Expected an Object.";void 0!==t&&null!==t&&t(e)}return new jt(n,e)}function qt(t){function e(t){var e=null===t||it(t);if(!e)throw"Expected a Function."}return new jt(e,t)}function Wt(){return"undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function Kt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Wt();if(void 0!==n){for(var r=new n,i=0;i<t.length;i++)r.append(t[i]);return r.getBlob()}if(ht())return new Blob(t);throw Error("This browser doesn't seem to support creating Blobs")}function Ht(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}var zt=function(){function t(t,e){var n=0,r="";lt(t)?(this.data_=t,n=t.size,r=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=r}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(lt(this.data_)){var r=this.data_,i=Ht(r,e,n);return null===i?null:new t(i)}var o=new Uint8Array(this.data_.buffer,e,n-e);return new t(o,!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(ht()){var r=e.map(function(e){return e instanceof t?e.data_:e});return new t(Kt.apply(null,r))}var i=e.map(function(t){return ut(t)?L(D.RAW,t).data:t.data_}),o=0;i.forEach(function(t){o+=t.byteLength});var a=new Uint8Array(o),s=0;return i.forEach(function(t){for(var e=0;e<t.length;e++)a[s++]=t[e]}),new t(a,!0)},t.prototype.uploadData=function(){return this.data_},t}();function Gt(t,e){return-1!==t.indexOf(e)}function Qt(t){return Array.prototype.slice.call(t)}function Yt(t,e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}var Xt=function(){function t(t,e,n,r){this.url=t,this.method=e,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}return t}();function Jt(t){if(!t)throw y()}function $t(t,e){function n(n,r){var i=xt(t,r,e);return Jt(null!==i),i}return n}function Zt(t,e){function n(n,r){var i=xt(t,r,e);return Jt(null!==i),Pt(i,r)}return n}function te(t){function e(e,n){var r;return r=401===e.getStatus()?b():402===e.getStatus()?m(t.bucket):403===e.getStatus()?w(t.path):n,r.setServerResponseProp(n.serverResponseProp()),r}return e}function ee(t){var e=te(t);function n(n,r){var i=e(n,r);return 404===n.getStatus()&&(i=g(t.path)),i.setServerResponseProp(r.serverResponseProp()),i}return n}function ne(t,e,n){var r=e.fullServerUrl(),i=bt(r),o="GET",a=t.maxOperationRetryTime(),s=new Xt(i,o,$t(t,n),a);return s.errorHandler=ee(e),s}function re(t,e,n){var r=e.fullServerUrl(),i=bt(r),o="GET",a=t.maxOperationRetryTime(),s=new Xt(i,o,Zt(t,n),a);return s.errorHandler=ee(e),s}function ie(t,e,n,r){var i=e.fullServerUrl(),o=bt(i),a="PATCH",s=Nt(n,r),u={"Content-Type":"application/json; charset=utf-8"},c=t.maxOperationRetryTime(),l=new Xt(o,a,$t(t,r),c);return l.headers=u,l.body=s,l.errorHandler=ee(e),l}function oe(t,e){var n=e.fullServerUrl(),r=bt(n),i="DELETE",o=t.maxOperationRetryTime();function a(t,e){}var s=new Xt(r,i,a,o);return s.successCodes=[200,204],s.errorHandler=ee(e),s}function ae(t,e){return t&&t["contentType"]||e&&e.type()||"application/octet-stream"}function se(t,e,n){var r=$(n);return r["fullPath"]=t.path,r["size"]=e.size(),r["contentType"]||(r["contentType"]=ae(null,e)),r}function ue(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function s(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}var u=s();a["Content-Type"]="multipart/related; boundary="+u;var c=se(e,r,i),l=Nt(c,n),h="--"+u+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+l+"\r\n--"+u+"\r\nContent-Type: "+c["contentType"]+"\r\n\r\n",f="\r\n--"+u+"--",d=zt.getBlob(h,r,f);if(null===d)throw S();var p={name:c["fullPath"]},v=_t(o),y="POST",g=t.maxUploadRetryTime(),m=new Xt(v,y,$t(t,n),g);return m.urlParams=p,m.headers=a,m.body=d.uploadData(),m.errorHandler=te(e),m}var ce=function(){function t(t,e,n,r){this.current=t,this.total=e,this.finalized=!!n,this.metadata=r||null}return t}();function le(t,e){var n;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(i){Jt(!1)}var r=e||["active"];return Jt(Gt(r,n)),n}function he(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a=se(e,r,i),s={name:a["fullPath"]},u=_t(o),c="POST",l={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":a["contentType"],"Content-Type":"application/json; charset=utf-8"},h=Nt(a,n),f=t.maxUploadRetryTime();function d(t,e){var n;le(t);try{n=t.getResponseHeader("X-Goog-Upload-URL")}catch(r){Jt(!1)}return Jt(ut(n)),n}var p=new Xt(u,c,d,f);return p.urlParams=s,p.headers=l,p.body=h,p.errorHandler=te(e),p}function fe(t,e,n,r){var i={"X-Goog-Upload-Command":"query"};function o(t,e){var n,i=le(t,["active","final"]);try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(a){Jt(!1)}var o=parseInt(n,10);return Jt(!isNaN(o)),new ce(o,r.size(),"final"===i)}var a="POST",s=t.maxUploadRetryTime(),u=new Xt(n,a,o,s);return u.headers=i,u.errorHandler=te(e),u}var de=262144;function pe(t,e,n,r,i,o,a,s){var u=new ce(0,0);if(a?(u.current=a.current,u.total=a.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw C();var c=u.total-u.current,l=c;i>0&&(l=Math.min(l,i));var h=u.current,f=h+l,d=l===c?"upload, finalize":"upload",p={"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":u.current},v=r.slice(h,f);if(null===v)throw S();function y(t,n){var i,a=le(t,["active","final"]),s=u.current+l,c=r.size();return i="final"===a?$t(e,o)(t,n):null,new ce(s,c,"final"===a,i)}var g="POST",m=e.maxUploadRetryTime(),b=new Xt(n,g,y,m);return b.headers=p,b.body=v.uploadData(),b.progressCallback=s||null,b.errorHandler=te(t),b}var ve=function(){function t(t,e,n){var r=it(t)||nt(e)||nt(n);if(r)this.next=t,this.error=e||null,this.complete=n||null;else{var i=t;this.next=i.next||null,this.error=i.error||null,this.complete=i.complete||null}}return t}(),ye=function(){function t(t,e,n,r,i,o){this.bytesTransferred=t,this.totalBytes=e,this.state=n,this.metadata=r,this.task=i,this.ref=o}return t}();function ge(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];tt(!0).then(function(){t.apply(null,e)})}}var me=function(){function t(t,e,n,r,i,o){void 0===o&&(o=null);var a=this;this.transferred_=0,this.needToFetchStatus_=!1,this.needToFetchMetadata_=!1,this.observers_=[],this.error_=null,this.uploadUrl_=null,this.request_=null,this.chunkMultiplier_=1,this.resolve_=null,this.reject_=null,this.ref_=t,this.authWrapper_=e,this.location_=n,this.blob_=i,this.metadata_=o,this.mappings_=r,this.resumable_=this.shouldDoResumable_(this.blob_),this.state_=G.RUNNING,this.errorHandler_=function(t){a.request_=null,a.chunkMultiplier_=1,t.codeEquals(p.CANCELED)?(a.needToFetchStatus_=!0,a.completeTransitions_()):(a.error_=t,a.transition_(G.ERROR))},this.metadataErrorHandler_=function(t){a.request_=null,t.codeEquals(p.CANCELED)?a.completeTransitions_():(a.error_=t,a.transition_(G.ERROR))},this.promise_=Z(function(t,e){a.resolve_=t,a.reject_=e,a.start_()}),this.promise_.then(null,function(){})}return t.prototype.makeProgressCallback_=function(){var t=this,e=this.transferred_;return function(n,r){t.updateProgress_(e+n)}},t.prototype.shouldDoResumable_=function(t){return t.size()>262144},t.prototype.start_=function(){this.state_===G.RUNNING&&null===this.request_&&(this.resumable_?null===this.uploadUrl_?this.createResumable_():this.needToFetchStatus_?this.fetchStatus_():this.needToFetchMetadata_?this.fetchMetadata_():this.continueUpload_():this.oneShotUpload_())},t.prototype.resolveToken_=function(t){var e=this;this.authWrapper_.getAuthToken().then(function(n){switch(e.state_){case G.RUNNING:t(n);break;case G.CANCELING:e.transition_(G.CANCELED);break;case G.PAUSING:e.transition_(G.PAUSED);break;default:}})},t.prototype.createResumable_=function(){var t=this;this.resolveToken_(function(e){var n=he(t.authWrapper_,t.location_,t.mappings_,t.blob_,t.metadata_),r=t.authWrapper_.makeRequest(n,e);t.request_=r,r.getPromise().then(function(e){t.request_=null,t.uploadUrl_=e,t.needToFetchStatus_=!1,t.completeTransitions_()},t.errorHandler_)})},t.prototype.fetchStatus_=function(){var t=this,e=this.uploadUrl_;this.resolveToken_(function(n){var r=fe(t.authWrapper_,t.location_,e,t.blob_),i=t.authWrapper_.makeRequest(r,n);t.request_=i,i.getPromise().then(function(e){e=e,t.request_=null,t.updateProgress_(e.current),t.needToFetchStatus_=!1,e.finalized&&(t.needToFetchMetadata_=!0),t.completeTransitions_()},t.errorHandler_)})},t.prototype.continueUpload_=function(){var t=this,e=de*this.chunkMultiplier_,n=new ce(this.transferred_,this.blob_.size()),r=this.uploadUrl_;this.resolveToken_(function(i){var o;try{o=pe(t.location_,t.authWrapper_,r,t.blob_,e,t.mappings_,n,t.makeProgressCallback_())}catch(s){return t.error_=s,void t.transition_(G.ERROR)}var a=t.authWrapper_.makeRequest(o,i);t.request_=a,a.getPromise().then(function(e){t.increaseMultiplier_(),t.request_=null,t.updateProgress_(e.current),e.finalized?(t.metadata_=e.metadata,t.transition_(G.SUCCESS)):t.completeTransitions_()},t.errorHandler_)})},t.prototype.increaseMultiplier_=function(){var t=de*this.chunkMultiplier_;t<33554432&&(this.chunkMultiplier_*=2)},t.prototype.fetchMetadata_=function(){var t=this;this.resolveToken_(function(e){var n=ne(t.authWrapper_,t.location_,t.mappings_),r=t.authWrapper_.makeRequest(n,e);t.request_=r,r.getPromise().then(function(e){t.request_=null,t.metadata_=e,t.transition_(G.SUCCESS)},t.metadataErrorHandler_)})},t.prototype.oneShotUpload_=function(){var t=this;this.resolveToken_(function(e){var n=ue(t.authWrapper_,t.location_,t.mappings_,t.blob_,t.metadata_),r=t.authWrapper_.makeRequest(n,e);t.request_=r,r.getPromise().then(function(e){t.request_=null,t.metadata_=e,t.updateProgress_(t.blob_.size()),t.transition_(G.SUCCESS)},t.errorHandler_)})},t.prototype.updateProgress_=function(t){var e=this.transferred_;this.transferred_=t,this.transferred_!==e&&this.notifyObservers_()},t.prototype.transition_=function(t){if(this.state_!==t)switch(t){case G.CANCELING:this.state_=t,null!==this.request_&&this.request_.cancel();break;case G.PAUSING:this.state_=t,null!==this.request_&&this.request_.cancel();break;case G.RUNNING:var e=this.state_===G.PAUSED;this.state_=t,e&&(this.notifyObservers_(),this.start_());break;case G.PAUSED:this.state_=t,this.notifyObservers_();break;case G.CANCELED:this.error_=k(),this.state_=t,this.notifyObservers_();break;case G.ERROR:this.state_=t,this.notifyObservers_();break;case G.SUCCESS:this.state_=t,this.notifyObservers_();break}},t.prototype.completeTransitions_=function(){switch(this.state_){case G.PAUSING:this.transition_(G.PAUSED);break;case G.CANCELING:this.transition_(G.CANCELED);break;case G.RUNNING:this.start_();break;default:break}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=Y(this.state_);return new ye(this.transferred_,this.blob_.size(),t,this.metadata_,this,this.ref_)},enumerable:!0,configurable:!0}),t.prototype.on=function(t,e,n,r){function i(e){if(t!==z.STATE_CHANGED)throw"Expected one of the event types: ["+z.STATE_CHANGED+"]."}void 0===e&&(e=void 0),void 0===n&&(n=void 0),void 0===r&&(r=void 0);var o="Expected a function or an Object with one of `next`, `error`, `complete` properties.",a=qt(!0).validator,s=Ut(null,!0).validator;function u(t){try{return void a(t)}catch(n){}try{s(t);var e=rt(t["next"])||rt(t["error"])||rt(t["complete"]);if(!e)throw"";return}catch(n){throw o}}var c=[Lt(i),Ut(u,!0),qt(!0),qt(!0)];Dt("on",c,arguments);var l=this;function h(t){function e(e,n,i){null!==t&&Dt("on",t,arguments);var o=new ve(e,n,r);return l.addObserver_(o),function(){l.removeObserver_(o)}}return e}function f(t){if(null===t)throw o;u(t)}var d=[Ut(f),qt(!0),qt(!0)],p=!(rt(e)||rt(n)||rt(r));return p?h(d):h(null)(e,n,r)},t.prototype.then=function(t,e){return this.promise_.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype.addObserver_=function(t){this.observers_.push(t),this.notifyObserver_(t)},t.prototype.removeObserver_=function(t){Yt(this.observers_,t)},t.prototype.notifyObservers_=function(){var t=this;this.finishPromise_();var e=Qt(this.observers_);e.forEach(function(e){t.notifyObserver_(e)})},t.prototype.finishPromise_=function(){if(null!==this.resolve_){var t=!0;switch(Y(this.state_)){case Q.SUCCESS:ge(this.resolve_.bind(null,this.snapshot))();break;case Q.CANCELED:case Q.ERROR:var e=this.reject_;ge(e.bind(null,this.error_))();break;default:t=!1;break}t&&(this.resolve_=null,this.reject_=null)}},t.prototype.notifyObserver_=function(t){var e=Y(this.state_);switch(e){case Q.RUNNING:case Q.PAUSED:null!==t.next&&ge(t.next.bind(t,this.snapshot))();break;case Q.SUCCESS:null!==t.complete&&ge(t.complete.bind(t))();break;case Q.CANCELED:case Q.ERROR:null!==t.error&&ge(t.error.bind(t,this.error_))();break;default:null!==t.error&&ge(t.error.bind(t,this.error_))()}},t.prototype.resume=function(){Dt("resume",[],arguments);var t=this.state_===G.PAUSED||this.state_===G.PAUSING;return t&&this.transition_(G.RUNNING),t},t.prototype.pause=function(){Dt("pause",[],arguments);var t=this.state_===G.RUNNING;return t&&this.transition_(G.PAUSING),t},t.prototype.cancel=function(){Dt("cancel",[],arguments);var t=this.state_===G.RUNNING||this.state_===G.PAUSING;return t&&this.transition_(G.CANCELING),t},t}(),be=function(){function t(t,e){this.authWrapper=t,this.location=e instanceof vt?e:vt.makeFromUrl(e)}return t.prototype.toString=function(){return Dt("toString",[],arguments),"gs://"+this.location.bucket+"/"+this.location.path},t.prototype.newRef=function(e,n){return new t(e,n)},t.prototype.mappings=function(){return Ot()},t.prototype.child=function(t){Dt("child",[Lt()],arguments);var e=gt(this.location.path,t),n=new vt(this.location.bucket,e);return this.newRef(this.authWrapper,n)},Object.defineProperty(t.prototype,"parent",{get:function(){var t=yt(this.location.path);if(null===t)return null;var e=new vt(this.location.bucket,t);return this.newRef(this.authWrapper,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){var t=new vt(this.location.bucket,"");return this.newRef(this.authWrapper,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this.location.bucket},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this.location.path},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return mt(this.location.path)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this.authWrapper.service()},enumerable:!0,configurable:!0}),t.prototype.put=function(t,e){return void 0===e&&(e=null),Dt("put",[Ft(),Vt(!0)],arguments),this.throwIfRoot_("put"),new me(this,this.authWrapper,this.location,this.mappings(),new zt(t),e)},t.prototype.putString=function(t,e,n){void 0===e&&(e=D.RAW),Dt("putString",[Lt(),Lt(j,!0),Vt(!0)],arguments),this.throwIfRoot_("putString");var r=L(e,t),i=$(n);return!nt(i["contentType"])&&nt(r.contentType)&&(i["contentType"]=r.contentType),new me(this,this.authWrapper,this.location,this.mappings(),new zt(r.data,!0),i)},t.prototype.delete=function(){Dt("delete",[],arguments),this.throwIfRoot_("delete");var t=this;return this.authWrapper.getAuthToken().then(function(e){var n=oe(t.authWrapper,t.location);return t.authWrapper.makeRequest(n,e).getPromise()})},t.prototype.getMetadata=function(){Dt("getMetadata",[],arguments),this.throwIfRoot_("getMetadata");var t=this;return this.authWrapper.getAuthToken().then(function(e){var n=ne(t.authWrapper,t.location,t.mappings());return t.authWrapper.makeRequest(n,e).getPromise()})},t.prototype.updateMetadata=function(t){Dt("updateMetadata",[Vt()],arguments),this.throwIfRoot_("updateMetadata");var e=this;return this.authWrapper.getAuthToken().then(function(n){var r=ie(e.authWrapper,e.location,t,e.mappings());return e.authWrapper.makeRequest(r,n).getPromise()})},t.prototype.getDownloadURL=function(){Dt("getDownloadURL",[],arguments),this.throwIfRoot_("getDownloadURL");var t=this;return this.authWrapper.getAuthToken().then(function(e){var n=re(t.authWrapper,t.location,t.mappings());return t.authWrapper.makeRequest(n,e).getPromise().then(function(t){if(null===t)throw O();return t})})},t.prototype.throwIfRoot_=function(t){if(""===this.location.path)throw P(t)},t}(),we=function(){function t(t){this.promise_=et(t)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){void 0===t&&(t=!1)},t}(),_e=function(){function t(){this.map_={},this.id_=f}return t.prototype.addRequest=function(t){var e=this.id_;this.id_++,this.map_[e]=t;var n=this;function r(){delete n.map_[e]}t.getPromise().then(r,r)},t.prototype.clear=function(){J(this.map_,function(t,e){e&&e.cancel(!0)}),this.map_={}},t}(),ke=function(){function t(e,n,r,i,o){if(this.bucket_=null,this.deleted_=!1,this.app_=e,null!==this.app_){var a=this.app_.options;nt(a)&&(this.bucket_=t.extractBucket_(a))}this.storageRefMaker_=n,this.requestMaker_=r,this.pool_=o,this.service_=i,this.maxOperationRetryTime_=l,this.maxUploadRetryTime_=h,this.requestMap_=new _e}return t.extractBucket_=function(t){var e=t[c]||null;if(null==e)return null;var n=vt.makeFromBucketSpec(e);return n.bucket},t.prototype.getAuthToken=function(){return null!==this.app_&&nt(this.app_.INTERNAL)&&nt(this.app_.INTERNAL.getToken)?this.app_.INTERNAL.getToken().then(function(t){return null!==t?t.accessToken:null},function(t){return null}):tt(null)},t.prototype.bucket=function(){if(this.deleted_)throw x();return this.bucket_},t.prototype.service=function(){return this.service_},t.prototype.makeStorageReference=function(t){return this.storageRefMaker_(this,t)},t.prototype.makeRequest=function(t,e){if(this.deleted_)return new we(x());var n=this.requestMaker_(t,e,this.pool_);return this.requestMap_.addRequest(n),n},t.prototype.deleteApp=function(){this.deleted_=!0,this.app_=null,this.requestMap_.clear()},t.prototype.maxUploadRetryTime=function(){return this.maxUploadRetryTime_},t.prototype.setMaxUploadRetryTime=function(t){this.maxUploadRetryTime_=t},t.prototype.maxOperationRetryTime=function(){return this.maxOperationRetryTime_},t.prototype.setMaxOperationRetryTime=function(t){this.maxOperationRetryTime_=t},t}();function Ee(t,e,n){var r=1,i=null,o=!1,a=0;function s(){return 2===a}var u=!1;function c(){u||(u=!0,e.apply(null,arguments))}function l(e){i=setTimeout(function(){i=null,t(h,s())},e)}function h(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!u)if(t)c.apply(null,arguments);else{var i,h=s()||o;if(h)c.apply(null,arguments);else r<64&&(r*=2),1===a?(a=2,i=0):i=1e3*(r+Math.random()),l(i)}}var f=!1;function d(t){f||(f=!0,u||(null!==i?(t||(a=2),clearTimeout(i),l(0)):t||(a=1)))}return l(0),setTimeout(function(){o=!0,d(!0)},n),d}function Te(t){t(!1)}var Se=function(){function t(t,e,n,r,i,o,a,s,u,c,l){this.pendingXhr_=null,this.backoffId_=null,this.resolve_=null,this.reject_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=a,this.errorCallback_=s,this.progressCallback_=c,this.timeout_=u,this.pool_=l;var h=this;this.promise_=Z(function(t,e){h.resolve_=t,h.reject_=e,h.start_()})}return t.prototype.start_=function(){var t=this;function e(e,n){if(n)e(!1,new Ce(!1,null,!0));else{var r=t.pool_.createXhrIo();t.pendingXhr_=r,null!==t.progressCallback_&&r.addUploadProgressListener(i),r.send(t.url_,t.method_,t.body_,t.headers_).then(function(n){null!==t.progressCallback_&&n.removeUploadProgressListener(i),t.pendingXhr_=null,n=n;var r=n.getErrorCode()===H.NO_ERROR,o=n.getStatus();if(r&&!t.isRetryStatusCode_(o)){var a=Gt(t.successCodes_,o);e(!0,new Ce(a,n))}else{var s=n.getErrorCode()===H.ABORT;e(!1,new Ce(!1,null,s))}})}function i(e){var n=e.loaded,r=e.lengthComputable?e.total:-1;null!==t.progressCallback_&&t.progressCallback_(n,r)}}function n(e,n){var r=t.resolve_,i=t.reject_,o=n.xhr;if(n.wasSuccessCode)try{var a=t.callback_(o,o.getResponseText());rt(a)?r(a):r()}catch(u){i(u)}else if(null!==o){var s=y();s.setServerResponseProp(o.getResponseText()),t.errorCallback_?i(t.errorCallback_(o,s)):i(s)}else if(n.canceled){s=t.appDelete_?x():k();i(s)}else{s=_();i(s)}}this.canceled_?n(!1,new Ce(!1,null,!0)):this.backoffId_=Ee(e,n,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&Te(this.backoffId_),null!==this.pendingXhr_&&this.pendingXhr_.abort()},t.prototype.isRetryStatusCode_=function(t){var e=t>=500&&t<600,n=[408,429],r=Gt(n,t),i=Gt(this.additionalRetryCodes_,t);return e||r||i},t}(),Ce=function(){function t(t,e,n){this.wasSuccessCode=t,this.xhr=e,this.canceled=!!n}return t}();function Oe(t,e){null!==e&&e.length>0&&(t["Authorization"]="Firebase "+e)}function Ae(t){var e="undefined"!==typeof i.a?i.a.SDK_VERSION:"AppManager";t["X-Firebase-Storage-Version"]="webjs/"+e}function Ie(t,e,n){var r=kt(t.urlParams),i=t.url+r,o=$(t.headers);return Oe(o,e),Ae(o),new Se(i,t.method,o,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,n)}var xe=function(){function t(t,e,n){function r(t,e){return new be(t,e)}if(this.bucket_=null,this.authWrapper_=new ke(t,r,Ie,this,e),this.app_=t,null!=n)this.bucket_=vt.makeFromBucketSpec(n);else{var i=this.authWrapper_.bucket();null!=i&&(this.bucket_=new vt(i,""))}this.internals_=new Pe(this)}return t.prototype.ref=function(t){function e(t){if(/^[A-Za-z]+:\/\//.test(t))throw"Expected child path but got a URL, use refFromURL instead."}if(Dt("ref",[Lt(e,!0)],arguments),null==this.bucket_)throw new Error("No Storage Bucket defined in Firebase Options.");var n=new be(this.authWrapper_,this.bucket_);return null!=t?n.child(t):n},t.prototype.refFromURL=function(t){function e(t){if(!/^[A-Za-z]+:\/\//.test(t))throw"Expected full URL but got a child path, use ref instead.";try{vt.makeFromUrl(t)}catch(e){throw"Expected valid full URL but got an invalid one."}}return Dt("refFromURL",[Lt(e,!1)],arguments),new be(this.authWrapper_,t)},Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this.authWrapper_.maxUploadRetryTime()},enumerable:!0,configurable:!0}),t.prototype.setMaxUploadRetryTime=function(t){Dt("setMaxUploadRetryTime",[Bt()],arguments),this.authWrapper_.setMaxUploadRetryTime(t)},Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this.authWrapper_.maxOperationRetryTime()},enumerable:!0,configurable:!0}),t.prototype.setMaxOperationRetryTime=function(t){Dt("setMaxOperationRetryTime",[Bt()],arguments),this.authWrapper_.setMaxOperationRetryTime(t)},Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"INTERNAL",{get:function(){return this.internals_},enumerable:!0,configurable:!0}),t}(),Pe=function(){function t(t){this.service_=t}return t.prototype.delete=function(){return this.service_.authWrapper_.deleteApp(),tt(void 0)},t}(),Ne="storage";function Re(t,e,n){return new xe(t,new dt,n)}function De(t){var e={TaskState:Q,TaskEvent:z,StringFormat:D,Storage:xe,Reference:be};t.INTERNAL.registerService(Ne,Re,e,void 0,!0)}De(i.a)},"2f21":function(t,e,n){"use strict";var r=n("79e5");t.exports=function(t,e){return!!t&&r(function(){e?t.call(null,function(){},1):t.call(null)})}},"2f37":function(t,e,n){var r=n("63b6");r(r.S,"Date",{now:function(){return(new Date).getTime()}})},"2f74":function(t,e,n){"use strict";function r(){return!1}e["a"]=r},"2fdb":function(t,e,n){"use strict";var r=n("5ca1"),i=n("d2c8"),o="includes";r(r.P+r.F*n("5147")(o),"String",{includes:function(t){return!!~i(this,t,o).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},3024:function(t,e){t.exports=function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},"30b7":function(t,e,n){},"32a6":function(t,e,n){var r=n("241e"),i=n("c3a1");n("ce7e")("keys",function(){return function(t){return i(r(t))}})},"332d":function(t,e){t.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M14.958 9.367l-2.189 1.837a.75.75 0 0 0 .965 1.149l3.788-3.18a.747.747 0 0 0 .21-.284.75.75 0 0 0-.17-.945L13.77 4.762a.75.75 0 1 0-.964 1.15l2.331 1.955H6.22A.75.75 0 0 0 6 7.9a4 4 0 1 0 1.477 7.718l-.344-1.489A2.5 2.5 0 1 1 6.039 9.4l-.008-.032h8.927z"/></svg>'},"34ef":function(t,e,n){n("ec30")("Uint8",1,function(t){return function(e,n,r){return t(this,e,n,r)}})},3523:function(t,e,n){"use strict";(function(r){function i(t){return t&&"object"===typeof t&&"default"in t?t["default"]:t}Object.defineProperty(e,"__esModule",{value:!0});var o=n("cd51"),a=n("abfd"),s=n("9802"),u=i(n("c23d")),c=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),o.stringify(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:o.jsonEval(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}(),l=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return o.contains(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}(),h=function(t){try{if("undefined"!==typeof window&&"undefined"!==typeof window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new c(e)}}catch(n){}return new l},f=h("localStorage"),d=h("sessionStorage"),p=new a.Logger("@firebase/database"),v=function(){var t=1;return function(){return t++}}(),y=function(t){var e=o.stringToByteArray(t),n=new o.Sha1;n.update(e);var r=n.digest();return o.base64.encodeByteArray(r)},g=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",r=0;r<t.length;r++)Array.isArray(t[r])||t[r]&&"object"===typeof t[r]&&"number"===typeof t[r].length?n+=g.apply(null,t[r]):"object"===typeof t[r]?n+=o.stringify(t[r]):n+=t[r],n+=" ";return n},m=null,b=!0,w=function(t,e){o.assert(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(p.logLevel=a.LogLevel.VERBOSE,m=p.log.bind(p),e&&d.set("logging_enabled",!0)):"function"===typeof t?m=t:(m=null,d.remove("logging_enabled"))},_=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!0===b&&(b=!1,null===m&&!0===d.get("logging_enabled")&&w(!0)),m){var n=g.apply(null,t);m(n)}},k=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];_.apply(void 0,[t].concat(e))}},E=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+g.apply(void 0,t);p.error(n)},T=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+g.apply(void 0,t);throw p.error(n),new Error(n)},S=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE WARNING: "+g.apply(void 0,t);p.warn(n)},C=function(){"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&S("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},O=function(t){return"number"===typeof t&&(t!=t||t==Number.POSITIVE_INFINITY||t==Number.NEGATIVE_INFINITY)},A=function(t){if(o.isNodeSdk()||"complete"===document.readyState)t();else{var e=!1,n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}},I="[MIN_NAME]",x="[MAX_NAME]",P=function(t,e){if(t===e)return 0;if(t===I||e===x)return-1;if(e===I||t===x)return 1;var n=q(t),r=q(e);return null!==n?null!==r?n-r==0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1},N=function(t,e){return t===e?0:t<e?-1:1},R=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+o.stringify(e))},D=function(t){if("object"!==typeof t||null===t)return o.stringify(t);var e=[];for(var n in t)e.push(n);e.sort();for(var r="{",i=0;i<e.length;i++)0!==i&&(r+=","),r+=o.stringify(e[i]),r+=":",r+=D(t[e[i]]);return r+="}",r},j=function(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r},M=function(t,e){if(Array.isArray(t))for(var n=0;n<t.length;++n)e(n,t[n]);else o.forEach(t,function(t,n){return e(n,t)})},L=function(t){o.assert(!O(t),"Invalid JSON number");var e,n,r,i,a,s,u,c=11,l=52,h=(1<<c-1)-1;for(0===t?(n=0,r=0,e=1/t===-1/0?1:0):(e=t<0,t=Math.abs(t),t>=Math.pow(2,1-h)?(i=Math.min(Math.floor(Math.log(t)/Math.LN2),h),n=i+h,r=Math.round(t*Math.pow(2,l-i)-Math.pow(2,l))):(n=0,r=Math.round(t/Math.pow(2,1-h-l)))),s=[],a=l;a;a-=1)s.push(r%2?1:0),r=Math.floor(r/2);for(a=c;a;a-=1)s.push(n%2?1:0),n=Math.floor(n/2);s.push(e?1:0),s.reverse(),u=s.join("");var f="";for(a=0;a<64;a+=8){var d=parseInt(u.substr(a,8),2).toString(16);1===d.length&&(d="0"+d),f+=d}return f.toLowerCase()},F=function(){return!("object"!==typeof window||!window["chrome"]||!window["chrome"]["extension"]||/^chrome/.test(window.location.href))},V=function(){return"object"===typeof Windows&&"object"===typeof Windows.UI},B=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==t?n="Client doesn't have permission to access the desired data.":"unavailable"==t&&(n="The service is unavailable");var r=new Error(t+" at "+e.path.toString()+": "+n);return r.code=t.toUpperCase(),r},U=new RegExp("^-?\\d{1,10}$"),q=function(t){if(U.test(t)){var e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},W=function(t){try{t()}catch(e){setTimeout(function(){var t=e.stack||"";throw S("Exception was thrown by user callback.",t),e},Math.floor(0))}},K=function(){var t="object"===typeof window&&window["navigator"]&&window["navigator"]["userAgent"]||"";return t.search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},H=function(t,e){var n=setTimeout(t,e);return"object"===typeof n&&n["unref"]&&n["unref"](),n},z=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return Object.defineProperty(t,"Empty",{get:function(){return new t("")},enumerable:!0,configurable:!0}),t.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},t.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},t.prototype.popFront=function(){var e=this.pieceNum_;return e<this.pieces_.length&&e++,new t(this.pieces_,e)},t.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t.prototype.toUrlEncodedString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+encodeURIComponent(String(this.pieces_[e])));return t||"/"},t.prototype.slice=function(t){return void 0===t&&(t=0),this.pieces_.slice(this.pieceNum_+t)},t.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var e=[],n=this.pieceNum_;n<this.pieces_.length-1;n++)e.push(this.pieces_[n]);return new t(e,0)},t.prototype.child=function(e){for(var n=[],r=this.pieceNum_;r<this.pieces_.length;r++)n.push(this.pieces_[r]);if(e instanceof t)for(r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{var i=e.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new t(n,0)},t.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},t.relativePath=function(e,n){var r=e.getFront(),i=n.getFront();if(null===r)return n;if(r===i)return t.relativePath(e.popFront(),n.popFront());throw new Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+e+")")},t.comparePaths=function(t,e){for(var n=t.slice(),r=e.slice(),i=0;i<n.length&&i<r.length;i++){var o=P(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1},t.prototype.equals=function(t){if(this.getLength()!==t.getLength())return!1;for(var e=this.pieceNum_,n=t.pieceNum_;e<=this.pieces_.length;e++,n++)if(this.pieces_[e]!==t.pieces_[n])return!1;return!0},t.prototype.contains=function(t){var e=this.pieceNum_,n=t.pieceNum_;if(this.getLength()>t.getLength())return!1;while(e<this.pieces_.length){if(this.pieces_[e]!==t.pieces_[n])return!1;++e,++n}return!0},t}(),G=function(){function t(t,e){this.errorPrefix_=e,this.parts_=t.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=o.stringLength(this.parts_[n]);this.checkValid_()}return Object.defineProperty(t,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!0,configurable:!0}),t.prototype.push=function(t){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(t),this.byteLength_+=o.stringLength(t),this.checkValid_()},t.prototype.pop=function(){var t=this.parts_.pop();this.byteLength_-=o.stringLength(t),this.parts_.length>0&&(this.byteLength_-=1)},t.prototype.checkValid_=function(){if(this.byteLength_>t.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+t.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>t.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+t.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},t.prototype.toErrorString=function(){return 0==this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},t}(),Q="5",Y="v",X="s",J="r",$="f",Z="firebaseio.com",tt="ls",et="websocket",nt="long_polling",rt=function(){function t(t,e,n,r,i){void 0===i&&(i=""),this.secure=e,this.namespace=n,this.webSocketOnly=r,this.persistenceKey=i,this.host=t.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=f.get("host:"+t)||this.host}return t.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()},t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},t.prototype.updateHost=function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&f.set("host:"+this.host,this.internalHost))},t.prototype.connectionURL=function(t,e){var n;if(o.assert("string"===typeof t,"typeof type must == string"),o.assert("object"===typeof e,"typeof params must == object"),t===et)n=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(t!==nt)throw new Error("Unknown connection type: "+t);n=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(e["ns"]=this.namespace);var r=[];return o.forEach(e,function(t,e){r.push(t+"="+e)}),n+r.join("&")},t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},t}();function it(t){for(var e="",n=t.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(o){}e+="/"+i}return e}function ot(t){var e={};"?"===t.charAt(0)&&(t=t.substring(1));for(var n=0,r=t.split("&");n<r.length;n++){var i=r[n];if(0!==i.length){var o=i.split("=");2===o.length?e[decodeURIComponent(o[0])]=decodeURIComponent(o[1]):S("Invalid query segment '"+i+"' in query '"+t+"'")}}return e}var at,st,ut=function(t){var e=ct(t),n=e.subdomain;"firebase"===e.domain&&T(e.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),n&&"undefined"!=n||"localhost"===e.domain||T("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),e.secure||C();var r="ws"===e.scheme||"wss"===e.scheme;return{repoInfo:new rt(e.host,e.secure,n,r),path:new z(e.pathString)}},ct=function(t){var e="",n="",r="",i="",o=!0,a="https",s=443;if("string"===typeof t){var u=t.indexOf("//");u>=0&&(a=t.substring(0,u-1),t=t.substring(u+2));var c=t.indexOf("/");-1===c&&(c=t.length);var l=t.indexOf("?");-1===l&&(l=t.length),e=t.substring(0,Math.min(c,l)),c<l&&(i=it(t.substring(c,l)));var h=ot(t.substring(Math.min(t.length,l)));u=e.indexOf(":"),u>=0?(o="https"===a||"wss"===a,s=parseInt(e.substring(u+1),10)):u=t.length;var f=e.split(".");3===f.length?(n=f[1],r=f[0].toLowerCase()):2===f.length?n=f[0]:"localhost"===f[0].slice(0,u).toLowerCase()&&(n="localhost"),""===r&&"ns"in h&&(r=h["ns"])}return{host:e,port:s,domain:n,subdomain:r,secure:o,scheme:a,pathString:i}},lt=/[\[\].#$\/\u0000-\u001F\u007F]/,ht=/[\[\].#$\u0000-\u001F\u007F]/,ft=10485760,dt=function(t){return"string"===typeof t&&0!==t.length&&!lt.test(t)},pt=function(t){return"string"===typeof t&&0!==t.length&&!ht.test(t)},vt=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),pt(t)},yt=function(t){return null===t||"string"===typeof t||"number"===typeof t&&!O(t)||t&&"object"===typeof t&&o.contains(t,".sv")},gt=function(t,e,n,r,i){i&&void 0===n||mt(o.errorPrefix(t,e,i),n,r)},mt=function(t,e,n){var r=n instanceof z?new G(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+r.toErrorString());if("function"===typeof e)throw new Error(t+"contains a function "+r.toErrorString()+" with contents = "+e.toString());if(O(e))throw new Error(t+"contains "+e.toString()+" "+r.toErrorString());if("string"===typeof e&&e.length>ft/3&&o.stringLength(e)>ft)throw new Error(t+"contains a string greater than "+ft+" utf8 bytes "+r.toErrorString()+" ('"+e.substring(0,50)+"...')");if(e&&"object"===typeof e){var i=!1,a=!1;if(o.forEach(e,function(e,n){if(".value"===e)i=!0;else if(".priority"!==e&&".sv"!==e&&(a=!0,!dt(e)))throw new Error(t+" contains an invalid key ("+e+") "+r.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');r.push(e),mt(t,n,r),r.pop()}),i&&a)throw new Error(t+' contains ".value" child '+r.toErrorString()+" in addition to actual children.")}},bt=function(t,e){var n,r;for(n=0;n<e.length;n++){r=e[n];for(var i=r.slice(),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!dt(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}e.sort(z.comparePaths);var a=null;for(n=0;n<e.length;n++){if(r=e[n],null!==a&&a.contains(r))throw new Error(t+"contains a path "+a.toString()+" that is ancestor of another path "+r.toString());a=r}},wt=function(t,e,n,r,i){if(!i||void 0!==n){var a=o.errorPrefix(t,e,i);if(!n||"object"!==typeof n||Array.isArray(n))throw new Error(a+" must be an object containing the children to replace.");var s=[];o.forEach(n,function(t,e){var n=new z(t);if(mt(a,e,r.child(n)),".priority"===n.getBack()&&!yt(e))throw new Error(a+"contains an invalid value for '"+n.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(n)}),bt(a,s)}},_t=function(t,e,n,r){if(!r||void 0!==n){if(O(n))throw new Error(o.errorPrefix(t,e,r)+"is "+n.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!yt(n))throw new Error(o.errorPrefix(t,e,r)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},kt=function(t,e,n,r){if(!r||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(o.errorPrefix(t,e,r)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},Et=function(t,e,n,r){if((!r||void 0!==n)&&!dt(n))throw new Error(o.errorPrefix(t,e,r)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Tt=function(t,e,n,r){if((!r||void 0!==n)&&!pt(n))throw new Error(o.errorPrefix(t,e,r)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},St=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Tt(t,e,n,r)},Ct=function(t,e){if(".info"===e.getFront())throw new Error(t+" failed = Can't modify data under /.info/")},Ot=function(t,e,n){var r=n.path.toString();if("string"!==typeof n.repoInfo.host||0===n.repoInfo.host.length||!dt(n.repoInfo.namespace)&&"localhost"!==n.repoInfo.host.split(":")[0]||0!==r.length&&!vt(r))throw new Error(o.errorPrefix(t,e,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},At=function(t,e,n,r){if((!r||void 0!==n)&&"boolean"!==typeof n)throw new Error(o.errorPrefix(t,e,r)+"must be a boolean.")},It=function(){function t(t,e){this.repo_=t,this.path_=e}return t.prototype.cancel=function(t){o.validateArgCount("OnDisconnect.cancel",0,1,arguments.length),o.validateCallback("OnDisconnect.cancel",1,t,!0);var e=new o.Deferred;return this.repo_.onDisconnectCancel(this.path_,e.wrapCallback(t)),e.promise},t.prototype.remove=function(t){o.validateArgCount("OnDisconnect.remove",0,1,arguments.length),Ct("OnDisconnect.remove",this.path_),o.validateCallback("OnDisconnect.remove",1,t,!0);var e=new o.Deferred;return this.repo_.onDisconnectSet(this.path_,null,e.wrapCallback(t)),e.promise},t.prototype.set=function(t,e){o.validateArgCount("OnDisconnect.set",1,2,arguments.length),Ct("OnDisconnect.set",this.path_),gt("OnDisconnect.set",1,t,this.path_,!1),o.validateCallback("OnDisconnect.set",2,e,!0);var n=new o.Deferred;return this.repo_.onDisconnectSet(this.path_,t,n.wrapCallback(e)),n.promise},t.prototype.setWithPriority=function(t,e,n){o.validateArgCount("OnDisconnect.setWithPriority",2,3,arguments.length),Ct("OnDisconnect.setWithPriority",this.path_),gt("OnDisconnect.setWithPriority",1,t,this.path_,!1),_t("OnDisconnect.setWithPriority",2,e,!1),o.validateCallback("OnDisconnect.setWithPriority",3,n,!0);var r=new o.Deferred;return this.repo_.onDisconnectSetWithPriority(this.path_,t,e,r.wrapCallback(n)),r.promise},t.prototype.update=function(t,e){if(o.validateArgCount("OnDisconnect.update",1,2,arguments.length),Ct("OnDisconnect.update",this.path_),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,S("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}wt("OnDisconnect.update",1,t,this.path_,!1),o.validateCallback("OnDisconnect.update",2,e,!0);var i=new o.Deferred;return this.repo_.onDisconnectUpdate(this.path_,t,i.wrapCallback(e)),i.promise},t}(),xt=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return o.validateArgCount("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}(),Pt=function(){var t="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",e=0,n=[];return function(r){var i,a=r===e;e=r;var s=new Array(8);for(i=7;i>=0;i--)s[i]=t.charAt(r%64),r=Math.floor(r/64);o.assert(0===r,"Cannot push at time == 0");var u=s.join("");if(a){for(i=11;i>=0&&63===n[i];i--)n[i]=0;n[i]++}else for(i=0;i<12;i++)n[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)u+=t.charAt(n[i]);return o.assert(20===u.length,"nextPushId: Length should be 20."),u}}(),Nt=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}(),Rt=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new Nt(I,t),r=new Nt(I,e);return 0!==this.compare(n,r)},t.prototype.minPost=function(){return Nt.MIN},t}(),Dt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return at},set:function(t){at=t},enumerable:!0,configurable:!0}),e.prototype.compare=function(t,e){return P(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw o.assertionError("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return Nt.MIN},e.prototype.maxPost=function(){return new Nt(x,at)},e.prototype.makePost=function(t,e){return o.assert("string"===typeof t,"KeyIndex indexValue must always be a string."),new Nt(t,at)},e.prototype.toString=function(){return".key"},e}(Rt),jt=new Dt;function Mt(t){st=t}var Lt,Ft,Vt,Bt=function(t){return"number"===typeof t?"number:"+L(t):"string:"+t},Ut=function(t){if(t.isLeafNode()){var e=t.val();o.assert("string"===typeof e||"number"===typeof e||"object"===typeof e&&o.contains(e,".sv"),"Priority must be a string or number.")}else o.assert(t===st||t.isEmpty(),"priority of unexpected type.");o.assert(t===st||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},qt=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,o.assert(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Ut(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return Lt},set:function(t){Lt=t},enumerable:!0,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return e.isEmpty()?this:".priority"===e.getFront()?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var r=e.getFront();return null===r?n:n.isEmpty()&&".priority"!==r?this:(o.assert(".priority"!==r||1===e.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(e.popFront(),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+Bt(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"===e?L(this.value_):this.value_,this.lazyHash_=y(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:(o.assert(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,r=typeof this.value_,i=t.VALUE_TYPE_ORDER.indexOf(n),a=t.VALUE_TYPE_ORDER.indexOf(r);return o.assert(i>=0,"Unknown leaf type: "+n),o.assert(a>=0,"Unknown leaf type: "+r),i===a?"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:a-i},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode()){var e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}();function Wt(t){Ft=t}function Kt(t){Vt=t}var Ht,zt,Gt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?P(t.name,e.name):i},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return Nt.MIN},e.prototype.maxPost=function(){return new Nt(x,new qt("[PRIORITY-POST]",Vt))},e.prototype.makePost=function(t,e){var n=Ft(t);return new Nt(e,new qt("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(Rt),Qt=new Gt,Yt=function(){function t(t,e,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];var o=1;while(!t.isEmpty())if(t=t,o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_){e=e.left;while(!e.isEmpty())this.nodeStack_.push(e),e=e.right}else{e=e.right;while(!e.isEmpty())this.nodeStack_.push(e),e=e.left}return t},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}(),Xt=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:$t.EMPTY_NODE,this.right=null!=o?o:$t.EMPTY_NODE}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r,i;return i=this,r=n(t,i.key),i=r<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return $t.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()},t.prototype.remove=function(t,e){var n,r;if(n=this,e(t,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return $t.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},t.prototype.check_=function(){var t;if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");if(t=this.left.check_(),t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}(),Jt=function(){function t(){}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Xt(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}(),$t=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Xt.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Xt.BLACK,null,null))},t.prototype.get=function(t){var e,n=this.root_;while(!n.isEmpty()){if(e=this.comparator_(t,n.key),0===e)return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){var e,n=this.root_,r=null;while(!n.isEmpty()){if(e=this.comparator_(t,n.key),0===e){if(n.left.isEmpty())return r?r.key:null;n=n.left;while(!n.right.isEmpty())n=n.right;return n.key}e<0?n=n.left:e>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new Yt(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new Yt(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new Yt(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new Yt(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new Jt,t}(),Zt=Math.log(2),te=function(){function t(t){var e=function(t){return parseInt(Math.log(t)/Zt,10)},n=function(t){return parseInt(Array(t+1).join("1"),2)};this.count=e(t+1),this.current_=this.count-1;var r=n(this.count);this.bits_=t+1&r}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}(),ee=function(t,e,n,r){t.sort(e);var i=function(e,r){var o,a,s=r-e;if(0==s)return null;if(1==s)return o=t[e],a=n?n(o):o,new Xt(a,o.node,Xt.BLACK,null,null);var u=parseInt(s/2,10)+e,c=i(e,u),l=i(u+1,r);return o=t[u],a=n?n(o):o,new Xt(a,o.node,Xt.BLACK,c,l)},o=function(e){for(var r=null,o=null,a=t.length,s=function(e,r){var o=a-e,s=a;a-=e;var c=i(o+1,s),l=t[o],h=n?n(l):l;u(new Xt(h,l.node,r,null,c))},u=function(t){r?(r.left=t,r=t):(o=t,r=t)},c=0;c<e.count;++c){var l=e.nextBitIsOne(),h=Math.pow(2,e.count-(c+1));l?s(h,Xt.BLACK):(s(h,Xt.BLACK),s(h,Xt.RED))}return o},a=new te(t.length),s=o(a);return new $t(r||e,s)},ne={},re=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return o.assert(ne&&Qt,"ChildrenNode.ts has not been loaded"),Ht=Ht||new t({".priority":ne},{".priority":Qt}),Ht},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var e=o.safeGet(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e===ne?null:e},t.prototype.hasIndex=function(t){return o.contains(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){o.assert(e!==jt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");var r,i=[],a=!1,s=n.getIterator(Nt.Wrap),u=s.getNext();while(u)a=a||e.isDefinedOn(u.node),i.push(u),u=s.getNext();r=a?ee(i,e.getCompare()):ne;var c=e.toString(),l=o.clone(this.indexSet_);l[c]=e;var h=o.clone(this.indexes_);return h[c]=r,new t(h,l)},t.prototype.addToIndexes=function(e,n){var r=this,i=o.map(this.indexes_,function(t,i){var a=o.safeGet(r.indexSet_,i);if(o.assert(a,"Missing index implementation for "+i),t===ne){if(a.isDefinedOn(e.node)){var s=[],u=n.getIterator(Nt.Wrap),c=u.getNext();while(c)c.name!=e.name&&s.push(c),c=u.getNext();return s.push(e),ee(s,a.getCompare())}return ne}var l=n.get(e.name),h=t;return l&&(h=h.remove(new Nt(e.name,l))),h.insert(e,e.node)});return new t(i,this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){var r=o.map(this.indexes_,function(t){if(t===ne)return t;var r=n.get(e.name);return r?t.remove(new Nt(e.name,r)):t});return new t(r,this.indexSet_)},t}();function ie(t,e){return P(t.name,e.name)}function oe(t,e){return P(t,e)}var ae=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Ut(this.priorityNode_),this.children_.isEmpty()&&o.assert(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return zt||(zt=new t(new $t(oe),null,re.Default))},enumerable:!0,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||zt},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?zt:e},t.prototype.getChild=function(t){var e=t.getFront();return null===e?this:this.getImmediateChild(e).getChild(t.popFront())},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if(o.assert(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var r=new Nt(e,n),i=void 0,a=void 0,s=void 0;return n.isEmpty()?(i=this.children_.remove(e),a=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),a=this.indexMap_.addToIndexes(r,this.children_)),s=i.isEmpty()?zt:this.priorityNode_,new t(i,s,a)},t.prototype.updateChild=function(t,e){var n=t.getFront();if(null===n)return e;o.assert(".priority"!==t.getFront()||1===t.getLength(),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(t.popFront(),e);return this.updateImmediateChild(n,r)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(Qt,function(a,s){n[a]=s.val(e),r++,o&&t.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1}),!e&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+Bt(this.getPriority().val())+":"),this.forEachChild(Qt,function(e,n){var r=n.hash();""!==r&&(t+=":"+e+":"+r)}),this.lazyHash_=""===t?"":y(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new Nt(t,e));return i?i.name:null}return this.children_.getPredecessorKey(t)},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new Nt(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new Nt(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal(function(t){return e(t.name,t.node)}):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,function(t){return t});var r=this.children_.getIteratorFrom(t.name,Nt.Wrap),i=r.peek();while(null!=i&&e.compare(i,t)<0)r.getNext(),i=r.peek();return r},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,function(t){return t});var r=this.children_.getReverseIteratorFrom(t.name,Nt.Wrap),i=r.peek();while(null!=i&&e.compare(i,t)>0)r.getNext(),i=r.peek();return r},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===ue?-1:0},t.prototype.withIndex=function(e){if(e===jt||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===jt||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){var n=this.getIterator(Qt),r=e.getIterator(Qt),i=n.getNext(),o=r.getNext();while(i&&o){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},t.prototype.resolveIndex_=function(t){return t===jt?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}(),se=function(t){function e(){return t.call(this,new $t(oe),ae.EMPTY_NODE,re.Default)||this}return s.__extends(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return ae.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(ae),ue=new se;Object.defineProperties(Nt,{MIN:{value:new Nt(I,ae.EMPTY_NODE)},MAX:{value:new Nt(x,ue)}}),Dt.__EMPTY_NODE=ae.EMPTY_NODE,qt.__childrenNodeConstructor=ae,Mt(ue),Kt(ue);var ce=!0;function le(t,e){if(void 0===e&&(e=null),null===t)return ae.EMPTY_NODE;if("object"===typeof t&&".priority"in t&&(e=t[".priority"]),o.assert(null===e||"string"===typeof e||"number"===typeof e||"object"===typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"===typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!==typeof t||".sv"in t){var n=t;return new qt(n,le(e))}if(t instanceof Array||!ce){var r=ae.EMPTY_NODE,i=t;return o.forEach(i,function(t,e){if(o.contains(i,t)&&"."!==t.substring(0,1)){var n=le(e);!n.isLeafNode()&&n.isEmpty()||(r=r.updateImmediateChild(t,n))}}),r.updatePriority(le(e))}var a=[],s=!1,u=t;if(o.forEach(u,function(t,e){if("string"!==typeof t||"."!==t.substring(0,1)){var n=le(u[t]);n.isEmpty()||(s=s||!n.getPriority().isEmpty(),a.push(new Nt(t,n)))}}),0==a.length)return ae.EMPTY_NODE;var c=ee(a,ie,function(t){return t.name},oe);if(s){var l=ee(a,Qt.getCompare());return new ae(c,le(e),new re({".priority":l},{".priority":Qt}))}return new ae(c,le(e),re.Default)}Wt(le);var he,fe,de=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?P(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return Nt.MIN},e.prototype.maxPost=function(){return Nt.MAX},e.prototype.makePost=function(t,e){var n=le(t);return new Nt(e,n)},e.prototype.toString=function(){return".value"},e}(Rt),pe=new de,ve=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,o.assert(!e.isEmpty()&&".priority"!==e.getFront(),"Can't create PathIndex with empty path or .priority key"),n}return s.__extends(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?P(t.name,e.name):i},e.prototype.makePost=function(t,e){var n=le(t),r=ae.EMPTY_NODE.updateChild(this.indexPath_,n);return new Nt(e,r)},e.prototype.maxPost=function(){var t=ae.EMPTY_NODE.updateChild(this.indexPath_,ue);return new Nt(x,t)},e.prototype.toString=function(){return this.indexPath_.slice().join("/")},e}(Rt),ye=function(){function t(t,e,n){this.node_=t,this.ref_=e,this.index_=n}return t.prototype.val=function(){return o.validateArgCount("DataSnapshot.val",0,0,arguments.length),this.node_.val()},t.prototype.exportVal=function(){return o.validateArgCount("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},t.prototype.toJSON=function(){return o.validateArgCount("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},t.prototype.exists=function(){return o.validateArgCount("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},t.prototype.child=function(e){o.validateArgCount("DataSnapshot.child",0,1,arguments.length),e=String(e),Tt("DataSnapshot.child",1,e,!1);var n=new z(e),r=this.ref_.child(n);return new t(this.node_.getChild(n),r,Qt)},t.prototype.hasChild=function(t){o.validateArgCount("DataSnapshot.hasChild",1,1,arguments.length),Tt("DataSnapshot.hasChild",1,t,!1);var e=new z(t);return!this.node_.getChild(e).isEmpty()},t.prototype.getPriority=function(){return o.validateArgCount("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},t.prototype.forEach=function(e){var n=this;if(o.validateArgCount("DataSnapshot.forEach",1,1,arguments.length),o.validateCallback("DataSnapshot.forEach",1,e,!1),this.node_.isLeafNode())return!1;var r=this.node_;return!!r.forEachChild(this.index_,function(r,i){return e(new t(i,n.ref_.child(r),Qt))})},t.prototype.hasChildren=function(){return o.validateArgCount("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(t.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!0,configurable:!0}),t.prototype.numChildren=function(){return o.validateArgCount("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},t.prototype.getRef=function(){return o.validateArgCount("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),t}(),ge=function(){function t(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}return t.prototype.getPath=function(){var t=this.snapshot.getRef();return"value"===this.eventType?t.path:t.getParent().path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+o.stringify(this.snapshot.exportVal())},t}(),me=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}(),be=function(){function t(t,e,n){this.callback_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e.getQueryParams().getIndex();return new ge("value",this,new ye(t.snapshotNode,e.getRef(),n))},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){o.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callback_;return function(){r.call(e,t.snapshot)}},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new me(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callback_||!this.callback_||e.callback_===this.callback_&&e.context_===this.context_)},t.prototype.hasAnyCallback=function(){return null!==this.callback_},t}(),we=function(){function t(t,e,n){this.callbacks_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,o.contains(this.callbacks_,e)},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new me(this,t,e):null},t.prototype.createEvent=function(t,e){o.assert(null!=t.childName,"Child events should have a childName.");var n=e.getRef().child(t.childName),r=e.getQueryParams().getIndex();return new ge(t.type,this,new ye(t.snapshotNode,n,r),t.prevName)},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){o.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callbacks_[t.eventType];return function(){r.call(e,t.snapshot,t.prevName)}},t.prototype.matches=function(e){if(e instanceof t){if(!this.callbacks_||!e.callbacks_)return!0;if(this.context_===e.context_){var n=o.getCount(e.callbacks_),r=o.getCount(this.callbacks_);if(n===r){if(1===n){var i=o.getAnyKey(e.callbacks_),a=o.getAnyKey(this.callbacks_);return a===i&&(!e.callbacks_[i]||!this.callbacks_[a]||e.callbacks_[i]===this.callbacks_[a])}return o.every(this.callbacks_,function(t,n){return e.callbacks_[t]===n})}}}return!1},t.prototype.hasAnyCallback=function(){return null!==this.callbacks_},t}(),_e=function(){function t(t,e,n,r){this.repo=t,this.path=e,this.queryParams_=n,this.orderByCalled_=r}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return o.assert(he,"Reference.ts has not been loaded"),he},set:function(t){he=t},enumerable:!0,configurable:!0}),t.validateQueryEndpoints_=function(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===jt){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(t.hasStart()){var a=t.getIndexStartName();if(a!=I)throw new Error(r);if("string"!==typeof e)throw new Error(i)}if(t.hasEnd()){var s=t.getIndexEndName();if(s!=x)throw new Error(r);if("string"!==typeof n)throw new Error(i)}}else if(t.getIndex()===Qt){if(null!=e&&!yt(e)||null!=n&&!yt(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(o.assert(t.getIndex()instanceof ve||t.getIndex()===pe,"unknown index type."),null!=e&&"object"===typeof e||null!=n&&"object"===typeof n)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},t.validateLimit_=function(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},t.prototype.validateNoPreviousOrderByCall_=function(t){if(!0===this.orderByCalled_)throw new Error(t+": You can't combine multiple orderBy calls.")},t.prototype.getQueryParams=function(){return this.queryParams_},t.prototype.getRef=function(){return o.validateArgCount("Query.ref",0,0,arguments.length),new t.__referenceConstructor(this.repo,this.path)},t.prototype.on=function(e,n,r,i){o.validateArgCount("Query.on",2,4,arguments.length),kt("Query.on",1,e,!1),o.validateCallback("Query.on",2,n,!1);var a=t.getCancelAndContextArgs_("Query.on",r,i);if("value"===e)this.onValueEvent(n,a.cancel,a.context);else{var s={};s[e]=n,this.onChildEvent(s,a.cancel,a.context)}return n},t.prototype.onValueEvent=function(t,e,n){var r=new be(t,e||null,n||null);this.repo.addEventCallbackForQuery(this,r)},t.prototype.onChildEvent=function(t,e,n){var r=new we(t,e,n);this.repo.addEventCallbackForQuery(this,r)},t.prototype.off=function(t,e,n){o.validateArgCount("Query.off",0,3,arguments.length),kt("Query.off",1,t,!0),o.validateCallback("Query.off",2,e,!0),o.validateContextObject("Query.off",3,n,!0);var r=null,i=null;if("value"===t){var a=e||null;r=new be(a,null,n||null)}else t&&(e&&(i={},i[t]=e),r=new we(i,null,n||null));this.repo.removeEventCallbackForQuery(this,r)},t.prototype.once=function(e,n,r,i){var a=this;o.validateArgCount("Query.once",1,4,arguments.length),kt("Query.once",1,e,!1),o.validateCallback("Query.once",2,n,!0);var s=t.getCancelAndContextArgs_("Query.once",r,i),u=!0,c=new o.Deferred;c.promise.catch(function(){});var l=function(t){u&&(u=!1,a.off(e,l),n&&n.bind(s.context)(t),c.resolve(t))};return this.on(e,l,function(t){a.off(e,l),s.cancel&&s.cancel.bind(s.context)(t),c.reject(t)}),c.promise},t.prototype.limitToFirst=function(e){if(o.validateArgCount("Query.limitToFirst",1,1,arguments.length),"number"!==typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToFirst(e),this.orderByCalled_)},t.prototype.limitToLast=function(e){if(o.validateArgCount("Query.limitToLast",1,1,arguments.length),"number"!==typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToLast(e),this.orderByCalled_)},t.prototype.orderByChild=function(e){if(o.validateArgCount("Query.orderByChild",1,1,arguments.length),"$key"===e)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===e)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===e)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');Tt("Query.orderByChild",1,e,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var n=new z(e);if(n.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var r=new ve(n),i=this.queryParams_.orderBy(r);return t.validateQueryEndpoints_(i),new t(this.repo,this.path,i,!0)},t.prototype.orderByKey=function(){o.validateArgCount("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var e=this.queryParams_.orderBy(jt);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByPriority=function(){o.validateArgCount("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var e=this.queryParams_.orderBy(Qt);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByValue=function(){o.validateArgCount("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var e=this.queryParams_.orderBy(pe);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.startAt=function(e,n){void 0===e&&(e=null),o.validateArgCount("Query.startAt",0,2,arguments.length),gt("Query.startAt",1,e,this.path,!0),Et("Query.startAt",2,n,!0);var r=this.queryParams_.startAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===e&&(e=null,n=null),new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.endAt=function(e,n){void 0===e&&(e=null),o.validateArgCount("Query.endAt",0,2,arguments.length),gt("Query.endAt",1,e,this.path,!0),Et("Query.endAt",2,n,!0);var r=this.queryParams_.endAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.equalTo=function(t,e){if(o.validateArgCount("Query.equalTo",1,2,arguments.length),gt("Query.equalTo",1,t,this.path,!1),Et("Query.equalTo",2,e,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(t,e).endAt(t,e)},t.prototype.toString=function(){return o.validateArgCount("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},t.prototype.toJSON=function(){return o.validateArgCount("Query.toJSON",0,1,arguments.length),this.toString()},t.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},t.prototype.queryIdentifier=function(){var t=this.queryObject(),e=D(t);return"{}"===e?"default":e},t.prototype.isEqual=function(e){if(o.validateArgCount("Query.isEqual",1,1,arguments.length),!(e instanceof t)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}var r=this.repo===e.repo,i=this.path.equals(e.path),a=this.queryIdentifier()===e.queryIdentifier();return r&&i&&a},t.getCancelAndContextArgs_=function(t,e,n){var r={cancel:null,context:null};if(e&&n)r.cancel=e,o.validateCallback(t,3,r.cancel,!0),r.context=n,o.validateContextObject(t,4,r.context,!0);else if(e)if("object"===typeof e&&null!==e)r.context=e;else{if("function"!==typeof e)throw new Error(o.errorPrefix(t,3,!0)+" must either be a cancel callback or a context object.");r.cancel=e}return r},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),t}(),ke=function(){function t(){this.set={}}return t.prototype.add=function(t,e){this.set[t]=null===e||e},t.prototype.contains=function(t){return o.contains(this.set,t)},t.prototype.get=function(t){return this.contains(t)?this.set[t]:void 0},t.prototype.remove=function(t){delete this.set[t]},t.prototype.clear=function(){this.set={}},t.prototype.isEmpty=function(){return o.isEmpty(this.set)},t.prototype.count=function(){return o.getCount(this.set)},t.prototype.each=function(t){o.forEach(this.set,function(e,n){return t(e,n)})},t.prototype.keys=function(){var t=[];return o.forEach(this.set,function(e){t.push(e)}),t},t}(),Ee=function(){function t(){this.value_=null,this.children_=null}return t.prototype.find=function(t){if(null!=this.value_)return this.value_.getChild(t);if(t.isEmpty()||null==this.children_)return null;var e=t.getFront();if(t=t.popFront(),this.children_.contains(e)){var n=this.children_.get(e);return n.find(t)}return null},t.prototype.remember=function(e,n){if(e.isEmpty())this.value_=n,this.children_=null;else if(null!==this.value_)this.value_=this.value_.updateChild(e,n);else{null==this.children_&&(this.children_=new ke);var r=e.getFront();this.children_.contains(r)||this.children_.add(r,new t);var i=this.children_.get(r);e=e.popFront(),i.remember(e,n)}},t.prototype.forget=function(t){if(t.isEmpty())return this.value_=null,this.children_=null,!0;if(null!==this.value_){if(this.value_.isLeafNode())return!1;var e=this.value_;this.value_=null;var n=this;return e.forEachChild(Qt,function(t,e){n.remember(new z(t),e)}),this.forget(t)}if(null!==this.children_){var r=t.getFront();if(t=t.popFront(),this.children_.contains(r)){var i=this.children_.get(r).forget(t);i&&this.children_.remove(r)}return!!this.children_.isEmpty()&&(this.children_=null,!0)}return!0},t.prototype.forEachTree=function(t,e){null!==this.value_?e(t,this.value_):this.forEachChild(function(n,r){var i=new z(t.toString()+"/"+n);r.forEachTree(i,e)})},t.prototype.forEachChild=function(t){null!==this.children_&&this.children_.each(function(e,n){t(e,n)})},t}(),Te=function(t){return t=t||{},t["timestamp"]=t["timestamp"]||(new Date).getTime(),t},Se=function(t,e){return t&&"object"===typeof t?(o.assert(".sv"in t,"Unexpected leaf node or priority contents"),e[t[".sv"]]):t},Ce=function(t,e){var n=new Ee;return t.forEachTree(new z(""),function(t,r){n.remember(t,Oe(r,e))}),n},Oe=function(t,e){var n,r=t.getPriority().val(),i=Se(r,e);if(t.isLeafNode()){var o=t,a=Se(o.getValue(),e);return a!==o.getValue()||i!==o.getPriority().val()?new qt(a,le(i)):t}var s=t;return n=s,i!==s.getPriority().val()&&(n=n.updatePriority(new qt(i))),s.forEachChild(Qt,function(t,r){var i=Oe(r,e);i!==r&&(n=n.updateImmediateChild(t,i))}),n};(function(t){t[t["OVERWRITE"]=0]="OVERWRITE",t[t["MERGE"]=1]="MERGE",t[t["ACK_USER_WRITE"]=2]="ACK_USER_WRITE",t[t["LISTEN_COMPLETE"]=3]="LISTEN_COMPLETE"})(fe||(fe={}));var Ae,Ie,xe=function(){function t(t,e,n,r){this.fromUser=t,this.fromServer=e,this.queryId=n,this.tagged=r,o.assert(!r||e,"Tagged queries must be from server.")}return t.User=new t(!0,!1,null,!1),t.Server=new t(!1,!0,null,!1),t.forServerTaggedQuery=function(e){return new t(!1,!0,e,!0)},t}(),Pe=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=fe.ACK_USER_WRITE,this.source=xe.User}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return o.assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new z(e));return new t(z.Empty,n,this.revert)}return o.assert(this.path.getFront()===e,"operationForChild called for unrelated child."),new t(this.path.popFront(),this.affectedTree,this.revert)},t}(),Ne=function(){return Ae||(Ae=new $t(N)),Ae},Re=function(){function t(t,e){void 0===e&&(e=Ne()),this.value=t,this.children=e}return t.fromObject=function(e){var n=t.Empty;return o.forEach(e,function(t,e){n=n.set(new z(t),e)}),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:z.Empty,value:this.value};if(t.isEmpty())return null;var n=t.getFront(),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(t.popFront(),e);if(null!=i){var o=new z(n).child(i.path);return{path:o,value:i.value}}return null}return null},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,function(){return!0})},t.prototype.subtree=function(e){if(e.isEmpty())return this;var n=e.getFront(),r=this.children.get(n);return null!==r?r.subtree(e.popFront()):t.Empty},t.prototype.set=function(e,n){if(e.isEmpty())return new t(n,this.children);var r=e.getFront(),i=this.children.get(r)||t.Empty,o=i.set(e.popFront(),n),a=this.children.insert(r,o);return new t(this.value,a)},t.prototype.remove=function(e){if(e.isEmpty())return this.children.isEmpty()?t.Empty:new t(null,this.children);var n=e.getFront(),r=this.children.get(n);if(r){var i=r.remove(e.popFront()),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?t.Empty:new t(this.value,o)}return this},t.prototype.get=function(t){if(t.isEmpty())return this.value;var e=t.getFront(),n=this.children.get(e);return n?n.get(t.popFront()):null},t.prototype.setTree=function(e,n){if(e.isEmpty())return n;var r=e.getFront(),i=this.children.get(r)||t.Empty,o=i.setTree(e.popFront(),n),a=void 0;return a=o.isEmpty()?this.children.remove(r):this.children.insert(r,o),new t(this.value,a)},t.prototype.fold=function(t){return this.fold_(z.Empty,t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal(function(r,i){n[r]=i.fold_(t.child(r),e)}),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,z.Empty,e)},t.prototype.findOnPath_=function(t,e,n){var r=!!this.value&&n(e,this.value);if(r)return r;if(t.isEmpty())return null;var i=t.getFront(),o=this.children.get(i);return o?o.findOnPath_(t.popFront(),e.child(i),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,z.Empty,e)},t.prototype.foreachOnPath_=function(e,n,r){if(e.isEmpty())return this;this.value&&r(n,this.value);var i=e.getFront(),o=this.children.get(i);return o?o.foreachOnPath_(e.popFront(),n.child(i),r):t.Empty},t.prototype.foreach=function(t){this.foreach_(z.Empty,t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal(function(n,r){r.foreach_(t.child(n),e)}),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal(function(e,n){n.value&&t(e,n.value)})},t.Empty=new t(null),t}(),De=function(){function t(t,e){this.source=t,this.path=e,this.type=fe.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,z.Empty):new t(this.source,this.path.popFront())},t}(),je=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=fe.OVERWRITE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,z.Empty,this.snap.getImmediateChild(e)):new t(this.source,this.path.popFront(),this.snap)},t}(),Me=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=fe.MERGE}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){var n=this.children.subtree(new z(e));return n.isEmpty()?null:n.value?new je(this.source,z.Empty,n.value):new t(this.source,z.Empty,n)}return o.assert(this.path.getFront()===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,this.path.popFront(),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}(),Le=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(t.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var e=t.getFront();return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}(),Fe=function(){function t(t,e){this.eventCache_=t,this.serverCache_=e}return t.prototype.updateEventSnap=function(e,n,r){return new t(new Le(e,n,r),this.serverCache_)},t.prototype.updateServerSnap=function(e,n,r){return new t(this.eventCache_,new Le(e,n,r))},t.prototype.getEventCache=function(){return this.eventCache_},t.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},t.prototype.getServerCache=function(){return this.serverCache_},t.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},t.Empty=new t(new Le(ae.EMPTY_NODE,!1,!1),new Le(ae.EMPTY_NODE,!1,!1)),t}(),Ve=function(){function t(t,e,n,r,i){this.type=t,this.snapshotNode=e,this.childName=n,this.oldSnap=r,this.prevName=i}return t.valueChange=function(e){return new t(t.VALUE,e)},t.childAddedChange=function(e,n){return new t(t.CHILD_ADDED,n,e)},t.childRemovedChange=function(e,n){return new t(t.CHILD_REMOVED,n,e)},t.childChangedChange=function(e,n,r){return new t(t.CHILD_CHANGED,n,e,r)},t.childMovedChange=function(e,n){return new t(t.CHILD_MOVED,n,e)},t.CHILD_ADDED="child_added",t.CHILD_REMOVED="child_removed",t.CHILD_CHANGED="child_changed",t.CHILD_MOVED="child_moved",t.VALUE="value",t}(),Be=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,r,i,a){o.assert(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var s=t.getImmediateChild(e);return s.getChild(r).equals(n.getChild(r))&&s.isEmpty()==n.isEmpty()?t:(null!=a&&(n.isEmpty()?t.hasChild(e)?a.trackChildChange(Ve.childRemovedChange(e,s)):o.assert(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):s.isEmpty()?a.trackChildChange(Ve.childAddedChange(e,n)):a.trackChildChange(Ve.childChangedChange(e,n,s))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=function(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(Qt,function(t,r){e.hasChild(t)||n.trackChildChange(Ve.childRemovedChange(t,r))}),e.isLeafNode()||e.forEachChild(Qt,function(e,r){if(t.hasChild(e)){var i=t.getImmediateChild(e);i.equals(r)||n.trackChildChange(Ve.childChangedChange(e,r,i))}else n.trackChildChange(Ve.childAddedChange(e,r))})),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?ae.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}(),Ue=function(){function t(){this.changeMap_={}}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;o.assert(e==Ve.CHILD_ADDED||e==Ve.CHILD_CHANGED||e==Ve.CHILD_REMOVED,"Only child changes supported for tracking"),o.assert(".priority"!==n,"Only non-priority child changes can be tracked.");var r=o.safeGet(this.changeMap_,n);if(r){var i=r.type;if(e==Ve.CHILD_ADDED&&i==Ve.CHILD_REMOVED)this.changeMap_[n]=Ve.childChangedChange(n,t.snapshotNode,r.snapshotNode);else if(e==Ve.CHILD_REMOVED&&i==Ve.CHILD_ADDED)delete this.changeMap_[n];else if(e==Ve.CHILD_REMOVED&&i==Ve.CHILD_CHANGED)this.changeMap_[n]=Ve.childRemovedChange(n,r.oldSnap);else if(e==Ve.CHILD_CHANGED&&i==Ve.CHILD_ADDED)this.changeMap_[n]=Ve.childAddedChange(n,t.snapshotNode);else{if(e!=Ve.CHILD_CHANGED||i!=Ve.CHILD_CHANGED)throw o.assertionError("Illegal combination of changes: "+t+" occurred after "+r);this.changeMap_[n]=Ve.childChangedChange(n,t.snapshotNode,r.oldSnap)}}else this.changeMap_[n]=t},t.prototype.getChanges=function(){return o.getValues(this.changeMap_)},t}(),qe=function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}(),We=new qe,Ke=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.getEventCache();if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new Le(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(t,n)},t.prototype.getChildAfterChild=function(t,e,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),i=this.writes_.calcIndexedSlice(r,e,1,n,t);return 0===i.length?null:i[0]},t}(),He=function(){function t(t,e){this.viewCache=t,this.changes=e}return t}(),ze=function(){function t(t){this.filter_=t}return t.prototype.assertIndexed=function(t){o.assert(t.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),o.assert(t.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},t.prototype.applyOperation=function(e,n,r,i){var a,s,u=new Ue;if(n.type===fe.OVERWRITE){var c=n;c.source.fromUser?a=this.applyUserOverwrite_(e,c.path,c.snap,r,i,u):(o.assert(c.source.fromServer,"Unknown source."),s=c.source.tagged||e.getServerCache().isFiltered()&&!c.path.isEmpty(),a=this.applyServerOverwrite_(e,c.path,c.snap,r,i,s,u))}else if(n.type===fe.MERGE){var l=n;l.source.fromUser?a=this.applyUserMerge_(e,l.path,l.children,r,i,u):(o.assert(l.source.fromServer,"Unknown source."),s=l.source.tagged||e.getServerCache().isFiltered(),a=this.applyServerMerge_(e,l.path,l.children,r,i,s,u))}else if(n.type===fe.ACK_USER_WRITE){var h=n;a=h.revert?this.revertUserWrite_(e,h.path,r,i,u):this.ackUserWrite_(e,h.path,h.affectedTree,r,i,u)}else{if(n.type!==fe.LISTEN_COMPLETE)throw o.assertionError("Unknown operation type: "+n.type);a=this.listenComplete_(e,n.path,r,u)}var f=u.getChanges();return t.maybeAddValueEvent_(e,a,f),new He(a,f)},t.maybeAddValueEvent_=function(t,e,n){var r=e.getEventCache();if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=t.getCompleteEventSnap();(n.length>0||!t.getEventCache().isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(Ve.valueChange(e.getCompleteEventSnap()))}},t.prototype.generateEventCacheAfterServerEvent_=function(t,e,n,r,i){var a=t.getEventCache();if(null!=n.shadowingWrite(e))return t;var s=void 0,u=void 0;if(e.isEmpty())if(o.assert(t.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),t.getServerCache().isFiltered()){var c=t.getCompleteServerSnap(),l=c instanceof ae?c:ae.EMPTY_NODE,h=n.calcCompleteEventChildren(l);s=this.filter_.updateFullNode(t.getEventCache().getNode(),h,i)}else{var f=n.calcCompleteEventCache(t.getCompleteServerSnap());s=this.filter_.updateFullNode(t.getEventCache().getNode(),f,i)}else{var d=e.getFront();if(".priority"==d){o.assert(1==e.getLength(),"Can't have a priority with additional path components");var p=a.getNode();u=t.getServerCache().getNode();var v=n.calcEventCacheAfterServerOverwrite(e,p,u);s=null!=v?this.filter_.updatePriority(p,v):a.getNode()}else{var y=e.popFront(),g=void 0;if(a.isCompleteForChild(d)){u=t.getServerCache().getNode();var m=n.calcEventCacheAfterServerOverwrite(e,a.getNode(),u);g=null!=m?a.getNode().getImmediateChild(d).updateChild(y,m):a.getNode().getImmediateChild(d)}else g=n.calcCompleteChild(d,t.getServerCache());s=null!=g?this.filter_.updateChild(a.getNode(),d,g,y,r,i):a.getNode()}}return t.updateEventSnap(s,a.isFullyInitialized()||e.isEmpty(),this.filter_.filtersNodes())},t.prototype.applyServerOverwrite_=function(t,e,n,r,i,o,a){var s,u=t.getServerCache(),c=o?this.filter_:this.filter_.getIndexedFilter();if(e.isEmpty())s=c.updateFullNode(u.getNode(),n,null);else if(c.filtersNodes()&&!u.isFiltered()){var l=u.getNode().updateChild(e,n);s=c.updateFullNode(u.getNode(),l,null)}else{var h=e.getFront();if(!u.isCompleteForPath(e)&&e.getLength()>1)return t;var f=e.popFront(),d=u.getNode().getImmediateChild(h),p=d.updateChild(f,n);s=".priority"==h?c.updatePriority(u.getNode(),p):c.updateChild(u.getNode(),h,p,f,We,null)}var v=t.updateServerSnap(s,u.isFullyInitialized()||e.isEmpty(),c.filtersNodes()),y=new Ke(r,v,i);return this.generateEventCacheAfterServerEvent_(v,e,r,y,a)},t.prototype.applyUserOverwrite_=function(t,e,n,r,i,o){var a,s,u=t.getEventCache(),c=new Ke(r,t,i);if(e.isEmpty())s=this.filter_.updateFullNode(t.getEventCache().getNode(),n,o),a=t.updateEventSnap(s,!0,this.filter_.filtersNodes());else{var l=e.getFront();if(".priority"===l)s=this.filter_.updatePriority(t.getEventCache().getNode(),n),a=t.updateEventSnap(s,u.isFullyInitialized(),u.isFiltered());else{var h=e.popFront(),f=u.getNode().getImmediateChild(l),d=void 0;if(h.isEmpty())d=n;else{var p=c.getCompleteChild(l);d=null!=p?".priority"===h.getBack()&&p.getChild(h.parent()).isEmpty()?p:p.updateChild(h,n):ae.EMPTY_NODE}if(f.equals(d))a=t;else{var v=this.filter_.updateChild(u.getNode(),l,d,h,c,o);a=t.updateEventSnap(v,u.isFullyInitialized(),this.filter_.filtersNodes())}}}return a},t.cacheHasChild_=function(t,e){return t.getEventCache().isCompleteForChild(e)},t.prototype.applyUserMerge_=function(e,n,r,i,o,a){var s=this,u=e;return r.foreach(function(r,c){var l=n.child(r);t.cacheHasChild_(e,l.getFront())&&(u=s.applyUserOverwrite_(u,l,c,i,o,a))}),r.foreach(function(r,c){var l=n.child(r);t.cacheHasChild_(e,l.getFront())||(u=s.applyUserOverwrite_(u,l,c,i,o,a))}),u},t.prototype.applyMerge_=function(t,e){return e.foreach(function(e,n){t=t.updateChild(e,n)}),t},t.prototype.applyServerMerge_=function(t,e,n,r,i,o,a){var s=this;if(t.getServerCache().getNode().isEmpty()&&!t.getServerCache().isFullyInitialized())return t;var u,c=t;u=e.isEmpty()?n:Re.Empty.setTree(e,n);var l=t.getServerCache().getNode();return u.children.inorderTraversal(function(e,n){if(l.hasChild(e)){var u=t.getServerCache().getNode().getImmediateChild(e),h=s.applyMerge_(u,n);c=s.applyServerOverwrite_(c,new z(e),h,r,i,o,a)}}),u.children.inorderTraversal(function(e,n){var u=!t.getServerCache().isCompleteForChild(e)&&null==n.value;if(!l.hasChild(e)&&!u){var h=t.getServerCache().getNode().getImmediateChild(e),f=s.applyMerge_(h,n);c=s.applyServerOverwrite_(c,new z(e),f,r,i,o,a)}}),c},t.prototype.ackUserWrite_=function(t,e,n,r,i,o){if(null!=r.shadowingWrite(e))return t;var a=t.getServerCache().isFiltered(),s=t.getServerCache();if(null!=n.value){if(e.isEmpty()&&s.isFullyInitialized()||s.isCompleteForPath(e))return this.applyServerOverwrite_(t,e,s.getNode().getChild(e),r,i,a,o);if(e.isEmpty()){var u=Re.Empty;return s.getNode().forEachChild(jt,function(t,e){u=u.set(new z(t),e)}),this.applyServerMerge_(t,e,u,r,i,a,o)}return t}var c=Re.Empty;return n.foreach(function(t,n){var r=e.child(t);s.isCompleteForPath(r)&&(c=c.set(t,s.getNode().getChild(r)))}),this.applyServerMerge_(t,e,c,r,i,a,o)},t.prototype.listenComplete_=function(t,e,n,r){var i=t.getServerCache(),o=t.updateServerSnap(i.getNode(),i.isFullyInitialized()||e.isEmpty(),i.isFiltered());return this.generateEventCacheAfterServerEvent_(o,e,n,We,r)},t.prototype.revertUserWrite_=function(t,e,n,r,i){var a;if(null!=n.shadowingWrite(e))return t;var s=new Ke(n,t,r),u=t.getEventCache().getNode(),c=void 0;if(e.isEmpty()||".priority"===e.getFront()){var l=void 0;if(t.getServerCache().isFullyInitialized())l=n.calcCompleteEventCache(t.getCompleteServerSnap());else{var h=t.getServerCache().getNode();o.assert(h instanceof ae,"serverChildren would be complete if leaf node"),l=n.calcCompleteEventChildren(h)}l=l,c=this.filter_.updateFullNode(u,l,i)}else{var f=e.getFront(),d=n.calcCompleteChild(f,t.getServerCache());null==d&&t.getServerCache().isCompleteForChild(f)&&(d=u.getImmediateChild(f)),c=null!=d?this.filter_.updateChild(u,f,d,e.popFront(),s,i):t.getEventCache().getNode().hasChild(f)?this.filter_.updateChild(u,f,ae.EMPTY_NODE,e.popFront(),s,i):u,c.isEmpty()&&t.getServerCache().isFullyInitialized()&&(a=n.calcCompleteEventCache(t.getCompleteServerSnap()),a.isLeafNode()&&(c=this.filter_.updateFullNode(c,a,i)))}return a=t.getServerCache().isFullyInitialized()||null!=n.shadowingWrite(z.Empty),t.updateEventSnap(c,a,this.filter_.filtersNodes())},t}(),Ge=function(){function t(t){this.query_=t,this.index_=this.query_.getQueryParams().getIndex()}return t.prototype.generateEventsForChanges=function(t,e,n){var r=this,i=[],o=[];return t.forEach(function(t){t.type===Ve.CHILD_CHANGED&&r.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push(Ve.childMovedChange(t.childName,t.snapshotNode))}),this.generateEventsForType_(i,Ve.CHILD_REMOVED,t,n,e),this.generateEventsForType_(i,Ve.CHILD_ADDED,t,n,e),this.generateEventsForType_(i,Ve.CHILD_MOVED,o,n,e),this.generateEventsForType_(i,Ve.CHILD_CHANGED,t,n,e),this.generateEventsForType_(i,Ve.VALUE,t,n,e),i},t.prototype.generateEventsForType_=function(t,e,n,r,i){var o=this,a=n.filter(function(t){return t.type===e});a.sort(this.compareChanges_.bind(this)),a.forEach(function(e){var n=o.materializeSingleChange_(e,i);r.forEach(function(r){r.respondsTo(e.type)&&t.push(r.createEvent(n,o.query_))})})},t.prototype.materializeSingleChange_=function(t,e){return"value"===t.type||"child_removed"===t.type?t:(t.prevName=e.getPredecessorChildName(t.childName,t.snapshotNode,this.index_),t)},t.prototype.compareChanges_=function(t,e){if(null==t.childName||null==e.childName)throw o.assertionError("Should only compare child_ events.");var n=new Nt(t.childName,t.snapshotNode),r=new Nt(e.childName,e.snapshotNode);return this.index_.compare(n,r)},t}(),Qe=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n=this.query_.getQueryParams(),r=new Be(n.getIndex()),i=n.getNodeFilter();this.processor_=new ze(i);var o=e.getServerCache(),a=e.getEventCache(),s=r.updateFullNode(ae.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(ae.EMPTY_NODE,a.getNode(),null),c=new Le(s,o.isFullyInitialized(),r.filtersNodes()),l=new Le(u,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=new Fe(l,c),this.eventGenerator_=new Ge(this.query_)}return t.prototype.getQuery=function(){return this.query_},t.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},t.prototype.getCompleteServerCache=function(t){var e=this.viewCache_.getCompleteServerSnap();return e&&(this.query_.getQueryParams().loadsAllData()||!t.isEmpty()&&!e.getImmediateChild(t.getFront()).isEmpty())?e.getChild(t):null},t.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},t.prototype.addEventRegistration=function(t){this.eventRegistrations_.push(t)},t.prototype.removeEventRegistration=function(t,e){var n=[];if(e){o.assert(null==t,"A cancel should cancel all event registrations.");var r=this.query_.path;this.eventRegistrations_.forEach(function(t){e=e;var i=t.createCancelEvent(e,r);i&&n.push(i)})}if(t){for(var i=[],a=0;a<this.eventRegistrations_.length;++a){var s=this.eventRegistrations_[a];if(s.matches(t)){if(t.hasAnyCallback()){i=i.concat(this.eventRegistrations_.slice(a+1));break}}else i.push(s)}this.eventRegistrations_=i}else this.eventRegistrations_=[];return n},t.prototype.applyOperation=function(t,e,n){t.type===fe.MERGE&&null!==t.source.queryId&&(o.assert(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),o.assert(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var r=this.viewCache_,i=this.processor_.applyOperation(r,t,e,n);return this.processor_.assertIndexed(i.viewCache),o.assert(i.viewCache.getServerCache().isFullyInitialized()||!r.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=i.viewCache,this.generateEventsForChanges_(i.changes,i.viewCache.getEventCache().getNode(),null)},t.prototype.getInitialEvents=function(t){var e=this.viewCache_.getEventCache(),n=[];if(!e.getNode().isLeafNode()){var r=e.getNode();r.forEachChild(Qt,function(t,e){n.push(Ve.childAddedChange(t,e))})}return e.isFullyInitialized()&&n.push(Ve.valueChange(e.getNode())),this.generateEventsForChanges_(n,e.getNode(),t)},t.prototype.generateEventsForChanges_=function(t,e,n){var r=n?[n]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(t,e,r)},t}(),Ye=function(){function t(){this.views_={}}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return o.assert(Ie,"Reference.ts has not been loaded"),Ie},set:function(t){o.assert(!Ie,"__referenceConstructor has already been defined"),Ie=t},enumerable:!0,configurable:!0}),t.prototype.isEmpty=function(){return o.isEmpty(this.views_)},t.prototype.applyOperation=function(t,e,n){var r=t.source.queryId;if(null!==r){var i=o.safeGet(this.views_,r);return o.assert(null!=i,"SyncTree gave us an op for an invalid query."),i.applyOperation(t,e,n)}var a=[];return o.forEach(this.views_,function(r,i){a=a.concat(i.applyOperation(t,e,n))}),a},t.prototype.addEventRegistration=function(t,e,n,r,i){var a=t.queryIdentifier(),s=o.safeGet(this.views_,a);if(!s){var u=n.calcCompleteEventCache(i?r:null),c=!1;u?c=!0:r instanceof ae?(u=n.calcCompleteEventChildren(r),c=!1):(u=ae.EMPTY_NODE,c=!1);var l=new Fe(new Le(u,c,!1),new Le(r,i,!1));s=new Qe(t,l),this.views_[a]=s}return s.addEventRegistration(e),s.getInitialEvents(e)},t.prototype.removeEventRegistration=function(e,n,r){var i=e.queryIdentifier(),a=[],s=[],u=this.hasCompleteView();if("default"===i){var c=this;o.forEach(this.views_,function(t,e){s=s.concat(e.removeEventRegistration(n,r)),e.isEmpty()&&(delete c.views_[t],e.getQuery().getQueryParams().loadsAllData()||a.push(e.getQuery()))})}else{var l=o.safeGet(this.views_,i);l&&(s=s.concat(l.removeEventRegistration(n,r)),l.isEmpty()&&(delete this.views_[i],l.getQuery().getQueryParams().loadsAllData()||a.push(l.getQuery())))}return u&&!this.hasCompleteView()&&a.push(new t.__referenceConstructor(e.repo,e.path)),{removed:a,events:s}},t.prototype.getQueryViews=function(){var t=this,e=Object.keys(this.views_).map(function(e){return t.views_[e]});return e.filter(function(t){return!t.getQuery().getQueryParams().loadsAllData()})},t.prototype.getCompleteServerCache=function(t){var e=null;return o.forEach(this.views_,function(n,r){e=e||r.getCompleteServerCache(t)}),e},t.prototype.viewForQuery=function(t){var e=t.getQueryParams();if(e.loadsAllData())return this.getCompleteView();var n=t.queryIdentifier();return o.safeGet(this.views_,n)},t.prototype.viewExistsForQuery=function(t){return null!=this.viewForQuery(t)},t.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},t.prototype.getCompleteView=function(){var t=o.findValue(this.views_,function(t){return t.getQuery().getQueryParams().loadsAllData()});return t||null},t}(),Xe=function(){function t(t){this.writeTree_=t}return t.prototype.addWrite=function(e,n){if(e.isEmpty())return new t(new Re(n));var r=this.writeTree_.findRootMostValueAndPath(e);if(null!=r){var i=r.path,o=r.value,a=z.relativePath(i,e);return o=o.updateChild(a,n),new t(this.writeTree_.set(i,o))}var s=new Re(n),u=this.writeTree_.setTree(e,s);return new t(u)},t.prototype.addWrites=function(t,e){var n=this;return o.forEach(e,function(e,r){n=n.addWrite(t.child(e),r)}),n},t.prototype.removeWrite=function(e){if(e.isEmpty())return t.Empty;var n=this.writeTree_.setTree(e,Re.Empty);return new t(n)},t.prototype.hasCompleteWrite=function(t){return null!=this.getCompleteNode(t)},t.prototype.getCompleteNode=function(t){var e=this.writeTree_.findRootMostValueAndPath(t);return null!=e?this.writeTree_.get(e.path).getChild(z.relativePath(e.path,t)):null},t.prototype.getCompleteChildren=function(){var t=[],e=this.writeTree_.value;return null!=e?e.isLeafNode()||e.forEachChild(Qt,function(e,n){t.push(new Nt(e,n))}):this.writeTree_.children.inorderTraversal(function(e,n){null!=n.value&&t.push(new Nt(e,n.value))}),t},t.prototype.childCompoundWrite=function(e){if(e.isEmpty())return this;var n=this.getCompleteNode(e);return new t(null!=n?new Re(n):this.writeTree_.subtree(e))},t.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},t.prototype.apply=function(e){return t.applySubtreeWrite_(z.Empty,this.writeTree_,e)},t.Empty=new t(new Re(null)),t.applySubtreeWrite_=function(e,n,r){if(null!=n.value)return r.updateChild(e,n.value);var i=null;return n.children.inorderTraversal(function(n,a){".priority"===n?(o.assert(null!==a.value,"Priority writes must always be leaf nodes"),i=a.value):r=t.applySubtreeWrite_(e.child(n),a,r)}),r.getChild(e).isEmpty()||null===i||(r=r.updateChild(e.child(".priority"),i)),r},t}(),Je=function(){function t(){this.visibleWrites_=Xe.Empty,this.allWrites_=[],this.lastWriteId_=-1}return t.prototype.childWrites=function(t){return new $e(t,this)},t.prototype.addOverwrite=function(t,e,n,r){o.assert(n>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),this.allWrites_.push({path:t,snap:e,writeId:n,visible:r}),r&&(this.visibleWrites_=this.visibleWrites_.addWrite(t,e)),this.lastWriteId_=n},t.prototype.addMerge=function(t,e,n){o.assert(n>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:t,children:e,writeId:n,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(t,e),this.lastWriteId_=n},t.prototype.getWrite=function(t){for(var e=0;e<this.allWrites_.length;e++){var n=this.allWrites_[e];if(n.writeId===t)return n}return null},t.prototype.removeWrite=function(t){var e=this,n=this.allWrites_.findIndex(function(e){return e.writeId===t});o.assert(n>=0,"removeWrite called with nonexistent writeId.");var r=this.allWrites_[n];this.allWrites_.splice(n,1);var i=r.visible,a=!1,s=this.allWrites_.length-1;while(i&&s>=0){var u=this.allWrites_[s];u.visible&&(s>=n&&this.recordContainsPath_(u,r.path)?i=!1:r.path.contains(u.path)&&(a=!0)),s--}if(i){if(a)return this.resetTree_(),!0;if(r.snap)this.visibleWrites_=this.visibleWrites_.removeWrite(r.path);else{var c=r.children;o.forEach(c,function(t){e.visibleWrites_=e.visibleWrites_.removeWrite(r.path.child(t))})}return!0}return!1},t.prototype.getCompleteWriteData=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcCompleteEventCache=function(e,n,r,i){if(r||i){var o=this.visibleWrites_.childCompoundWrite(e);if(!i&&o.isEmpty())return n;if(i||null!=n||o.hasCompleteWrite(z.Empty)){var a=function(t){return(t.visible||i)&&(!r||!~r.indexOf(t.writeId))&&(t.path.contains(e)||e.contains(t.path))},s=t.layerTree_(this.allWrites_,a,e);l=n||ae.EMPTY_NODE;return s.apply(l)}return null}var u=this.visibleWrites_.getCompleteNode(e);if(null!=u)return u;var c=this.visibleWrites_.childCompoundWrite(e);if(c.isEmpty())return n;if(null!=n||c.hasCompleteWrite(z.Empty)){var l=n||ae.EMPTY_NODE;return c.apply(l)}return null},t.prototype.calcCompleteEventChildren=function(t,e){var n=ae.EMPTY_NODE,r=this.visibleWrites_.getCompleteNode(t);if(r)return r.isLeafNode()||r.forEachChild(Qt,function(t,e){n=n.updateImmediateChild(t,e)}),n;if(e){var i=this.visibleWrites_.childCompoundWrite(t);return e.forEachChild(Qt,function(t,e){var r=i.childCompoundWrite(new z(t)).apply(e);n=n.updateImmediateChild(t,r)}),i.getCompleteChildren().forEach(function(t){n=n.updateImmediateChild(t.name,t.node)}),n}var o=this.visibleWrites_.childCompoundWrite(t);return o.getCompleteChildren().forEach(function(t){n=n.updateImmediateChild(t.name,t.node)}),n},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n,r){o.assert(n||r,"Either existingEventSnap or existingServerSnap must exist");var i=t.child(e);if(this.visibleWrites_.hasCompleteWrite(i))return null;var a=this.visibleWrites_.childCompoundWrite(i);return a.isEmpty()?r.getChild(e):a.apply(r.getChild(e))},t.prototype.calcCompleteChild=function(t,e,n){var r=t.child(e),i=this.visibleWrites_.getCompleteNode(r);if(null!=i)return i;if(n.isCompleteForChild(e)){var o=this.visibleWrites_.childCompoundWrite(r);return o.apply(n.getNode().getImmediateChild(e))}return null},t.prototype.shadowingWrite=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcIndexedSlice=function(t,e,n,r,i,o){var a,s=this.visibleWrites_.childCompoundWrite(t),u=s.getCompleteNode(z.Empty);if(null!=u)a=u;else{if(null==e)return[];a=s.apply(e)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];var c=[],l=o.getCompare(),h=i?a.getReverseIteratorFrom(n,o):a.getIteratorFrom(n,o),f=h.getNext();while(f&&c.length<r)0!==l(f,n)&&c.push(f),f=h.getNext();return c},t.prototype.recordContainsPath_=function(t,e){return t.snap?t.path.contains(e):!!o.findKey(t.children,function(n,r){return t.path.child(r).contains(e)})},t.prototype.resetTree_=function(){this.visibleWrites_=t.layerTree_(this.allWrites_,t.DefaultFilter_,z.Empty),this.allWrites_.length>0?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},t.DefaultFilter_=function(t){return t.visible},t.layerTree_=function(t,e,n){for(var r=Xe.Empty,i=0;i<t.length;++i){var a=t[i];if(e(a)){var s=a.path,u=void 0;if(a.snap)n.contains(s)?(u=z.relativePath(n,s),r=r.addWrite(u,a.snap)):s.contains(n)&&(u=z.relativePath(s,n),r=r.addWrite(z.Empty,a.snap.getChild(u)));else{if(!a.children)throw o.assertionError("WriteRecord should have .snap or .children");if(n.contains(s))u=z.relativePath(n,s),r=r.addWrites(u,a.children);else if(s.contains(n))if(u=z.relativePath(s,n),u.isEmpty())r=r.addWrites(z.Empty,a.children);else{var c=o.safeGet(a.children,u.getFront());if(c){var l=c.getChild(u.popFront());r=r.addWrite(z.Empty,l)}}}}}return r},t}(),$e=function(){function t(t,e){this.treePath_=t,this.writeTree_=e}return t.prototype.calcCompleteEventCache=function(t,e,n){return this.writeTree_.calcCompleteEventCache(this.treePath_,t,e,n)},t.prototype.calcCompleteEventChildren=function(t){return this.writeTree_.calcCompleteEventChildren(this.treePath_,t)},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,t,e,n)},t.prototype.shadowingWrite=function(t){return this.writeTree_.shadowingWrite(this.treePath_.child(t))},t.prototype.calcIndexedSlice=function(t,e,n,r,i){return this.writeTree_.calcIndexedSlice(this.treePath_,t,e,n,r,i)},t.prototype.calcCompleteChild=function(t,e){return this.writeTree_.calcCompleteChild(this.treePath_,t,e)},t.prototype.child=function(e){return new t(this.treePath_.child(e),this.writeTree_)},t}(),Ze=function(){function t(t){this.listenProvider_=t,this.syncPointTree_=Re.Empty,this.pendingWriteTree_=new Je,this.tagToQueryMap_={},this.queryToTagMap_={}}return t.prototype.applyUserOverwrite=function(t,e,n,r){return this.pendingWriteTree_.addOverwrite(t,e,n,r),r?this.applyOperationToSyncPoints_(new je(xe.User,t,e)):[]},t.prototype.applyUserMerge=function(t,e,n){this.pendingWriteTree_.addMerge(t,e,n);var r=Re.fromObject(e);return this.applyOperationToSyncPoints_(new Me(xe.User,t,r))},t.prototype.ackUserWrite=function(t,e){void 0===e&&(e=!1);var n=this.pendingWriteTree_.getWrite(t),r=this.pendingWriteTree_.removeWrite(t);if(r){var i=Re.Empty;return null!=n.snap?i=i.set(z.Empty,!0):o.forEach(n.children,function(t,e){i=i.set(new z(t),e)}),this.applyOperationToSyncPoints_(new Pe(n.path,i,e))}return[]},t.prototype.applyServerOverwrite=function(t,e){return this.applyOperationToSyncPoints_(new je(xe.Server,t,e))},t.prototype.applyServerMerge=function(t,e){var n=Re.fromObject(e);return this.applyOperationToSyncPoints_(new Me(xe.Server,t,n))},t.prototype.applyListenComplete=function(t){return this.applyOperationToSyncPoints_(new De(xe.Server,t))},t.prototype.applyTaggedQueryOverwrite=function(e,n,r){var i=this.queryKeyForTag_(r);if(null!=i){var o=t.parseQueryKey_(i),a=o.path,s=o.queryId,u=z.relativePath(a,e),c=new je(xe.forServerTaggedQuery(s),u,n);return this.applyTaggedOperation_(a,c)}return[]},t.prototype.applyTaggedQueryMerge=function(e,n,r){var i=this.queryKeyForTag_(r);if(i){var o=t.parseQueryKey_(i),a=o.path,s=o.queryId,u=z.relativePath(a,e),c=Re.fromObject(n),l=new Me(xe.forServerTaggedQuery(s),u,c);return this.applyTaggedOperation_(a,l)}return[]},t.prototype.applyTaggedListenComplete=function(e,n){var r=this.queryKeyForTag_(n);if(r){var i=t.parseQueryKey_(r),o=i.path,a=i.queryId,s=z.relativePath(o,e),u=new De(xe.forServerTaggedQuery(a),s);return this.applyTaggedOperation_(o,u)}return[]},t.prototype.addEventRegistration=function(e,n){var r=e.path,i=null,a=!1;this.syncPointTree_.foreachOnPath(r,function(t,e){var n=z.relativePath(t,r);i=i||e.getCompleteServerCache(n),a=a||e.hasCompleteView()});var s,u=this.syncPointTree_.get(r);if(u?(a=a||u.hasCompleteView(),i=i||u.getCompleteServerCache(z.Empty)):(u=new Ye,this.syncPointTree_=this.syncPointTree_.set(r,u)),null!=i)s=!0;else{s=!1,i=ae.EMPTY_NODE;var c=this.syncPointTree_.subtree(r);c.foreachChild(function(t,e){var n=e.getCompleteServerCache(z.Empty);n&&(i=i.updateImmediateChild(t,n))})}var l=u.viewExistsForQuery(e);if(!l&&!e.getQueryParams().loadsAllData()){var h=t.makeQueryKey_(e);o.assert(!(h in this.queryToTagMap_),"View does not exist, but we have a tag");var f=t.getNextQueryTag_();this.queryToTagMap_[h]=f,this.tagToQueryMap_["_"+f]=h}var d=this.pendingWriteTree_.childWrites(r),p=u.addEventRegistration(e,n,d,i,s);if(!l&&!a){var v=u.viewForQuery(e);p=p.concat(this.setupListener_(e,v))}return p},t.prototype.removeEventRegistration=function(e,n,r){var i=this,o=e.path,a=this.syncPointTree_.get(o),s=[];if(a&&("default"===e.queryIdentifier()||a.viewExistsForQuery(e))){var u=a.removeEventRegistration(e,n,r);a.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(o));var c=u.removed;s=u.events;var l=-1!==c.findIndex(function(t){return t.getQueryParams().loadsAllData()}),h=this.syncPointTree_.findOnPath(o,function(t,e){return e.hasCompleteView()});if(l&&!h){var f=this.syncPointTree_.subtree(o);if(!f.isEmpty())for(var d=this.collectDistinctViewsForSubTree_(f),p=0;p<d.length;++p){var v=d[p],y=v.getQuery(),g=this.createListenerForView_(v);this.listenProvider_.startListening(t.queryForListening_(y),this.tagForQuery_(y),g.hashFn,g.onComplete)}}if(!h&&c.length>0&&!r)if(l){var m=null;this.listenProvider_.stopListening(t.queryForListening_(e),m)}else c.forEach(function(e){var n=i.queryToTagMap_[t.makeQueryKey_(e)];i.listenProvider_.stopListening(t.queryForListening_(e),n)});this.removeTags_(c)}return s},t.prototype.calcCompleteEventCache=function(t,e){var n=!0,r=this.pendingWriteTree_,i=this.syncPointTree_.findOnPath(t,function(e,n){var r=z.relativePath(e,t),i=n.getCompleteServerCache(r);if(i)return i});return r.calcCompleteEventCache(t,i,e,n)},t.prototype.collectDistinctViewsForSubTree_=function(t){return t.fold(function(t,e,n){if(e&&e.hasCompleteView()){var r=e.getCompleteView();return[r]}var i=[];return e&&(i=e.getQueryViews()),o.forEach(n,function(t,e){i=i.concat(e)}),i})},t.prototype.removeTags_=function(e){for(var n=0;n<e.length;++n){var r=e[n];if(!r.getQueryParams().loadsAllData()){var i=t.makeQueryKey_(r),o=this.queryToTagMap_[i];delete this.queryToTagMap_[i],delete this.tagToQueryMap_["_"+o]}}},t.queryForListening_=function(t){return t.getQueryParams().loadsAllData()&&!t.getQueryParams().isDefault()?t.getRef():t},t.prototype.setupListener_=function(e,n){var r=e.path,i=this.tagForQuery_(e),a=this.createListenerForView_(n),s=this.listenProvider_.startListening(t.queryForListening_(e),i,a.hashFn,a.onComplete),u=this.syncPointTree_.subtree(r);if(i)o.assert(!u.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var c=u.fold(function(t,e,n){if(!t.isEmpty()&&e&&e.hasCompleteView())return[e.getCompleteView().getQuery()];var r=[];return e&&(r=r.concat(e.getQueryViews().map(function(t){return t.getQuery()}))),o.forEach(n,function(t,e){r=r.concat(e)}),r}),l=0;l<c.length;++l){var h=c[l];this.listenProvider_.stopListening(t.queryForListening_(h),this.tagForQuery_(h))}return s},t.prototype.createListenerForView_=function(t){var e=this,n=t.getQuery(),r=this.tagForQuery_(n);return{hashFn:function(){var e=t.getServerCache()||ae.EMPTY_NODE;return e.hash()},onComplete:function(t){if("ok"===t)return r?e.applyTaggedListenComplete(n.path,r):e.applyListenComplete(n.path);var i=B(t,n);return e.removeEventRegistration(n,null,i)}}},t.makeQueryKey_=function(t){return t.path.toString()+"$"+t.queryIdentifier()},t.parseQueryKey_=function(t){var e=t.indexOf("$");return o.assert(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new z(t.substr(0,e))}},t.prototype.queryKeyForTag_=function(t){return this.tagToQueryMap_["_"+t]},t.prototype.tagForQuery_=function(e){var n=t.makeQueryKey_(e);return o.safeGet(this.queryToTagMap_,n)},t.getNextQueryTag_=function(){return t.nextQueryTag_++},t.prototype.applyTaggedOperation_=function(t,e){var n=this.syncPointTree_.get(t);o.assert(n,"Missing sync point for query tag that we're tracking");var r=this.pendingWriteTree_.childWrites(t);return n.applyOperation(e,r,null)},t.prototype.applyOperationToSyncPoints_=function(t){return this.applyOperationHelper_(t,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(z.Empty))},t.prototype.applyOperationHelper_=function(t,e,n,r){if(t.path.isEmpty())return this.applyOperationDescendantsHelper_(t,e,n,r);var i=e.get(z.Empty);null==n&&null!=i&&(n=i.getCompleteServerCache(z.Empty));var o=[],a=t.path.getFront(),s=t.operationForChild(a),u=e.children.get(a);if(u&&s){var c=n?n.getImmediateChild(a):null,l=r.child(a);o=o.concat(this.applyOperationHelper_(s,u,c,l))}return i&&(o=o.concat(i.applyOperation(t,r,n))),o},t.prototype.applyOperationDescendantsHelper_=function(t,e,n,r){var i=this,o=e.get(z.Empty);null==n&&null!=o&&(n=o.getCompleteServerCache(z.Empty));var a=[];return e.children.inorderTraversal(function(e,o){var s=n?n.getImmediateChild(e):null,u=r.child(e),c=t.operationForChild(e);c&&(a=a.concat(i.applyOperationDescendantsHelper_(c,o,s,u)))}),o&&(a=a.concat(o.applyOperation(t,r,n))),a},t.nextQueryTag_=1,t}(),tn=function(){function t(){this.rootNode_=ae.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}(),en=function(){function t(t){this.app_=t}return t.prototype.getToken=function(t){return this.app_["INTERNAL"]["getToken"](t).then(null,function(t){return t&&"auth/token-not-initialized"===t.code?(_("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)})},t.prototype.addTokenChangeListener=function(t){this.app_["INTERNAL"]["addAuthTokenListener"](t)},t.prototype.removeTokenChangeListener=function(t){this.app_["INTERNAL"]["removeAuthTokenListener"](t)},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.app_.options?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',S(t)},t}(),nn=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),o.contains(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return o.deepCopy(this.counters_)},t}(),rn=function(){function t(){}return t.getCollection=function(t){var e=t.toString();return this.collections_[e]||(this.collections_[e]=new nn),this.collections_[e]},t.getOrCreateReporter=function(t,e){var n=t.toString();return this.reporters_[n]||(this.reporters_[n]=e()),this.reporters_[n]},t.collections_={},t.reporters_={},t}(),on=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=o.clone(t);return this.last_&&o.forEach(this.last_,function(t,n){e[t]=e[t]-n}),this.last_=t,e},t}(),an=1e4,sn=3e4,un=3e5,cn=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new on(t);var n=an+(sn-an)*Math.random();H(this.reportStats_.bind(this),Math.floor(n))}return t.prototype.includeStat=function(t){this.statsToReport_[t]=!0},t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},r=!1;o.forEach(e,function(e,i){i>0&&o.contains(t.statsToReport_,e)&&(n[e]=i,r=!0)}),r&&this.server_.reportStats(n),H(this.reportStats_.bind(this),Math.floor(2*Math.random()*un))},t}(),ln=function(){function t(){this.eventLists_=[],this.recursionDepth_=0}return t.prototype.queueEvents=function(t){for(var e=null,n=0;n<t.length;n++){var r=t[n],i=r.getPath();null===e||i.equals(e.getPath())||(this.eventLists_.push(e),e=null),null===e&&(e=new hn(i)),e.add(r)}e&&this.eventLists_.push(e)},t.prototype.raiseEventsAtPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_(function(e){return e.equals(t)})},t.prototype.raiseEventsForChangedPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_(function(e){return e.contains(t)||t.contains(e)})},t.prototype.raiseQueuedEventsMatchingPredicate_=function(t){this.recursionDepth_++;for(var e=!0,n=0;n<this.eventLists_.length;n++){var r=this.eventLists_[n];if(r){var i=r.getPath();t(i)?(this.eventLists_[n].raise(),this.eventLists_[n]=null):e=!1}}e&&(this.eventLists_=[]),this.recursionDepth_--},t}(),hn=function(){function t(t){this.path_=t,this.events_=[]}return t.prototype.add=function(t){this.events_.push(t)},t.prototype.raise=function(){for(var t=0;t<this.events_.length;t++){var e=this.events_[t];if(null!==e){this.events_[t]=null;var n=e.getEventRunner();m&&_("event: "+e.toString()),W(n)}}},t.prototype.getPath=function(){return this.path_},t}(),fn=function(){function t(t){this.allowedEvents_=t,this.listeners_={},o.assert(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var r=this.listeners_[t].slice(),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var r=this.getInitialEvent(t);r&&e.apply(n,r)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var r=this.listeners_[t]||[],i=0;i<r.length;i++)if(r[i].callback===e&&(!n||n===r[i].context))return void r.splice(i,1)},t.prototype.validateEventType_=function(t){o.assert(this.allowedEvents_.find(function(e){return e===t}),"Unknown event: "+t)},t}(),dn=function(t){function e(){var e,n,r=t.call(this,["visible"])||this;return"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document["hidden"]?(n="visibilitychange",e="hidden"):"undefined"!==typeof document["mozHidden"]?(n="mozvisibilitychange",e="mozHidden"):"undefined"!==typeof document["msHidden"]?(n="msvisibilitychange",e="msHidden"):"undefined"!==typeof document["webkitHidden"]&&(n="webkitvisibilitychange",e="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,function(){var t=!document[e];t!==r.visible_&&(r.visible_=t,r.trigger("visible",t))},!1),r}return s.__extends(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return o.assert("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(fn),pn=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"===typeof window||"undefined"===typeof window.addEventListener||o.isMobileCordova()||(window.addEventListener("online",function(){e.online_||(e.online_=!0,e.trigger("online",!0))},!1),window.addEventListener("offline",function(){e.online_&&(e.online_=!1,e.trigger("online",!1))},!1)),e}return s.__extends(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return o.assert("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(fn),vn=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;var r=function(){var t=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var e=function(e){t[e]&&W(function(){n.onMessage_(t[e])})},r=0;r<t.length;++r)e(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;while(this.pendingResponses[this.currentResponseNum]){var o=r();if("break"===o)break}},t}(),yn="start",gn="close",mn="pLPCommand",bn="pRTLPCB",wn="id",_n="pw",kn="ser",En="cb",Tn="seg",Sn="ts",Cn="d",On="disconn",An="dframe",In=1870,xn=30,Pn=In-xn,Nn=25e3,Rn=3e4,Dn=function(){function t(t,e,n,r){this.connId=t,this.repoInfo=e,this.transportSessionId=n,this.lastSessionId=r,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=k(t),this.stats_=rn.getCollection(e),this.urlFn=function(t){return e.connectionURL(nt,t)}}return t.prototype.open=function(t,e){var n=this;this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new vn(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null},Math.floor(Rn)),A(function(){if(!n.isClosed_){n.scriptTagHolder=new jn(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t[0],i=t[1],o=t[2];if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,r==yn)n.id=i,n.password=o;else{if(r!==gn)throw new Error("Unrecognized command received: "+r);i?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(i,function(){n.onClosed_()})):n.onClosed_()}},function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t[0],i=t[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(r,i)},function(){n.onClosed_()},n.urlFn);var t={};t[yn]="t",t[kn]=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(t[En]=n.scriptTagHolder.uniqueCallbackIdentifier),t[Y]=Q,n.transportSessionId&&(t[X]=n.transportSessionId),n.lastSessionId&&(t[tt]=n.lastSessionId),!o.isNodeSdk()&&"undefined"!==typeof location&&location.href&&-1!==location.href.indexOf(Z)&&(t[J]=$);var e=n.urlFn(t);n.log_("Connecting via long-poll to "+e),n.scriptTagHolder.addTag(e,function(){})}})},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return t.forceAllow_||!t.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!F()&&!V()&&!o.isNodeSdk()},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=o.stringify(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n=o.base64Encode(e),r=j(n,Pn),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,e){if(!o.isNodeSdk()){this.myDisconnFrame=document.createElement("iframe");var n={};n[An]="t",n[wn]=t,n[_n]=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},t.prototype.incrementIncomingBytes_=function(t){var e=o.stringify(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}(),jn=function(){function t(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new ke,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,o.isNodeSdk())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=v(),window[mn+this.uniqueCallbackIdentifier]=e,window[bn+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();var a="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)){var s=document.domain;a='<script>document.domain="'+s+'";<\/script>'}var u="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(u),this.myIFrame.doc.close()}catch(c){_("frame writing exception"),c.stack&&_(c.stack),_(c)}}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{var e=t.contentWindow.document;e||_("No IE domain setting required")}catch(r){var n=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var e=this;if(this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)},Math.floor(0))),o.isNodeSdk()&&this.myID){var n={};n[On]="t",n[wn]=this.myID,n[_n]=this.myPW;var r=this.urlFn(n);t.nodeRestRequest(r)}var i=this.onDisconnect;i&&(this.onDisconnect=null,i())},t.prototype.startLongPoll=function(t,e){this.myID=t,this.myPW=e,this.alive=!0;while(this.newRequest_());},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.count()<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var t={};t[wn]=this.myID,t[_n]=this.myPW,t[kn]=this.currentSerial;var e=this.urlFn(t),n="",r=0;while(this.pendingSegs.length>0){var i=this.pendingSegs[0];if(!(i.d.length+xn+n.length<=In))break;var o=this.pendingSegs.shift();n=n+"&"+Tn+r+"="+o.seg+"&"+Sn+r+"="+o.ts+"&"+Cn+r+"="+o.d,r++}return e+=n,this.addLongPollTag_(e,this.currentSerial),!0}return!1},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e,1);var r=function(){n.outstandingRequests.remove(e),n.newRequest_()},i=setTimeout(r,Math.floor(Nn)),o=function(){clearTimeout(i),r()};this.addTag(t,o)},t.prototype.addTag=function(t,e){var n=this;o.isNodeSdk()?this.doNodeLongPoll(t,e):setTimeout(function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){var t=r.readyState;t&&"loaded"!==t&&"complete"!==t||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),e())},r.onerror=function(){_("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(i){}},Math.floor(1))},t}(),Mn=16384,Ln=45e3,Fn=null;"undefined"!==typeof MozWebSocket?Fn=MozWebSocket:"undefined"!==typeof WebSocket&&(Fn=WebSocket);var Vn=function(){function t(e,n,r,i){this.connId=e,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=k(this.connId),this.stats_=rn.getCollection(n),this.connURL=t.connectionURL_(n,r,i)}return t.connectionURL_=function(t,e,n){var r={};return r[Y]=Q,!o.isNodeSdk()&&"undefined"!==typeof location&&location.href&&-1!==location.href.indexOf(Z)&&(r[J]=$),e&&(r[X]=e),n&&(r[tt]=n),t.connectionURL(et,r)},t.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,f.set("previous_websocket_failure",!0);try{if(o.isNodeSdk()){var i=o.CONSTANTS.NODE_ADMIN?"AdminNode":"Node",a={headers:{"User-Agent":"Firebase/"+Q+"/"+u.SDK_VERSION+"/"+r.platform+"/"+i}},s=Object({NODE_ENV:"production",BASE_URL:"/"}),c=0==this.connURL.indexOf("wss://")?s["HTTPS_PROXY"]||s["https_proxy"]:s["HTTP_PROXY"]||s["http_proxy"];c&&(a["proxy"]={origin:c}),this.mySock=new Fn(this.connURL,[],a)}else this.mySock=new Fn(this.connURL)}catch(h){this.log_("Error instantiating WebSocket.");var l=h.message||h.data;return l&&this.log_(l),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(t){n.handleIncomingFrame(t)},this.mySock.onerror=function(t){n.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&n.log_(e),n.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!==typeof navigator&&navigator.userAgent){var n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&null!==Fn&&!t.forceDisallow_},t.previouslyFailed=function(){return f.isInMemoryStorage||!0===f.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){f.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length==this.totalFrames){var e=this.frames.join("");this.frames=null;var n=o.jsonEval(e);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},t.prototype.extractFrameCount_=function(t){if(o.assert(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},t.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t["data"];if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(t){this.resetKeepAlive();var e=o.stringify(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=j(e,Mn);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()},Math.floor(Ln))},t.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}(),Bn=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[Dn,Vn]},enumerable:!0,configurable:!0}),t.prototype.initTransports_=function(e){var n=Vn&&Vn["isAvailable"](),r=n&&!Vn.previouslyFailed();if(e.webSocketOnly&&(n||S("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[Vn];else{var i=this.transports_=[];M(t.ALL_TRANSPORTS,function(t,e){e&&e["isAvailable"]()&&i.push(e)})}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}(),Un=6e4,qn=5e3,Wn=10240,Kn=102400,Hn="t",zn="d",Gn="s",Qn="r",Yn="e",Xn="o",Jn="a",$n="n",Zn="p",tr="h",er=function(){function t(t,e,n,r,i,o,a){this.id=t,this.repoInfo_=e,this.onMessage_=n,this.onReady_=r,this.onDisconnect_=i,this.onKill_=o,this.lastSessionId=a,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=k("c:"+this.id+":"),this.transportManager_=new Bn(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,void 0,this.lastSessionId),this.primaryResponsesRequired_=e["responsesRequiredToBeHealthy"]||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){t.conn_&&t.conn_.open(n,r)},Math.floor(0));var i=e["healthyTimeout"]||0;i>0&&(this.healthyTimeout_=H(function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&t.conn_.bytesReceived>Kn?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&t.conn_.bytesSent>Wn?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))},Math.floor(i)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!=e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){var e={t:"d",d:t};this.sendData_(e)},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if(Hn in t){var e=t[Hn];e===Jn?this.upgradeIfSecondaryHealthy_():e===Qn?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):e===Xn&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=R("t",t),n=R("d",t);if("c"==e)this.onSecondaryControl_(n);else{if("d"!=e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Zn,d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Jn,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:$n,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=R("t",t),n=R("d",t);"c"==e?this.onControl_(n):"d"==e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},t.prototype.onControl_=function(t){var e=R(Hn,t);if(zn in t){var n=t[zn];if(e===tr)this.onHandshake_(n);else if(e===$n){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else e===Gn?this.onConnectionShutdown_(n):e===Qn?this.onReset_(n):e===Yn?E("Server Error: "+n):e===Xn?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):E("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.updateHost(r),0==this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),Q!==n&&S("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.sessionId),this.secondaryResponsesRequired_=t["responsesRequiredToBeHealthy"]||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),H(function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())},Math.floor(Un))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.updateHost(t),1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):H(function(){n.sendPingOnPrimaryIfNecessary_()},Math.floor(qn))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Zn,d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(f.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}(),nr=function(){function t(){}return t.prototype.put=function(t,e,n,r){},t.prototype.merge=function(t,e,n,r){},t.prototype.refreshAuthToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}(),rr=1e3,ir=3e5,or=3e4,ar=1.3,sr=3e4,ur="server_kill",cr=3,lr=function(t){function e(n,r,i,a,s,u){var c=t.call(this)||this;if(c.repoInfo_=n,c.onDataUpdate_=r,c.onConnectStatus_=i,c.onServerInfoUpdate_=a,c.authTokenProvider_=s,c.authOverride_=u,c.id=e.nextPersistentConnectionId_++,c.log_=k("p:"+c.id+":"),c.interruptReasons_={},c.listens_={},c.outstandingPuts_=[],c.outstandingPutCount_=0,c.onDisconnectRequestQueue_=[],c.connected_=!1,c.reconnectDelay_=rr,c.maxReconnectDelay_=ir,c.securityDebugCallback_=null,c.lastSessionId=null,c.establishConnectionTimer_=null,c.visible_=!1,c.requestCBHash_={},c.requestNumber_=0,c.realtime_=null,c.authToken_=null,c.forceTokenRefresh_=!1,c.invalidAuthTokenCount_=0,c.firstConnection_=!0,c.lastConnectionAttemptTime_=null,c.lastConnectionEstablishedTime_=null,u&&!o.isNodeSdk())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return c.scheduleConnect_(0),dn.getInstance().on("visible",c.onVisible_,c),-1===n.host.indexOf("fblocal")&&pn.getInstance().on("online",c.onOnline_,c),c}return s.__extends(e,t),e.prototype.sendRequest=function(t,e,n){var r=++this.requestNumber_,i={r:r,a:t,b:e};this.log_(o.stringify(i)),o.assert(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},e.prototype.listen=function(t,e,n,r){var i=t.queryIdentifier(),a=t.path.toString();this.log_("Listen called for "+a+" "+i),this.listens_[a]=this.listens_[a]||{},o.assert(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),o.assert(!this.listens_[a][i],"listen() called twice for same path/queryId.");var s={onComplete:r,hashFn:e,query:t,tag:n};this.listens_[a][i]=s,this.connected_&&this.sendListen_(s)},e.prototype.sendListen_=function(t){var n=this,r=t.query,i=r.path.toString(),o=r.queryIdentifier();this.log_("Listen on "+i+" for "+o);var a={p:i},s="q";t.tag&&(a["q"]=r.queryObject(),a["t"]=t.tag),a["h"]=t.hashFn(),this.sendRequest(s,a,function(a){var s=a["d"],u=a["s"];e.warnOnListenWarnings_(s,r);var c=n.listens_[i]&&n.listens_[i][o];c===t&&(n.log_("listen response",a),"ok"!==u&&n.removeListen_(i,o),t.onComplete&&t.onComplete(u,s))})},e.warnOnListenWarnings_=function(t,e){if(t&&"object"===typeof t&&o.contains(t,"w")){var n=o.safeGet(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+e.getQueryParams().getIndex().toString()+'"',i=e.path.toString();S("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){var e=t&&40===t.length;(e||o.isAdmin(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=or)},e.prototype.tryAuth=function(){var t=this;if(this.connected_&&this.authToken_){var e=this.authToken_,n=o.isValidFormat(e)?"auth":"gauth",r={cred:e};null===this.authOverride_?r["noauth"]=!0:"object"===typeof this.authOverride_&&(r["authvar"]=this.authOverride_),this.sendRequest(n,r,function(n){var r=n["s"],i=n["d"]||"error";t.authToken_===e&&("ok"===r?t.invalidAuthTokenCount_=0:t.onAuthRevoked_(r,i))})}},e.prototype.unlisten=function(t,e){var n=t.path.toString(),r=t.queryIdentifier();this.log_("Unlisten called for "+n+" "+r),o.assert(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query");var i=this.removeListen_(n,r);i&&this.connected_&&this.sendUnlisten_(n,r,t.queryObject(),e)},e.prototype.sendUnlisten_=function(t,e,n,r){this.log_("Unlisten on "+t+" for "+e);var i={p:t},o="n";r&&(i["q"]=n,i["t"]=r),this.sendRequest(o,i)},e.prototype.onDisconnectPut=function(t,e,n){this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,r){var i={p:e,d:n};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,function(t){r&&setTimeout(function(){r(t["s"],t["d"])},Math.floor(0))})},e.prototype.put=function(t,e,n,r){this.putInternal("p",t,e,n,r)},e.prototype.merge=function(t,e,n,r){this.putInternal("m",t,e,n,r)},e.prototype.putInternal=function(t,e,n,r,i){var o={p:e,d:n};void 0!==i&&(o["h"]=i),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,r,function(r){e.log_(n+" response",r),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),i&&i(r["s"],r["d"])})},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,function(t){var n=t["s"];if("ok"!==n){var r=t["d"];e.log_("reportStats","Error sending stats: "+r)}})}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+o.stringify(t));var e=t["r"],n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t["b"]))}else{if("error"in t)throw"A server-side error has occurred: "+t["error"];"a"in t&&this.onDataPush_(t["a"],t["b"])}},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e["p"],e["d"],!1,e["t"]):"m"===t?this.onDataUpdate_(e["p"],e["d"],!0,e["t"]):"c"===t?this.onListenRevoked_(e["p"],e["q"]):"ac"===t?this.onAuthRevoked_(e["s"],e["d"]):"sd"===t?this.onSecurityDebugPacket_(e):E("Unrecognized action received from server: "+o.stringify(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;o.assert(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){e.establishConnectionTimer_=null,e.establishConnection_()},Math.floor(t))},e.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=rr,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=rr,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){var t=(new Date).getTime()-this.lastConnectionEstablishedTime_;t>sr&&(this.reconnectDelay_=rr),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var e=(new Date).getTime()-this.lastConnectionAttemptTime_,n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*ar)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+e.nextConnectionId_++,a=this,s=this.lastSessionId,u=!1,c=null,l=function(){c?c.close():(u=!0,r())},h=function(t){o.assert(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(t)};this.realtime_={close:l,sendRequest:h};var f=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(f).then(function(e){u?_("getToken() completed but was canceled"):(_("getToken() completed. Creating connection."),a.authToken_=e&&e.accessToken,c=new er(i,a.repoInfo_,t,n,r,function(t){S(t+" ("+a.repoInfo_.toString()+")"),a.interrupt(ur)},s))}).then(null,function(t){a.log_("Failed to get token: "+t),u||(o.CONSTANTS.NODE_ADMIN&&S(t),l())})}},e.prototype.interrupt=function(t){_("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){_("Resuming connection for reason: "+t),delete this.interruptReasons_[t],o.isEmpty(this.interruptReasons_)&&(this.reconnectDelay_=rr,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map(function(t){return D(t)}).join("$"):"default";var r=this.removeListen_(t,n);r&&r.onComplete&&r.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,r=new z(t).toString();return void 0!==this.listens_[r]?(n=this.listens_[r][e],delete this.listens_[r][e],0===o.getCount(this.listens_[r])&&delete this.listens_[r]):n=void 0,n},e.prototype.onAuthRevoked_=function(t,e){_("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=cr&&(this.reconnectDelay_=or,this.authTokenProvider_.notifyForInvalidToken()))},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t["msg"].replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t=this;this.tryAuth(),o.forEach(this.listens_,function(e,n){o.forEach(n,function(e,n){t.sendListen_(n)})});for(var e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);while(this.onDisconnectRequestQueue_.length){var n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}},e.prototype.sendConnectStats_=function(){var t={},e="js";o.CONSTANTS.NODE_ADMIN?e="admin_node":o.CONSTANTS.NODE_CLIENT&&(e="node"),t["sdk."+e+"."+u.SDK_VERSION.replace(/\./g,"-")]=1,o.isMobileCordova()?t["framework.cordova"]=1:o.isReactNative()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=pn.getInstance().currentlyOnline();return o.isEmpty(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(nr),hr=function(t){function e(e,n,r){var i=t.call(this)||this;return i.repoInfo_=e,i.onDataUpdate_=n,i.authTokenProvider_=r,i.log_=k("p:rest:"),i.listens_={},i}return s.__extends(e,t),e.prototype.reportStats=function(t){throw new Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:(o.assert(t.getQueryParams().isDefault(),"should have a tag if it's not a default query."),t.path.toString())},e.prototype.listen=function(t,n,r,i){var a=this,s=t.path.toString();this.log_("Listen called for "+s+" "+t.queryIdentifier());var u=e.getListenId_(t,r),c={};this.listens_[u]=c;var l=t.getQueryParams().toRestQueryStringParameters();this.restRequest_(s+".json",l,function(t,e){var n,l=e;(404===t&&(l=null,t=null),null===t&&a.onDataUpdate_(s,l,!1,r),o.safeGet(a.listens_,u)===c)&&(n=t?401==t?"permission_denied":"rest_error:"+t:"ok",i(n,null))})},e.prototype.unlisten=function(t,n){var r=e.getListenId_(t,n);delete this.listens_[r]},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var r=this;void 0===e&&(e={}),e["format"]="export",this.authTokenProvider_.getToken(!1).then(function(i){var a=i&&i.accessToken;a&&(e["auth"]=a);var s=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+t+"?ns="+r.repoInfo_.namespace+o.querystring(e);r.log_("Sending REST request for "+s);var u=new XMLHttpRequest;u.onreadystatechange=function(){if(n&&4===u.readyState){r.log_("REST Response for "+s+" received. status:",u.status,"response:",u.responseText);var t=null;if(u.status>=200&&u.status<300){try{t=o.jsonEval(u.responseText)}catch(e){S("Failed to parse JSON response for "+s+": "+u.responseText)}n(null,t)}else 401!==u.status&&404!==u.status&&S("Got unsuccessful REST response for "+s+" Status: "+u.status),n(u.status);n=null}},u.open("GET",s,!0),u.send()})},e}(nr),fr="repo_interrupt",dr=function(){function t(t,e,n){var r=this;this.repoInfo_=t,this.app=n,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new ln,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new Ee,this.persistentConnection_=null;var i=new en(n);if(this.stats_=rn.getCollection(t),e||K())this.server_=new hr(this.repoInfo_,this.onDataUpdate_.bind(this),i),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var a=n.options["databaseAuthVariableOverride"];if("undefined"!==typeof a&&null!==a){if("object"!==typeof a)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{o.stringify(a)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}this.persistentConnection_=new lr(this.repoInfo_,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),i,a),this.server_=this.persistentConnection_}i.addTokenChangeListener(function(t){r.server_.refreshAuthToken(t)}),this.statsReporter_=rn.getOrCreateReporter(t,function(){return new cn(r.stats_,r.server_)}),this.transactions_init_(),this.infoData_=new tn,this.infoSyncTree_=new Ze({startListening:function(t,e,n,i){var o=[],a=r.infoData_.getNode(t.path);return a.isEmpty()||(o=r.infoSyncTree_.applyServerOverwrite(t.path,a),setTimeout(function(){i("ok")},0)),o},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new Ze({startListening:function(t,e,n,i){return r.server_.listen(t,n,e,function(e,n){var o=i(e,n);r.eventQueue_.raiseEventsForChangedPath(t.path,o)}),[]},stopListening:function(t,e){r.server_.unlisten(t,e)}})}return t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t.prototype.name=function(){return this.repoInfo_.namespace},t.prototype.serverTime=function(){var t=this.infoData_.getNode(new z(".info/serverTimeOffset")),e=t.val()||0;return(new Date).getTime()+e},t.prototype.generateServerValues=function(){return Te({timestamp:this.serverTime()})},t.prototype.onDataUpdate_=function(t,e,n,r){this.dataUpdateCount++;var i=new z(t);e=this.interceptServerDataCallback_?this.interceptServerDataCallback_(t,e):e;var a=[];if(r)if(n){var s=o.map(e,function(t){return le(t)});a=this.serverSyncTree_.applyTaggedQueryMerge(i,s,r)}else{var u=le(e);a=this.serverSyncTree_.applyTaggedQueryOverwrite(i,u,r)}else if(n){var c=o.map(e,function(t){return le(t)});a=this.serverSyncTree_.applyServerMerge(i,c)}else{var l=le(e);a=this.serverSyncTree_.applyServerOverwrite(i,l)}var h=i;a.length>0&&(h=this.rerunTransactions_(i)),this.eventQueue_.raiseEventsForChangedPath(h,a)},t.prototype.interceptServerData_=function(t){this.interceptServerDataCallback_=t},t.prototype.onConnectStatus_=function(t){this.updateInfo_("connected",t),!1===t&&this.runOnDisconnectEvents_()},t.prototype.onServerInfoUpdate_=function(t){var e=this;M(t,function(t,n){e.updateInfo_(n,t)})},t.prototype.updateInfo_=function(t,e){var n=new z("/.info/"+t),r=le(e);this.infoData_.updateSnapshot(n,r);var i=this.infoSyncTree_.applyServerOverwrite(n,r);this.eventQueue_.raiseEventsForChangedPath(n,i)},t.prototype.getNextWriteId_=function(){return this.nextWriteId_++},t.prototype.setWithPriority=function(t,e,n,r){var i=this;this.log_("set",{path:t.toString(),value:e,priority:n});var o=this.generateServerValues(),a=le(e,n),s=Oe(a,o),u=this.getNextWriteId_(),c=this.serverSyncTree_.applyUserOverwrite(t,s,u,!0);this.eventQueue_.queueEvents(c),this.server_.put(t.toString(),a.val(!0),function(e,n){var o="ok"===e;o||S("set at "+t+" failed: "+e);var a=i.serverSyncTree_.ackUserWrite(u,!o);i.eventQueue_.raiseEventsForChangedPath(t,a),i.callOnCompleteCallback(r,e,n)});var l=this.abortTransactions_(t);this.rerunTransactions_(l),this.eventQueue_.raiseEventsForChangedPath(l,[])},t.prototype.update=function(t,e,n){var r=this;this.log_("update",{path:t.toString(),value:e});var i=!0,a=this.generateServerValues(),s={};if(o.forEach(e,function(t,e){i=!1;var n=le(e);s[t]=Oe(n,a)}),i)_("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(n,"ok");else{var u=this.getNextWriteId_(),c=this.serverSyncTree_.applyUserMerge(t,s,u);this.eventQueue_.queueEvents(c),this.server_.merge(t.toString(),e,function(e,i){var o="ok"===e;o||S("update at "+t+" failed: "+e);var a=r.serverSyncTree_.ackUserWrite(u,!o),s=a.length>0?r.rerunTransactions_(t):t;r.eventQueue_.raiseEventsForChangedPath(s,a),r.callOnCompleteCallback(n,e,i)}),o.forEach(e,function(e){var n=r.abortTransactions_(t.child(e));r.rerunTransactions_(n)}),this.eventQueue_.raiseEventsForChangedPath(t,[])}},t.prototype.runOnDisconnectEvents_=function(){var t=this;this.log_("onDisconnectEvents");var e=this.generateServerValues(),n=Ce(this.onDisconnect_,e),r=[];n.forEachTree(z.Empty,function(e,n){r=r.concat(t.serverSyncTree_.applyServerOverwrite(e,n));var i=t.abortTransactions_(e);t.rerunTransactions_(i)}),this.onDisconnect_=new Ee,this.eventQueue_.raiseEventsForChangedPath(z.Empty,r)},t.prototype.onDisconnectCancel=function(t,e){var n=this;this.server_.onDisconnectCancel(t.toString(),function(r,i){"ok"===r&&n.onDisconnect_.forget(t),n.callOnCompleteCallback(e,r,i)})},t.prototype.onDisconnectSet=function(t,e,n){var r=this,i=le(e);this.server_.onDisconnectPut(t.toString(),i.val(!0),function(e,o){"ok"===e&&r.onDisconnect_.remember(t,i),r.callOnCompleteCallback(n,e,o)})},t.prototype.onDisconnectSetWithPriority=function(t,e,n,r){var i=this,o=le(e,n);this.server_.onDisconnectPut(t.toString(),o.val(!0),function(e,n){"ok"===e&&i.onDisconnect_.remember(t,o),i.callOnCompleteCallback(r,e,n)})},t.prototype.onDisconnectUpdate=function(t,e,n){var r=this;if(o.isEmpty(e))return _("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(n,"ok");this.server_.onDisconnectMerge(t.toString(),e,function(i,a){"ok"===i&&o.forEach(e,function(e,n){var i=le(n);r.onDisconnect_.remember(t.child(e),i)}),r.callOnCompleteCallback(n,i,a)})},t.prototype.addEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.addEventRegistration(t,e):this.serverSyncTree_.addEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.removeEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.removeEventRegistration(t,e):this.serverSyncTree_.removeEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt(fr)},t.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume(fr)},t.prototype.stats=function(t){if(void 0===t&&(t=!1),"undefined"!==typeof console){var e;t?(this.statsListener_||(this.statsListener_=new on(this.stats_)),e=this.statsListener_.get()):e=this.stats_.get();var n=Object.keys(e).reduce(function(t,e){return Math.max(e.length,t)},0);o.forEach(e,function(t,e){for(var r=t.length;r<n+2;r++)t+=" ";console.log(t+e)})}},t.prototype.statsIncrementCounter=function(t){this.stats_.incrementCounter(t),this.statsReporter_.includeStat(t)},t.prototype.log_=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="";this.persistentConnection_&&(n=this.persistentConnection_.id+":"),_.apply(void 0,[n].concat(t))},t.prototype.callOnCompleteCallback=function(t,e,n){t&&W(function(){if("ok"==e)t(null);else{var r=(e||"error").toUpperCase(),i=r;n&&(i+=": "+n);var o=new Error(i);o.code=r,t(o)}})},Object.defineProperty(t.prototype,"database",{get:function(){return this.__database||(this.__database=new Tr(this))},enumerable:!0,configurable:!0}),t}(),pr=function(){function t(e){this.indexedFilter_=new Be(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},t.prototype.updateChild=function(t,e,n,r,i,o){return this.matches(new Nt(e,n))||(n=ae.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,r,i,o)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=ae.EMPTY_NODE);var r=e.withIndex(this.index_);r=r.updatePriority(ae.EMPTY_NODE);var i=this;return e.forEachChild(Qt,function(t,e){i.matches(new Nt(t,e))||(r=r.updateImmediateChild(t,ae.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},t.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},t}(),vr=function(){function t(t){this.rangedFilter_=new pr(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,r,i,o){return this.rangedFilter_.matches(new Nt(e,n))||(n=ae.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,r,i,o):this.fullLimitUpdateChild_(t,e,n,i,o)},t.prototype.updateFullNode=function(t,e,n){var r;if(e.isLeafNode()||e.isEmpty())r=ae.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){r=ae.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);var o=0;while(i.hasNext()&&o<this.limit_){var a=i.getNext(),s=void 0;if(s=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0,!s)break;r=r.updateImmediateChild(a.name,a.node),o++}}else{r=e.withIndex(this.index_),r=r.updatePriority(ae.EMPTY_NODE);var u=void 0,c=void 0,l=void 0;i=void 0;if(this.reverse_){i=r.getReverseIterator(this.index_),u=this.rangedFilter_.getEndPost(),c=this.rangedFilter_.getStartPost();var h=this.index_.getCompare();l=function(t,e){return h(e,t)}}else i=r.getIterator(this.index_),u=this.rangedFilter_.getStartPost(),c=this.rangedFilter_.getEndPost(),l=this.index_.getCompare();o=0;var f=!1;while(i.hasNext()){a=i.getNext();!f&&l(u,a)<=0&&(f=!0);s=f&&o<this.limit_&&l(a,c)<=0;s?o++:r=r.updateImmediateChild(a.name,ae.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,r,i){var a;if(this.reverse_){var s=this.index_.getCompare();a=function(t,e){return s(e,t)}}else a=this.index_.getCompare();var u=t;o.assert(u.numChildren()==this.limit_,"");var c=new Nt(e,n),l=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),h=this.rangedFilter_.matches(c);if(u.hasChild(e)){var f=u.getImmediateChild(e),d=r.getChildAfterChild(this.index_,l,this.reverse_);while(null!=d&&(d.name==e||u.hasChild(d.name)))d=r.getChildAfterChild(this.index_,d,this.reverse_);var p=null==d?1:a(d,c),v=h&&!n.isEmpty()&&p>=0;if(v)return null!=i&&i.trackChildChange(Ve.childChangedChange(e,n,f)),u.updateImmediateChild(e,n);null!=i&&i.trackChildChange(Ve.childRemovedChange(e,f));var y=u.updateImmediateChild(e,ae.EMPTY_NODE),g=null!=d&&this.rangedFilter_.matches(d);return g?(null!=i&&i.trackChildChange(Ve.childAddedChange(d.name,d.node)),y.updateImmediateChild(d.name,d.node)):y}return n.isEmpty()?t:h&&a(l,c)>=0?(null!=i&&(i.trackChildChange(Ve.childRemovedChange(l.name,l.node)),i.trackChildChange(Ve.childAddedChange(e,n))),u.updateImmediateChild(e,n).updateImmediateChild(l.name,ae.EMPTY_NODE)):t},t}(),yr=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Qt}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},t.prototype.getIndexStartValue=function(){return o.assert(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return o.assert(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:I},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return o.assert(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return o.assert(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:x},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return o.assert(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.copy_=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t.prototype.limit=function(t){var e=this.copy_();return e.limitSet_=!0,e.limit_=t,e.viewFrom_="",e},t.prototype.limitToFirst=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,n},t.prototype.limitToLast=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,n},t.prototype.startAt=function(t,e){var n=this.copy_();return n.startSet_=!0,void 0===t&&(t=null),n.indexStartValue_=t,null!=e?(n.startNameSet_=!0,n.indexStartName_=e):(n.startNameSet_=!1,n.indexStartName_=""),n},t.prototype.endAt=function(t,e){var n=this.copy_();return n.endSet_=!0,void 0===t&&(t=null),n.indexEndValue_=t,void 0!==e?(n.endNameSet_=!0,n.indexEndName_=e):(n.endNameSet_=!1,n.indexEndName_=""),n},t.prototype.orderBy=function(t){var e=this.copy_();return e.index_=t,e},t.prototype.getQueryObject=function(){var e=t.WIRE_PROTOCOL_CONSTANTS_,n={};if(this.startSet_&&(n[e.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(n[e.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(n[e.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(n[e.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){n[e.LIMIT]=this.limit_;var r=this.viewFrom_;""===r&&(r=this.isViewFromLeft()?e.VIEW_FROM_LEFT:e.VIEW_FROM_RIGHT),n[e.VIEW_FROM]=r}return this.index_!==Qt&&(n[e.INDEX]=this.index_.toString()),n},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_==Qt},t.prototype.getNodeFilter=function(){return this.loadsAllData()?new Be(this.getIndex()):this.hasLimit()?new vr(this):new pr(this)},t.prototype.toRestQueryStringParameters=function(){var e,n=t.REST_QUERY_CONSTANTS_,r={};return this.isDefault()?r:(this.index_===Qt?e=n.PRIORITY_INDEX:this.index_===pe?e=n.VALUE_INDEX:this.index_===jt?e=n.KEY_INDEX:(o.assert(this.index_ instanceof ve,"Unrecognized index type!"),e=this.index_.toString()),r[n.ORDER_BY]=o.stringify(e),this.startSet_&&(r[n.START_AT]=o.stringify(this.indexStartValue_),this.startNameSet_&&(r[n.START_AT]+=","+o.stringify(this.indexStartName_))),this.endSet_&&(r[n.END_AT]=o.stringify(this.indexEndValue_),this.endNameSet_&&(r[n.END_AT]+=","+o.stringify(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?r[n.LIMIT_TO_FIRST]=this.limit_:r[n.LIMIT_TO_LAST]=this.limit_),r)},t.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},t.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},t.DEFAULT=new t,t}(),gr=function(t){function e(e,n){var r=this;if(!(e instanceof dr))throw new Error("new Reference() no longer supported - use app.database().");return r=t.call(this,e,n,yr.DEFAULT,!1)||this,r}return s.__extends(e,t),e.prototype.getKey=function(){return o.validateArgCount("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},e.prototype.child=function(t){return o.validateArgCount("Reference.child",1,1,arguments.length),"number"===typeof t?t=String(t):t instanceof z||(null===this.path.getFront()?St("Reference.child",1,t,!1):Tt("Reference.child",1,t,!1)),new e(this.repo,this.path.child(t))},e.prototype.getParent=function(){o.validateArgCount("Reference.parent",0,0,arguments.length);var t=this.path.parent();return null===t?null:new e(this.repo,t)},e.prototype.getRoot=function(){o.validateArgCount("Reference.root",0,0,arguments.length);var t=this;while(null!==t.getParent())t=t.getParent();return t},e.prototype.databaseProp=function(){return this.repo.database},e.prototype.set=function(t,e){o.validateArgCount("Reference.set",1,2,arguments.length),Ct("Reference.set",this.path),gt("Reference.set",1,t,this.path,!1),o.validateCallback("Reference.set",2,e,!0);var n=new o.Deferred;return this.repo.setWithPriority(this.path,t,null,n.wrapCallback(e)),n.promise},e.prototype.update=function(t,e){if(o.validateArgCount("Reference.update",1,2,arguments.length),Ct("Reference.update",this.path),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,S("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}wt("Reference.update",1,t,this.path,!1),o.validateCallback("Reference.update",2,e,!0);var i=new o.Deferred;return this.repo.update(this.path,t,i.wrapCallback(e)),i.promise},e.prototype.setWithPriority=function(t,e,n){if(o.validateArgCount("Reference.setWithPriority",2,3,arguments.length),Ct("Reference.setWithPriority",this.path),gt("Reference.setWithPriority",1,t,this.path,!1),_t("Reference.setWithPriority",2,e,!1),o.validateCallback("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var r=new o.Deferred;return this.repo.setWithPriority(this.path,t,e,r.wrapCallback(n)),r.promise},e.prototype.remove=function(t){return o.validateArgCount("Reference.remove",0,1,arguments.length),Ct("Reference.remove",this.path),o.validateCallback("Reference.remove",1,t,!0),this.set(null,t)},e.prototype.transaction=function(t,e,n){if(o.validateArgCount("Reference.transaction",1,3,arguments.length),Ct("Reference.transaction",this.path),o.validateCallback("Reference.transaction",1,t,!1),o.validateCallback("Reference.transaction",2,e,!0),At("Reference.transaction",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===n&&(n=!0);var r=new o.Deferred;"function"===typeof e&&r.promise.catch(function(){});var i=function(t,n,i){t?r.reject(t):r.resolve(new xt(n,i)),"function"===typeof e&&e(t,n,i)};return this.repo.startTransaction(this.path,t,i,n),r.promise},e.prototype.setPriority=function(t,e){o.validateArgCount("Reference.setPriority",1,2,arguments.length),Ct("Reference.setPriority",this.path),_t("Reference.setPriority",1,t,!1),o.validateCallback("Reference.setPriority",2,e,!0);var n=new o.Deferred;return this.repo.setWithPriority(this.path.child(".priority"),t,null,n.wrapCallback(e)),n.promise},e.prototype.push=function(t,e){o.validateArgCount("Reference.push",0,2,arguments.length),Ct("Reference.push",this.path),gt("Reference.push",1,t,this.path,!0),o.validateCallback("Reference.push",2,e,!0);var n,r=this.repo.serverTime(),i=Pt(r),a=this.child(i),s=this.child(i);return n=null!=t?a.set(t,e).then(function(){return s}):Promise.resolve(s),a.then=n.then.bind(n),a.catch=n.then.bind(n,void 0),"function"===typeof e&&n.catch(function(){}),a},e.prototype.onDisconnect=function(){return Ct("Reference.onDisconnect",this.path),new It(this.repo,this.path)},Object.defineProperty(e.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!0,configurable:!0}),e}(_e);_e.__referenceConstructor=gr,Ye.__referenceConstructor=gr;var mr,br=function(){function t(){this.children={},this.childCount=0,this.value=null}return t}(),wr=function(){function t(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n=new br),this.name_=t,this.parent_=e,this.node_=n}return t.prototype.subTree=function(e){var n,r=e instanceof z?e:new z(e),i=this;while(null!==(n=r.getFront())){var a=o.safeGet(i.node_.children,n)||new br;i=new t(n,i,a),r=r.popFront()}return i},t.prototype.getValue=function(){return this.node_.value},t.prototype.setValue=function(t){o.assert("undefined"!==typeof t,"Cannot set value to undefined"),this.node_.value=t,this.updateParents_()},t.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},t.prototype.hasChildren=function(){return this.node_.childCount>0},t.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},t.prototype.forEachChild=function(e){var n=this;o.forEach(this.node_.children,function(r,i){e(new t(r,n,i))})},t.prototype.forEachDescendant=function(t,e,n){e&&!n&&t(this),this.forEachChild(function(e){e.forEachDescendant(t,!0,n)}),e&&n&&t(this)},t.prototype.forEachAncestor=function(t,e){var n=e?this:this.parent();while(null!==n){if(t(n))return!0;n=n.parent()}return!1},t.prototype.forEachImmediateDescendantWithValue=function(t){this.forEachChild(function(e){null!==e.getValue()?t(e):e.forEachImmediateDescendantWithValue(t)})},t.prototype.path=function(){return new z(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},t.prototype.name=function(){return this.name_},t.prototype.parent=function(){return this.parent_},t.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},t.prototype.updateChild_=function(t,e){var n=e.isEmpty(),r=o.contains(this.node_.children,t);n&&r?(delete this.node_.children[t],this.node_.childCount--,this.updateParents_()):n||r||(this.node_.children[t]=e.node_,this.node_.childCount++,this.updateParents_())},t}();(function(t){t[t["RUN"]=0]="RUN",t[t["SENT"]=1]="SENT",t[t["COMPLETED"]=2]="COMPLETED",t[t["SENT_NEEDS_ABORT"]=3]="SENT_NEEDS_ABORT",t[t["NEEDS_ABORT"]=4]="NEEDS_ABORT"})(mr||(mr={})),dr.MAX_TRANSACTION_RETRIES_=25,dr.prototype.transactions_init_=function(){this.transactionQueueTree_=new wr},dr.prototype.startTransaction=function(t,e,n,r){this.log_("transaction on "+t);var i=function(){},a=new gr(this,t);a.on("value",i);var s=function(){a.off("value",i)},u={path:t,update:e,onComplete:n,status:null,order:v(),applyLocally:r,retryCount:0,unwatcher:s,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},c=this.getLatestState_(t);u.currentInputSnapshot=c;var l=u.update(c.val());if(void 0===l){if(u.unwatcher(),u.currentOutputSnapshotRaw=null,u.currentOutputSnapshotResolved=null,u.onComplete){var h=new ye(u.currentInputSnapshot,new gr(this,u.path),Qt);u.onComplete(null,!1,h)}}else{mt("transaction failed: Data returned ",l,u.path),u.status=mr.RUN;var f=this.transactionQueueTree_.subTree(t),d=f.getValue()||[];d.push(u),f.setValue(d);var p=void 0;if("object"===typeof l&&null!==l&&o.contains(l,".priority"))p=o.safeGet(l,".priority"),o.assert(yt(p),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else{var y=this.serverSyncTree_.calcCompleteEventCache(t)||ae.EMPTY_NODE;p=y.getPriority().val()}p=p;var g=this.generateServerValues(),m=le(l,p),b=Oe(m,g);u.currentOutputSnapshotRaw=m,u.currentOutputSnapshotResolved=b,u.currentWriteId=this.getNextWriteId_();var w=this.serverSyncTree_.applyUserOverwrite(t,b,u.currentWriteId,u.applyLocally);this.eventQueue_.raiseEventsForChangedPath(t,w),this.sendReadyTransactions_()}},dr.prototype.getLatestState_=function(t,e){return this.serverSyncTree_.calcCompleteEventCache(t,e)||ae.EMPTY_NODE},dr.prototype.sendReadyTransactions_=function(t){var e=this;if(void 0===t&&(t=this.transactionQueueTree_),t||this.pruneCompletedTransactionsBelowNode_(t),null!==t.getValue()){var n=this.buildTransactionQueue_(t);o.assert(n.length>0,"Sending zero length transaction queue");var r=n.every(function(t){return t.status===mr.RUN});r&&this.sendTransactionQueue_(t.path(),n)}else t.hasChildren()&&t.forEachChild(function(t){e.sendReadyTransactions_(t)})},dr.prototype.sendTransactionQueue_=function(t,e){for(var n=this,r=e.map(function(t){return t.currentWriteId}),i=this.getLatestState_(t,r),a=i,s=i.hash(),u=0;u<e.length;u++){var c=e[u];o.assert(c.status===mr.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),c.status=mr.SENT,c.retryCount++;var l=z.relativePath(t,c.path);a=a.updateChild(l,c.currentOutputSnapshotRaw)}var h=a.val(!0),f=t;this.server_.put(f.toString(),h,function(r){n.log_("transaction put response",{path:f.toString(),status:r});var i=[];if("ok"===r){for(var o=[],a=0;a<e.length;a++){if(e[a].status=mr.COMPLETED,i=i.concat(n.serverSyncTree_.ackUserWrite(e[a].currentWriteId)),e[a].onComplete){var s=e[a].currentOutputSnapshotResolved,u=new gr(n,e[a].path),c=new ye(s,u,Qt);o.push(e[a].onComplete.bind(null,null,!0,c))}e[a].unwatcher()}n.pruneCompletedTransactionsBelowNode_(n.transactionQueueTree_.subTree(t)),n.sendReadyTransactions_(),n.eventQueue_.raiseEventsForChangedPath(t,i);for(a=0;a<o.length;a++)W(o[a])}else{if("datastale"===r)for(a=0;a<e.length;a++)e[a].status===mr.SENT_NEEDS_ABORT?e[a].status=mr.NEEDS_ABORT:e[a].status=mr.RUN;else{S("transaction at "+f.toString()+" failed: "+r);for(a=0;a<e.length;a++)e[a].status=mr.NEEDS_ABORT,e[a].abortReason=r}n.rerunTransactions_(t)}},s)},dr.prototype.rerunTransactions_=function(t){var e=this.getAncestorTransactionNode_(t),n=e.path(),r=this.buildTransactionQueue_(e);return this.rerunTransactionQueue_(r,n),n},dr.prototype.rerunTransactionQueue_=function(t,e){if(0!==t.length){for(var n=[],r=[],i=t.filter(function(t){return t.status===mr.RUN}),a=i.map(function(t){return t.currentWriteId}),s=0;s<t.length;s++){var u=t[s],c=z.relativePath(e,u.path),l=!1,h=void 0;if(o.assert(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),u.status===mr.NEEDS_ABORT)l=!0,h=u.abortReason,r=r.concat(this.serverSyncTree_.ackUserWrite(u.currentWriteId,!0));else if(u.status===mr.RUN)if(u.retryCount>=dr.MAX_TRANSACTION_RETRIES_)l=!0,h="maxretry",r=r.concat(this.serverSyncTree_.ackUserWrite(u.currentWriteId,!0));else{var f=this.getLatestState_(u.path,a);u.currentInputSnapshot=f;var d=t[s].update(f.val());if(void 0!==d){mt("transaction failed: Data returned ",d,u.path);var p=le(d),v="object"===typeof d&&null!=d&&o.contains(d,".priority");v||(p=p.updatePriority(f.getPriority()));var y=u.currentWriteId,g=this.generateServerValues(),m=Oe(p,g);u.currentOutputSnapshotRaw=p,u.currentOutputSnapshotResolved=m,u.currentWriteId=this.getNextWriteId_(),a.splice(a.indexOf(y),1),r=r.concat(this.serverSyncTree_.applyUserOverwrite(u.path,m,u.currentWriteId,u.applyLocally)),r=r.concat(this.serverSyncTree_.ackUserWrite(y,!0))}else l=!0,h="nodata",r=r.concat(this.serverSyncTree_.ackUserWrite(u.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(e,r),r=[],l&&(t[s].status=mr.COMPLETED,function(t){setTimeout(t,Math.floor(0))}(t[s].unwatcher),t[s].onComplete))if("nodata"===h){var b=new gr(this,t[s].path),w=t[s].currentInputSnapshot,_=new ye(w,b,Qt);n.push(t[s].onComplete.bind(null,null,!1,_))}else n.push(t[s].onComplete.bind(null,new Error(h),!1,null))}this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_);for(s=0;s<n.length;s++)W(n[s]);this.sendReadyTransactions_()}},dr.prototype.getAncestorTransactionNode_=function(t){var e,n=this.transactionQueueTree_;while(null!==(e=t.getFront())&&null===n.getValue())n=n.subTree(e),t=t.popFront();return n},dr.prototype.buildTransactionQueue_=function(t){var e=[];return this.aggregateTransactionQueuesForNode_(t,e),e.sort(function(t,e){return t.order-e.order}),e},dr.prototype.aggregateTransactionQueuesForNode_=function(t,e){var n=this,r=t.getValue();if(null!==r)for(var i=0;i<r.length;i++)e.push(r[i]);t.forEachChild(function(t){n.aggregateTransactionQueuesForNode_(t,e)})},dr.prototype.pruneCompletedTransactionsBelowNode_=function(t){var e=this,n=t.getValue();if(n){for(var r=0,i=0;i<n.length;i++)n[i].status!==mr.COMPLETED&&(n[r]=n[i],r++);n.length=r,t.setValue(n.length>0?n:null)}t.forEachChild(function(t){e.pruneCompletedTransactionsBelowNode_(t)})},dr.prototype.abortTransactions_=function(t){var e=this,n=this.getAncestorTransactionNode_(t).path(),r=this.transactionQueueTree_.subTree(t);return r.forEachAncestor(function(t){e.abortTransactionsOnNode_(t)}),this.abortTransactionsOnNode_(r),r.forEachDescendant(function(t){e.abortTransactionsOnNode_(t)}),n},dr.prototype.abortTransactionsOnNode_=function(t){var e=t.getValue();if(null!==e){for(var n=[],r=[],i=-1,a=0;a<e.length;a++)if(e[a].status===mr.SENT_NEEDS_ABORT);else if(e[a].status===mr.SENT)o.assert(i===a-1,"All SENT items should be at beginning of queue."),i=a,e[a].status=mr.SENT_NEEDS_ABORT,e[a].abortReason="set";else if(o.assert(e[a].status===mr.RUN,"Unexpected transaction status in abort"),e[a].unwatcher(),r=r.concat(this.serverSyncTree_.ackUserWrite(e[a].currentWriteId,!0)),e[a].onComplete){var s=null;n.push(e[a].onComplete.bind(null,new Error("set"),!1,s))}-1===i?t.setValue(null):e.length=i+1,this.eventQueue_.raiseEventsForChangedPath(t.path(),r);for(a=0;a<n.length;a++)W(n[a])}};var _r,kr="databaseURL",Er=function(){function t(){this.repos_={},this.useRestClient_=!1}return t.getInstance=function(){return _r||(_r=new t),_r},t.prototype.interrupt=function(){for(var t in this.repos_)for(var e in this.repos_[t])this.repos_[t][e].interrupt()},t.prototype.resume=function(){for(var t in this.repos_)for(var e in this.repos_[t])this.repos_[t][e].resume()},t.prototype.databaseFromApp=function(t,e){var n=e||t.options[kr];void 0===n&&T("Can't determine Firebase Database URL.  Be sure to include "+kr+" option when calling firebase.initializeApp().");var r=ut(n),i=r.repoInfo;Ot("Invalid Firebase Database URL",1,r),r.path.isEmpty()||T("Database URL must point to the root of a Firebase Database (not including a child path).");var o=this.createRepo(i,t);return o.database},t.prototype.deleteRepo=function(t){var e=o.safeGet(this.repos_,t.app.name);e&&o.safeGet(e,t.repoInfo_.toURLString())===t||T("Database "+t.app.name+"("+t.repoInfo_+") has already been deleted."),t.interrupt(),delete e[t.repoInfo_.toURLString()]},t.prototype.createRepo=function(t,e){var n=o.safeGet(this.repos_,e.name);n||(n={},this.repos_[e.name]=n);var r=o.safeGet(n,t.toURLString());return r&&T("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new dr(t,this.useRestClient_,e),n[t.toURLString()]=r,r},t.prototype.forceRestClient=function(t){this.useRestClient_=t},t}(),Tr=function(){function t(t){this.repo_=t,t instanceof dr||T("Don't call new Database() directly - please use firebase.database()."),this.root_=new gr(t,z.Empty),this.INTERNAL=new Sr(this)}return Object.defineProperty(t.prototype,"app",{get:function(){return this.repo_.app},enumerable:!0,configurable:!0}),t.prototype.ref=function(t){return this.checkDeleted_("ref"),o.validateArgCount("database.ref",0,1,arguments.length),t instanceof gr?this.refFromURL(t.toString()):void 0!==t?this.root_.child(t):this.root_},t.prototype.refFromURL=function(t){var e="database.refFromURL";this.checkDeleted_(e),o.validateArgCount(e,1,1,arguments.length);var n=ut(t);Ot(e,1,n);var r=n.repoInfo;return r.host!==this.repo_.repoInfo_.host&&T(e+": Host name does not match the current database: (found "+r.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(n.path.toString())},t.prototype.checkDeleted_=function(t){null===this.repo_&&T("Cannot call "+t+" on a deleted database.")},t.prototype.goOffline=function(){o.validateArgCount("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},t.prototype.goOnline=function(){o.validateArgCount("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},t.ServerValue={TIMESTAMP:{".sv":"timestamp"}},t}(),Sr=function(){function t(t){this.database=t}return t.prototype.delete=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){return this.database.checkDeleted_("delete"),Er.getInstance().deleteRepo(this.database.repo_),this.database.repo_=null,this.database.root_=null,this.database.INTERNAL=null,this.database=null,[2]})})},t}(),Cr=function(){Vn.forceDisallow(),Dn.forceAllow()},Or=function(){Dn.forceDisallow()},Ar=function(){return Vn["isAvailable"]()},Ir=function(t,e){t.repo.persistentConnection_.securityDebugCallback_=e},xr=function(t,e){t.repo.stats(e)},Pr=function(t,e){t.repo.statsIncrementCounter(e)},Nr=function(t){return t.repo.dataUpdateCount},Rr=function(t,e){return t.repo.interceptServerData_(e)},Dr=Object.freeze({forceLongPolling:Cr,forceWebSockets:Or,isWebSocketsAvailable:Ar,setSecurityDebugCallback:Ir,stats:xr,statsIncrementCounter:Pr,dataUpdateCount:Nr,interceptServerData:Rr}),jr=lr;lr.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},lr.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var Mr=er,Lr=function(t){var e=lr.prototype.put;return lr.prototype.put=function(n,r,i,o){void 0!==o&&(o=t()),e.call(this,n,r,i,o)},function(){lr.prototype.put=e}},Fr=rt,Vr=function(t){return t.queryIdentifier()},Br=function(t){return t.repo.persistentConnection_.listens_},Ur=function(t){Er.getInstance().forceRestClient(t)},qr=Object.freeze({DataConnection:jr,RealTimeConnection:Mr,hijackHash:Lr,ConnectionTarget:Fr,queryIdentifier:Vr,listens:Br,forceRestClient:Ur}),Wr=Tr.ServerValue;function Kr(e){var n=e.INTERNAL.registerService("database",function(t,e,n){return Er.getInstance().databaseFromApp(t,n)},{Reference:gr,Query:_e,Database:Tr,enableLogging:w,INTERNAL:Dr,ServerValue:Wr,TEST_ACCESS:qr},null,!0);o.isNodeSdk()&&(t.exports=n)}Kr(u),e.registerDatabase=Kr,e.Database=Tr,e.Query=_e,e.Reference=gr,e.enableLogging=w,e.ServerValue=Wr,e.DataSnapshot=ye,e.OnDisconnect=It}).call(this,n("4362"))},"356b":function(t,e,n){},"36bd":function(t,e,n){"use strict";var r=n("4bf8"),i=n("77f1"),o=n("9def");t.exports=function(t){var e=r(this),n=o(e.length),a=arguments.length,s=i(a>1?arguments[1]:void 0,n),u=a>2?arguments[2]:void 0,c=void 0===u?n:i(u,n);while(c>s)e[s++]=t;return e}},3702:function(t,e,n){var r=n("481b"),i=n("5168")("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||o[i]===t)}},3846:function(t,e,n){n("9e1e")&&"g"!=/./g.flags&&n("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:n("0bfb")})},"386b":function(t,e,n){var r=n("5ca1"),i=n("79e5"),o=n("be13"),a=/"/g,s=function(t,e,n,r){var i=String(o(t)),s="<"+e;return""!==n&&(s+=" "+n+'="'+String(r).replace(a,"&quot;")+'"'),s+">"+i+"</"+e+">"};t.exports=function(t,e){var n={};n[t]=e(s),r(r.P+r.F*i(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}),"String",n)}},3879:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 250"><rect rx="4"/></svg>'},"39cf":function(t,e,n){"use strict";var r,i=n("57b1")(0),o=n("9138"),a=n("ebfd"),s=n("9306"),u=n("901e"),c=n("f772"),l=n("294c"),h=n("9f79"),f="WeakMap",d=a.getWeak,p=Object.isExtensible,v=u.ufstore,y={},g=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},m={get:function(t){if(c(t)){var e=d(t);return!0===e?v(h(this,f)).get(t):e?e[this._i]:void 0}},set:function(t,e){return u.def(h(this,f),t,e)}},b=t.exports=n("ada4")(f,g,m,u,!0,!0);l(function(){return 7!=(new b).set((Object.freeze||Object)(y),7).get(y)})&&(r=u.getConstructor(g,f),s(r.prototype,m),a.NEED=!0,i(["delete","has","get","set"],function(t){var e=b.prototype,n=e[t];o(e,t,function(e,i){if(c(e)&&!p(e)){this._f||(this._f=new r);var o=this._f[t](e,i);return"set"==t?this:o}return n.call(this,e,i)})}))},"3a7f":function(t,e,n){},"3b2b":function(t,e,n){var r=n("7726"),i=n("5dbc"),o=n("86cc").f,a=n("9093").f,s=n("aae3"),u=n("0bfb"),c=r.RegExp,l=c,h=c.prototype,f=/a/g,d=/a/g,p=new c(f)!==f;if(n("9e1e")&&(!p||n("79e5")(function(){return d[n("2b4c")("match")]=!1,c(f)!=f||c(d)==d||"/a/i"!=c(f,"i")}))){c=function(t,e){var n=this instanceof c,r=s(t),o=void 0===e;return!n&&r&&t.constructor===c&&o?t:i(p?new l(r&&!o?t.source:t,e):l((r=t instanceof c)?t.source:t,r&&o?u.call(t):e),n?this:h,c)};for(var v=function(t){t in c||o(c,t,{configurable:!0,get:function(){return l[t]},set:function(e){l[t]=e}})},y=a(l),g=0;y.length>g;)v(y[g++]);h.constructor=c,c.prototype=h,n("2aba")(r,"RegExp",c)}n("7a56")("RegExp")},"3c11":function(t,e,n){"use strict";var r=n("63b6"),i=n("584a"),o=n("e53d"),a=n("f201"),s=n("cd78");r(r.P+r.R,"Promise",{finally:function(t){var e=a(this,i.Promise||o.Promise),n="function"==typeof t;return this.then(n?function(n){return s(e,t()).then(function(){return n})}:t,n?function(n){return s(e,t()).then(function(){throw n})}:t)}})},"3d1d":function(t,e,n){},"40c3":function(t,e,n){var r=n("6b4c"),i=n("5168")("toStringTag"),o="Arguments"==r(function(){return arguments}()),a=function(t,e){try{return t[e]}catch(n){}};t.exports=function(t){var e,n,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=a(e=Object(t),i))?n:o?r(e):"Object"==(s=r(e))&&"function"==typeof e.callee?"Arguments":s}},4178:function(t,e,n){var r,i,o,a=n("d864"),s=n("3024"),u=n("32fc"),c=n("1ec9"),l=n("e53d"),h=l.process,f=l.setImmediate,d=l.clearImmediate,p=l.MessageChannel,v=l.Dispatch,y=0,g={},m="onreadystatechange",b=function(){var t=+this;if(g.hasOwnProperty(t)){var e=g[t];delete g[t],e()}},w=function(t){b.call(t.data)};f&&d||(f=function(t){var e=[],n=1;while(arguments.length>n)e.push(arguments[n++]);return g[++y]=function(){s("function"==typeof t?t:Function(t),e)},r(y),y},d=function(t){delete g[t]},"process"==n("6b4c")(h)?r=function(t){h.nextTick(a(b,t,1))}:v&&v.now?r=function(t){v.now(a(b,t,1))}:p?(i=new p,o=i.port2,i.port1.onmessage=w,r=a(o.postMessage,o,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(r=function(t){l.postMessage(t+"","*")},l.addEventListener("message",w,!1)):r=m in c("script")?function(t){u.appendChild(c("script"))[m]=function(){u.removeChild(this),b.call(t)}}:function(t){setTimeout(a(b,t,1),0)}),t.exports={set:f,clear:d}},"42b5":function(t,e){t.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><g><path class="ck-icon__fill" d="M10.798 1.59L3.002 12.875l1.895 1.852 2.521 1.402 6.997-12.194z"/><path d="M2.556 16.727l.234-.348c-.297-.151-.462-.293-.498-.426-.036-.137.002-.416.115-.837.094-.25.15-.449.169-.595a4.495 4.495 0 0 0 0-.725c-.209-.621-.303-1.041-.284-1.26.02-.218.178-.506.475-.862l6.77-9.414c.539-.91 1.605-.85 3.199.18 1.594 1.032 2.188 1.928 1.784 2.686l-5.877 10.36c-.158.412-.333.673-.526.782-.193.108-.604.179-1.232.21-.362.131-.608.237-.738.318-.13.081-.305.238-.526.47-.293.265-.504.397-.632.397-.096 0-.27-.075-.524-.226l-.31.41-1.6-1.12zm-.279.415l1.575 1.103-.392.515H1.19l1.087-1.618zm8.1-13.656l-4.953 6.9L8.75 12.57l4.247-7.574c.175-.25-.188-.647-1.092-1.192-.903-.546-1.412-.652-1.528-.32zM8.244 18.5L9.59 17h9.406v1.5H8.245z"/></g></svg>'},4362:function(t,e,n){e.nextTick=function(t){setTimeout(t,0)},e.platform=e.arch=e.execPath=e.title="browser",e.pid=1,e.browser=!0,e.env={},e.argv=[],e.binding=function(t){throw new Error("No such module. (Possibly not yet loaded)")},function(){var t,r="/";e.cwd=function(){return r},e.chdir=function(e){t||(t=n("df7c")),r=t.resolve(e,r)}}(),e.exit=e.kill=e.umask=e.dlopen=e.uptime=e.memoryUsage=e.uvCounters=function(){},e.features={}},"43ae":function(t,e,n){},"43fc":function(t,e,n){"use strict";var r=n("63b6"),i=n("656e"),o=n("4439");r(r.S,"Promise",{try:function(t){var e=i.f(this),n=o(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}})},4439:function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(e){return{e:!0,v:e}}}},4517:function(t,e,n){var r=n("a22a");t.exports=function(t,e){var n=[];return r(t,!1,n.push,n,e),n}},"454f":function(t,e,n){n("46a7");var r=n("584a").Object;t.exports=function(t,e,n){return r.defineProperty(t,e,n)}},"469f":function(t,e,n){n("6c1c"),n("1654"),t.exports=n("7d7b")},"46a7":function(t,e,n){var r=n("63b6");r(r.S+r.F*!n("8e60"),"Object",{defineProperty:n("d9f6").f})},4910:function(t,e,n){n("1cb7"),t.exports=n("584a").Reflect.get},4917:function(t,e,n){"use strict";var r=n("cb7c"),i=n("9def"),o=n("0390"),a=n("5f1b");n("214f")("match",1,function(t,e,n,s){return[function(n){var r=t(this),i=void 0==n?void 0:n[e];return void 0!==i?i.call(n,r):new RegExp(n)[e](String(r))},function(t){var e=s(n,t,this);if(e.done)return e.value;var u=r(t),c=String(this);if(!u.global)return a(u,c);var l=u.unicode;u.lastIndex=0;var h,f=[],d=0;while(null!==(h=a(u,c))){var p=String(h[0]);f[d]=p,""===p&&(u.lastIndex=o(c,i(u.lastIndex),l)),d++}return 0===d?null:f}]})},"4c95":function(t,e,n){"use strict";var r=n("e53d"),i=n("584a"),o=n("d9f6"),a=n("8e60"),s=n("5168")("species");t.exports=function(t){var e="function"==typeof i[t]?i[t]:r[t];a&&e&&!e[s]&&o.f(e,s,{configurable:!0,get:function(){return this}})}},"4ca4":function(t,e){t.exports='<svg viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg"><path d="M.941 4.523a.75.75 0 1 1 1.06-1.06l3.006 3.005 3.005-3.005a.75.75 0 1 1 1.06 1.06l-3.549 3.55a.75.75 0 0 1-1.168-.136L.941 4.523z"/></svg>'},"4ee1":function(t,e,n){var r=n("5168")("iterator"),i=!1;try{var o=[7][r]();o["return"]=function(){i=!0},Array.from(o,function(){throw 2})}catch(a){}t.exports=function(t,e){if(!e&&!i)return!1;var n=!1;try{var o=[7],s=o[r]();s.next=function(){return{done:n=!0}},o[r]=function(){return s},t(o)}catch(a){}return n}},5037:function(t,e,n){n("c207"),n("1654"),n("6c1c"),n("837d"),n("5cb6"),n("fe1e"),n("7554"),t.exports=n("584a").Map},"507e":function(t,e,n){},"50bd":function(t,e){t.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 10.423a6.5 6.5 0 0 1 6.056-6.408l.038.67C6.448 5.423 5.354 7.663 5.22 10H9c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574zm8 0a6.5 6.5 0 0 1 6.056-6.408l.038.67c-2.646.739-3.74 2.979-3.873 5.315H17c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574z"/></svg>'},5147:function(t,e,n){var r=n("2b4c")("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[r]=!1,!"/./"[t](e)}catch(i){}}return!0}},5176:function(t,e,n){t.exports=n("51b6")},"51b6":function(t,e,n){n("a3c3"),t.exports=n("584a").Object.assign},"520a":function(t,e,n){"use strict";var r=n("0bfb"),i=RegExp.prototype.exec,o=String.prototype.replace,a=i,s="lastIndex",u=function(){var t=/a/,e=/b*/g;return i.call(t,"a"),i.call(e,"a"),0!==t[s]||0!==e[s]}(),c=void 0!==/()??/.exec("")[1],l=u||c;l&&(a=function(t){var e,n,a,l,h=this;return c&&(n=new RegExp("^"+h.source+"$(?!\\s)",r.call(h))),u&&(e=h[s]),a=i.call(h,t),u&&a&&(h[s]=h.global?a.index+a[0].length:e),c&&a&&a.length>1&&o.call(a[0],n,function(){for(l=1;l<arguments.length-2;l++)void 0===arguments[l]&&(a[l]=void 0)}),a}),t.exports=a},"52a7":function(t,e){e.f={}.propertyIsEnumerable},"52fe":function(t,e){(function(t){"use strict";if(!t.fetch){var e={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(e.arrayBuffer)var n=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],r=function(t){return t&&DataView.prototype.isPrototypeOf(t)},i=ArrayBuffer.isView||function(t){return t&&n.indexOf(Object.prototype.toString.call(t))>-1};l.prototype.append=function(t,e){t=s(t),e=u(e);var n=this.map[t];this.map[t]=n?n+","+e:e},l.prototype["delete"]=function(t){delete this.map[s(t)]},l.prototype.get=function(t){return t=s(t),this.has(t)?this.map[t]:null},l.prototype.has=function(t){return this.map.hasOwnProperty(s(t))},l.prototype.set=function(t,e){this.map[s(t)]=u(e)},l.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},l.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),c(t)},l.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),c(t)},l.prototype.entries=function(){var t=[];return this.forEach(function(e,n){t.push([n,e])}),c(t)},e.iterable&&(l.prototype[Symbol.iterator]=l.prototype.entries);var o=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},g.call(b.prototype),g.call(k.prototype),k.prototype.clone=function(){return new k(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new l(this.headers),url:this.url})},k.error=function(){var t=new k(null,{status:0,statusText:""});return t.type="error",t};var a=[301,302,303,307,308];k.redirect=function(t,e){if(-1===a.indexOf(e))throw new RangeError("Invalid status code");return new k(null,{status:e,headers:{location:t}})},t.Headers=l,t.Request=b,t.Response=k,t.fetch=function(t,n){return new Promise(function(r,i){var o=new b(t,n),a=new XMLHttpRequest;a.onload=function(){var t={status:a.status,statusText:a.statusText,headers:_(a.getAllResponseHeaders()||"")};t.url="responseURL"in a?a.responseURL:t.headers.get("X-Request-URL");var e="response"in a?a.response:a.responseText;r(new k(e,t))},a.onerror=function(){i(new TypeError("Network request failed"))},a.ontimeout=function(){i(new TypeError("Network request failed"))},a.open(o.method,o.url,!0),"include"===o.credentials?a.withCredentials=!0:"omit"===o.credentials&&(a.withCredentials=!1),"responseType"in a&&e.blob&&(a.responseType="blob"),o.headers.forEach(function(t,e){a.setRequestHeader(e,t)}),a.send("undefined"===typeof o._bodyInit?null:o._bodyInit)})},t.fetch.polyfill=!0}function s(t){if("string"!==typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function u(t){return"string"!==typeof t&&(t=String(t)),t}function c(t){var n={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return e.iterable&&(n[Symbol.iterator]=function(){return n}),n}function l(t){this.map={},t instanceof l?t.forEach(function(t,e){this.append(e,t)},this):Array.isArray(t)?t.forEach(function(t){this.append(t[0],t[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function h(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function f(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function d(t){var e=new FileReader,n=f(e);return e.readAsArrayBuffer(t),n}function p(t){var e=new FileReader,n=f(e);return e.readAsText(t),n}function v(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}function y(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function g(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,t)if("string"===typeof t)this._bodyText=t;else if(e.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(e.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(e.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(e.arrayBuffer&&e.blob&&r(t))this._bodyArrayBuffer=y(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!e.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t)&&!i(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=y(t)}else this._bodyText="";this.headers.get("content-type")||("string"===typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):e.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},e.blob&&(this.blob=function(){var t=h(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?h(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(d)}),this.text=function(){var t=h(this);if(t)return t;if(this._bodyBlob)return p(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(v(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},e.formData&&(this.formData=function(){return this.text().then(w)}),this.json=function(){return this.text().then(JSON.parse)},this}function m(t){var e=t.toUpperCase();return o.indexOf(e)>-1?e:t}function b(t,e){e=e||{};var n=e.body;if(t instanceof b){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new l(t.headers)),this.method=t.method,this.mode=t.mode,n||null==t._bodyInit||(n=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new l(e.headers)),this.method=m(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function w(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(i))}}),e}function _(t){var e=new l,n=t.replace(/\r?\n[\t ]+/g," ");return n.split(/\r?\n/).forEach(function(t){var n=t.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();e.append(r,i)}}),e}function k(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new l(e.headers),this.url=e.url||"",this._initBody(t)}})("undefined"!==typeof self?self:this)},"546e":function(t,e){t.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5.085 6.22L2.943 4.078a.75.75 0 1 1 1.06-1.06l2.592 2.59A11.094 11.094 0 0 1 10 5.068c4.738 0 8.578 3.101 8.578 5.083 0 1.197-1.401 2.803-3.555 3.887l1.714 1.713a.75.75 0 0 1-.09 1.138.488.488 0 0 1-.15.084.75.75 0 0 1-.821-.16L6.17 7.304c-.258.11-.51.233-.757.365l6.239 6.24-.006.005.78.78c-.388.094-.78.166-1.174.215l-1.11-1.11h.011L4.55 8.197a7.2 7.2 0 0 0-.665.514l-.112.098 4.897 4.897-.005.006 1.276 1.276a10.164 10.164 0 0 1-1.477-.117l-.479-.479-.009.009-4.863-4.863-.022.031a2.563 2.563 0 0 0-.124.2c-.043.077-.08.158-.108.241a.534.534 0 0 0-.028.133.29.29 0 0 0 .008.072.927.927 0 0 0 .082.226c.067.133.145.26.234.379l3.242 3.365.025.01.59.623c-3.265-.918-5.59-3.155-5.59-4.668 0-1.194 1.448-2.838 3.663-3.93zm7.07.531a4.632 4.632 0 0 1 1.108 5.992l.345.344.046-.018a9.313 9.313 0 0 0 2-1.112c.256-.187.5-.392.727-.613.137-.134.27-.277.392-.431.072-.091.141-.185.203-.286.057-.093.107-.19.148-.292a.72.72 0 0 0 .036-.12.29.29 0 0 0 .008-.072.492.492 0 0 0-.028-.133.999.999 0 0 0-.036-.096 2.165 2.165 0 0 0-.071-.145 2.917 2.917 0 0 0-.125-.2 3.592 3.592 0 0 0-.263-.335 5.444 5.444 0 0 0-.53-.523 7.955 7.955 0 0 0-1.054-.768 9.766 9.766 0 0 0-1.879-.891c-.337-.118-.68-.219-1.027-.301zm-2.85.21l-.069.002a.508.508 0 0 0-.254.097.496.496 0 0 0-.104.679.498.498 0 0 0 .326.199l.045.005c.091.003.181.003.272.012a2.45 2.45 0 0 1 2.017 1.513c.024.061.043.125.069.185a.494.494 0 0 0 .45.287h.008a.496.496 0 0 0 .35-.158.482.482 0 0 0 .13-.335.638.638 0 0 0-.048-.219 3.379 3.379 0 0 0-.36-.723 3.438 3.438 0 0 0-2.791-1.543l-.028-.001h-.013z"/></svg>'},"549b":function(t,e,n){"use strict";var r=n("d864"),i=n("63b6"),o=n("241e"),a=n("b0dc"),s=n("3702"),u=n("b447"),c=n("20fd"),l=n("7cd6");i(i.S+i.F*!n("4ee1")(function(t){Array.from(t)}),"Array",{from:function(t){var e,n,i,h,f=o(t),d="function"==typeof this?this:Array,p=arguments.length,v=p>1?arguments[1]:void 0,y=void 0!==v,g=0,m=l(f);if(y&&(v=r(v,p>2?arguments[2]:void 0,2)),void 0==m||d==Array&&s(m))for(e=u(f.length),n=new d(e);e>g;g++)c(n,g,y?v(f[g],g):f[g]);else for(h=m.call(f),n=new d;!(i=h.next()).done;g++)c(n,g,y?a(h,v,[i.value,g],!0):i.value);return n.length=g,n}})},"54a1":function(t,e,n){n("6c1c"),n("1654"),t.exports=n("95d5")},"55dd":function(t,e,n){"use strict";var r=n("5ca1"),i=n("d8e8"),o=n("4bf8"),a=n("79e5"),s=[].sort,u=[1,2,3];r(r.P+r.F*(a(function(){u.sort(void 0)})||!a(function(){u.sort(null)})||!n("2f21")(s)),"Array",{sort:function(t){return void 0===t?s.call(o(this)):s.call(o(this),i(t))}})},"57b1":function(t,e,n){var r=n("d864"),i=n("335c"),o=n("241e"),a=n("b447"),s=n("bfac");t.exports=function(t,e){var n=1==t,u=2==t,c=3==t,l=4==t,h=6==t,f=5==t||h,d=e||s;return function(e,s,p){for(var v,y,g=o(e),m=i(g),b=r(s,p,3),w=a(m.length),_=0,k=n?d(e,w):u?d(e,0):void 0;w>_;_++)if((f||_ in m)&&(v=m[_],y=b(v,_,g),t))if(n)k[_]=y;else if(y)switch(t){case 3:return!0;case 5:return v;case 6:return _;case 2:k.push(v)}else if(l)return!1;return h?-1:c||l?l:k}}},"57e3":function(t,e,n){n("68f7")("Set")},"58e0":function(t,e,n){"use strict";(function(t){var r=n("26ee"),i=n("2f74"),o="object"==typeof exports&&exports&&!exports.nodeType&&exports,a=o&&"object"==typeof t&&t&&!t.nodeType&&t,s=a&&a.exports===o,u=s?r["a"].Buffer:void 0,c=u?u.isBuffer:void 0,l=c||i["a"];e["a"]=l}).call(this,n("dd40")(t))},"5a79":function(t,e,n){n("7075")("WeakSet")},"5aee":function(t,e,n){"use strict";var r=n("d9f6").f,i=n("a159"),o=n("5c95"),a=n("d864"),s=n("1173"),u=n("a22a"),c=n("30f1"),l=n("50ed"),h=n("4c95"),f=n("8e60"),d=n("ebfd").fastKey,p=n("9f79"),v=f?"_s":"size",y=function(t,e){var n,r=d(e);if("F"!==r)return t._i[r];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,c){var l=t(function(t,r){s(t,l,e,"_i"),t._t=e,t._i=i(null),t._f=void 0,t._l=void 0,t[v]=0,void 0!=r&&u(r,n,t[c],t)});return o(l.prototype,{clear:function(){for(var t=p(this,e),n=t._i,r=t._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];t._f=t._l=void 0,t[v]=0},delete:function(t){var n=p(this,e),r=y(n,t);if(r){var i=r.n,o=r.p;delete n._i[r.i],r.r=!0,o&&(o.n=i),i&&(i.p=o),n._f==r&&(n._f=i),n._l==r&&(n._l=o),n[v]--}return!!r},forEach:function(t){p(this,e);var n,r=a(t,arguments.length>1?arguments[1]:void 0,3);while(n=n?n.n:this._f){r(n.v,n.k,this);while(n&&n.r)n=n.p}},has:function(t){return!!y(p(this,e),t)}}),f&&r(l.prototype,"size",{get:function(){return p(this,e)[v]}}),l},def:function(t,e,n){var r,i,o=y(t,e);return o?o.v=n:(t._l=o={i:i=d(e,!0),k:e,v:n,p:r=t._l,n:void 0,r:!1},t._f||(t._f=o),r&&(r.n=o),t[v]++,"F"!==i&&(t._i[i]=o)),t},getEntry:y,setStrong:function(t,e,n){c(t,e,function(t,n){this._t=p(t,e),this._k=n,this._l=void 0},function(){var t=this,e=t._k,n=t._l;while(n&&n.r)n=n.p;return t._t&&(t._l=n=n?n.n:t._t._f)?l(0,"keys"==e?n.k:"values"==e?n.v:[n.k,n.v]):(t._t=void 0,l(1))},n?"entries":"values",!n,!0),h(e)}}},"5c95":function(t,e,n){var r=n("35e8");t.exports=function(t,e,n){for(var i in e)n&&t[i]?t[i]=e[i]:r(t,i,e[i]);return t}},"5cb6":function(t,e,n){var r=n("63b6");r(r.P+r.R,"Map",{toJSON:n("f228")("Map")})},"5d6b":function(t,e,n){var r=n("e53d").parseInt,i=n("a1ce").trim,o=n("e692"),a=/^[-+]?0[xX]/;t.exports=8!==r(o+"08")||22!==r(o+"0x16")?function(t,e){var n=i(String(t),3);return r(n,e>>>0||(a.test(n)?16:10))}:r},"5d73":function(t,e,n){t.exports=n("469f")},"5dbc":function(t,e,n){var r=n("d3f4"),i=n("8b97").set;t.exports=function(t,e,n){var o,a=e.constructor;return a!==n&&"function"==typeof a&&(o=a.prototype)!==n.prototype&&r(o)&&i&&i(t,o),t}},"5df3":function(t,e,n){"use strict";var r=n("02f4")(!0);n("01f9")(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})})},"5ea3":function(t,e,n){"use strict";(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e["a"]=n}).call(this,n("c8ba"))},"5f1b":function(t,e,n){"use strict";var r=n("23c6"),i=RegExp.prototype.exec;t.exports=function(t,e){var n=t.exec;if("function"===typeof n){var o=n.call(t,e);if("object"!==typeof o)throw new TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==r(t))throw new TypeError("RegExp#exec called on incompatible receiver");return i.call(t,e)}},"5f69":function(t,e,n){},6134:function(t,e,n){},"656e":function(t,e,n){"use strict";var r=n("79aa");function i(t){var e,n;this.promise=new t(function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r}),this.resolve=r(e),this.reject=r(n)}t.exports.f=function(t){return new i(t)}},"660d":function(t,e){t.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 4.5V3h16v1.5zm2.5 3V12h11V7.5h-11zM4.061 6H15.94c.586 0 1.061.407 1.061.91v5.68c0 .503-.475.91-1.061.91H4.06c-.585 0-1.06-.407-1.06-.91V6.91C3 6.406 3.475 6 4.061 6zM2 16.5V15h16v1.5z"/></svg>'},6649:function(t,e,n){},6762:function(t,e,n){"use strict";var r=n("5ca1"),i=n("c366")(!0);r(r.P,"Array",{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")("includes")},"68f7":function(t,e,n){"use strict";var r=n("63b6"),i=n("79aa"),o=n("d864"),a=n("a22a");t.exports=function(t){r(r.S,t,{from:function(t){var e,n,r,s,u=arguments[1];return i(this),e=void 0!==u,e&&i(u),void 0==t?new this:(n=[],e?(r=0,s=o(u,arguments[2],2),a(t,!1,function(t){n.push(s(t,r++))})):a(t,!1,n.push,n),new this(n))}})}},"696e":function(t,e,n){n("c207"),n("1654"),n("6c1c"),n("24c5"),n("3c11"),n("43fc"),t.exports=n("584a").Promise},"6b54":function(t,e,n){"use strict";n("3846");var r=n("cb7c"),i=n("0bfb"),o=n("9e1e"),a="toString",s=/./[a],u=function(t){n("2aba")(RegExp.prototype,a,t,!0)};n("79e5")(function(){return"/a/b"!=s.call({source:"a",flags:"b"})})?u(function(){var t=r(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?i.call(t):void 0)}):s.name!=a&&u(function(){return s.call(this)})},"700e":function(t,e){t.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 0v1H1v3H0V.5A.5.5 0 0 1 .5 0H4zm8 0h3.5a.5.5 0 0 1 .5.5V4h-1V1h-3V0zM4 16H.5a.5.5 0 0 1-.5-.5V12h1v3h3v1zm8 0v-1h3v-3h1v3.5a.5.5 0 0 1-.5.5H12z"/><path fill-opacity=".256" d="M1 1h14v14H1z"/><g class="ck-icon__selected-indicator"><path d="M7 0h2v1H7V0zM0 7h1v2H0V7zm15 0h1v2h-1V7zm-8 8h2v1H7v-1z"/><path fill-opacity=".254" d="M1 1h14v14H1z"/></g></svg>'},7075:function(t,e,n){"use strict";var r=n("63b6");t.exports=function(t){r(r.S,t,{of:function(){var t=arguments.length,e=new Array(t);while(t--)e[t]=arguments[t];return new this(e)}})}},7201:function(t,e,n){},"733c":function(t,e,n){var r=n("63b6"),i=n("a159"),o=n("79aa"),a=n("e4ae"),s=n("f772"),u=n("294c"),c=n("c189"),l=(n("e53d").Reflect||{}).construct,h=u(function(){function t(){}return!(l(function(){},[],t)instanceof t)}),f=!u(function(){l(function(){})});r(r.S+r.F*(h||f),"Reflect",{construct:function(t,e){o(t),a(e);var n=arguments.length<3?t:o(arguments[2]);if(f&&!h)return l(t,e,n);if(t==n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var r=[null];return r.push.apply(r,e),new(c.apply(t,r))}var u=n.prototype,d=i(s(u)?u:Object.prototype),p=Function.apply.call(t,d,e);return s(p)?p:d}})},7445:function(t,e,n){var r=n("63b6"),i=n("5d6b");r(r.G+r.F*(parseInt!=i),{parseInt:i})},"74be":function(t,e,n){var r=n("63b6");r(r.P+r.R,"Set",{toJSON:n("f228")("Set")})},"74fe":function(t,e,n){},7514:function(t,e,n){"use strict";var r=n("5ca1"),i=n("0a49")(5),o="find",a=!0;o in[]&&Array(1)[o](function(){a=!1}),r(r.P+r.F*a,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")(o)},7554:function(t,e,n){n("68f7")("Map")},"774e":function(t,e,n){t.exports=n("d2d5")},"77bd":function(t,e){t.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.077 15l.991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184z"/></svg>'},"782c":function(t,e,n){n("68f7")("WeakSet")},"795b":function(t,e,n){t.exports=n("696e")},"7bc7":function(t,e,n){},"7cd6":function(t,e,n){var r=n("40c3"),i=n("5168")("iterator"),o=n("481b");t.exports=n("584a").getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[r(t)]}},"7d7b":function(t,e,n){var r=n("e4ae"),i=n("7cd6");t.exports=n("584a").getIterator=function(t){var e=i(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return r(e.call(t))}},"7def":function(t,e,n){},"7eec":function(t,e){t.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0C1 4.784 1.777 4 2.75 4c.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75C1.784 7.5 1 6.723 1 5.75zm6 9c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0c0-.966.777-1.75 1.75-1.75.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75-.966 0-1.75-.777-1.75-1.75z"/></svg>'},"7f7f":function(t,e,n){var r=n("86cc").f,i=Function.prototype,o=/^\s*function ([^ (]*)/,a="name";a in i||n("9e1e")&&r(i,a,{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(t){return""}}})},8030:function(t,e,n){},8071:function(t,e,n){"use strict";n.r(e);var r=n("cd51"),i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function o(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};function s(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})}function u(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return u([t,e])}}function u(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}var c=n("c23d"),l=n.n(c);n.d(e,"registerMessaging",function(){return z}),n.d(e,"isSupported",function(){return G});var h,f,d,p={AVAILABLE_IN_WINDOW:"only-available-in-window",AVAILABLE_IN_SW:"only-available-in-sw",SHOULD_BE_INHERITED:"should-be-overriden",BAD_SENDER_ID:"bad-sender-id",INCORRECT_GCM_SENDER_ID:"incorrect-gcm-sender-id",PERMISSION_DEFAULT:"permission-default",PERMISSION_BLOCKED:"permission-blocked",UNSUPPORTED_BROWSER:"unsupported-browser",NOTIFICATIONS_BLOCKED:"notifications-blocked",FAILED_DEFAULT_REGISTRATION:"failed-serviceworker-registration",SW_REGISTRATION_EXPECTED:"sw-registration-expected",GET_SUBSCRIPTION_FAILED:"get-subscription-failed",INVALID_SAVED_TOKEN:"invalid-saved-token",SW_REG_REDUNDANT:"sw-reg-redundant",TOKEN_SUBSCRIBE_FAILED:"token-subscribe-failed",TOKEN_SUBSCRIBE_NO_TOKEN:"token-subscribe-no-token",TOKEN_SUBSCRIBE_NO_PUSH_SET:"token-subscribe-no-push-set",TOKEN_UNSUBSCRIBE_FAILED:"token-unsubscribe-failed",TOKEN_UPDATE_FAILED:"token-update-failed",TOKEN_UPDATE_NO_TOKEN:"token-update-no-token",USE_SW_BEFORE_GET_TOKEN:"use-sw-before-get-token",INVALID_DELETE_TOKEN:"invalid-delete-token",DELETE_TOKEN_NOT_FOUND:"delete-token-not-found",DELETE_SCOPE_NOT_FOUND:"delete-scope-not-found",BG_HANDLER_FUNCTION_EXPECTED:"bg-handler-function-expected",NO_WINDOW_CLIENT_TO_MSG:"no-window-client-to-msg",UNABLE_TO_RESUBSCRIBE:"unable-to-resubscribe",NO_FCM_TOKEN_FOR_RESUBSCRIBE:"no-fcm-token-for-resubscribe",FAILED_TO_DELETE_TOKEN:"failed-to-delete-token",NO_SW_IN_REG:"no-sw-in-reg",BAD_SCOPE:"bad-scope",BAD_VAPID_KEY:"bad-vapid-key",BAD_SUBSCRIPTION:"bad-subscription",BAD_TOKEN:"bad-token",BAD_PUSH_SET:"bad-push-set",FAILED_DELETE_VAPID_KEY:"failed-delete-vapid-key",INVALID_PUBLIC_VAPID_KEY:"invalid-public-vapid-key",USE_PUBLIC_KEY_BEFORE_GET_TOKEN:"use-public-key-before-get-token",PUBLIC_KEY_DECRYPTION_FAILED:"public-vapid-key-decryption-failed"},v=(h={},h[p.AVAILABLE_IN_WINDOW]="This method is available in a Window context.",h[p.AVAILABLE_IN_SW]="This method is available in a service worker context.",h[p.SHOULD_BE_INHERITED]="This method should be overriden by extended classes.",h[p.BAD_SENDER_ID]="Please ensure that 'messagingSenderId' is set correctly in the options passed into firebase.initializeApp().",h[p.PERMISSION_DEFAULT]="The required permissions were not granted and dismissed instead.",h[p.PERMISSION_BLOCKED]="The required permissions were not granted and blocked instead.",h[p.UNSUPPORTED_BROWSER]="This browser doesn't support the API's required to use the firebase SDK.",h[p.NOTIFICATIONS_BLOCKED]="Notifications have been blocked.",h[p.FAILED_DEFAULT_REGISTRATION]="We are unable to register the default service worker. {$browserErrorMessage}",h[p.SW_REGISTRATION_EXPECTED]="A service worker registration was the expected input.",h[p.GET_SUBSCRIPTION_FAILED]="There was an error when trying to get any existing Push Subscriptions.",h[p.INVALID_SAVED_TOKEN]="Unable to access details of the saved token.",h[p.SW_REG_REDUNDANT]="The service worker being used for push was made redundant.",h[p.TOKEN_SUBSCRIBE_FAILED]="A problem occured while subscribing the user to FCM: {$message}",h[p.TOKEN_SUBSCRIBE_NO_TOKEN]="FCM returned no token when subscribing the user to push.",h[p.TOKEN_SUBSCRIBE_NO_PUSH_SET]="FCM returned an invalid response when getting an FCM token.",h[p.TOKEN_UNSUBSCRIBE_FAILED]="A problem occured while unsubscribing the user from FCM: {$message}",h[p.TOKEN_UPDATE_FAILED]="A problem occured while updating the user from FCM: {$message}",h[p.TOKEN_UPDATE_NO_TOKEN]="FCM returned no token when updating the user to push.",h[p.USE_SW_BEFORE_GET_TOKEN]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",h[p.INVALID_DELETE_TOKEN]="You must pass a valid token into deleteToken(), i.e. the token from getToken().",h[p.DELETE_TOKEN_NOT_FOUND]="The deletion attempt for token could not be performed as the token was not found.",h[p.DELETE_SCOPE_NOT_FOUND]="The deletion attempt for service worker scope could not be performed as the scope was not found.",h[p.BG_HANDLER_FUNCTION_EXPECTED]="The input to setBackgroundMessageHandler() must be a function.",h[p.NO_WINDOW_CLIENT_TO_MSG]="An attempt was made to message a non-existant window client.",h[p.UNABLE_TO_RESUBSCRIBE]="There was an error while re-subscribing the FCM token for push messaging. Will have to resubscribe the user on next visit. {$message}",h[p.NO_FCM_TOKEN_FOR_RESUBSCRIBE]="Could not find an FCM token and as a result, unable to resubscribe. Will have to resubscribe the user on next visit.",h[p.FAILED_TO_DELETE_TOKEN]="Unable to delete the currently saved token.",h[p.NO_SW_IN_REG]="Even though the service worker registration was successful, there was a problem accessing the service worker itself.",h[p.INCORRECT_GCM_SENDER_ID]="Please change your web app manifest's 'gcm_sender_id' value to '103953800507' to use Firebase messaging.",h[p.BAD_SCOPE]="The service worker scope must be a string with at least one character.",h[p.BAD_VAPID_KEY]="The public VAPID key is not a Uint8Array with 65 bytes.",h[p.BAD_SUBSCRIPTION]="The subscription must be a valid PushSubscription.",h[p.BAD_TOKEN]="The FCM Token used for storage / lookup was not a valid token string.",h[p.BAD_PUSH_SET]="The FCM push set used for storage / lookup was not not a valid push set string.",h[p.FAILED_DELETE_VAPID_KEY]="The VAPID key could not be deleted.",h[p.INVALID_PUBLIC_VAPID_KEY]="The public VAPID key must be a string.",h[p.PUBLIC_KEY_DECRYPTION_FAILED]="The public VAPID key did not equal 65 bytes when decrypted.",h),y=new r["ErrorFactory"]("messaging","Messaging",v),g=new Uint8Array([4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110]),m="https://fcm.googleapis.com";function b(t,e){if(null==t||null==e)return!1;if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(var n=new DataView(t),r=new DataView(e),i=0;i<t.byteLength;i++)if(n.getUint8(i)!==r.getUint8(i))return!1;return!0}function w(t){var e=new Uint8Array(t);return btoa(String.fromCharCode.apply(null,e))}function _(t){var e=w(t);return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}(function(t){t["TYPE_OF_MSG"]="firebase-messaging-msg-type",t["DATA"]="firebase-messaging-msg-data"})(f||(f={})),function(t){t["PUSH_MSG_RECEIVED"]="push-msg-received",t["NOTIFICATION_CLICKED"]="notification-clicked"}(d||(d={}));var k=function(){function t(){}return t.prototype.getToken=function(t,e,n){return s(this,void 0,void 0,function(){var r,i,o,a,s,c,l,h,f;return u(this,function(u){switch(u.label){case 0:r=_(e.getKey("p256dh")),i=_(e.getKey("auth")),o="authorized_entity="+t+"&endpoint="+e.endpoint+"&encryption_key="+r+"&encryption_auth="+i,b(n.buffer,g.buffer)||(a=_(n),o+="&application_pub_key="+a),s=new Headers,s.append("Content-Type","application/x-www-form-urlencoded"),c={method:"POST",headers:s,body:o},u.label=1;case 1:return u.trys.push([1,4,,5]),[4,fetch(m+"/fcm/connect/subscribe",c)];case 2:return h=u.sent(),[4,h.json()];case 3:return l=u.sent(),[3,5];case 4:throw u.sent(),y.create(p.TOKEN_SUBSCRIBE_FAILED);case 5:if(l.error)throw f=l.error.message,y.create(p.TOKEN_SUBSCRIBE_FAILED,{message:f});if(!l.token)throw y.create(p.TOKEN_SUBSCRIBE_NO_TOKEN);if(!l.pushSet)throw y.create(p.TOKEN_SUBSCRIBE_NO_PUSH_SET);return[2,{token:l.token,pushSet:l.pushSet}]}})})},t.prototype.updateToken=function(t,e,n,r,i){return s(this,void 0,void 0,function(){var o,a,s,c,l,h,f,d,v;return u(this,function(u){switch(u.label){case 0:o=_(r.getKey("p256dh")),a=_(r.getKey("auth")),s="push_set="+n+"&token="+e+"&authorized_entity="+t+"&endpoint="+r.endpoint+"&encryption_key="+o+"&encryption_auth="+a,b(i.buffer,g.buffer)||(c=_(i),s+="&application_pub_key="+c),l=new Headers,l.append("Content-Type","application/x-www-form-urlencoded"),h={method:"POST",headers:l,body:s},u.label=1;case 1:return u.trys.push([1,4,,5]),[4,fetch(m+"/fcm/connect/subscribe",h)];case 2:return d=u.sent(),[4,d.json()];case 3:return f=u.sent(),[3,5];case 4:throw u.sent(),y.create(p.TOKEN_UPDATE_FAILED);case 5:if(f.error)throw v=f.error.message,y.create(p.TOKEN_UPDATE_FAILED,{message:v});if(!f.token)throw y.create(p.TOKEN_UPDATE_NO_TOKEN);return[2,f.token]}})})},t.prototype.deleteToken=function(t,e,n){return s(this,void 0,void 0,function(){var r,i,o,a,s,c;return u(this,function(u){switch(u.label){case 0:r="authorized_entity="+t+"&token="+e+"&pushSet="+n,i=new Headers,i.append("Content-Type","application/x-www-form-urlencoded"),o={method:"POST",headers:i,body:r},u.label=1;case 1:return u.trys.push([1,4,,5]),[4,fetch(m+"/fcm/connect/unsubscribe",o)];case 2:return a=u.sent(),[4,a.json()];case 3:if(s=u.sent(),s.error)throw c=s.error.message,y.create(p.TOKEN_UNSUBSCRIBE_FAILED,{message:c});return[3,5];case 4:throw u.sent(),y.create(p.TOKEN_UNSUBSCRIBE_FAILED);case 5:return[2]}})})},t}();function E(t){for(var e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(n),i=new Uint8Array(r.length),o=0;o<r.length;++o)i[o]=r.charCodeAt(o);return i}var T="undefined",S="fcm_token_object_Store";function C(t){if(t.objectStoreNames.contains(S)){var e=t.transaction(S),n=e.objectStore(S),r=new k,i=n.openCursor();i.onerror=function(t){console.warn("Unable to cleanup old IDB.",t)},i.onsuccess=function(){var e=i.result;if(e){var n=e.value;r.deleteToken(n.fcmSenderId,n.fcmToken,n.fcmPushSet),e.continue()}else t.close(),indexedDB.deleteDatabase(T)}}}function O(){var t=indexedDB.open(T);t.onerror=function(t){},t.onsuccess=function(e){var n=t.result;C(n)}}var A=function(){function t(){this.dbPromise=null}return t.prototype.get=function(t){return this.createTransaction(function(e){return e.get(t)})},t.prototype.getIndex=function(t,e){function n(n){var r=n.index(t);return r.get(e)}return this.createTransaction(n)},t.prototype.put=function(t){return this.createTransaction(function(e){return e.put(t)},"readwrite")},t.prototype.delete=function(t){return this.createTransaction(function(e){return e.delete(t)},"readwrite")},t.prototype.closeDatabase=function(){return s(this,void 0,void 0,function(){var t;return u(this,function(e){switch(e.label){case 0:return this.dbPromise?[4,this.dbPromise]:[3,2];case 1:t=e.sent(),t.close(),this.dbPromise=null,e.label=2;case 2:return[2]}})})},t.prototype.createTransaction=function(t,e){return void 0===e&&(e="readonly"),s(this,void 0,void 0,function(){var n,r,i,o;return u(this,function(a){switch(a.label){case 0:return[4,this.getDb()];case 1:return n=a.sent(),r=n.transaction(this.objectStoreName,e),i=r.objectStore(this.objectStoreName),[4,I(t(i))];case 2:return o=a.sent(),[2,new Promise(function(t,e){r.oncomplete=function(){t(o)},r.onerror=function(){e(r.error)}})]}})})},t.prototype.getDb=function(){var t=this;return this.dbPromise||(this.dbPromise=new Promise(function(e,n){var r=indexedDB.open(t.dbName,t.dbVersion);r.onsuccess=function(){e(r.result)},r.onerror=function(){t.dbPromise=null,n(r.error)},r.onupgradeneeded=function(e){return t.onDbUpgrade(r,e)}})),this.dbPromise},t}();function I(t){return new Promise(function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}})}var x=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dbName="fcm_token_details_db",e.dbVersion=3,e.objectStoreName="fcm_token_object_Store",e}return o(e,t),e.prototype.onDbUpgrade=function(t,e){var n=t.result;switch(e.oldVersion){case 0:var r=n.createObjectStore(this.objectStoreName,{keyPath:"swScope"});r.createIndex("fcmSenderId","fcmSenderId",{unique:!1}),r.createIndex("fcmToken","fcmToken",{unique:!0});case 1:O();case 2:r=t.transaction.objectStore(this.objectStoreName);var i=r.openCursor();i.onsuccess=function(){var t=i.result;if(t){var e=t.value,n=a({},e);e.createTime||(n.createTime=Date.now()),"string"===typeof e.vapidKey&&(n.vapidKey=E(e.vapidKey)),"string"===typeof e.auth&&(n.auth=E(e.auth).buffer),"string"===typeof e.auth&&(n.p256dh=E(e.p256dh).buffer),t.update(n),t.continue()}}}},e.prototype.getTokenDetailsFromToken=function(t){return s(this,void 0,void 0,function(){return u(this,function(e){if(!t)throw y.create(p.BAD_TOKEN);return P({fcmToken:t}),[2,this.getIndex("fcmToken",t)]})})},e.prototype.getTokenDetailsFromSWScope=function(t){return s(this,void 0,void 0,function(){return u(this,function(e){if(!t)throw y.create(p.BAD_SCOPE);return P({swScope:t}),[2,this.get(t)]})})},e.prototype.saveTokenDetails=function(t){return s(this,void 0,void 0,function(){return u(this,function(e){if(!t.swScope)throw y.create(p.BAD_SCOPE);if(!t.vapidKey)throw y.create(p.BAD_VAPID_KEY);if(!t.endpoint||!t.auth||!t.p256dh)throw y.create(p.BAD_SUBSCRIPTION);if(!t.fcmSenderId)throw y.create(p.BAD_SENDER_ID);if(!t.fcmToken)throw y.create(p.BAD_TOKEN);if(!t.fcmPushSet)throw y.create(p.BAD_PUSH_SET);return P(t),[2,this.put(t)]})})},e.prototype.deleteToken=function(t){return s(this,void 0,void 0,function(){var e;return u(this,function(n){switch(n.label){case 0:return"string"!==typeof t||0===t.length?[2,Promise.reject(y.create(p.INVALID_DELETE_TOKEN))]:[4,this.getTokenDetailsFromToken(t)];case 1:if(e=n.sent(),!e)throw y.create(p.DELETE_TOKEN_NOT_FOUND);return[4,this.delete(e.swScope)];case 2:return n.sent(),[2,e]}})})},e}(A);function P(t){if(t.fcmToken&&("string"!==typeof t.fcmToken||0===t.fcmToken.length))throw y.create(p.BAD_TOKEN);if(t.swScope&&("string"!==typeof t.swScope||0===t.swScope.length))throw y.create(p.BAD_SCOPE);if(t.vapidKey&&(!(t.vapidKey instanceof Uint8Array)||65!==t.vapidKey.length))throw y.create(p.BAD_VAPID_KEY);if(t.endpoint&&("string"!==typeof t.endpoint||0===t.endpoint.length))throw y.create(p.BAD_SUBSCRIPTION);if(t.auth&&!(t.auth instanceof ArrayBuffer))throw y.create(p.BAD_SUBSCRIPTION);if(t.p256dh&&!(t.p256dh instanceof ArrayBuffer))throw y.create(p.BAD_SUBSCRIPTION);if(t.fcmSenderId&&("string"!==typeof t.fcmSenderId||0===t.fcmSenderId.length))throw y.create(p.BAD_SENDER_ID);if(t.fcmPushSet&&("string"!==typeof t.fcmPushSet||0===t.fcmPushSet.length))throw y.create(p.BAD_PUSH_SET)}var N=65,R=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dbName="fcm_vapid_details_db",e.dbVersion=1,e.objectStoreName="fcm_vapid_object_Store",e}return o(e,t),e.prototype.onDbUpgrade=function(t){var e=t.result;e.createObjectStore(this.objectStoreName,{keyPath:"swScope"})},e.prototype.getVapidFromSWScope=function(t){return s(this,void 0,void 0,function(){var e;return u(this,function(n){switch(n.label){case 0:if("string"!==typeof t||0===t.length)throw y.create(p.BAD_SCOPE);return[4,this.get(t)];case 1:return e=n.sent(),[2,e?e.vapidKey:void 0]}})})},e.prototype.saveVapidDetails=function(t,e){return s(this,void 0,void 0,function(){var n;return u(this,function(r){if("string"!==typeof t||0===t.length)throw y.create(p.BAD_SCOPE);if(null===e||e.length!==N)throw y.create(p.BAD_VAPID_KEY);return n={swScope:t,vapidKey:e},[2,this.put(n)]})})},e.prototype.deleteVapidDetails=function(t){return s(this,void 0,void 0,function(){var e;return u(this,function(n){switch(n.label){case 0:return[4,this.getVapidFromSWScope(t)];case 1:if(e=n.sent(),!e)throw y.create(p.DELETE_SCOPE_NOT_FOUND);return[4,this.delete(t)];case 2:return n.sent(),[2,e]}})})},e}(A),D="messagingSenderId",j=6048e5,M=function(){function t(t){var e=this;if(!t.options[D]||"string"!==typeof t.options[D])throw y.create(p.BAD_SENDER_ID);this.messagingSenderId=t.options[D],this.tokenDetailsModel=new x,this.vapidDetailsModel=new R,this.iidModel=new k,this.app=t,this.INTERNAL={delete:function(){return e.delete()}}}return t.prototype.getToken=function(){return s(this,void 0,void 0,function(){var t,e,n,r,i;return u(this,function(o){switch(o.label){case 0:if(t=this.getNotificationPermission_(),"denied"===t)throw y.create(p.NOTIFICATIONS_BLOCKED);return"granted"!==t?[2,null]:[4,this.getSWRegistration_()];case 1:return e=o.sent(),[4,this.getPublicVapidKey_()];case 2:return n=o.sent(),[4,this.getPushSubscription(e,n)];case 3:return r=o.sent(),[4,this.tokenDetailsModel.getTokenDetailsFromSWScope(e.scope)];case 4:return i=o.sent(),i?[2,this.manageExistingToken(e,r,n,i)]:[2,this.getNewToken(e,r,n)]}})})},t.prototype.manageExistingToken=function(t,e,n,r){return s(this,void 0,void 0,function(){var i,o;return u(this,function(a){switch(a.label){case 0:return i=L(e,n,r),i?(o=Date.now(),o<r.createTime+j?[2,r.fcmToken]:[2,this.updateToken(t,e,n,r)]):[4,this.deleteTokenFromDB(r.fcmToken)];case 1:return a.sent(),[2,this.getNewToken(t,e,n)]}})})},t.prototype.updateToken=function(t,e,n,r){return s(this,void 0,void 0,function(){var i,o,a;return u(this,function(s){switch(s.label){case 0:return s.trys.push([0,4,,6]),[4,this.iidModel.updateToken(this.messagingSenderId,r.fcmToken,r.fcmPushSet,e,n)];case 1:return i=s.sent(),o={swScope:t.scope,vapidKey:n,fcmSenderId:this.messagingSenderId,fcmToken:i,fcmPushSet:r.fcmPushSet,createTime:Date.now(),endpoint:e.endpoint,auth:e.getKey("auth"),p256dh:e.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(o)];case 2:return s.sent(),[4,this.vapidDetailsModel.saveVapidDetails(t.scope,n)];case 3:return s.sent(),[2,i];case 4:return a=s.sent(),[4,this.deleteToken(r.fcmToken)];case 5:throw s.sent(),a;case 6:return[2]}})})},t.prototype.getNewToken=function(t,e,n){return s(this,void 0,void 0,function(){var r,i;return u(this,function(o){switch(o.label){case 0:return[4,this.iidModel.getToken(this.messagingSenderId,e,n)];case 1:return r=o.sent(),i={swScope:t.scope,vapidKey:n,fcmSenderId:this.messagingSenderId,fcmToken:r.token,fcmPushSet:r.pushSet,createTime:Date.now(),endpoint:e.endpoint,auth:e.getKey("auth"),p256dh:e.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(i)];case 2:return o.sent(),[4,this.vapidDetailsModel.saveVapidDetails(t.scope,n)];case 3:return o.sent(),[2,r.token]}})})},t.prototype.deleteToken=function(t){return s(this,void 0,void 0,function(){var e,n;return u(this,function(r){switch(r.label){case 0:return[4,this.deleteTokenFromDB(t)];case 1:return r.sent(),[4,this.getSWRegistration_()];case 2:return e=r.sent(),e?[4,e.pushManager.getSubscription()]:[3,4];case 3:if(n=r.sent(),n)return[2,n.unsubscribe()];r.label=4;case 4:return[2,!0]}})})},t.prototype.deleteTokenFromDB=function(t){return s(this,void 0,void 0,function(){var e;return u(this,function(n){switch(n.label){case 0:return[4,this.tokenDetailsModel.deleteToken(t)];case 1:return e=n.sent(),[4,this.iidModel.deleteToken(e.fcmSenderId,e.fcmToken,e.fcmPushSet)];case 2:return n.sent(),[2]}})})},t.prototype.getPushSubscription=function(t,e){return t.pushManager.getSubscription().then(function(n){return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:e})})},t.prototype.requestPermission=function(){throw y.create(p.AVAILABLE_IN_WINDOW)},t.prototype.useServiceWorker=function(t){throw y.create(p.AVAILABLE_IN_WINDOW)},t.prototype.usePublicVapidKey=function(t){throw y.create(p.AVAILABLE_IN_WINDOW)},t.prototype.onMessage=function(t,e,n){throw y.create(p.AVAILABLE_IN_WINDOW)},t.prototype.onTokenRefresh=function(t,e,n){throw y.create(p.AVAILABLE_IN_WINDOW)},t.prototype.setBackgroundMessageHandler=function(t){throw y.create(p.AVAILABLE_IN_SW)},t.prototype.delete=function(){return s(this,void 0,void 0,function(){return u(this,function(t){switch(t.label){case 0:return[4,Promise.all([this.tokenDetailsModel.closeDatabase(),this.vapidDetailsModel.closeDatabase()])];case 1:return t.sent(),[2]}})})},t.prototype.getNotificationPermission_=function(){return Notification.permission},t.prototype.getTokenDetailsModel=function(){return this.tokenDetailsModel},t.prototype.getVapidDetailsModel=function(){return this.vapidDetailsModel},t.prototype.getIidModel=function(){return this.iidModel},t}();function L(t,e,n){if(!n.vapidKey||!b(e.buffer,n.vapidKey.buffer))return!1;var r=t.endpoint===n.endpoint,i=b(t.getKey("auth"),n.auth),o=b(t.getKey("p256dh"),n.p256dh);return r&&i&&o}var F="FCM_MSG",V=function(t){function e(e){var n=t.call(this,e)||this;return n.bgMessageHandler=null,self.addEventListener("push",function(t){n.onPush(t)}),self.addEventListener("pushsubscriptionchange",function(t){n.onSubChange(t)}),self.addEventListener("notificationclick",function(t){n.onNotificationClick(t)}),n}return o(e,t),e.prototype.onPush=function(t){t.waitUntil(this.onPush_(t))},e.prototype.onSubChange=function(t){t.waitUntil(this.onSubChange_(t))},e.prototype.onNotificationClick=function(t){t.waitUntil(this.onNotificationClick_(t))},e.prototype.onPush_=function(t){return s(this,void 0,void 0,function(){var e,n,r,i,o,a,s;return u(this,function(u){switch(u.label){case 0:if(!t.data)return[2];try{e=t.data.json()}catch(c){return[2]}return[4,this.hasVisibleClients_()];case 1:return n=u.sent(),n?[2,this.sendMessageToWindowClients_(e)]:(r=this.getNotificationData_(e),r?(i=r.title||"",[4,this.getSWRegistration_()]):[3,3]);case 2:return o=u.sent(),a=r.actions,s=Notification.maxActions,a&&s&&a.length>s&&console.warn("This browser only supports "+s+" actions.The remaining actions will not be displayed."),[2,o.showNotification(i,r)];case 3:return this.bgMessageHandler?[4,this.bgMessageHandler(e)]:[3,5];case 4:return u.sent(),[2];case 5:return[2]}})})},e.prototype.onSubChange_=function(t){return s(this,void 0,void 0,function(){var t,e,n,r,i;return u(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.getSWRegistration_()];case 1:return t=o.sent(),[3,3];case 2:throw e=o.sent(),y.create(p.UNABLE_TO_RESUBSCRIBE,{message:e});case 3:return o.trys.push([3,5,,8]),[4,t.pushManager.getSubscription()];case 4:return o.sent(),[3,8];case 5:return n=o.sent(),r=this.getTokenDetailsModel(),[4,r.getTokenDetailsFromSWScope(t.scope)];case 6:if(i=o.sent(),!i)throw n;return[4,this.deleteToken(i.fcmToken)];case 7:throw o.sent(),n;case 8:return[2]}})})},e.prototype.onNotificationClick_=function(t){return s(this,void 0,void 0,function(){var e,n,r,i;return u(this,function(o){switch(o.label){case 0:return t.notification&&t.notification.data&&t.notification.data[F]?t.action?[2]:(t.stopImmediatePropagation(),t.notification.close(),e=t.notification.data[F],e.notification?(n=e.fcmOptions&&e.fcmOptions.link||e.notification.click_action,n?[4,this.getWindowClient_(n)]:[2]):[2]):[2];case 1:return r=o.sent(),r?[3,3]:[4,self.clients.openWindow(n)];case 2:return r=o.sent(),[3,5];case 3:return[4,r.focus()];case 4:r=o.sent(),o.label=5;case 5:return r?(delete e.notification,delete e.fcmOptions,i=U(d.NOTIFICATION_CLICKED,e),[2,this.attemptToMessageClient_(r,i)]):[2]}})})},e.prototype.getNotificationData_=function(t){if(t&&"object"===typeof t.notification){var e,n=a({},t.notification);return n.data=a({},t.notification.data,(e={},e[F]=t,e)),n}},e.prototype.setBackgroundMessageHandler=function(t){if(!t||"function"!==typeof t)throw y.create(p.BG_HANDLER_FUNCTION_EXPECTED);this.bgMessageHandler=t},e.prototype.getWindowClient_=function(t){return s(this,void 0,void 0,function(){var e,n,r,i,o;return u(this,function(a){switch(a.label){case 0:return e=new URL(t,self.location.href).href,[4,B()];case 1:for(n=a.sent(),r=null,i=0;i<n.length;i++)if(o=new URL(n[i].url,self.location.href).href,o===e){r=n[i];break}return[2,r]}})})},e.prototype.attemptToMessageClient_=function(t,e){return s(this,void 0,void 0,function(){return u(this,function(n){if(!t)throw y.create(p.NO_WINDOW_CLIENT_TO_MSG);return t.postMessage(e),[2]})})},e.prototype.hasVisibleClients_=function(){return s(this,void 0,void 0,function(){var t;return u(this,function(e){switch(e.label){case 0:return[4,B()];case 1:return t=e.sent(),[2,t.some(function(t){return"visible"===t.visibilityState})]}})})},e.prototype.sendMessageToWindowClients_=function(t){return s(this,void 0,void 0,function(){var e,n,r=this;return u(this,function(i){switch(i.label){case 0:return[4,B()];case 1:return e=i.sent(),n=U(d.PUSH_MSG_RECEIVED,t),[4,Promise.all(e.map(function(t){return r.attemptToMessageClient_(t,n)}))];case 2:return i.sent(),[2]}})})},e.prototype.getSWRegistration_=function(){return s(this,void 0,void 0,function(){return u(this,function(t){return[2,self.registration]})})},e.prototype.getPublicVapidKey_=function(){return s(this,void 0,void 0,function(){var t,e;return u(this,function(n){switch(n.label){case 0:return[4,this.getSWRegistration_()];case 1:if(t=n.sent(),!t)throw y.create(p.SW_REGISTRATION_EXPECTED);return[4,this.getVapidDetailsModel().getVapidFromSWScope(t.scope)];case 2:return e=n.sent(),null==e?[2,g]:[2,e]}})})},e}(M);function B(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function U(t,e){return n={},n[f.TYPE_OF_MSG]=t,n[f.DATA]=e,n;var n}var q="/firebase-messaging-sw.js",W="/firebase-cloud-messaging-push-scope",K=function(t){function e(e){var n=t.call(this,e)||this;return n.registrationToUse=null,n.publicVapidKeyToUse=null,n.manifestCheckPromise=null,n.messageObserver=null,n.tokenRefreshObserver=null,n.onMessageInternal=Object(r["createSubscribe"])(function(t){n.messageObserver=t}),n.onTokenRefreshInternal=Object(r["createSubscribe"])(function(t){n.tokenRefreshObserver=t}),n.setupSWMessageListener_(),n}return o(e,t),e.prototype.getToken=function(){return s(this,void 0,void 0,function(){return u(this,function(e){switch(e.label){case 0:return this.manifestCheckPromise||(this.manifestCheckPromise=H()),[4,this.manifestCheckPromise];case 1:return e.sent(),[2,t.prototype.getToken.call(this)]}})})},e.prototype.requestPermission=function(){return s(this,void 0,void 0,function(){var t;return u(this,function(e){switch(e.label){case 0:return"granted"===this.getNotificationPermission_()?[2]:[4,Notification.requestPermission()];case 1:if(t=e.sent(),"granted"===t)return[2];throw"denied"===t?y.create(p.PERMISSION_BLOCKED):y.create(p.PERMISSION_DEFAULT)}})})},e.prototype.useServiceWorker=function(t){if(!(t instanceof ServiceWorkerRegistration))throw y.create(p.SW_REGISTRATION_EXPECTED);if(null!=this.registrationToUse)throw y.create(p.USE_SW_BEFORE_GET_TOKEN);this.registrationToUse=t},e.prototype.usePublicVapidKey=function(t){if("string"!==typeof t)throw y.create(p.INVALID_PUBLIC_VAPID_KEY);if(null!=this.publicVapidKeyToUse)throw y.create(p.USE_PUBLIC_KEY_BEFORE_GET_TOKEN);var e=E(t);if(65!==e.length)throw y.create(p.PUBLIC_KEY_DECRYPTION_FAILED);this.publicVapidKeyToUse=e},e.prototype.onMessage=function(t,e,n){return"function"===typeof t?this.onMessageInternal(t,e,n):this.onMessageInternal(t)},e.prototype.onTokenRefresh=function(t,e,n){return"function"===typeof t?this.onTokenRefreshInternal(t,e,n):this.onTokenRefreshInternal(t)},e.prototype.waitForRegistrationToActivate_=function(t){var e=t.installing||t.waiting||t.active;return new Promise(function(n,r){if(e)if("activated"!==e.state)if("redundant"!==e.state){var i=function(){if("activated"===e.state)n(t);else{if("redundant"!==e.state)return;r(y.create(p.SW_REG_REDUNDANT))}e.removeEventListener("statechange",i)};e.addEventListener("statechange",i)}else r(y.create(p.SW_REG_REDUNDANT));else n(t);else r(y.create(p.NO_SW_IN_REG))})},e.prototype.getSWRegistration_=function(){var t=this;return this.registrationToUse?this.waitForRegistrationToActivate_(this.registrationToUse):(this.registrationToUse=null,navigator.serviceWorker.register(q,{scope:W}).catch(function(t){throw y.create(p.FAILED_DEFAULT_REGISTRATION,{browserErrorMessage:t.message})}).then(function(e){return t.waitForRegistrationToActivate_(e).then(function(){return t.registrationToUse=e,e.update(),e})}))},e.prototype.getPublicVapidKey_=function(){return s(this,void 0,void 0,function(){return u(this,function(t){return this.publicVapidKeyToUse?[2,this.publicVapidKeyToUse]:[2,g]})})},e.prototype.setupSWMessageListener_=function(){var t=this;navigator.serviceWorker.addEventListener("message",function(e){if(e.data&&e.data[f.TYPE_OF_MSG]){var n=e.data;switch(n[f.TYPE_OF_MSG]){case d.PUSH_MSG_RECEIVED:case d.NOTIFICATION_CLICKED:var r=n[f.DATA];t.messageObserver&&t.messageObserver.next(r);break;default:break}}},!1)},e}(M);function H(){return s(this,void 0,void 0,function(){var t,e,n;return u(this,function(r){switch(r.label){case 0:if(t=document.querySelector('link[rel="manifest"]'),!t)return[2];r.label=1;case 1:return r.trys.push([1,4,,5]),[4,fetch(t.href)];case 2:return n=r.sent(),[4,n.json()];case 3:return e=r.sent(),[3,5];case 4:return r.sent(),[2];case 5:if(!e||!e.gcm_sender_id)return[2];if("103953800507"!==e.gcm_sender_id)throw y.create(p.INCORRECT_GCM_SENDER_ID);return[2]}})})}function z(t){var e="messaging",n=function(t){if(!G())throw y.create(p.UNSUPPORTED_BROWSER);return self&&"ServiceWorkerGlobalScope"in self?new V(t):new K(t)},r={isSupported:G};t.INTERNAL.registerService(e,n,r)}function G(){return self&&"ServiceWorkerGlobalScope"in self?Y():Q()}function Q(){return navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function Y(){return"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}z(l.a)},"82b5":function(t,e){t.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>'},"837d":function(t,e,n){"use strict";var r=n("5aee"),i=n("9f79"),o="Map";t.exports=n("ada4")(o,function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=r.getEntry(i(this,o),t);return e&&e.v},set:function(t,e){return r.def(i(this,o),0===t?0:t,e)}},r,!0)},8449:function(t,e,n){"use strict";n("386b")("anchor",function(t){return function(e){return t(this,"a","name",e)}})},"85f2":function(t,e,n){t.exports=n("454f")},8708:function(t,e){t.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.187 17H5.773c-.637 0-1.092-.138-1.364-.415-.273-.277-.409-.718-.409-1.323V4.738c0-.617.14-1.062.419-1.332.279-.27.73-.406 1.354-.406h4.68c.69 0 1.288.041 1.793.124.506.083.96.242 1.36.478.341.197.644.447.906.75a3.262 3.262 0 0 1 .808 2.162c0 1.401-.722 2.426-2.167 3.075C15.05 10.175 16 11.315 16 13.01a3.756 3.756 0 0 1-2.296 3.504 6.1 6.1 0 0 1-1.517.377c-.571.073-1.238.11-2 .11zm-.217-6.217H7v4.087h3.069c1.977 0 2.965-.69 2.965-2.072 0-.707-.256-1.22-.768-1.537-.512-.319-1.277-.478-2.296-.478zM7 5.13v3.619h2.606c.729 0 1.292-.067 1.69-.2a1.6 1.6 0 0 0 .91-.765c.165-.267.247-.566.247-.897 0-.707-.26-1.176-.778-1.409-.519-.232-1.31-.348-2.375-.348H7z"/></svg>'},"8a8f":function(t,e,n){"use strict";var r=n("7bc7"),i=n.n(r);i.a},"8aa5":function(t,e,n){"use strict";function r(t){return t&&"object"===typeof t&&"default"in t?t["default"]:t}n("95c6");var i=r(n("c23d"));n("b7aa"),n("3523"),n("e89a"),n("001a"),n("8071"),n("2e66"),console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the module builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nCommonJS Modules:\nconst firebase = require('firebase/app');\nrequire('firebase/<PACKAGE>');\n\nES Modules:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n\nTypescript:\nimport * as firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n"),t.exports=i},"8aae":function(t,e,n){n("32a6"),t.exports=n("584a").Object.keys},"8b56":function(t,e,n){},"8b97":function(t,e,n){var r=n("d3f4"),i=n("cb7c"),o=function(t,e){if(i(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{r=n("9b43")(Function.call,n("11e9").f(Object.prototype,"__proto__").set,2),r(t,[]),e=!(t instanceof Array)}catch(i){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:r(t,n),t}}({},!1):void 0),check:o}},"8ef8":function(t,e){t.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.591 10.177l4.243 4.242a1 1 0 0 1-1.415 1.415l-4.242-4.243-4.243 4.243a1 1 0 0 1-1.414-1.415l4.243-4.242L4.52 5.934A1 1 0 0 1 5.934 4.52l4.243 4.243 4.242-4.243a1 1 0 1 1 1.415 1.414l-4.243 4.243z"/></svg>'},"8feb":function(t,e,n){t.exports=n("4910")},"901e":function(t,e,n){"use strict";var r=n("5c95"),i=n("ebfd").getWeak,o=n("e4ae"),a=n("f772"),s=n("1173"),u=n("a22a"),c=n("57b1"),l=n("07e3"),h=n("9f79"),f=c(5),d=c(6),p=0,v=function(t){return t._l||(t._l=new y)},y=function(){this.a=[]},g=function(t,e){return f(t.a,function(t){return t[0]===e})};y.prototype={get:function(t){var e=g(this,t);if(e)return e[1]},has:function(t){return!!g(this,t)},set:function(t,e){var n=g(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(t){var e=d(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,n,o){var c=t(function(t,r){s(t,c,e,"_i"),t._t=e,t._i=p++,t._l=void 0,void 0!=r&&u(r,n,t[o],t)});return r(c.prototype,{delete:function(t){if(!a(t))return!1;var n=i(t);return!0===n?v(h(this,e))["delete"](t):n&&l(n,this._i)&&delete n[this._i]},has:function(t){if(!a(t))return!1;var n=i(t);return!0===n?v(h(this,e)).has(t):n&&l(n,this._i)}}),c},def:function(t,e,n){var r=i(o(e),!0);return!0===r?v(t).set(e,n):r[t._i]=n,t},ufstore:v}},9093:function(t,e,n){var r=n("ce10"),i=n("e11e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},"91fd":function(t,e){t.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><g><path d="M8.636 9.531l-2.758 3.94a.5.5 0 0 0 .122.696l3.224 2.284h1.314l2.636-3.736L8.636 9.53zm.288 8.451L5.14 15.396a2 2 0 0 1-.491-2.786l6.673-9.53a2 2 0 0 1 2.785-.49l3.742 2.62a2 2 0 0 1 .491 2.785l-7.269 10.053-2.147-.066z"/><path d="M4 18h5.523v-1H4zm-2 0h1v-1H2z"/></g></svg>'},"92bd":function(t,e,n){},9306:function(t,e,n){"use strict";var r=n("c3a1"),i=n("9aa9"),o=n("355d"),a=n("241e"),s=n("335c"),u=Object.assign;t.exports=!u||n("294c")(function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach(function(t){e[t]=t}),7!=u({},t)[n]||Object.keys(u({},e)).join("")!=r})?function(t,e){var n=a(t),u=arguments.length,c=1,l=i.f,h=o.f;while(u>c){var f,d=s(arguments[c++]),p=l?r(d).concat(l(d)):r(d),v=p.length,y=0;while(v>y)h.call(d,f=p[y++])&&(n[f]=d[f])}return n}:u},"955a":function(t,e,n){},"95c6":function(t,e,n){"use strict";n.r(e),function(t){n("52fe");var e=setTimeout;function r(){}function i(t,e){return function(){t.apply(e,arguments)}}function o(t){if(!(this instanceof o))throw new TypeError("Promises must be constructed via new");if("function"!==typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],h(t,this)}function a(t,e){while(3===t._state)t=t._value;0!==t._state?(t._handled=!0,o._immediateFn(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var r;try{r=n(t._value)}catch(i){return void u(e.promise,i)}s(e.promise,r)}else(1===t._state?s:u)(e.promise,t._value)})):t._deferreds.push(e)}function s(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"===typeof e||"function"===typeof e)){var n=e.then;if(e instanceof o)return t._state=3,t._value=e,void c(t);if("function"===typeof n)return void h(i(n,e),t)}t._state=1,t._value=e,c(t)}catch(r){u(t,r)}}function u(t,e){t._state=2,t._value=e,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&o._immediateFn(function(){t._handled||o._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)a(t,t._deferreds[e]);t._deferreds=null}function l(t,e,n){this.onFulfilled="function"===typeof t?t:null,this.onRejected="function"===typeof e?e:null,this.promise=n}function h(t,e){var n=!1;try{t(function(t){n||(n=!0,s(e,t))},function(t){n||(n=!0,u(e,t))})}catch(r){if(n)return;n=!0,u(e,r)}}o.prototype["catch"]=function(t){return this.then(null,t)},o.prototype.then=function(t,e){var n=new this.constructor(r);return a(this,new l(t,e,n)),n},o.prototype["finally"]=function(t){var e=this.constructor;return this.then(function(n){return e.resolve(t()).then(function(){return n})},function(n){return e.resolve(t()).then(function(){return e.reject(n)})})},o.all=function(t){return new o(function(e,n){if(!t||"undefined"===typeof t.length)throw new TypeError("Promise.all accepts an array");var r=Array.prototype.slice.call(t);if(0===r.length)return e([]);var i=r.length;function o(t,a){try{if(a&&("object"===typeof a||"function"===typeof a)){var s=a.then;if("function"===typeof s)return void s.call(a,function(e){o(t,e)},n)}r[t]=a,0===--i&&e(r)}catch(u){n(u)}}for(var a=0;a<r.length;a++)o(a,r[a])})},o.resolve=function(t){return t&&"object"===typeof t&&t.constructor===o?t:new o(function(e){e(t)})},o.reject=function(t){return new o(function(e,n){n(t)})},o.race=function(t){return new o(function(e,n){for(var r=0,i=t.length;r<i;r++)t[r].then(e,n)})},o._immediateFn="function"===typeof setImmediate&&function(t){setImmediate(t)}||function(t){e(t,0)},o._unhandledRejectionFn=function(t){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};var f=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof t)return t;throw new Error("unable to locate global object")}();function d(t,e){return e={exports:{}},t(e,e.exports),e.exports}f.Promise||(f.Promise=o);var p=d(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),v=d(function(t){var e=t.exports={version:"2.5.5"};"number"==typeof __e&&(__e=e)}),y=(v.version,function(t){return"object"===typeof t?null!==t:"function"===typeof t}),g=function(t){if(!y(t))throw TypeError(t+" is not an object!");return t},m=function(t){try{return!!t()}catch(e){return!0}},b=!m(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),w=p.document,_=y(w)&&y(w.createElement),k=function(t){return _?w.createElement(t):{}},E=!b&&!m(function(){return 7!=Object.defineProperty(k("div"),"a",{get:function(){return 7}}).a}),T=function(t,e){if(!y(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!y(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!y(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!y(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")},S=Object.defineProperty,C=b?Object.defineProperty:function(t,e,n){if(g(t),e=T(e,!0),g(n),E)try{return S(t,e,n)}catch(r){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t},O={f:C},A=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},I=b?function(t,e,n){return O.f(t,e,A(1,n))}:function(t,e,n){return t[e]=n,t},x={}.hasOwnProperty,P=function(t,e){return x.call(t,e)},N=0,R=Math.random(),D=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++N+R).toString(36))},j=d(function(t){var e=D("src"),n="toString",r=Function[n],i=(""+r).split(n);v.inspectSource=function(t){return r.call(t)},(t.exports=function(t,n,r,o){var a="function"==typeof r;a&&(P(r,"name")||I(r,"name",n)),t[n]!==r&&(a&&(P(r,e)||I(r,e,t[n]?""+t[n]:i.join(String(n)))),t===p?t[n]=r:o?t[n]?t[n]=r:I(t,n,r):(delete t[n],I(t,n,r)))})(Function.prototype,n,function(){return"function"==typeof this&&this[e]||r.call(this)})}),M=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t},L=function(t,e,n){if(M(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}},F="prototype",V=function(t,e,n){var r,i,o,a,s=t&V.F,u=t&V.G,c=t&V.S,l=t&V.P,h=t&V.B,f=u?p:c?p[e]||(p[e]={}):(p[e]||{})[F],d=u?v:v[e]||(v[e]={}),y=d[F]||(d[F]={});for(r in u&&(n=e),n)i=!s&&f&&void 0!==f[r],o=(i?f:n)[r],a=h&&i?L(o,p):l&&"function"==typeof o?L(Function.call,o):o,f&&j(f,r,o,t&V.U),d[r]!=o&&I(d,r,a),l&&y[r]!=o&&(y[r]=o)};p.core=v,V.F=1,V.G=2,V.S=4,V.P=8,V.B=16,V.W=32,V.U=64,V.R=128;var B=V,U={}.toString,q=function(t){return U.call(t).slice(8,-1)},W=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==q(t)?t.split(""):Object(t)},K=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t},H=function(t){return Object(K(t))},z=Math.ceil,G=Math.floor,Q=function(t){return isNaN(t=+t)?0:(t>0?G:z)(t)},Y=Math.min,X=function(t){return t>0?Y(Q(t),9007199254740991):0},J=Array.isArray||function(t){return"Array"==q(t)},$="__core-js_shared__",Z=p[$]||(p[$]={}),tt=function(t){return Z[t]||(Z[t]={})},et=d(function(t){var e=tt("wks"),n=p.Symbol,r="function"==typeof n,i=t.exports=function(t){return e[t]||(e[t]=r&&n[t]||(r?n:D)("Symbol."+t))};i.store=e}),nt=et("species"),rt=function(t){var e;return J(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!J(e.prototype)||(e=void 0),y(e)&&(e=e[nt],null===e&&(e=void 0))),void 0===e?Array:e},it=function(t,e){return new(rt(t))(e)},ot=function(t,e){var n=1==t,r=2==t,i=3==t,o=4==t,a=6==t,s=5==t||a,u=e||it;return function(e,c,l){for(var h,f,d=H(e),p=W(d),v=L(c,l,3),y=X(p.length),g=0,m=n?u(e,y):r?u(e,0):void 0;y>g;g++)if((s||g in p)&&(h=p[g],f=v(h,g,d),t))if(n)m[g]=f;else if(f)switch(t){case 3:return!0;case 5:return h;case 6:return g;case 2:m.push(h)}else if(o)return!1;return a?-1:i||o?o:m}},at=et("unscopables"),st=Array.prototype;void 0==st[at]&&I(st,at,{});var ut=function(t){st[at][t]=!0},ct=ot(5),lt="find",ht=!0;lt in[]&&Array(1)[lt](function(){ht=!1}),B(B.P+B.F*ht,"Array",{find:function(t){return ct(this,t,arguments.length>1?arguments[1]:void 0)}}),ut(lt);v.Array.find;var ft=ot(6),dt="findIndex",pt=!0;dt in[]&&Array(1)[dt](function(){pt=!1}),B(B.P+B.F*pt,"Array",{findIndex:function(t){return ft(this,t,arguments.length>1?arguments[1]:void 0)}}),ut(dt);v.Array.findIndex;var vt=function(t){return W(K(t))},yt=Math.max,gt=Math.min,mt=function(t,e){return t=Q(t),t<0?yt(t+e,0):gt(t,e)},bt=function(t){return function(e,n,r){var i,o=vt(e),a=X(o.length),s=mt(r,a);if(t&&n!=n){while(a>s)if(i=o[s++],i!=i)return!0}else for(;a>s;s++)if((t||s in o)&&o[s]===n)return t||s||0;return!t&&-1}},wt=tt("keys"),_t=function(t){return wt[t]||(wt[t]=D(t))},kt=bt(!1),Et=_t("IE_PROTO"),Tt=function(t,e){var n,r=vt(t),i=0,o=[];for(n in r)n!=Et&&P(r,n)&&o.push(n);while(e.length>i)P(r,n=e[i++])&&(~kt(o,n)||o.push(n));return o},St="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),Ct=Object.keys||function(t){return Tt(t,St)},Ot=Object.getOwnPropertySymbols,At={f:Ot},It={}.propertyIsEnumerable,xt={f:It},Pt=Object.assign,Nt=!Pt||m(function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach(function(t){e[t]=t}),7!=Pt({},t)[n]||Object.keys(Pt({},e)).join("")!=r})?function(t,e){var n=H(t),r=arguments.length,i=1,o=At.f,a=xt.f;while(r>i){var s,u=W(arguments[i++]),c=o?Ct(u).concat(o(u)):Ct(u),l=c.length,h=0;while(l>h)a.call(u,s=c[h++])&&(n[s]=u[s])}return n}:Pt;B(B.S+B.F,"Object",{assign:Nt});v.Object.assign;var Rt=et("match"),Dt=function(t){var e;return y(t)&&(void 0!==(e=t[Rt])?!!e:"RegExp"==q(t))},jt=function(t,e,n){if(Dt(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(K(t))},Mt=et("match"),Lt=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[Mt]=!1,!"/./"[t](e)}catch(C){}}return!0},Ft="startsWith",Vt=""[Ft];B(B.P+B.F*Lt(Ft),"String",{startsWith:function(t){var e=jt(this,t,Ft),n=X(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),r=String(t);return Vt?Vt.call(e,r,n):e.slice(n,n+r.length)===r}});v.String.startsWith;var Bt=function(t){var e=String(K(this)),n="",r=Q(t);if(r<0||r==1/0)throw RangeError("Count can't be negative");for(;r>0;(r>>>=1)&&(e+=e))1&r&&(n+=e);return n};B(B.P,"String",{repeat:Bt});v.String.repeat;var Ut=d(function(t){var e=D("meta"),n=O.f,r=0,i=Object.isExtensible||function(){return!0},o=!m(function(){return i(Object.preventExtensions({}))}),a=function(t){n(t,e,{value:{i:"O"+ ++r,w:{}}})},s=function(t,n){if(!y(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!P(t,e)){if(!i(t))return"F";if(!n)return"E";a(t)}return t[e].i},u=function(t,n){if(!P(t,e)){if(!i(t))return!0;if(!n)return!1;a(t)}return t[e].w},c=function(t){return o&&l.NEED&&i(t)&&!P(t,e)&&a(t),t},l=t.exports={KEY:e,NEED:!1,fastKey:s,getWeak:u,onFreeze:c}}),qt=(Ut.KEY,Ut.NEED,Ut.fastKey,Ut.getWeak,Ut.onFreeze,O.f),Wt=et("toStringTag"),Kt=function(t,e,n){t&&!P(t=n?t:t.prototype,Wt)&&qt(t,Wt,{configurable:!0,value:e})},Ht=et,zt={f:Ht},Gt=!1,Qt=O.f,Yt=function(t){var e=v.Symbol||(v.Symbol=Gt?{}:p.Symbol||{});"_"==t.charAt(0)||t in e||Qt(e,t,{value:zt.f(t)})},Xt=function(t){var e=Ct(t),n=At.f;if(n){var r,i=n(t),o=xt.f,a=0;while(i.length>a)o.call(t,r=i[a++])&&e.push(r)}return e},Jt=b?Object.defineProperties:function(t,e){g(t);var n,r=Ct(e),i=r.length,o=0;while(i>o)O.f(t,n=r[o++],e[n]);return t},$t=p.document,Zt=$t&&$t.documentElement,te=_t("IE_PROTO"),ee=function(){},ne="prototype",re=function(){var t,e=k("iframe"),n=St.length,r="<",i=">";e.style.display="none",Zt.appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write(r+"script"+i+"document.F=Object"+r+"/script"+i),t.close(),re=t.F;while(n--)delete re[ne][St[n]];return re()},ie=Object.create||function(t,e){var n;return null!==t?(ee[ne]=g(t),n=new ee,ee[ne]=null,n[te]=t):n=re(),void 0===e?n:Jt(n,e)},oe=St.concat("length","prototype"),ae=Object.getOwnPropertyNames||function(t){return Tt(t,oe)},se={f:ae},ue=se.f,ce={}.toString,le="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],he=function(t){try{return ue(t)}catch(e){return le.slice()}},fe=function(t){return le&&"[object Window]"==ce.call(t)?he(t):ue(vt(t))},de={f:fe},pe=Object.getOwnPropertyDescriptor,ve=b?pe:function(t,e){if(t=vt(t),e=T(e,!0),E)try{return pe(t,e)}catch(n){}if(P(t,e))return A(!xt.f.call(t,e),t[e])},ye={f:ve},ge=Ut.KEY,me=ye.f,be=O.f,we=de.f,_e=p.Symbol,ke=p.JSON,Ee=ke&&ke.stringify,Te="prototype",Se=et("_hidden"),Ce=et("toPrimitive"),Oe={}.propertyIsEnumerable,Ae=tt("symbol-registry"),Ie=tt("symbols"),xe=tt("op-symbols"),Pe=Object[Te],Ne="function"==typeof _e,Re=p.QObject,De=!Re||!Re[Te]||!Re[Te].findChild,je=b&&m(function(){return 7!=ie(be({},"a",{get:function(){return be(this,"a",{value:7}).a}})).a})?function(t,e,n){var r=me(Pe,e);r&&delete Pe[e],be(t,e,n),r&&t!==Pe&&be(Pe,e,r)}:be,Me=function(t){var e=Ie[t]=ie(_e[Te]);return e._k=t,e},Le=Ne&&"symbol"==typeof _e.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof _e},Fe=function(t,e,n){return t===Pe&&Fe(xe,e,n),g(t),e=T(e,!0),g(n),P(Ie,e)?(n.enumerable?(P(t,Se)&&t[Se][e]&&(t[Se][e]=!1),n=ie(n,{enumerable:A(0,!1)})):(P(t,Se)||be(t,Se,A(1,{})),t[Se][e]=!0),je(t,e,n)):be(t,e,n)},Ve=function(t,e){g(t);var n,r=Xt(e=vt(e)),i=0,o=r.length;while(o>i)Fe(t,n=r[i++],e[n]);return t},Be=function(t,e){return void 0===e?ie(t):Ve(ie(t),e)},Ue=function(t){var e=Oe.call(this,t=T(t,!0));return!(this===Pe&&P(Ie,t)&&!P(xe,t))&&(!(e||!P(this,t)||!P(Ie,t)||P(this,Se)&&this[Se][t])||e)},qe=function(t,e){if(t=vt(t),e=T(e,!0),t!==Pe||!P(Ie,e)||P(xe,e)){var n=me(t,e);return!n||!P(Ie,e)||P(t,Se)&&t[Se][e]||(n.enumerable=!0),n}},We=function(t){var e,n=we(vt(t)),r=[],i=0;while(n.length>i)P(Ie,e=n[i++])||e==Se||e==ge||r.push(e);return r},Ke=function(t){var e,n=t===Pe,r=we(n?xe:vt(t)),i=[],o=0;while(r.length>o)!P(Ie,e=r[o++])||n&&!P(Pe,e)||i.push(Ie[e]);return i};Ne||(_e=function(){if(this instanceof _e)throw TypeError("Symbol is not a constructor!");var t=D(arguments.length>0?arguments[0]:void 0),e=function(n){this===Pe&&e.call(xe,n),P(this,Se)&&P(this[Se],t)&&(this[Se][t]=!1),je(this,t,A(1,n))};return b&&De&&je(Pe,t,{configurable:!0,set:e}),Me(t)},j(_e[Te],"toString",function(){return this._k}),ye.f=qe,O.f=Fe,se.f=de.f=We,xt.f=Ue,At.f=Ke,b&&!Gt&&j(Pe,"propertyIsEnumerable",Ue,!0),zt.f=function(t){return Me(et(t))}),B(B.G+B.W+B.F*!Ne,{Symbol:_e});for(var He="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ze=0;He.length>ze;)et(He[ze++]);for(var Ge=Ct(et.store),Qe=0;Ge.length>Qe;)Yt(Ge[Qe++]);B(B.S+B.F*!Ne,"Symbol",{for:function(t){return P(Ae,t+="")?Ae[t]:Ae[t]=_e(t)},keyFor:function(t){if(!Le(t))throw TypeError(t+" is not a symbol!");for(var e in Ae)if(Ae[e]===t)return e},useSetter:function(){De=!0},useSimple:function(){De=!1}}),B(B.S+B.F*!Ne,"Object",{create:Be,defineProperty:Fe,defineProperties:Ve,getOwnPropertyDescriptor:qe,getOwnPropertyNames:We,getOwnPropertySymbols:Ke}),ke&&B(B.S+B.F*(!Ne||m(function(){var t=_e();return"[null]"!=Ee([t])||"{}"!=Ee({a:t})||"{}"!=Ee(Object(t))})),"JSON",{stringify:function(t){var e,n,r=[t],i=1;while(arguments.length>i)r.push(arguments[i++]);if(n=e=r[1],(y(e)||void 0!==t)&&!Le(t))return J(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!Le(e))return e}),r[1]=e,Ee.apply(ke,r)}}),_e[Te][Ce]||I(_e[Te],Ce,_e[Te].valueOf),Kt(_e,"Symbol"),Kt(Math,"Math",!0),Kt(p.JSON,"JSON",!0);var Ye=et("toStringTag"),Xe="Arguments"==q(function(){return arguments}()),Je=function(t,e){try{return t[e]}catch(n){}},$e=function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=Je(e=Object(t),Ye))?n:Xe?q(e):"Object"==(r=q(e))&&"function"==typeof e.callee?"Arguments":r},Ze={};Ze[et("toStringTag")]="z",Ze+""!="[object z]"&&j(Object.prototype,"toString",function(){return"[object "+$e(this)+"]"},!0),Yt("asyncIterator"),Yt("observable");v.Symbol;var tn=function(t){return function(e,n){var r,i,o=String(K(e)),a=Q(n),s=o.length;return a<0||a>=s?t?"":void 0:(r=o.charCodeAt(a),r<55296||r>56319||a+1===s||(i=o.charCodeAt(a+1))<56320||i>57343?t?o.charAt(a):r:t?o.slice(a,a+2):i-56320+(r-55296<<10)+65536)}},en={},nn={};I(nn,et("iterator"),function(){return this});var rn=function(t,e,n){t.prototype=ie(nn,{next:A(1,n)}),Kt(t,e+" Iterator")},on=_t("IE_PROTO"),an=Object.prototype,sn=Object.getPrototypeOf||function(t){return t=H(t),P(t,on)?t[on]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?an:null},un=et("iterator"),cn=!([].keys&&"next"in[].keys()),ln="@@iterator",hn="keys",fn="values",dn=function(){return this},pn=function(t,e,n,r,i,o,a){rn(n,e,r);var s,u,c,l=function(t){if(!cn&&t in p)return p[t];switch(t){case hn:return function(){return new n(this,t)};case fn:return function(){return new n(this,t)}}return function(){return new n(this,t)}},h=e+" Iterator",f=i==fn,d=!1,p=t.prototype,v=p[un]||p[ln]||i&&p[i],y=v||l(i),g=i?f?l("entries"):y:void 0,m="Array"==e&&p.entries||v;if(m&&(c=sn(m.call(new t)),c!==Object.prototype&&c.next&&(Kt(c,h,!0),Gt||"function"==typeof c[un]||I(c,un,dn))),f&&v&&v.name!==fn&&(d=!0,y=function(){return v.call(this)}),Gt&&!a||!cn&&!d&&p[un]||I(p,un,y),en[e]=y,en[h]=dn,i)if(s={values:f?y:l(fn),keys:o?y:l(hn),entries:g},a)for(u in s)u in p||j(p,u,s[u]);else B(B.P+B.F*(cn||d),e,s);return s},vn=tn(!0);pn(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=vn(e,n),this._i+=t.length,{value:t,done:!1})});var yn=function(t,e){return{value:e,done:!!t}},gn=pn(Array,"Array",function(t,e){this._t=vt(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,yn(1)):yn(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values");en.Arguments=en.Array,ut("keys"),ut("values"),ut("entries");for(var mn=et("iterator"),bn=et("toStringTag"),wn=en.Array,_n={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},kn=Ct(_n),En=0;En<kn.length;En++){var Tn,Sn=kn[En],Cn=_n[Sn],On=p[Sn],An=On&&On.prototype;if(An&&(An[mn]||I(An,mn,wn),An[bn]||I(An,bn,Sn),en[Sn]=wn,Cn))for(Tn in gn)An[Tn]||j(An,Tn,gn[Tn],!0)}zt.f("iterator")}.call(this,n("c8ba"))},"95d5":function(t,e,n){var r=n("40c3"),i=n("5168")("iterator"),o=n("481b");t.exports=n("584a").isIterable=function(t){var e=Object(t);return void 0!==e[i]||"@@iterator"in e||o.hasOwnProperty(r(e))}},"96cf":function(t,e){!function(e){"use strict";var n,r=Object.prototype,i=r.hasOwnProperty,o="function"===typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag",c="object"===typeof t,l=e.regeneratorRuntime;if(l)c&&(t.exports=l);else{l=e.regeneratorRuntime=c?t.exports:{},l.wrap=w;var h="suspendedStart",f="suspendedYield",d="executing",p="completed",v={},y={};y[a]=function(){return this};var g=Object.getPrototypeOf,m=g&&g(g(N([])));m&&m!==r&&i.call(m,a)&&(y=m);var b=T.prototype=k.prototype=Object.create(y);E.prototype=b.constructor=T,T.constructor=E,T[u]=E.displayName="GeneratorFunction",l.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===E||"GeneratorFunction"===(e.displayName||e.name))},l.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,T):(t.__proto__=T,u in t||(t[u]="GeneratorFunction")),t.prototype=Object.create(b),t},l.awrap=function(t){return{__await:t}},S(C.prototype),C.prototype[s]=function(){return this},l.AsyncIterator=C,l.async=function(t,e,n,r){var i=new C(w(t,e,n,r));return l.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},S(b),b[u]="Generator",b[a]=function(){return this},b.toString=function(){return"[object Generator]"},l.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){while(e.length){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},l.values=N,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,i){return s.type="throw",s.arg=t,e.next=r,i&&(e.method="next",e.arg=n),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var u=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),x(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;x(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:N(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=n),v}}}function w(t,e,n,r){var i=e&&e.prototype instanceof k?e:k,o=Object.create(i.prototype),a=new P(r||[]);return o._invoke=O(t,n,a),o}function _(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(r){return{type:"throw",arg:r}}}function k(){}function E(){}function T(){}function S(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function C(t){function e(n,r,o,a){var s=_(t[n],t,r);if("throw"!==s.type){var u=s.arg,c=u.value;return c&&"object"===typeof c&&i.call(c,"__await")?Promise.resolve(c.__await).then(function(t){e("next",t,o,a)},function(t){e("throw",t,o,a)}):Promise.resolve(c).then(function(t){u.value=t,o(u)},function(t){return e("throw",t,o,a)})}a(s.arg)}var n;function r(t,r){function i(){return new Promise(function(n,i){e(t,r,n,i)})}return n=n?n.then(i,i):i()}this._invoke=r}function O(t,e,n){var r=h;return function(i,o){if(r===d)throw new Error("Generator is already running");if(r===p){if("throw"===i)throw o;return R()}n.method=i,n.arg=o;while(1){var a=n.delegate;if(a){var s=A(a,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var u=_(t,e,n);if("normal"===u.type){if(r=n.done?p:f,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=p,n.method="throw",n.arg=u.arg)}}}function A(t,e){var r=t.iterator[e.method];if(r===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=n,A(t,e),"throw"===e.method))return v;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=_(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,v;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,v):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,v)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function N(t){if(t){var e=t[a];if(e)return e.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){while(++r<t.length)if(i.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=n,e.done=!0,e};return o.next=o}}return{next:R}}function R(){return{value:n,done:!0}}}(function(){return this||"object"===typeof self&&self}()||Function("return this")())},9744:function(t,e,n){"use strict";var r=n("4588"),i=n("be13");t.exports=function(t){var e=String(i(this)),n="",o=r(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(n+=e);return n}},9802:function(t,e,n){"use strict";n.r(e),n.d(e,"__extends",function(){return i}),n.d(e,"__assign",function(){return o}),n.d(e,"__rest",function(){return a}),n.d(e,"__decorate",function(){return s}),n.d(e,"__param",function(){return u}),n.d(e,"__metadata",function(){return c}),n.d(e,"__awaiter",function(){return l}),n.d(e,"__generator",function(){return h}),n.d(e,"__exportStar",function(){return f}),n.d(e,"__values",function(){return d}),n.d(e,"__read",function(){return p}),n.d(e,"__spread",function(){return v}),n.d(e,"__await",function(){return y}),n.d(e,"__asyncGenerator",function(){return g}),n.d(e,"__asyncDelegator",function(){return m}),n.d(e,"__asyncValues",function(){return b}),n.d(e,"__makeTemplateObject",function(){return w}),n.d(e,"__importStar",function(){return _}),n.d(e,"__importDefault",function(){return k});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};function a(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&(n[r[i]]=t[r[i]])}return n}function s(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}function u(t,e){return function(n,r){e(n,r,t)}}function c(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)}function l(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})}function h(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return u([t,e])}}function u(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}function f(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}function d(t){var e="function"===typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function p(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{while((void 0===e||e-- >0)&&!(r=o.next()).done)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}return a}function v(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(p(arguments[e]));return t}function y(t){return this instanceof y?(this.v=t,this):new y(t)}function g(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(t){i[t]&&(r[t]=function(e){return new Promise(function(n,r){o.push([t,e,n,r])>1||s(t,e)})})}function s(t,e){try{u(i[t](e))}catch(n){h(o[0][3],n)}}function u(t){t.value instanceof y?Promise.resolve(t.value.v).then(c,l):h(o[0][2],t)}function c(t){s("next",t)}function l(t){s("throw",t)}function h(t,e){t(e),o.shift(),o.length&&s(o[0][0],o[0][1])}}function m(t){var e,n;return e={},r("next"),r("throw",function(t){throw t}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){t[r]&&(e[r]=function(e){return(n=!n)?{value:y(t[r](e)),done:"return"===r}:i?i(e):e})}}function b(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator];return e?e.call(t):"function"===typeof d?d(t):t[Symbol.iterator]()}function w(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function _(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function k(t){return t&&t.__esModule?t:{default:t}}},"9a04":function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n("a5b2"),i=n.n(r),o=n("54b6");function a(){if("undefined"===typeof Reflect||!i.a)return!1;if(i.a.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(i()(Date,[],function(){})),!0}catch(t){return!1}}function s(t,e,n){return s=a()?i.a:function(t,e,n){var r=[null];r.push.apply(r,e);var i=Function.bind.apply(t,r),a=new i;return n&&Object(o["a"])(a,n.prototype),a},s.apply(null,arguments)}},"9b9a":function(t,e,n){n("c207"),n("6c1c"),n("39cf"),n("0544"),n("fa3a"),t.exports=n("584a").WeakMap},"9f79":function(t,e,n){var r=n("f772");t.exports=function(t,e){if(!r(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},a098:function(t,e,n){t.exports=n("c7f9")},a1ce:function(t,e,n){var r=n("63b6"),i=n("25eb"),o=n("294c"),a=n("e692"),s="["+a+"]",u="",c=RegExp("^"+s+s+"*"),l=RegExp(s+s+"*$"),h=function(t,e,n){var i={},s=o(function(){return!!a[t]()||u[t]()!=u}),c=i[t]=s?e(f):a[t];n&&(i[n]=c),r(r.P+r.F*s,"String",i)},f=h.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(c,"")),2&e&&(t=t.replace(l,"")),t};t.exports=h},a21f:function(t,e,n){var r=n("584a"),i=r.JSON||(r.JSON={stringify:JSON.stringify});t.exports=function(t){return i.stringify.apply(i,arguments)}},a22a:function(t,e,n){var r=n("d864"),i=n("b0dc"),o=n("3702"),a=n("e4ae"),s=n("b447"),u=n("7cd6"),c={},l={};e=t.exports=function(t,e,n,h,f){var d,p,v,y,g=f?function(){return t}:u(t),m=r(n,h,e?2:1),b=0;if("function"!=typeof g)throw TypeError(t+" is not iterable!");if(o(g)){for(d=s(t.length);d>b;b++)if(y=e?m(a(p=t[b])[0],p[1]):m(t[b]),y===c||y===l)return y}else for(v=g.call(t);!(p=v.next()).done;)if(y=i(v,m,p.value,e),y===c||y===l)return y};e.BREAK=c,e.RETURN=l},a2cd:function(t,e,n){"use strict";n.r(e),n.d(e,"__extends",function(){return i}),n.d(e,"__assign",function(){return o}),n.d(e,"__rest",function(){return a}),n.d(e,"__decorate",function(){return s}),n.d(e,"__param",function(){return u}),n.d(e,"__metadata",function(){return c}),n.d(e,"__awaiter",function(){return l}),n.d(e,"__generator",function(){return h}),n.d(e,"__exportStar",function(){return f}),n.d(e,"__values",function(){return d}),n.d(e,"__read",function(){return p}),n.d(e,"__spread",function(){return v}),n.d(e,"__await",function(){return y}),n.d(e,"__asyncGenerator",function(){return g}),n.d(e,"__asyncDelegator",function(){return m}),n.d(e,"__asyncValues",function(){return b}),n.d(e,"__makeTemplateObject",function(){return w}),n.d(e,"__importStar",function(){return _}),n.d(e,"__importDefault",function(){return k});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};function a(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&(n[r[i]]=t[r[i]])}return n}function s(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}function u(t,e){return function(n,r){e(n,r,t)}}function c(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)}function l(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})}function h(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return u([t,e])}}function u(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}function f(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}function d(t){var e="function"===typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function p(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{while((void 0===e||e-- >0)&&!(r=o.next()).done)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}return a}function v(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(p(arguments[e]));return t}function y(t){return this instanceof y?(this.v=t,this):new y(t)}function g(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(t){i[t]&&(r[t]=function(e){return new Promise(function(n,r){o.push([t,e,n,r])>1||s(t,e)})})}function s(t,e){try{u(i[t](e))}catch(n){h(o[0][3],n)}}function u(t){t.value instanceof y?Promise.resolve(t.value.v).then(c,l):h(o[0][2],t)}function c(t){s("next",t)}function l(t){s("throw",t)}function h(t,e){t(e),o.shift(),o.length&&s(o[0][0],o[0][1])}}function m(t){var e,n;return e={},r("next"),r("throw",function(t){throw t}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){t[r]&&(e[r]=function(e){return(n=!n)?{value:y(t[r](e)),done:"return"===r}:i?i(e):e})}}function b(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator];return e?e.call(t):"function"===typeof d?d(t):t[Symbol.iterator]()}function w(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function _(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function k(t){return t&&t.__esModule?t:{default:t}}},a3c3:function(t,e,n){var r=n("63b6");r(r.S+r.F,"Object",{assign:n("9306")})},a481:function(t,e,n){"use strict";var r=n("cb7c"),i=n("4bf8"),o=n("9def"),a=n("4588"),s=n("0390"),u=n("5f1b"),c=Math.max,l=Math.min,h=Math.floor,f=/\$([$&`']|\d\d?|<[^>]*>)/g,d=/\$([$&`']|\d\d?)/g,p=function(t){return void 0===t?t:String(t)};n("214f")("replace",2,function(t,e,n,v){return[function(r,i){var o=t(this),a=void 0==r?void 0:r[e];return void 0!==a?a.call(r,o,i):n.call(String(o),r,i)},function(t,e){var i=v(n,t,this,e);if(i.done)return i.value;var h=r(t),f=String(this),d="function"===typeof e;d||(e=String(e));var g=h.global;if(g){var m=h.unicode;h.lastIndex=0}var b=[];while(1){var w=u(h,f);if(null===w)break;if(b.push(w),!g)break;var _=String(w[0]);""===_&&(h.lastIndex=s(f,o(h.lastIndex),m))}for(var k="",E=0,T=0;T<b.length;T++){w=b[T];for(var S=String(w[0]),C=c(l(a(w.index),f.length),0),O=[],A=1;A<w.length;A++)O.push(p(w[A]));var I=w.groups;if(d){var x=[S].concat(O,C,f);void 0!==I&&x.push(I);var P=String(e.apply(void 0,x))}else P=y(S,f,C,O,I,e);C>=E&&(k+=f.slice(E,C)+P,E=C+S.length)}return k+f.slice(E)}];function y(t,e,r,o,a,s){var u=r+t.length,c=o.length,l=d;return void 0!==a&&(a=i(a),l=f),n.call(s,l,function(n,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,r);case"'":return e.slice(u);case"<":s=a[i.slice(1,-1)];break;default:var l=+i;if(0===l)return i;if(l>c){var f=h(l/10);return 0===f?i:f<=c?void 0===o[f-1]?i.charAt(1):o[f-1]+i.charAt(1):i}s=o[l-1]}return void 0===s?"":s})}})},a4bb:function(t,e,n){t.exports=n("8aae")},a5b2:function(t,e,n){t.exports=n("aa28")},a745:function(t,e,n){t.exports=n("f410")},aa28:function(t,e,n){n("733c"),t.exports=n("584a").Reflect.construct},aa77:function(t,e,n){var r=n("5ca1"),i=n("be13"),o=n("79e5"),a=n("fdef"),s="["+a+"]",u="",c=RegExp("^"+s+s+"*"),l=RegExp(s+s+"*$"),h=function(t,e,n){var i={},s=o(function(){return!!a[t]()||u[t]()!=u}),c=i[t]=s?e(f):a[t];n&&(i[n]=c),r(r.P+r.F*s,"String",i)},f=h.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(c,"")),2&e&&(t=t.replace(l,"")),t};t.exports=h},aae3:function(t,e,n){var r=n("d3f4"),i=n("2d95"),o=n("2b4c")("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==i(t))}},aba2:function(t,e,n){var r=n("e53d"),i=n("4178").set,o=r.MutationObserver||r.WebKitMutationObserver,a=r.process,s=r.Promise,u="process"==n("6b4c")(a);t.exports=function(){var t,e,n,c=function(){var r,i;u&&(r=a.domain)&&r.exit();while(t){i=t.fn,t=t.next;try{i()}catch(o){throw t?n():e=void 0,o}}e=void 0,r&&r.enter()};if(u)n=function(){a.nextTick(c)};else if(!o||r.navigator&&r.navigator.standalone)if(s&&s.resolve){var l=s.resolve(void 0);n=function(){l.then(c)}}else n=function(){i.call(r,c)};else{var h=!0,f=document.createTextNode("");new o(c).observe(f,{characterData:!0}),n=function(){f.data=h=!h}}return function(r){var i={fn:r,next:void 0};e&&(e.next=i),t||(t=i,n()),e=i}}},abfd:function(t,e,n){"use strict";n.r(e),n.d(e,"setLogLevel",function(){return u}),n.d(e,"Logger",function(){return s}),n.d(e,"LogLevel",function(){return r});var r,i=[];(function(t){t[t["DEBUG"]=0]="DEBUG",t[t["VERBOSE"]=1]="VERBOSE",t[t["INFO"]=2]="INFO",t[t["WARN"]=3]="WARN",t[t["ERROR"]=4]="ERROR",t[t["SILENT"]=5]="SILENT"})(r||(r={}));var o=r.INFO,a=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var o=(new Date).toISOString();switch(e){case r.DEBUG:console.log.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;case r.VERBOSE:console.log.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;case r.INFO:console.info.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;case r.WARN:console.warn.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;case r.ERROR:console.error.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+e+")")}}},s=function(){function t(t){this.name=t,this._logLevel=o,this._logHandler=a,i.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in r))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!==typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,r.DEBUG].concat(t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,r.VERBOSE].concat(t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,r.INFO].concat(t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,r.WARN].concat(t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,r.ERROR].concat(t))},t}();function u(t){i.forEach(function(e){e.logLevel=t})}},ac6a:function(t,e,n){for(var r=n("cadf"),i=n("0d58"),o=n("2aba"),a=n("7726"),s=n("32e9"),u=n("84f2"),c=n("2b4c"),l=c("iterator"),h=c("toStringTag"),f=u.Array,d={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=i(d),v=0;v<p.length;v++){var y,g=p[v],m=d[g],b=a[g],w=b&&b.prototype;if(w&&(w[l]||s(w,l,f),w[h]||s(w,h,g),u[g]=f,m))for(y in r)w[y]||o(w,y,r[y],!0)}},ada4:function(t,e,n){"use strict";var r=n("e53d"),i=n("63b6"),o=n("ebfd"),a=n("294c"),s=n("35e8"),u=n("5c95"),c=n("a22a"),l=n("1173"),h=n("f772"),f=n("45f2"),d=n("d9f6").f,p=n("57b1")(0),v=n("8e60");t.exports=function(t,e,n,y,g,m){var b=r[t],w=b,_=g?"set":"add",k=w&&w.prototype,E={};return v&&"function"==typeof w&&(m||k.forEach&&!a(function(){(new w).entries().next()}))?(w=e(function(e,n){l(e,w,t,"_c"),e._c=new b,void 0!=n&&c(n,g,e[_],e)}),p("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(t){var e="add"==t||"set"==t;t in k&&(!m||"clear"!=t)&&s(w.prototype,t,function(n,r){if(l(this,w,t),!e&&m&&!h(n))return"get"==t&&void 0;var i=this._c[t](0===n?0:n,r);return e?this:i})}),m||d(w.prototype,"size",{get:function(){return this._c.size}})):(w=y.getConstructor(e,t,g,_),u(w.prototype,n),o.NEED=!0),f(w,t),E[t]=w,i(i.G+i.W+i.F,E),m||y.setStrong(w,t,g),w}},aef6:function(t,e,n){"use strict";var r=n("5ca1"),i=n("9def"),o=n("d2c8"),a="endsWith",s=""[a];r(r.P+r.F*n("5147")(a),"String",{endsWith:function(t){var e=o(this,t,a),n=arguments.length>1?arguments[1]:void 0,r=i(e.length),u=void 0===n?r:Math.min(i(n),r),c=String(t);return s?s.call(e,c,u):e.slice(u-c.length,u)===c}})},b0b4:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n("85f2"),i=n.n(r);function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),i()(t,r.key,r)}}function a(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}},b0c5:function(t,e,n){"use strict";var r=n("520a");n("5ca1")({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},b0d6:function(t,e,n){},b0dc:function(t,e,n){var r=n("e4ae");t.exports=function(t,e,n,i){try{return i?e(r(n)[0],n[1]):e(n)}catch(a){var o=t["return"];throw void 0!==o&&r(o.call(t)),a}}},b6d0:function(t,e,n){t.exports=n("fa2b")},b7aa:function(t,e,n){"use strict";n.r(e),function(t){var e=n("c23d"),r=n.n(e);(function(){var t,e=e||{},n=this;function i(t){return"string"==typeof t}function o(t){return"boolean"==typeof t}function a(){}function s(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&"undefined"!=typeof t.splice&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||"undefined"!=typeof t.call&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&"undefined"==typeof t.call)return"object";return e}function u(t){return null===t}function c(t){return"array"==s(t)}function l(t){var e=s(t);return"array"==e||"object"==e&&"number"==typeof t.length}function h(t){return"function"==s(t)}function f(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var d="closure_uid_"+(1e9*Math.random()>>>0),p=0;function v(t,e,n){return t.call.apply(t.bind,arguments)}function y(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function g(t,e,n){return g=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?v:y,g.apply(null,arguments)}function m(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var b=Date.now||function(){return+new Date};function w(t,e){function n(){}n.prototype=e.prototype,t.ob=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ed=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function _(t){t.prototype.then=t.prototype.then,t.prototype.$goog_Thenable=!0}function k(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(e){return!1}}function E(t){if(Error.captureStackTrace)Error.captureStackTrace(this,E);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function T(t,e){t=t.split("%s");for(var n="",r=t.length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");E.call(this,n+t[r])}function S(t,e){throw new T("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function C(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function O(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function A(){this.b=this.a=null}w(E,Error),E.prototype.name="CustomError",w(T,E),T.prototype.name="AssertionError",C.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var I=new C(function(){return new P},function(t){t.reset()});function x(){var t=gt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function P(){this.next=this.b=this.a=null}A.prototype.add=function(t,e){var n=I.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},P.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},P.prototype.reset=function(){this.next=this.b=this.a=null};var N=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(i(t))return i(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},R=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,o=i(t)?t.split(""):t,a=0;a<r;a++)a in o&&e.call(n,o[a],a,t)};function D(t,e){var n=t.length,r=i(t)?t.split(""):t;for(--n;0<=n;--n)n in r&&e.call(void 0,r[n],n,t)}var j=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),o=i(t)?t.split(""):t,a=0;a<n;a++)a in o&&(r[a]=e.call(void 0,o[a],a,t));return r},M=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=i(t)?t.split(""):t,o=0;o<n;o++)if(o in r&&e.call(void 0,r[o],o,t))return!0;return!1};function L(t){t:{for(var e=fa,n=t.length,r=i(t)?t.split(""):t,o=0;o<n;o++)if(o in r&&e.call(void 0,r[o],o,t)){e=o;break t}e=-1}return 0>e?null:i(t)?t.charAt(e):t[e]}function F(t,e){return 0<=N(t,e)}function V(t,e){var n;return e=N(t,e),(n=0<=e)&&Array.prototype.splice.call(t,e,1),n}function B(t,e){D(t,function(n,r){e.call(void 0,n,r,t)&&1==Array.prototype.splice.call(t,r,1).length&&0})}function U(t){return Array.prototype.concat.apply([],arguments)}function q(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function W(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}var K=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function H(t){return Z.test(t)?(-1!=t.indexOf("&")&&(t=t.replace(G,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(Q,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(Y,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(X,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(J,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace($,"&#0;")),t):t}var z,G=/&/g,Q=/</g,Y=/>/g,X=/"/g,J=/'/g,$=/\x00/g,Z=/[\x00&<>"']/;function tt(t,e){return-1!=t.indexOf(e)}function et(t,e){return t<e?-1:t>e?1:0}t:{var nt=n.navigator;if(nt){var rt=nt.userAgent;if(rt){z=rt;break t}}z=""}function it(t){return tt(z,t)}function ot(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function at(t){for(var e in t)return!1;return!0}function st(t){var e,n={};for(e in t)n[e]=t[e];return n}var ut,ct,lt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ht(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i],r)t[n]=r[n];for(var o=0;o<lt.length;o++)n=lt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ft(t){n.setTimeout(function(){throw t},0)}function dt(){var t=n.MessageChannel;if("undefined"===typeof t&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!it("Presto")&&(t=function(){var t=document.createElement("IFRAME");t.style.display="none",t.src="",document.documentElement.appendChild(t);var e=t.contentWindow;t=e.document,t.open(),t.write(""),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=g(function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()},this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),"undefined"!==typeof t&&!it("Trident")&&!it("MSIE")){var e=new t,r={},i=r;return e.port1.onmessage=function(){if(void 0!==r.next){r=r.next;var t=r.wb;r.wb=null,t()}},function(t){i.next={wb:t},i=i.next,e.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(t){var e=document.createElement("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){n.setTimeout(t,0)}}function pt(t,e){ct||vt(),yt||(ct(),yt=!0),gt.add(t,e)}function vt(){if(n.Promise&&n.Promise.resolve){var t=n.Promise.resolve(void 0);ct=function(){t.then(mt)}}else ct=function(){var t=mt;!h(n.setImmediate)||n.Window&&n.Window.prototype&&!it("Edge")&&n.Window.prototype.setImmediate==n.setImmediate?(ut||(ut=dt()),ut(t)):n.setImmediate(t)}}var yt=!1,gt=new A;function mt(){for(var t;t=x();){try{t.a.call(t.b)}catch(e){ft(e)}O(I,t)}yt=!1}function bt(t,e){if(this.a=wt,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=a)try{var n=this;t.call(e,function(t){Dt(n,_t,t)},function(t){if(!(t instanceof Wt))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(e){}Dt(n,kt,t)})}catch(r){Dt(this,kt,r)}}var wt=0,_t=2,kt=3;function Et(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Et.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Tt=new C(function(){return new Et},function(t){t.reset()});function St(t,e,n){var r=Tt.get();return r.g=t,r.b=e,r.f=n,r}function Ct(t){if(t instanceof bt)return t;var e=new bt(a);return Dt(e,_t,t),e}function Ot(t){return new bt(function(e,n){n(t)})}function At(t,e,n){jt(t,e,n,null)||pt(m(e,t))}function It(t){return new bt(function(e,n){var r=t.length,i=[];if(r)for(var o,a=function(t,n){r--,i[t]=n,0==r&&e(i)},s=function(t){n(t)},u=0;u<t.length;u++)o=t[u],At(o,m(a,u),s);else e(i)})}function xt(t){return new bt(function(e){var n=t.length,r=[];if(n)for(var i,o=function(t,i,o){n--,r[t]=i?{Db:!0,value:o}:{Db:!1,reason:o},0==n&&e(r)},a=0;a<t.length;a++)i=t[a],At(i,m(o,a,!0),m(o,a,!1));else e(r)})}function Pt(t,e){if(t.a==wt)if(t.c){var n=t.c;if(n.b){for(var r=0,i=null,o=null,a=n.b;a&&(a.c||(r++,a.a==t&&(i=a),!(i&&1<r)));a=a.next)i||(o=a);i&&(n.a==wt&&1==r?Pt(n,e):(o?(r=o,r.next==n.f&&(n.f=r),r.next=r.next.next):Ft(n),Vt(n,i,kt,e)))}t.c=null}else Dt(t,kt,e)}function Nt(t,e){t.b||t.a!=_t&&t.a!=kt||Lt(t),t.f?t.f.next=e:t.b=e,t.f=e}function Rt(t,e,n,r){var i=St(null,null,null);return i.a=new bt(function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(a){o(a)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof Wt?o(e):t(i)}catch(a){o(a)}}:o}),i.a.c=t,Nt(t,i),i.a}function Dt(t,e,n){t.a==wt&&(t===n&&(e=kt,n=new TypeError("Promise cannot resolve to itself")),t.a=1,jt(n,t.Nc,t.Oc,t)||(t.i=n,t.a=e,t.c=null,Lt(t),e!=kt||n instanceof Wt||Ut(t,n)))}function jt(t,e,n,r){if(t instanceof bt)return Nt(t,St(e||a,n||null,r)),!0;if(k(t))return t.then(e,n,r),!0;if(f(t))try{var i=t.then;if(h(i))return Mt(t,i,e,n,r),!0}catch(o){return n.call(r,o),!0}return!1}function Mt(t,e,n,r,i){function o(t){s||(s=!0,r.call(i,t))}function a(t){s||(s=!0,n.call(i,t))}var s=!1;try{e.call(t,a,o)}catch(u){o(u)}}function Lt(t){t.h||(t.h=!0,pt(t.Yb,t))}function Ft(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function Vt(t,e,n,r){if(n==kt&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,Bt(e,n,r);else try{e.c?e.g.call(e.f):Bt(e,n,r)}catch(i){qt.call(null,i)}O(Tt,e)}function Bt(t,e,n){e==_t?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}function Ut(t,e){t.g=!0,pt(function(){t.g&&qt.call(null,e)})}bt.prototype.then=function(t,e,n){return Rt(this,h(t)?t:null,h(e)?e:null,n)},_(bt),t=bt.prototype,t.ia=function(t,e){return t=St(t,t,e),t.c=!0,Nt(this,t),this},t.s=function(t,e){return Rt(this,null,t,e)},t.cancel=function(t){this.a==wt&&pt(function(){var e=new Wt(t);Pt(this,e)},this)},t.Nc=function(t){this.a=wt,Dt(this,_t,t)},t.Oc=function(t){this.a=wt,Dt(this,kt,t)},t.Yb=function(){for(var t;t=Ft(this);)Vt(this,t,this.a,this.i);this.h=!1};var qt=ft;function Wt(t){E.call(this,t)}function Kt(){0!=Ht&&(zt[this[d]||(this[d]=++p)]=this),this.qa=this.qa,this.ja=this.ja}w(Wt,E),Wt.prototype.name="cancel";var Ht=0,zt={};function Gt(t){if(!t.qa&&(t.qa=!0,t.va(),0!=Ht)){var e=t[d]||(t[d]=++p);if(0!=Ht&&t.ja&&0<t.ja.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete zt[e]}}function Qt(t){return Qt[" "](t),t}function Yt(t,e){var n=ue;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}Kt.prototype.qa=!1,Kt.prototype.va=function(){if(this.ja)for(;this.ja.length;)this.ja.shift()()},Qt[" "]=a;var Xt,Jt=it("Opera"),$t=it("Trident")||it("MSIE"),Zt=it("Edge"),te=Zt||$t,ee=it("Gecko")&&!(tt(z.toLowerCase(),"webkit")&&!it("Edge"))&&!(it("Trident")||it("MSIE"))&&!it("Edge"),ne=tt(z.toLowerCase(),"webkit")&&!it("Edge");function re(){var t=n.document;return t?t.documentMode:void 0}t:{var ie="",oe=function(){var t=z;return ee?/rv:([^\);]+)(\)|;)/.exec(t):Zt?/Edge\/([\d\.]+)/.exec(t):$t?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):ne?/WebKit\/(\S+)/.exec(t):Jt?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(oe&&(ie=oe?oe[1]:""),$t){var ae=re();if(null!=ae&&ae>parseFloat(ie)){Xt=String(ae);break t}}Xt=ie}var se,ue={};function ce(t){return Yt(t,function(){for(var e=0,n=K(String(Xt)).split("."),r=K(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=et(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||et(0==a[2].length,0==s[2].length)||et(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e})}var le=n.document;se=le&&$t?re()||("CSS1Compat"==le.compatMode?parseInt(Xt,10):5):void 0;var he=Object.freeze||function(t){return t},fe=!$t||9<=Number(se),de=$t&&!ce("9"),pe=function(){if(!n.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});return n.addEventListener("test",a,e),n.removeEventListener("test",a,e),t}();function ve(t,e){this.type=t,this.b=this.target=e,this.Kb=!0}function ye(t,e){if(ve.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,r=t.changedTouches?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(ee){t:{try{Qt(e.nodeName);var o=!0;break t}catch(a){}o=!1}o||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,null===r?(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0):(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=i(t.pointerType)?t.pointerType:ge[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}ve.prototype.preventDefault=function(){this.Kb=!1},w(ye,ve);var ge=he({2:"touch",3:"pen",4:"mouse"});ye.prototype.preventDefault=function(){ye.ob.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,de)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}},ye.prototype.f=function(){return this.a};var me="closure_listenable_"+(1e6*Math.random()|0),be=0;function we(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.La=i,this.key=++be,this.oa=this.Ia=!1}function _e(t){t.oa=!0,t.listener=null,t.proxy=null,t.src=null,t.La=null}function ke(t){this.src=t,this.a={},this.b=0}function Ee(t,e){var n=e.type;n in t.a&&V(t.a[n],e)&&(_e(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function Te(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.oa&&o.listener==e&&o.capture==!!n&&o.La==r)return i}return-1}ke.prototype.add=function(t,e,n,r,i){var o=t.toString();t=this.a[o],t||(t=this.a[o]=[],this.b++);var a=Te(t,e,r,i);return-1<a?(e=t[a],n||(e.Ia=!1)):(e=new we(e,this.src,o,!!r,i),e.Ia=n,t.push(e)),e};var Se="closure_lm_"+(1e6*Math.random()|0),Ce={};function Oe(t,e,n,r,i){if(r&&r.once)xe(t,e,n,r,i);else if(c(e))for(var o=0;o<e.length;o++)Oe(t,e[o],n,r,i);else n=Ve(n),t&&t[me]?Ue(t,e,n,f(r)?!!r.capture:!!r,i):Ae(t,e,n,!1,r,i)}function Ae(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=f(i)?!!i.capture:!!i,s=Le(t);if(s||(t[Se]=s=new ke(t)),n=s.add(e,n,r,a,o),!n.proxy){if(r=Ie(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)pe||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Re(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}0}}function Ie(){var t=Me,e=fe?function(n){return t.call(e.src,e.listener,n)}:function(n){if(n=t.call(e.src,e.listener,n),!n)return n};return e}function xe(t,e,n,r,i){if(c(e))for(var o=0;o<e.length;o++)xe(t,e[o],n,r,i);else n=Ve(n),t&&t[me]?qe(t,e,n,f(r)?!!r.capture:!!r,i):Ae(t,e,n,!0,r,i)}function Pe(t,e,n,r,i){if(c(e))for(var o=0;o<e.length;o++)Pe(t,e[o],n,r,i);else r=f(r)?!!r.capture:!!r,n=Ve(n),t&&t[me]?(t=t.l,e=String(e).toString(),e in t.a&&(o=t.a[e],n=Te(o,n,r,i),-1<n&&(_e(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=Le(t))&&(e=t.a[e.toString()],t=-1,e&&(t=Te(e,n,r,i)),(n=-1<t?e[t]:null)&&Ne(n))}function Ne(t){if("number"!=typeof t&&t&&!t.oa){var e=t.src;if(e&&e[me])Ee(e.l,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Re(n),r):e.addListener&&e.removeListener&&e.removeListener(r),0,(n=Le(e))?(Ee(n,t),0==n.b&&(n.src=null,e[Se]=null)):_e(t)}}}function Re(t){return t in Ce?Ce[t]:Ce[t]="on"+t}function De(t,e,n,r){var i=!0;if((t=Le(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.oa&&(o=je(o,r),i=i&&!1!==o)}return i}function je(t,e){var n=t.listener,r=t.La||t.src;return t.Ia&&Ne(t),n.call(r,e)}function Me(t,e){if(t.oa)return!0;if(!fe){if(!e)t:{e=["window","event"];for(var r=n,i=0;i<e.length;i++)if(r=r[e[i]],null==r){e=null;break t}e=r}if(i=e,e=new ye(i,this),r=!0,!(0>i.keyCode||void 0!=i.returnValue)){t:{var o=!1;if(0==i.keyCode)try{i.keyCode=-1;break t}catch(s){o=!0}(o||void 0==i.returnValue)&&(i.returnValue=!0)}for(i=[],o=e.b;o;o=o.parentNode)i.push(o);for(t=t.type,o=i.length-1;0<=o;o--){e.b=i[o];var a=De(i[o],t,!0,e);r=r&&a}for(o=0;o<i.length;o++)e.b=i[o],a=De(i[o],t,!1,e),r=r&&a}return r}return je(t,new ye(e,this))}function Le(t){return t=t[Se],t instanceof ke?t:null}var Fe="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ve(t){return h(t)?t:(t[Fe]||(t[Fe]=function(e){return t.handleEvent(e)}),t[Fe])}function Be(){Kt.call(this),this.l=new ke(this),this.Rb=this,this.Va=null}function Ue(t,e,n,r,i){t.l.add(String(e),n,!1,r,i)}function qe(t,e,n,r,i){t.l.add(String(e),n,!0,r,i)}function We(t,e,n,r){if(e=t.l.a[String(e)],!e)return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.oa&&a.capture==n){var s=a.listener,u=a.La||a.src;a.Ia&&Ee(t.l,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Kb}function Ke(t,e,r){if(h(t))r&&(t=g(t,r));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=g(t.handleEvent,t)}return 2147483647<Number(e)?-1:n.setTimeout(t,e||0)}function He(t){var e=null;return new bt(function(n,r){e=Ke(function(){n(void 0)},t),-1==e&&r(Error("Failed to schedule timer."))}).s(function(t){throw n.clearTimeout(e),t})}function ze(t){if(t.S&&"function"==typeof t.S)return t.S();if(i(t))return t.split("");if(l(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function Ge(t){if(t.U&&"function"==typeof t.U)return t.U();if(!t.S||"function"!=typeof t.S){if(l(t)||i(t)){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function Qe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(l(t)||i(t))R(t,e,void 0);else for(var n=Ge(t),r=ze(t),o=r.length,a=0;a<o;a++)e.call(void 0,r[a],n&&n[a],t)}function Ye(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ye)for(n=t.U(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Xe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Je(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)r=t.a[e],Je(i,r)||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Je(t,e){return Object.prototype.hasOwnProperty.call(t,e)}w(Be,Kt),Be.prototype[me]=!0,Be.prototype.addEventListener=function(t,e,n,r){Oe(this,t,e,n,r)},Be.prototype.removeEventListener=function(t,e,n,r){Pe(this,t,e,n,r)},Be.prototype.dispatchEvent=function(t){var e,n=this.Va;if(n)for(e=[];n;n=n.Va)e.push(n);n=this.Rb;var r=t.type||t;if(i(t))t=new ve(t,n);else if(t instanceof ve)t.target=t.target||n;else{var o=t;t=new ve(r,n),ht(t,o)}if(o=!0,e)for(var a=e.length-1;0<=a;a--){var s=t.b=e[a];o=We(s,r,!0,t)&&o}if(s=t.b=n,o=We(s,r,!0,t)&&o,o=We(s,r,!1,t)&&o,e)for(a=0;a<e.length;a++)s=t.b=e[a],o=We(s,r,!1,t)&&o;return o},Be.prototype.va=function(){if(Be.ob.va.call(this),this.l){var t,e=this.l;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)0,_e(n[r]);delete e.a[t],e.b--}}this.Va=null},t=Ye.prototype,t.S=function(){Xe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},t.U=function(){return Xe(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0},t.get=function(t,e){return Je(this.b,t)?this.b[t]:e},t.set=function(t,e){Je(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},t.forEach=function(t,e){for(var n=this.U(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var $e=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ze(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function tn(t,e){if(this.b=this.l=this.c="",this.i=null,this.h=this.g="",this.f=!1,t instanceof tn){this.f=void 0!==e?e:t.f,en(this,t.c),this.l=t.l,this.b=t.b,nn(this,t.i),this.g=t.g,e=t.a;var n=new gn;n.c=e.c,e.a&&(n.a=new Ye(e.a),n.b=e.b),rn(this,n),this.h=t.h}else t&&(n=String(t).match($e))?(this.f=!!e,en(this,n[1]||"",!0),this.l=cn(n[2]||""),this.b=cn(n[3]||"",!0),nn(this,n[4]),this.g=cn(n[5]||"",!0),rn(this,n[6]||"",!0),this.h=cn(n[7]||"")):(this.f=!!e,this.a=new gn(null,this.f))}function en(t,e,n){t.c=n?cn(e,!0):e,t.c&&(t.c=t.c.replace(/:$/,""))}function nn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.i=e}else t.i=null}function rn(t,e,n){e instanceof gn?(t.a=e,Tn(t.a,t.f)):(n||(e=ln(e,vn)),t.a=new gn(e,t.f))}function on(t,e,n){t.a.set(e,n)}function an(t,e){return t.a.get(e)}function sn(t){return t instanceof tn?new tn(t):new tn(t,void 0)}function un(t,e){var n=new tn(null,void 0);return en(n,"https"),t&&(n.b=t),e&&(n.g=e),n}function cn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function ln(t,e,n){return i(t)?(t=encodeURI(t).replace(e,hn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function hn(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(15&t).toString(16)}tn.prototype.toString=function(){var t=[],e=this.c;e&&t.push(ln(e,fn,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.l)&&t.push(ln(e,fn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.i,null!=n&&t.push(":",String(n))),(n=this.g)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(ln(n,"/"==n.charAt(0)?pn:dn,!0))),(n=this.a.toString())&&t.push("?",n),(n=this.h)&&t.push("#",ln(n,yn)),t.join("")};var fn=/[#\/\?@]/g,dn=/[#\?:]/g,pn=/[#\?]/g,vn=/[#\?@]/g,yn=/#/g;function gn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function mn(t){t.a||(t.a=new Ye,t.b=0,t.c&&Ze(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function bn(t){var e=Ge(t);if("undefined"==typeof e)throw Error("Keys are undefined");var n=new gn(null,void 0);t=ze(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];c(o)?kn(n,i,o):n.add(i,o)}return n}function wn(t,e){mn(t),e=En(t,e),Je(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,t=t.a,Je(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Xe(t)))}function _n(t,e){return mn(t),e=En(t,e),Je(t.a.b,e)}function kn(t,e,n){wn(t,e),0<n.length&&(t.c=null,t.a.set(En(t,e),q(n)),t.b+=n.length)}function En(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function Tn(t,e){e&&!t.f&&(mn(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(wn(this,e),kn(this,n,t))},t)),t.f=e}t=gn.prototype,t.add=function(t,e){mn(this),this.c=null,t=En(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},t.clear=function(){this.a=this.c=null,this.b=0},t.forEach=function(t,e){mn(this),this.a.forEach(function(n,r){R(n,function(n){t.call(e,n,r,this)},this)},this)},t.U=function(){mn(this);for(var t=this.a.S(),e=this.a.U(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},t.S=function(t){mn(this);var e=[];if(i(t))_n(this,t)&&(e=U(e,this.a.get(En(this,t))));else{t=this.a.S();for(var n=0;n<t.length;n++)e=U(e,t[n])}return e},t.set=function(t,e){return mn(this),this.c=null,t=En(this,t),_n(this,t)&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},t.get=function(t,e){return t=t?this.S(t):[],0<t.length?String(t[0]):e},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.U(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.S(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var Sn=!$t||9<=Number(se);function Cn(){this.a="",this.b=An}function On(t){return t instanceof Cn&&t.constructor===Cn&&t.b===An?t.a:(S("expected object of type Const, got '"+t+"'"),"type_error:Const")}Cn.prototype.na=!0,Cn.prototype.ma=function(){return this.a},Cn.prototype.toString=function(){return"Const{"+this.a+"}"};var An={};function In(t){var e=new Cn;return e.a=t,e}function xn(){this.a="",this.b=jn}function Pn(t){return t instanceof xn&&t.constructor===xn&&t.b===jn?t.a:(S("expected object of type TrustedResourceUrl, got '"+t+"' of type "+s(t)),"type_error:TrustedResourceUrl")}function Nn(t,e){var n=On(t);if(!Dn.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return t=n.replace(Rn,function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return t=e[r],t instanceof Cn?On(t):encodeURIComponent(String(t))}),Mn(t)}In(""),xn.prototype.na=!0,xn.prototype.ma=function(){return this.a},xn.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var Rn=/%{(\w+)}/g,Dn=/^(?:https:)?\/\/[0-9a-z.:[\]-]+\/|^\/[^\/\\]|^about:blank#/i,jn={};function Mn(t){var e=new xn;return e.a=t,e}function Ln(){this.a="",this.b=Un}function Fn(t){return t instanceof Ln&&t.constructor===Ln&&t.b===Un?t.a:(S("expected object of type SafeUrl, got '"+t+"' of type "+s(t)),"type_error:SafeUrl")}Ln.prototype.na=!0,Ln.prototype.ma=function(){return this.a},Ln.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Vn=/^(?:(?:https?|mailto|ftp):|[^:\/?#]*(?:[\/?#]|$))/i;function Bn(t){return t instanceof Ln?t:(t=t.na?t.ma():String(t),Vn.test(t)||(t="about:invalid#zClosurez"),qn(t))}var Un={};function qn(t){var e=new Ln;return e.a=t,e}function Wn(){this.a="",this.b=Hn}function Kn(t){return t instanceof Wn&&t.constructor===Wn&&t.b===Hn?t.a:(S("expected object of type SafeHtml, got '"+t+"' of type "+s(t)),"type_error:SafeHtml")}qn("about:blank"),Wn.prototype.na=!0,Wn.prototype.ma=function(){return this.a},Wn.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Hn={};function zn(t){var e=new Wn;return e.a=t,e}function Gn(t){var e=document;return i(t)?e.getElementById(t):t}function Qn(t,e){ot(e,function(e,n){e&&e.na&&(e=e.ma()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:Yn.hasOwnProperty(n)?t.setAttribute(Yn[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e})}zn("<!DOCTYPE html>"),zn(""),zn("<br>");var Yn={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function Xn(t,e,n){var r=arguments,o=document,a=String(r[0]),s=r[1];if(!Sn&&s&&(s.name||s.type)){if(a=["<",a],s.name&&a.push(' name="',H(s.name),'"'),s.type){a.push(' type="',H(s.type),'"');var u={};ht(u,s),delete u.type,s=u}a.push(">"),a=a.join("")}return a=o.createElement(a),s&&(i(s)?a.className=s:c(s)?a.className=s.join(" "):Qn(a,s)),2<r.length&&Jn(o,a,r),a}function Jn(t,e,n){function r(n){n&&e.appendChild(i(n)?t.createTextNode(n):n)}for(var o=2;o<n.length;o++){var a=n[o];!l(a)||f(a)&&0<a.nodeType?r(a):R($n(a)?q(a):a,r)}}function $n(t){if(t&&"number"==typeof t.length){if(f(t))return"function"==typeof t.item||"string"==typeof t.item;if(h(t))return"function"==typeof t.item}return!1}function Zn(t){var e=[];return er(new tr,t,e),e.join("")}function tr(){}function er(t,e,n){if(null==e)n.push("null");else{if("object"==typeof e){if(c(e)){var r=e;e=r.length,n.push("[");for(var i="",o=0;o<e;o++)n.push(i),er(t,r[o],n),i=",";return void n.push("]")}if(!(e instanceof String||e instanceof Number||e instanceof Boolean)){for(r in n.push("{"),i="",e)Object.prototype.hasOwnProperty.call(e,r)&&(o=e[r],"function"!=typeof o&&(n.push(i),ir(r,n),n.push(":"),er(t,o,n),i=","));return void n.push("}")}e=e.valueOf()}switch(typeof e){case"string":ir(e,n);break;case"number":n.push(isFinite(e)&&!isNaN(e)?String(e):"null");break;case"boolean":n.push(String(e));break;case"function":n.push("null");break;default:throw Error("Unknown type: "+typeof e)}}}var nr={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},rr=/\uffff/.test("")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function ir(t,e){e.push('"',t.replace(rr,function(t){var e=nr[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),nr[t]=e),e}),'"')}function or(){var t=Ir();return $t&&!!se&&11==se||/Edge\/\d+/.test(t)}function ar(){return n.window&&n.window.location.href||self&&self.location&&self.location.href||""}function sr(t,e){e=e||n.window;var r="about:blank";t&&(r=Fn(Bn(t))),e.location.href=r}function ur(t,e){var n,r=[];for(n in t)n in e?typeof t[n]!=typeof e[n]?r.push(n):"object"==typeof t[n]&&null!=t[n]&&null!=e[n]?0<ur(t[n],e[n]).length&&r.push(n):t[n]!==e[n]&&r.push(n):r.push(n);for(n in e)n in t||r.push(n);return r}function cr(){var t=Ir();return t=Cr(t)!=Sr?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null,!(t&&30>t)&&(!$t||!se||9<se)}function lr(t){return t=(t||Ir()).toLowerCase(),!!(t.match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function hr(t){t=t||n.window;try{t.close()}catch(e){}}function fr(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(a in e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=Ir().toLowerCase(),r&&(e.target=r,tt(n,"crios/")&&(e.target="_blank")),Cr(Ir())==Tr&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof Ln?n:Bn("undefined"!=typeof n.href?n.href:String(n)),n=t.target||n.target,i=[],t)switch(a){case"width":case"height":case"top":case"left":i.push(a+"="+t[a]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(a+"="+(t[a]?1:0))}var a=i.join(",");if((it("iPhone")&&!it("iPod")&&!it("iPad")||it("iPad")||it("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(a=r.document.createElement("A"),e instanceof Ln||e instanceof Ln||(e=e.na?e.ma():String(e),Vn.test(e)||(e="about:invalid#zClosurez"),e=qn(e)),a.href=Fn(e),a.setAttribute("target",n),t.noreferrer&&a.setAttribute("rel","noreferrer"),t=document.createEvent("MouseEvent"),t.initMouseEvent("click",!0,!0,r,1),a.dispatchEvent(t),a={}):t.noreferrer?(a=r.open("",n,a),t=Fn(e),a&&(te&&tt(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),a.opener=null,In("b/12014412, meta tag with sanitized URL"),t='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+H(t)+'">',t=zn(t),a.document.write(Kn(t)),a.document.close())):(a=r.open(Fn(e),n,a))&&t.noopener&&(a.opener=null),a)try{a.focus()}catch(s){}return a}function dr(t){return new bt(function(e){function n(){He(2e3).then(function(){if(t&&!t.closed)return n();e()})}return n()})}var pr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,vr=/^[^@]+@[^@]+$/;function yr(){var t=null;return new bt(function(e){"complete"==n.document.readyState?e():(t=function(){e()},xe(window,"load",t))}).s(function(e){throw Pe(window,"load",t),e})}function gr(){return mr(void 0)?yr().then(function(){return new bt(function(t,e){var r=n.document,i=setTimeout(function(){e(Error("Cordova framework is not ready."))},1e3);r.addEventListener("deviceready",function(){clearTimeout(i),t()},!1)})}):Ot(Error("Cordova must run in an Android or iOS file scheme."))}function mr(t){return t=t||Ir(),!("file:"!==Dr()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function br(){var t=n.window;try{return!(!t||t==t.top)}catch(e){return!1}}function wr(){return"object"!==typeof n.window&&"function"===typeof n.importScripts}function _r(){return r.a.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":r.a.INTERNAL.hasOwnProperty("node")?"Node":wr()?"Worker":"Browser"}function kr(){var t=_r();return"ReactNative"===t||"Node"===t}function Er(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}var Tr="Firefox",Sr="Chrome";function Cr(t){var e=t.toLowerCase();return tt(e,"opera/")||tt(e,"opr/")||tt(e,"opios/")?"Opera":tt(e,"iemobile")?"IEMobile":tt(e,"msie")||tt(e,"trident/")?"IE":tt(e,"edge/")?"Edge":tt(e,"firefox/")?Tr:tt(e,"silk/")?"Silk":tt(e,"blackberry")?"Blackberry":tt(e,"webos")?"Webos":!tt(e,"safari/")||tt(e,"chrome/")||tt(e,"crios/")||tt(e,"android")?!tt(e,"chrome/")&&!tt(e,"crios/")||tt(e,"edge/")?tt(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":Sr:"Safari"}var Or={Uc:"FirebaseCore-web",Wc:"FirebaseUI-web"};function Ar(t,e){e=e||[];var n,r=[],i={};for(n in Or)i[Or[n]]=!0;for(n=0;n<e.length;n++)"undefined"!==typeof i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),e=r,e.length||(e=["FirebaseCore-web"]),r=_r(),"Browser"===r?(i=Ir(),r=Cr(i)):"Worker"===r&&(i=Ir(),r=Cr(i)+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function Ir(){return n.navigator&&n.navigator.userAgent||""}function xr(t,e){t=t.split("."),e=e||n;for(var r=0;r<t.length&&"object"==typeof e&&null!=e;r++)e=e[t[r]];return r!=t.length&&(e=void 0),e}function Pr(){try{var t=n.localStorage,e=Vr();if(t)return t.setItem(e,"1"),t.removeItem(e),!or()||!!n.indexedDB}catch(r){return wr()&&!!n.indexedDB}return!1}function Nr(){return(Rr()||"chrome-extension:"===Dr()||mr())&&!kr()&&Pr()&&!wr()}function Rr(){return"http:"===Dr()||"https:"===Dr()}function Dr(){return n.location&&n.location.protocol||null}function jr(t){return t=t||Ir(),!lr(t)&&Cr(t)!=Tr}function Mr(t){return"undefined"===typeof t?null:Zn(t)}function Lr(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function Fr(t){if(null!==t)return JSON.parse(t)}function Vr(t){return t||Math.floor(1e9*Math.random()).toString()}function Br(t){return t=t||Ir(),"Safari"!=Cr(t)&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Ur(){var t=n.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var r=0;r<t.CP.length;r++)t.CP[r]=null}function qr(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=Ir(),e=_r(),this.b=lr(t)||"ReactNative"===e}function Wr(){var t=n.document;return!t||"undefined"===typeof t.visibilityState||"visible"==t.visibilityState}function Kr(){var t=n.document,e=null;return Wr()||!t?Ct():new bt(function(n){e=function(){Wr()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)}).s(function(n){throw t.removeEventListener("visibilitychange",e,!1),n})}function Hr(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(n){}return null}function zr(){return!(!xr("fireauth.oauthhelper",n)&&!xr("fireauth.iframe",n))}function Gr(){var t=n.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}function Qr(){var t=n.navigator;return t&&t.serviceWorker?Ct().then(function(){return t.serviceWorker.ready}).then(function(t){return t.active||null}).s(function(){return null}):Ct(null)}qr.prototype.get=function(){var t=n.navigator;return!t||"boolean"!==typeof t.onLine||!Rr()&&"chrome-extension:"!==Dr()&&"undefined"===typeof t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Yr,Xr={};function Jr(t){Xr[t]||(Xr[t]=!0,"undefined"!==typeof console&&"function"===typeof console.warn&&console.warn(t))}try{var $r={};Object.defineProperty($r,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty($r,"abcd",{configurable:!0,enumerable:!0,value:2}),Yr=2==$r.abcd}catch(_f){Yr=!1}function Zr(t,e,n){Yr?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function ti(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&Zr(t,n,e[n])}function ei(t){var e={};return ti(e,t),e}function ni(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}function ri(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(void 0===r||null===r||""===r)return!1}return!0}function ii(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)Zr(e,n,ii(t[n]));return e}function oi(t){var e={},n=t[si],r=t[ui];if(t=t[ci],!t||t!=ai&&!n)throw Error("Invalid provider user info!");e[hi]=r||null,e[li]=n||null,Zr(this,di,t),Zr(this,fi,ii(e))}var ai="EMAIL_SIGNIN",si="email",ui="newEmail",ci="requestType",li="email",hi="fromEmail",fi="data",di="operation";function pi(t,e){this.code=yi+t,this.message=e||gi[t]||""}function vi(t){var e=t&&t.code;return e?new pi(e.substring(yi.length),t.message):null}w(pi,Error),pi.prototype.C=function(){return{code:this.code,message:this.message}},pi.prototype.toJSON=function(){return this.C()};var yi="auth/",gi={"argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The OIDC ID token requires a valid unhashed nonce.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","user-cancelled":"User did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."};function mi(t){var e=t[Ei];if("undefined"===typeof e)throw new pi("missing-continue-uri");if("string"!==typeof e||"string"===typeof e&&!e.length)throw new pi("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[bi];if(n&&"object"===typeof n){e=n[Ci];var r=n[Ti];if(n=n[Si],"string"===typeof e&&e.length){if(this.a=e,"undefined"!==typeof r&&"boolean"!==typeof r)throw new pi("argument-error",Ti+" property must be a boolean when specified.");if(this.g=!!r,"undefined"!==typeof n&&("string"!==typeof n||"string"===typeof n&&!n.length))throw new pi("argument-error",Si+" property must be a non empty string when specified.");this.b=n||null}else{if("undefined"!==typeof e)throw new pi("argument-error",Ci+" property must be a non empty string when specified.");if("undefined"!==typeof r||"undefined"!==typeof n)throw new pi("missing-android-pkg-name")}}else if("undefined"!==typeof n)throw new pi("argument-error",bi+" property must be a non null object when specified.");if(this.f=null,(e=t[ki])&&"object"===typeof e){if(e=e[Oi],"string"===typeof e&&e.length)this.f=e;else if("undefined"!==typeof e)throw new pi("argument-error",Oi+" property must be a non empty string when specified.")}else if("undefined"!==typeof e)throw new pi("argument-error",ki+" property must be a non null object when specified.");if(e=t[_i],"undefined"!==typeof e&&"boolean"!==typeof e)throw new pi("argument-error",_i+" property must be a boolean when specified.");if(this.c=!!e,t=t[wi],"undefined"!==typeof t&&("string"!==typeof t||"string"===typeof t&&!t.length))throw new pi("argument-error",wi+" property must be a non empty string when specified.");this.i=t||null}var bi="android",wi="dynamicLinkDomain",_i="handleCodeInApp",ki="iOS",Ei="url",Ti="installApp",Si="minimumVersion",Ci="packageName",Oi="bundleId";function Ai(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}function Ii(t){return j(t,function(t){return t=t.toString(16),1<t.length?t:"0"+t}).join("")}var xi=null,Pi=null;function Ni(t){var e="";return Ri(t,function(t){e+=String.fromCharCode(t)}),e}function Ri(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=Pi[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}Di();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;e(i<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}function Di(){if(!xi){xi={},Pi={};for(var t=0;65>t;t++)xi[t]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(t),Pi[xi[t]]=t,62<=t&&(Pi["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(t)]=t)}}function ji(t){this.c=t.sub,b(),this.a=t.provider_id||t.firebase&&t.firebase.sign_in_provider||null,this.b=!!t.is_anonymous||"anonymous"==this.a}function Mi(t){return(t=Li(t))&&t.sub&&t.iss&&t.aud&&t.exp?new ji(t):null}function Li(t){if(!t)return null;if(t=t.split("."),3!=t.length)return null;t=t[1];for(var e=(4-t.length%4)%4,n=0;n<e;n++)t+=".";try{return JSON.parse(Ni(t))}catch(r){}return null}ji.prototype.f=function(){return this.b};var Fi,Vi={$c:{ab:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",ib:"https://securetoken.googleapis.com/v1/token",id:"p"},bd:{ab:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",ib:"https://staging-securetoken.sandbox.googleapis.com/v1/token",id:"s"},cd:{ab:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",ib:"https://test-securetoken.sandbox.googleapis.com/v1/token",id:"t"}};function Bi(t){for(var e in Vi)if(Vi[e].id===t)return t=Vi[e],{firebaseEndpoint:t.ab,secureTokenEndpoint:t.ib};return null}Fi=Bi("__EID__")?"__EID__":void 0;var Ui="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),qi=["client_id","response_type","scope","redirect_uri","state"],Wi={Vc:{Ma:"locale",Ba:500,Aa:600,Na:"facebook.com",hb:qi},Xc:{Ma:null,Ba:500,Aa:620,Na:"github.com",hb:qi},Yc:{Ma:"hl",Ba:515,Aa:680,Na:"google.com",hb:qi},dd:{Ma:"lang",Ba:485,Aa:705,Na:"twitter.com",hb:Ui}};function Ki(t){for(var e in Wi)if(Wi[e].Na==t)return Wi[e];return null}function Hi(t){var e={};e["facebook.com"]=Xi,e["google.com"]=$i,e["github.com"]=Ji,e["twitter.com"]=Zi;var n=t&&t[Gi];try{if(n)return e[n]?new e[n](t):new Yi(t);if("undefined"!==typeof t[zi])return new Qi(t)}catch(r){}return null}var zi="idToken",Gi="providerId";function Qi(t){var e=t[Gi];if(!e&&t[zi]){var n=Mi(t[zi]);n&&n.a&&(e=n.a)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,"undefined"!==typeof t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),Zr(this,"providerId",e),Zr(this,"isNewUser",n)}function Yi(t){Qi.call(this,t),t=Fr(t.rawUserInfo||"{}"),Zr(this,"profile",ii(t||{}))}function Xi(t){if(Yi.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function Ji(t){if(Yi.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Zr(this,"username",this.profile&&this.profile.login||null)}function $i(t){if(Yi.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function Zi(t){if(Yi.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Zr(this,"username",t.screenName||null)}function to(t){this.a=sn(t)}function eo(t){var e=sn(t),n=an(e,"link"),r=an(sn(n),"link");return e=an(e,"deep_link_id"),an(sn(e),"link")||e||r||n||t}function no(t,e){return t.then(function(t){if(t[Wa]){var n=Mi(t[Wa]);if(!n||e!=n.c)throw new pi("user-mismatch");return t}throw new pi("user-mismatch")}).s(function(t){throw t&&t.code&&t.code==yi+"user-not-found"?new pi("user-mismatch"):t})}function ro(t,e){if(!e)throw new pi("internal-error","failed to construct a credential");this.a=e,Zr(this,"providerId",t),Zr(this,"signInMethod",t)}function io(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function oo(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&Zr(this,"idToken",e.idToken),e.accessToken&&Zr(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&Zr(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new pi("internal-error","failed to construct a credential");Zr(this,"accessToken",e.oauthToken),Zr(this,"secret",e.oauthTokenSecret)}Zr(this,"providerId",t),Zr(this,"signInMethod",n)}function ao(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:bn(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function so(t,e){this.Dc=e||[],ti(this,{providerId:t,isOAuthProvider:!0}),this.yb={},this.cb=(Ki(t)||{}).Ma||null,this.$a=null}function uo(t){if("string"!==typeof t||0!=t.indexOf("saml."))throw new pi("argument-error",'SAML provider IDs must be prefixed with "saml."');so.call(this,t,[])}function co(t){so.call(this,t,qi),this.a=[]}function lo(){co.call(this,"facebook.com")}function ho(t){if(!t)throw new pi("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return f(t)&&(e=t.accessToken),(new lo).credential(null,e)}function fo(){co.call(this,"github.com")}function po(t){if(!t)throw new pi("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return f(t)&&(e=t.accessToken),(new fo).credential(null,e)}function vo(){co.call(this,"google.com"),this.ua("profile")}function yo(t,e){var n=t;return f(t)&&(n=t.idToken,e=t.accessToken),(new vo).credential(n,e)}function go(){so.call(this,"twitter.com",Ui)}function mo(t,e){var n=t;if(f(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new pi("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new oo("twitter.com",n,"twitter.com")}function bo(t,e,n){this.a=t,this.c=e,Zr(this,"providerId","password"),Zr(this,"signInMethod",n===wo.EMAIL_LINK_SIGN_IN_METHOD?wo.EMAIL_LINK_SIGN_IN_METHOD:wo.EMAIL_PASSWORD_SIGN_IN_METHOD)}function wo(){ti(this,{providerId:"password",isOAuthProvider:!1})}function _o(t,e){if(e=ko(e),!e)throw new pi("argument-error","Invalid email link!");return new bo(t,e,wo.EMAIL_LINK_SIGN_IN_METHOD)}function ko(t){t=eo(t),t=new to(t);var e=an(t.a,"oobCode")||null;return"signIn"===(an(t.a,"mode")||null)&&e?e:null}function Eo(t){if(!(t.Ta&&t.Sa||t.Fa&&t.$))throw new pi("internal-error");this.a=t,Zr(this,"providerId","phone"),Zr(this,"signInMethod","phone")}function To(t){return t.a.Fa&&t.a.$?{temporaryProof:t.a.Fa,phoneNumber:t.a.$}:{sessionInfo:t.a.Ta,code:t.a.Sa}}function So(t){try{this.a=t||r.a.auth()}catch(e){throw new pi("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}ti(this,{providerId:"phone",isOAuthProvider:!1})}function Co(t,e){if(!t)throw new pi("missing-verification-id");if(!e)throw new pi("missing-verification-code");return new Eo({Ta:t,Sa:e})}function Oo(t){if(t.temporaryProof&&t.phoneNumber)return new Eo({Fa:t.temporaryProof,$:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,o=t&&t.oauthIdToken,a=t&&t.pendingToken;try{switch(e){case"google.com":return yo(o,n);case"facebook.com":return ho(n);case"github.com":return po(n);case"twitter.com":return mo(n,r);default:return n||r||o||a?a?0==e.indexOf("saml.")?new ro(e,a):new oo(e,{pendingToken:a,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new co(e).credential(o,n,i):null}}catch(s){return null}}function Ao(t){if(!t.isOAuthProvider)throw new pi("invalid-oauth-provider")}function Io(t,e,n,r,i,o){if(this.b=t,this.c=e||null,this.f=n||null,this.g=r||null,this.h=o||null,this.a=i||null,!this.f&&!this.a)throw new pi("invalid-auth-event");if(this.f&&this.a)throw new pi("invalid-auth-event");if(this.f&&!this.g)throw new pi("invalid-auth-event")}function xo(t){return t=t||{},t.type?new Io(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&vi(t.error),t.postBody):null}function Po(){this.b=null,this.a=[]}w(Yi,Qi),w(Xi,Yi),w(Ji,Yi),w($i,Yi),w(Zi,Yi),ro.prototype.la=function(t){return vs(t,io(this))},ro.prototype.b=function(t,e){var n=io(this);return n.idToken=e,ys(t,n)},ro.prototype.f=function(t,e){return no(gs(t,io(this)),e)},ro.prototype.C=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},oo.prototype.la=function(t){return vs(t,ao(this))},oo.prototype.b=function(t,e){var n=ao(this);return n.idToken=e,ys(t,n)},oo.prototype.f=function(t,e){var n=ao(this);return no(gs(t,n),e)},oo.prototype.C=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},so.prototype.Da=function(t){return this.yb=st(t),this},w(uo,so),w(co,so),co.prototype.ua=function(t){return F(this.a,t)||this.a.push(t),this},co.prototype.Eb=function(){return q(this.a)},co.prototype.credential=function(t,e,n){if(!t&&!e)throw new pi("argument-error","credential failed: must provide the ID token and/or the access token.");return new oo(this.providerId,{idToken:t||null,accessToken:e||null,nonce:n||null},this.providerId)},w(lo,co),Zr(lo,"PROVIDER_ID","facebook.com"),Zr(lo,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),w(fo,co),Zr(fo,"PROVIDER_ID","github.com"),Zr(fo,"GITHUB_SIGN_IN_METHOD","github.com"),w(vo,co),Zr(vo,"PROVIDER_ID","google.com"),Zr(vo,"GOOGLE_SIGN_IN_METHOD","google.com"),w(go,so),Zr(go,"PROVIDER_ID","twitter.com"),Zr(go,"TWITTER_SIGN_IN_METHOD","twitter.com"),bo.prototype.la=function(t){return this.signInMethod==wo.EMAIL_LINK_SIGN_IN_METHOD?zs(t,Ss,{email:this.a,oobCode:this.c}):zs(t,qs,{email:this.a,password:this.c})},bo.prototype.b=function(t,e){return this.signInMethod==wo.EMAIL_LINK_SIGN_IN_METHOD?zs(t,Cs,{idToken:e,email:this.a,oobCode:this.c}):zs(t,Ms,{idToken:e,email:this.a,password:this.c})},bo.prototype.f=function(t,e){return no(this.la(t),e)},bo.prototype.C=function(){return{email:this.a,password:this.c,signInMethod:this.signInMethod}},ti(wo,{PROVIDER_ID:"password"}),ti(wo,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),ti(wo,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),Eo.prototype.la=function(t){return t.Ua(To(this))},Eo.prototype.b=function(t,e){var n=To(this);return n.idToken=e,zs(t,Ks,n)},Eo.prototype.f=function(t,e){var n=To(this);return n.operation="REAUTH",t=zs(t,Hs,n),no(t,e)},Eo.prototype.C=function(){var t={providerId:"phone"};return this.a.Ta&&(t.verificationId=this.a.Ta),this.a.Sa&&(t.verificationCode=this.a.Sa),this.a.Fa&&(t.temporaryProof=this.a.Fa),this.a.$&&(t.phoneNumber=this.a.$),t},So.prototype.Ua=function(t,e){var n=this.a.b;return Ct(e.verify()).then(function(r){if(!i(r))throw new pi("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":return ls(n,{phoneNumber:t,recaptchaToken:r}).then(function(t){return"function"===typeof e.reset&&e.reset(),t},function(t){throw"function"===typeof e.reset&&e.reset(),t});default:throw new pi("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}})},ti(So,{PROVIDER_ID:"phone"}),ti(So,{PHONE_SIGN_IN_METHOD:"phone"}),Io.prototype.C=function(){return{type:this.b,eventId:this.c,urlResponse:this.f,sessionId:this.g,postBody:this.h,error:this.a&&this.a.C()}};var No,Ro=null;function Do(t){var e="unauthorized-domain",n=void 0,r=sn(t);t=r.b,r=r.c,"chrome-extension"==r?n=W("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=W("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",pi.call(this,e,n)}function jo(t,e,n){pi.call(this,t,n),t=e||{},t.zb&&Zr(this,"email",t.zb),t.$&&Zr(this,"phoneNumber",t.$),t.credential&&Zr(this,"credential",t.credential)}function Mo(t){if(t.code){var e=t.code||"";0==e.indexOf(yi)&&(e=e.substring(yi.length));var n={credential:Oo(t)};if(t.email)n.zb=t.email;else if(t.phoneNumber)n.$=t.phoneNumber;else if(!n.credential)return new pi(e,t.message||void 0);return new jo(e,n,t.message)}return null}function Lo(){}function Fo(t){return t.c||(t.c=t.b())}function Vo(){}function Bo(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(i){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function Uo(){}function qo(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseText="",this.status=-1,this.statusText="",this.a.onload=g(this.ec,this),this.a.onerror=g(this.Fb,this),this.a.onprogress=g(this.fc,this),this.a.ontimeout=g(this.ic,this)}function Wo(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function Ko(t,e,n){this.reset(t,e,n,void 0,void 0)}Po.prototype.subscribe=function(t){var e=this;this.a.push(t),this.b||(this.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},t=xr("universalLinks.subscribe",n),"function"===typeof t&&t(null,this.b))},Po.prototype.unsubscribe=function(t){B(this.a,function(e){return e==t})},w(Do,pi),w(jo,pi),jo.prototype.C=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber);var e=this.credential&&this.credential.C();return e&&ht(t,e),t},jo.prototype.toJSON=function(){return this.C()},Lo.prototype.c=null,w(Vo,Lo),Vo.prototype.a=function(){var t=Bo(this);return t?new ActiveXObject(t):new XMLHttpRequest},Vo.prototype.b=function(){var t={};return Bo(this)&&(t[0]=!0,t[1]=!0),t},No=new Vo,w(Uo,Lo),Uo.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new qo;throw Error("Unsupported browser")},Uo.prototype.b=function(){return{}},t=qo.prototype,t.open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},t.ec=function(){this.status=200,this.responseText=this.a.responseText,Wo(this,4)},t.Fb=function(){this.status=500,this.responseText="",Wo(this,4)},t.ic=function(){this.Fb()},t.fc=function(){this.status=200,Wo(this,1)},t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},Ko.prototype.a=null;function Ho(t){this.f=t,this.b=this.c=this.a=null}function zo(t,e){this.name=t,this.value=e}Ko.prototype.reset=function(t,e,n,r,i){"number"==typeof i||0,r||b(),delete this.a},zo.prototype.toString=function(){return this.name};var Go=new zo("SEVERE",1e3),Qo=new zo("WARNING",900),Yo=new zo("CONFIG",700),Xo=new zo("FINE",500);function Jo(t){return t.c?t.c:t.a?Jo(t.a):(S("Root logger has no level set."),null)}Ho.prototype.log=function(t,e,n){if(t.value>=Jo(this).value)for(h(e)&&(e=e()),t=new Ko(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var $o={},Zo=null;function ta(t){var e;if(Zo||(Zo=new Ho(""),$o[""]=Zo,Zo.c=Yo),!(e=$o[t])){e=new Ho(t);var n=t.lastIndexOf("."),r=t.substr(n+1);n=ta(t.substr(0,n)),n.b||(n.b={}),n.b[r]=e,e.a=n,$o[t]=e}return e}function ea(t,e){t&&t.log(Xo,e,void 0)}function na(t){this.f=t}function ra(t){Be.call(this),this.i=t,this.readyState=ia,this.status=0,this.responseText=this.statusText="",this.onreadystatechange=null,this.g=new Headers,this.b=null,this.h="GET",this.c="",this.a=!1,this.f=ta("goog.net.FetchXmlHttp")}w(na,Lo),na.prototype.a=function(){return new ra(this.f)},na.prototype.b=function(t){return function(){return t}}({}),w(ra,Be);var ia=0;function oa(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function aa(t){Be.call(this),this.headers=new Ye,this.D=t||null,this.c=!1,this.w=this.a=null,this.h=this.N=this.m="",this.f=this.I=this.i=this.G=!1,this.g=0,this.u=null,this.o=sa,this.v=this.O=!1}t=ra.prototype,t.open=function(t,e){if(this.readyState!=ia)throw this.abort(),Error("Error reopening a connection");this.h=t,this.c=e,this.readyState=1,oa(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.g,method:this.h,credentials:void 0,cache:void 0};t&&(e.body=t),this.i.fetch(new Request(this.c,e)).then(this.hc.bind(this),this.Gb.bind(this))},t.abort=function(){this.responseText="",this.g=new Headers,this.status=0,1<=this.readyState&&this.a&&4!=this.readyState&&(this.readyState=4,this.a=!1,oa(this)),this.readyState=ia},t.hc=function(t){this.a&&(this.b||(this.b=t.headers,this.readyState=2,oa(this)),this.a&&(this.readyState=3,oa(this),this.a&&t.text().then(this.gc.bind(this,t),this.Gb.bind(this))))},t.gc=function(t,e){this.a&&(this.status=t.status,this.statusText=t.statusText,this.responseText=e,this.readyState=4,oa(this))},t.Gb=function(t){var e=this.f;e&&e.log(Qo,"Failed to fetch url "+this.c,t instanceof Error?t:Error(t)),this.a&&(this.readyState=4,oa(this))},t.setRequestHeader=function(t,e){this.g.append(t,e)},t.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.f)&&t.log(Qo,"Attempting to get response header but no headers have been received for url: "+this.c,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var t=this.f;return t&&t.log(Qo,"Attempting to get all response headers but no headers have been received for url: "+this.c,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},w(aa,Be);var sa="";aa.prototype.b=ta("goog.net.XhrIo");var ua=/^https?$/i,ca=["POST","PUT"];function la(t,e,r,i,o){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.m+"; newUri="+e);r=r?r.toUpperCase():"GET",t.m=e,t.h="",t.N=r,t.G=!1,t.c=!0,t.a=t.D?t.D.a():No.a(),t.w=t.D?Fo(t.D):Fo(No),t.a.onreadystatechange=g(t.Jb,t);try{ea(t.b,_a(t,"Opening Xhr")),t.I=!0,t.a.open(r,String(e),!0),t.I=!1}catch(s){return ea(t.b,_a(t,"Error opening Xhr: "+s.message)),void da(t,s)}e=i||"";var a=new Ye(t.headers);o&&Qe(o,function(t,e){a.set(e,t)}),o=L(a.U()),i=n.FormData&&e instanceof n.FormData,!F(ca,r)||o||i||a.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),a.forEach(function(t,e){this.a.setRequestHeader(e,t)},t),t.o&&(t.a.responseType=t.o),"withCredentials"in t.a&&t.a.withCredentials!==t.O&&(t.a.withCredentials=t.O);try{ga(t),0<t.g&&(t.v=ha(t.a),ea(t.b,_a(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.v)),t.v?(t.a.timeout=t.g,t.a.ontimeout=g(t.Ga,t)):t.u=Ke(t.Ga,t.g,t)),ea(t.b,_a(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(s){ea(t.b,_a(t,"Send error: "+s.message)),da(t,s)}}function ha(t){return $t&&ce(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}function fa(t){return"content-type"==t.toLowerCase()}function da(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,pa(t),ya(t)}function pa(t){t.G||(t.G=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function va(t){if(t.c&&"undefined"!=typeof e)if(t.w[1]&&4==ma(t)&&2==ba(t))ea(t.b,_a(t,"Local request error detected and ignored"));else if(t.i&&4==ma(t))Ke(t.Jb,0,t);else if(t.dispatchEvent("readystatechange"),4==ma(t)){ea(t.b,_a(t,"Request complete")),t.c=!1;try{var r,i=ba(t);t:switch(i){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var o=!0;break t;default:o=!1}if(!(r=o)){var a;if(a=0===i){var s=String(t.m).match($e)[1]||null;if(!s&&n.self&&n.self.location){var u=n.self.location.protocol;s=u.substr(0,u.length-1)}a=!ua.test(s?s.toLowerCase():"")}r=a}if(r)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<ma(t)?t.a.statusText:""}catch(l){ea(t.b,"Can not get status: "+l.message),c=""}t.h=c+" ["+ba(t)+"]",pa(t)}}finally{ya(t)}}}function ya(t,e){if(t.a){ga(t);var n=t.a,r=t.w[0]?a:null;t.a=null,t.w=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){(t=t.b)&&t.log(Go,"Problem encountered resetting onreadystatechange: "+i.message,void 0)}}}function ga(t){t.a&&t.v&&(t.a.ontimeout=null),t.u&&(n.clearTimeout(t.u),t.u=null)}function ma(t){return t.a?t.a.readyState:0}function ba(t){try{return 2<ma(t)?t.a.status:-1}catch(e){return-1}}function wa(t){try{return t.a?t.a.responseText:""}catch(e){return ea(t.b,"Can not get responseText: "+e.message),""}}function _a(t,e){return e+" ["+t.N+" "+t.m+" "+ba(t)+"]"}function ka(t,e){this.g=[],this.v=t,this.u=e||null,this.f=this.a=!1,this.c=void 0,this.m=this.w=this.i=!1,this.h=0,this.b=null,this.l=0}function Ea(t,e,n){t.a=!0,t.c=n,t.f=!e,Aa(t)}function Ta(t){if(t.a){if(!t.m)throw new Ia(t);t.m=!1}}function Sa(t,e){Ca(t,null,e,void 0)}function Ca(t,e,n,r){t.g.push([e,n,r]),t.a&&Aa(t)}function Oa(t){return M(t.g,function(t){return h(t[1])})}function Aa(t){if(t.h&&t.a&&Oa(t)){var e=t.h,r=Na[e];r&&(n.clearTimeout(r.a),delete Na[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var i=r=!1;t.g.length&&!t.i;){var o=t.g.shift(),a=o[0],s=o[1];if(o=o[2],a=t.f?s:a)try{var u=a.call(o||t.u,e);void 0!==u&&(t.f=t.f&&(u==e||u instanceof Error),t.c=e=u),(k(e)||"function"===typeof n.Promise&&e instanceof n.Promise)&&(i=!0,t.i=!0)}catch(c){e=c,t.f=!0,Oa(t)||(r=!0)}}t.c=e,i&&(u=g(t.o,t,!0),i=g(t.o,t,!1),e instanceof ka?(Ca(e,u,i),e.w=!0):e.then(u,i)),r&&(e=new Pa(e),Na[e.a]=e,t.h=e.a)}function Ia(){E.call(this)}function xa(){E.call(this)}function Pa(t){this.a=n.setTimeout(g(this.c,this),0),this.b=t}t=aa.prototype,t.Ga=function(){"undefined"!=typeof e&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",ea(this.b,_a(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(){this.a&&this.c&&(ea(this.b,_a(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),ya(this))},t.va=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),ya(this,!0)),aa.ob.va.call(this)},t.Jb=function(){this.qa||(this.I||this.i||this.f?va(this):this.wc())},t.wc=function(){va(this)},t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.o){case sa:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(Go,"Response type "+this.o+" is not supported on this browser",void 0),null}catch(e){return ea(this.b,"Can not get response: "+e.message),null}},ka.prototype.cancel=function(t){if(this.a)this.c instanceof ka&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.v?this.v.call(this.u,this):this.m=!0,this.a||(t=new xa(this),Ta(this),Ea(this,!1,t))}},ka.prototype.o=function(t,e){this.i=!1,Ea(this,t,e)},ka.prototype.D=function(){Ta(this),Ea(this,!0,null)},ka.prototype.then=function(t,e,n){var r,i,o=new bt(function(t,e){r=t,i=e});return Ca(this,r,function(t){t instanceof xa?o.cancel():i(t)}),o.then(t,e,n)},_(ka),w(Ia,E),Ia.prototype.message="Deferred has already fired",Ia.prototype.name="AlreadyCalledError",w(xa,E),xa.prototype.message="Deferred was canceled",xa.prototype.name="CanceledError",Pa.prototype.c=function(){throw delete Na[this.a],this.b};var Na={};function Ra(t){var e={},n=e.document||document,r=Pn(t),i=document.createElement("SCRIPT"),o={Lb:i,Ga:void 0},a=new ka(ja,o),s=null,u=null!=e.timeout?e.timeout:5e3;return 0<u&&(s=window.setTimeout(function(){Ma(i,!0);var t=new Va(Fa,"Timeout reached for loading script "+r);Ta(a),Ea(a,!1,t)},u),o.Ga=s),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(Ma(i,e.fd||!1,s),a.D())},i.onerror=function(){Ma(i,!0,s);var t=new Va(La,"Error while loading script "+r);Ta(a),Ea(a,!1,t)},o=e.attributes||{},ht(o,{type:"text/javascript",charset:"UTF-8"}),Qn(i,o),i.src=Pn(t),Da(n).appendChild(i),a}function Da(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}function ja(){if(this&&this.Lb){var t=this.Lb;t&&"SCRIPT"==t.tagName&&Ma(t,!0,this.Ga)}}function Ma(t,e,r){null!=r&&n.clearTimeout(r),t.onload=a,t.onerror=a,t.onreadystatechange=a,e&&window.setTimeout(function(){t&&t.parentNode&&t.parentNode.removeChild(t)},0)}var La=0,Fa=1;function Va(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),E.call(this,n),this.code=t}function Ba(t){this.f=t}function Ua(t,e,i){if(this.b=t,t=e||{},this.i=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.l=t.secureTokenTimeout||Ka,this.f=st(t.secureTokenHeaders||Ha),this.g=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.h=t.firebaseTimeout||za,this.a=st(t.firebaseHeaders||Ga),i&&(this.a["X-Client-Version"]=i,this.f["X-Client-Version"]=i),i="Node"==_r(),i=n.XMLHttpRequest||i&&r.a.INTERNAL.node&&r.a.INTERNAL.node.XMLHttpRequest,!i&&!wr())throw new pi("internal-error","The XMLHttpRequest compatibility library was not found.");this.c=void 0,wr()?this.c=new na(self):kr()?this.c=new Ba(i):this.c=new Uo}w(Va,E),w(Ba,Lo),Ba.prototype.a=function(){return new this.f},Ba.prototype.b=function(){return{}};var qa,Wa="idToken",Ka=new qr(3e4,6e4),Ha={"Content-Type":"application/x-www-form-urlencoded"},za=new qr(3e4,6e4),Ga={"Content-Type":"application/json"};function Qa(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function Ya(t,e){e?(t.a["X-Client-Version"]=e,t.f["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.f["X-Client-Version"])}function Xa(t,e,n,r,i,o,a){cr()||wr()?t=g(t.o,t):(qa||(qa=new bt(function(t,e){Za(t,e)})),t=g(t.m,t)),t(e,n,r,i,o,a)}Ua.prototype.o=function(t,e,r,i,o,a){if(wr()&&("undefined"===typeof n.fetch||"undefined"===typeof n.Headers||"undefined"===typeof n.Request))throw new pi("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var s=new aa(this.c);if(a){s.g=Math.max(0,a);var u=setTimeout(function(){s.dispatchEvent("timeout")},a)}Ue(s,"complete",function(){u&&clearTimeout(u);var t=null;try{t=JSON.parse(wa(this))||null}catch(n){t=null}e&&e(t)}),qe(s,"ready",function(){u&&clearTimeout(u),Gt(this)}),qe(s,"timeout",function(){u&&clearTimeout(u),Gt(this),e&&e(null)}),la(s,t,r,i,o)};var Ja=In("https://apis.google.com/js/client.js?onload=%{onload}"),$a="__fcb"+Math.floor(1e6*Math.random()).toString();function Za(t,e){if(((window.gapi||{}).client||{}).request)t();else{n[$a]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))};var r=Nn(Ja,{onload:$a});Sa(Ra(r),function(){e(Error("CORS_UNSUPPORTED"))})}}function ts(t,e){return new bt(function(n,r){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?Xa(t,t.i+"?key="+encodeURIComponent(t.b),function(t){t?t.error?r(Qs(t)):t.access_token&&t.refresh_token?n(t):r(new pi("internal-error")):r(new pi("network-request-failed"))},"POST",bn(e).toString(),t.f,t.l.get()):r(new pi("internal-error"))})}function es(t,e,n,r,i,o){var a=sn(t.g+e);on(a,"key",t.b),o&&on(a,"cb",b().toString());var s="GET"==n;if(s)for(var u in r)r.hasOwnProperty(u)&&on(a,u,r[u]);return new bt(function(e,o){Xa(t,a.toString(),function(t){t?t.error?o(Qs(t,i||{})):e(t):o(new pi("network-request-failed"))},n,s?void 0:Zn(Lr(r)),t.a,t.h.get())})}function ns(t){if(t=t.email,!i(t)||!vr.test(t))throw new pi("invalid-email")}function rs(t){"email"in t&&ns(t)}function is(t,e){return zs(t,ks,{identifier:e,continueUri:Rr()?ar():"http://localhost"}).then(function(t){return t.allProviders||[]})}function os(t,e){return zs(t,ks,{identifier:e,continueUri:Rr()?ar():"http://localhost"}).then(function(t){return t.signinMethods||[]})}function as(t){return zs(t,Ps,{}).then(function(t){return t.authorizedDomains||[]})}function ss(t){if(!t[Wa])throw new pi("internal-error")}function us(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new pi("internal-error")}else{if(!t.sessionInfo)throw new pi("missing-verification-id");if(!t.code)throw new pi("missing-verification-code")}}Ua.prototype.m=function(t,e,n,r,i){var o=this;qa.then(function(){window.gapi.client.setApiKey(o.b);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})}).s(function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})})},Ua.prototype.Qa=function(){return zs(this,Ls,{})},Ua.prototype.pb=function(t,e){return zs(this,js,{idToken:t,email:e})},Ua.prototype.qb=function(t,e){return zs(this,Ms,{idToken:t,password:e})};var cs={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function ls(t,e){return zs(t,Ds,e)}function hs(t,e,n){return zs(t,Ts,{idToken:e,deleteProvider:n})}function fs(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new pi("internal-error")}function ds(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&(t=new gn(t.postBody),_n(t,"nonce")&&(e.nonce=t.get("nonce")))),e}function ps(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=Mo(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=Mo(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=Mo(t)):t.errorMessage&&(e=Gs(t.errorMessage)),e)throw e;if(!t[Wa])throw new pi("internal-error")}function vs(t,e){return e.returnIdpCredential=!0,zs(t,Fs,e)}function ys(t,e){return e.returnIdpCredential=!0,zs(t,Bs,e)}function gs(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,zs(t,Vs,e)}function ms(t){if(!t.oobCode)throw new pi("invalid-action-code")}t=Ua.prototype,t.rb=function(t,e){var n={idToken:t},r=[];return ot(cs,function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)}),r.length&&(n.deleteAttribute=r),zs(this,js,n)},t.kb=function(t,e){return t={requestType:"PASSWORD_RESET",email:t},ht(t,e),zs(this,xs,t)},t.lb=function(t,e){return t={requestType:"EMAIL_SIGNIN",email:t},ht(t,e),zs(this,As,t)},t.jb=function(t,e){return t={requestType:"VERIFY_EMAIL",idToken:t},ht(t,e),zs(this,Is,t)},t.Ua=function(t){return zs(this,Ws,t)},t.Za=function(t,e){return zs(this,Rs,{oobCode:t,newPassword:e})},t.Ja=function(t){return zs(this,ws,{oobCode:t})},t.Wa=function(t){return zs(this,bs,{oobCode:t})};var bs={endpoint:"setAccountInfo",B:ms,da:"email"},ws={endpoint:"resetPassword",B:ms,J:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e)throw new pi("internal-error")}},_s={endpoint:"signupNewUser",B:function(t){if(ns(t),!t.password)throw new pi("weak-password")},J:ss,R:!0},ks={endpoint:"createAuthUri"},Es={endpoint:"deleteAccount",T:["idToken"]},Ts={endpoint:"setAccountInfo",T:["idToken","deleteProvider"],B:function(t){if(!c(t.deleteProvider))throw new pi("internal-error")}},Ss={endpoint:"emailLinkSignin",T:["email","oobCode"],B:ns,J:ss,R:!0},Cs={endpoint:"emailLinkSignin",T:["idToken","email","oobCode"],B:ns,J:ss,R:!0},Os={endpoint:"getAccountInfo"},As={endpoint:"getOobConfirmationCode",T:["requestType"],B:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new pi("internal-error");ns(t)},da:"email"},Is={endpoint:"getOobConfirmationCode",T:["idToken","requestType"],B:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new pi("internal-error")},da:"email"},xs={endpoint:"getOobConfirmationCode",T:["requestType"],B:function(t){if("PASSWORD_RESET"!=t.requestType)throw new pi("internal-error");ns(t)},da:"email"},Ps={ub:!0,endpoint:"getProjectConfig",Ib:"GET"},Ns={ub:!0,endpoint:"getRecaptchaParam",Ib:"GET",J:function(t){if(!t.recaptchaSiteKey)throw new pi("internal-error")}},Rs={endpoint:"resetPassword",B:ms,da:"email"},Ds={endpoint:"sendVerificationCode",T:["phoneNumber","recaptchaToken"],da:"sessionInfo"},js={endpoint:"setAccountInfo",T:["idToken"],B:rs,R:!0},Ms={endpoint:"setAccountInfo",T:["idToken"],B:function(t){if(rs(t),!t.password)throw new pi("weak-password")},J:ss,R:!0},Ls={endpoint:"signupNewUser",J:ss,R:!0},Fs={endpoint:"verifyAssertion",B:fs,Oa:ds,J:ps,R:!0},Vs={endpoint:"verifyAssertion",B:fs,Oa:ds,J:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new pi("user-not-found");if(t.errorMessage)throw Gs(t.errorMessage);if(!t[Wa])throw new pi("internal-error")},R:!0},Bs={endpoint:"verifyAssertion",B:function(t){if(fs(t),!t.idToken)throw new pi("internal-error")},Oa:ds,J:ps,R:!0},Us={endpoint:"verifyCustomToken",B:function(t){if(!t.token)throw new pi("invalid-custom-token")},J:ss,R:!0},qs={endpoint:"verifyPassword",B:function(t){if(ns(t),!t.password)throw new pi("wrong-password")},J:ss,R:!0},Ws={endpoint:"verifyPhoneNumber",B:us,J:ss},Ks={endpoint:"verifyPhoneNumber",B:function(t){if(!t.idToken)throw new pi("internal-error");us(t)},J:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",Mo(t);ss(t)}},Hs={Xb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",B:us,J:ss};function zs(t,e,n){if(!ri(n,e.T))return Ot(new pi("internal-error"));var r,i=e.Ib||"POST";return Ct(n).then(e.B).then(function(){return e.R&&(n.returnSecureToken=!0),es(t,e.endpoint,i,n,e.Xb,e.ub||!1)}).then(function(t){return r=t,e.Oa?e.Oa(n,r):r}).then(e.J).then(function(){if(!e.da)return r;if(!(e.da in r))throw new pi("internal-error");return r[e.da]})}function Gs(t){return Qs({error:{errors:[{message:t}],code:400,message:t}})}function Qs(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new pi(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash"},ht(r,e||{}),e=(e=n.match(/^[^\s]+\s*:\s*(.*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new pi(r[i],e);return!e&&t&&(e=Mr(t)),new pi("internal-error",e)}function Ys(t){this.b=t,this.a=null,this.fb=Xs(this)}function Xs(t){return ru().then(function(){return new bt(function(e,n){xr("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:xr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(r){function i(){clearTimeout(o),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var o=setTimeout(function(){n(Error("Network Error"))},eu.get());r.ping(i).then(i,function(){n(Error("Network Error"))})})})})}function Js(t,e){return t.fb.then(function(){return new bt(function(n){t.a.send(e.type,e,n,xr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})})}function $s(t,e){t.fb.then(function(){t.a.register("authEvent",e,xr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}var Zs=In("https://apis.google.com/js/api.js?onload=%{onload}"),tu=new qr(3e4,6e4),eu=new qr(5e3,15e3),nu=null;function ru(){return nu||(nu=new bt(function(t,e){function r(){Ur(),xr("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Ur(),e(Error("Network Error"))},timeout:tu.get()})}if(xr("gapi.iframes.Iframe"))t();else if(xr("gapi.load"))r();else{var i="__iframefcb"+Math.floor(1e6*Math.random()).toString();n[i]=function(){xr("gapi.load")?r():e(Error("Network Error"))},i=Nn(Zs,{onload:i}),Ct(Ra(i)).s(function(){e(Error("Network Error"))})}}).s(function(t){throw nu=null,t}))}function iu(t,e,n){this.i=t,this.g=e,this.h=n,this.f=null,this.a=un(this.i,"/__/auth/iframe"),on(this.a,"apiKey",this.g),on(this.a,"appName",this.h),this.b=null,this.c=[]}function ou(t,e,n,r,i){this.o=t,this.m=e,this.c=n,this.l=r,this.h=this.g=this.i=null,this.a=i,this.f=null}function au(t){try{return r.a.app(t).auth().ya()}catch(e){return[]}}function su(t,e,n,r,i){this.m=t,this.f=e,this.b=n,this.c=r||null,this.h=i||null,this.o=this.u=this.v=null,this.g=[],this.l=this.a=null}function uu(t){var e=ar();return as(t).then(function(t){t:{var n=sn(e),r=n.c;n=n.b;for(var i=0;i<t.length;i++){var o=t[i],a=n,s=r;if(0==o.indexOf("chrome-extension://")?a=sn(o).b==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:pr.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new Do(ar())})}function cu(t){return t.l?t.l:(t.l=yr().then(function(){if(!t.u){var e=t.c,n=t.h,r=au(t.b),i=new iu(t.m,t.f,t.b);i.f=e,i.b=n,i.c=q(r||[]),t.u=i.toString()}t.i=new Ys(t.u),fu(t)}),t.l)}function lu(t){return t.o||(t.v=t.c?Ar(t.c,au(t.b)):null,t.o=new Ua(t.f,Bi(t.h),t.v)),t.o}function hu(t,e,n,r,i,o,a,s,u,c){return t=new ou(t,e,n,r,i),t.i=o,t.g=a,t.h=s,t.b=st(u||null),t.f=c,t.toString()}function fu(t){if(!t.i)throw Error("IfcHandler must be initialized!");$s(t.i,function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=xo(e.authEvent),n=0;n<t.g.length;n++)r=t.g[n](e)||r;return n={},n.status=r?"ACK":"ERROR",Ct(n)}return n.status="ERROR",Ct(n)})}function du(t){var e={type:"webStorageSupport"};return cu(t).then(function(){return Js(t.i,e)}).then(function(t){if(t&&t.length&&"undefined"!==typeof t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()})}function pu(t){if(this.a=t||r.a.INTERNAL.reactNative&&r.a.INTERNAL.reactNative.AsyncStorage,!this.a)throw new pi("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function vu(t){this.b=t,this.a={},this.c=g(this.f,this)}iu.prototype.toString=function(){return this.f?on(this.a,"v",this.f):wn(this.a.a,"v"),this.b?on(this.a,"eid",this.b):wn(this.a.a,"eid"),this.c.length?on(this.a,"fw",this.c.join(",")):wn(this.a.a,"fw"),this.a.toString()},ou.prototype.toString=function(){var t=un(this.o,"/__/auth/handler");if(on(t,"apiKey",this.m),on(t,"appName",this.c),on(t,"authType",this.l),this.a.isOAuthProvider){var e=this.a;try{var n=r.a.app(this.c).auth().ea()}catch(u){n=null}for(var i in e.$a=n,on(t,"providerId",this.a.providerId),e=this.a,n=Lr(e.yb),n)n[i]=n[i].toString();i=e.Dc,n=st(n);for(var o=0;o<i.length;o++){var a=i[o];a in n&&delete n[a]}e.cb&&e.$a&&!n[e.cb]&&(n[e.cb]=e.$a),at(n)||on(t,"customParameters",Mr(n))}if("function"===typeof this.a.Eb&&(e=this.a.Eb(),e.length&&on(t,"scopes",e.join(","))),this.i?on(t,"redirectUrl",this.i):wn(t.a,"redirectUrl"),this.g?on(t,"eventId",this.g):wn(t.a,"eventId"),this.h?on(t,"v",this.h):wn(t.a,"v"),this.b)for(var s in this.b)this.b.hasOwnProperty(s)&&!an(t,s)&&on(t,s,this.b[s]);return this.f?on(t,"eid",this.f):wn(t.a,"eid"),s=au(this.c),s.length&&on(t,"fw",s.join(",")),t.toString()},t=su.prototype,t.Ea=function(t,e,n){var r=new pi("popup-closed-by-user"),i=new pi("web-storage-unsupported"),o=this,a=!1;return this.ga().then(function(){du(o).then(function(n){n||(t&&hr(t),e(i),a=!0)})}).s(function(){}).then(function(){if(!a)return dr(t)}).then(function(){if(!a)return He(n).then(function(){e(r)})})},t.Mb=function(){var t=Ir();return!jr(t)&&!Br(t)},t.Hb=function(){return!1},t.Cb=function(t,e,n,r,i,o,a){if(!t)return Ot(new pi("popup-blocked"));if(a&&!jr())return this.ga().s(function(e){hr(t),i(e)}),r(),Ct();this.a||(this.a=uu(lu(this)));var s=this;return this.a.then(function(){var e=s.ga().s(function(e){throw hr(t),i(e),e});return r(),e}).then(function(){if(Ao(n),!a){var r=hu(s.m,s.f,s.b,e,n,null,o,s.c,void 0,s.h);sr(r,t)}}).s(function(t){throw"auth/network-request-failed"==t.code&&(s.a=null),t})},t.Ca=function(t,e,n){this.a||(this.a=uu(lu(this)));var r=this;return this.a.then(function(){Ao(e);var i=hu(r.m,r.f,r.b,t,e,ar(),n,r.c,void 0,r.h);sr(i)}).s(function(t){throw"auth/network-request-failed"==t.code&&(r.a=null),t})},t.ga=function(){var t=this;return cu(this).then(function(){return t.i.fb}).s(function(){throw t.a=null,new pi("network-request-failed")})},t.Qb=function(){return!0},t.wa=function(t){this.g.push(t)},t.Ka=function(t){B(this.g,function(e){return e==t})},t=pu.prototype,t.get=function(t){return Ct(this.a.getItem(t)).then(function(t){return t&&Fr(t)})},t.set=function(t,e){return Ct(this.a.setItem(t,Mr(e)))},t.P=function(t){return Ct(this.a.removeItem(t))},t.Y=function(){},t.ca=function(){};var yu,gu=[];function mu(){var t=wr()?self:null;if(R(gu,function(n){n.b==t&&(e=n)}),!e){var e=new vu(t);gu.push(e)}return e}function bu(t){this.a=t}function wu(t){this.c=t,this.b=!1,this.a=[]}function _u(t,e,n,r){var i,o,a,s,u=n||{},c=null;if(t.b)return Ot(Error("connection_unavailable"));var l=r?800:50,h="undefined"!==typeof MessageChannel?new MessageChannel:null;return new bt(function(n,r){h?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),h.port1.start(),a=setTimeout(function(){r(Error("unsupported_event"))},l),o=function(t){t.data.eventId===i&&("ack"===t.data.status?(clearTimeout(a),s=setTimeout(function(){r(Error("timeout"))},3e3)):"done"===t.data.status?(clearTimeout(s),"undefined"!==typeof t.data.response?n(t.data.response):r(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),r(Error("invalid_response"))))},c={messageChannel:h,onMessage:o},t.a.push(c),h.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:i,data:u},[h.port2])):r(Error("connection_unavailable"))}).then(function(e){return ku(t,c),e}).s(function(e){throw ku(t,c),e})}function ku(t,e){if(e){var n=e.messageChannel,r=e.onMessage;n&&(n.port1.removeEventListener("message",r),n.port1.close()),B(t.a,function(t){return t==e})}}function Eu(){if(!Ou())throw new pi("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=n.indexedDB,this.type="indexedDB",this.g=this.l=this.f=this.i=null,this.u=!1,this.h=null;var t=this;wr()&&self?(this.l=mu(),this.l.subscribe("keyChanged",function(e,n){return Nu(t).then(function(e){return 0<e.length&&R(t.a,function(t){t(e)}),{keyProcessed:F(e,n.key)}})}),this.l.subscribe("ping",function(){return Ct(["keyChanged"])})):Qr().then(function(e){(t.h=e)&&(t.g=new wu(new bu(e)),_u(t.g,"ping",null,!0).then(function(e){e[0].fulfilled&&F(e[0].value,"keyChanged")&&(t.u=!0)}).s(function(){}))})}function Tu(t){return new bt(function(e,n){var r=t.m.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){e()},r.onerror=function(t){n(Error(t.target.error))}})}function Su(t){return new bt(function(e,n){var r=t.m.open("firebaseLocalStorageDb",1);r.onerror=function(t){try{t.preventDefault()}catch(e){}n(Error(t.target.error))},r.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(e){n(e)}},r.onsuccess=function(r){r=r.target.result,r.objectStoreNames.contains("firebaseLocalStorage")?e(r):Tu(t).then(function(){return Su(t)}).then(function(t){e(t)}).s(function(t){n(t)})}})}function Cu(t){return t.o||(t.o=Su(t)),t.o}function Ou(){try{return!!n.indexedDB}catch(_f){return!1}}function Au(t){return t.objectStore("firebaseLocalStorage")}function Iu(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function xu(t){return new bt(function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}})}function Pu(t,e){return t.g&&t.h&&Gr()===t.h?_u(t.g,"keyChanged",{key:e},t.u).then(function(){}).s(function(){}):Ct()}function Nu(t){return Cu(t).then(function(t){var e=Au(Iu(t,!1));return e.getAll?xu(e.getAll()):new bt(function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e["continue"]()):t(r)},i.onerror=function(t){n(t.target.error)}})}).then(function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=ur(t.c,n),t.c=n}return r})}function Ru(t){function e(){t.f=setTimeout(function(){t.i=Nu(t).then(function(e){0<e.length&&R(t.a,function(t){t(e)})}).then(function(){e()}).s(function(t){"STOP_EVENT"!=t.message&&e()})},800)}Du(t),e()}function Du(t){t.i&&t.i.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function ju(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=Ct().then(function(){if(Ou()){var t=Vr(),r="__sak"+t;return yu||(yu=new Eu),n=yu,n.set(r,t).then(function(){return n.get(r)}).then(function(e){if(e!==t)throw Error("indexedDB not supported!");return n.P(r)}).then(function(){return n}).s(function(){return e.c})}return e.c}).then(function(t){return e.type=t.type,t.Y(function(t){R(e.a,function(e){e(t)})}),t})}function Mu(){this.a={},this.type="inMemory"}function Lu(){if(!Vu()){if("Node"==_r())throw new pi("internal-error","The LocalStorage compatibility library was not found.");throw new pi("web-storage-unsupported")}this.a=Fu()||r.a.INTERNAL.node.localStorage,this.type="localStorage"}function Fu(){try{var t=n.localStorage,e=Vr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(r){return null}}function Vu(){var t="Node"==_r();if(t=Fu()||t&&r.a.INTERNAL.node&&r.a.INTERNAL.node.localStorage,!t)return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}function Bu(){this.type="nullStorage"}function Uu(){if(!Wu()){if("Node"==_r())throw new pi("internal-error","The SessionStorage compatibility library was not found.");throw new pi("web-storage-unsupported")}this.a=qu()||r.a.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function qu(){try{var t=n.sessionStorage,e=Vr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(r){return null}}function Wu(){var t="Node"==_r();if(t=qu()||t&&r.a.INTERNAL.node&&r.a.INTERNAL.node.sessionStorage,!t)return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}function Ku(){var t={};t.Browser=Gu,t.Node=Qu,t.ReactNative=Yu,t.Worker=Xu,this.a=t[_r()]}vu.prototype.f=function(t){var e=t.data.eventType,n=t.data.eventId,r=this.a[e];if(r&&0<r.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var i=[];R(r,function(e){i.push(Ct().then(function(){return e(t.origin,t.data.data)}))}),xt(i).then(function(r){var i=[];R(r,function(t){i.push({fulfilled:t.Db,value:t.value,reason:t.reason?t.reason.message:void 0})}),R(i,function(t){for(var e in t)"undefined"===typeof t[e]&&delete t[e]}),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:i})})}},vu.prototype.subscribe=function(t,e){at(this.a)&&this.b.addEventListener("message",this.c),"undefined"===typeof this.a[t]&&(this.a[t]=[]),this.a[t].push(e)},vu.prototype.unsubscribe=function(t,e){"undefined"!==typeof this.a[t]&&e?(B(this.a[t],function(t){return t==e}),0==this.a[t].length&&delete this.a[t]):e||delete this.a[t],at(this.a)&&this.b.removeEventListener("message",this.c)},bu.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},wu.prototype.close=function(){for(;0<this.a.length;)ku(this,this.a[0]);this.b=!0},t=Eu.prototype,t.set=function(t,e){var n,r=!1,i=this;return Cu(this).then(function(e){return n=e,e=Au(Iu(n,!0)),xu(e.get(t))}).then(function(o){var a=Au(Iu(n,!0));return o?(o.value=e,xu(a.put(o))):(i.b++,r=!0,o={},o.fbase_key=t,o.value=e,xu(a.add(o)))}).then(function(){return i.c[t]=e,Pu(i,t)}).ia(function(){r&&i.b--})},t.get=function(t){return Cu(this).then(function(e){return xu(Au(Iu(e,!1)).get(t))}).then(function(t){return t&&t.value})},t.P=function(t){var e=!1,n=this;return Cu(this).then(function(r){return e=!0,n.b++,xu(Au(Iu(r,!0))["delete"](t))}).then(function(){return delete n.c[t],Pu(n,t)}).ia(function(){e&&n.b--})},t.Y=function(t){0==this.a.length&&Ru(this),this.a.push(t)},t.ca=function(t){B(this.a,function(e){return e==t}),0==this.a.length&&Du(this)},t=ju.prototype,t.get=function(t){return this.b.then(function(e){return e.get(t)})},t.set=function(t,e){return this.b.then(function(n){return n.set(t,e)})},t.P=function(t){return this.b.then(function(e){return e.P(t)})},t.Y=function(t){this.a.push(t)},t.ca=function(t){B(this.a,function(e){return e==t})},t=Mu.prototype,t.get=function(t){return Ct(this.a[t])},t.set=function(t,e){return this.a[t]=e,Ct()},t.P=function(t){return delete this.a[t],Ct()},t.Y=function(){},t.ca=function(){},t=Lu.prototype,t.get=function(t){var e=this;return Ct().then(function(){var n=e.a.getItem(t);return Fr(n)})},t.set=function(t,e){var n=this;return Ct().then(function(){var r=Mr(e);null===r?n.P(t):n.a.setItem(t,r)})},t.P=function(t){var e=this;return Ct().then(function(){e.a.removeItem(t)})},t.Y=function(t){n.window&&Oe(n.window,"storage",t)},t.ca=function(t){n.window&&Pe(n.window,"storage",t)},t=Bu.prototype,t.get=function(){return Ct(null)},t.set=function(){return Ct()},t.P=function(){return Ct()},t.Y=function(){},t.ca=function(){},t=Uu.prototype,t.get=function(t){var e=this;return Ct().then(function(){var n=e.a.getItem(t);return Fr(n)})},t.set=function(t,e){var n=this;return Ct().then(function(){var r=Mr(e);null===r?n.P(t):n.a.setItem(t,r)})},t.P=function(t){var e=this;return Ct().then(function(){e.a.removeItem(t)})},t.Y=function(){},t.ca=function(){};var Hu,zu,Gu={A:Lu,Ra:Uu},Qu={A:Lu,Ra:Uu},Yu={A:pu,Ra:Bu},Xu={A:Lu,Ra:Bu},Ju={Zc:"local",NONE:"none",ad:"session"};function $u(t){var e=new pi("invalid-persistence-type"),n=new pi("unsupported-persistence-type");t:{for(r in Ju)if(Ju[r]==t){var r=!0;break t}r=!1}if(!r||"string"!==typeof t)throw e;switch(_r()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;default:if(!Pr()&&"none"!==t)throw n}}function Zu(){var t=!(Br(Ir())||!br()),e=jr(),r=Pr();this.o=t,this.h=e,this.l=r,this.a={},Hu||(Hu=new Ku),t=Hu;try{this.g=!or()&&zr()||!n.indexedDB?new t.a.A:new ju(wr()?new Mu:new t.a.A)}catch(i){this.g=new Mu,this.h=!0}try{this.i=new t.a.Ra}catch(i){this.i=new Mu}this.m=new Mu,this.f=g(this.Pb,this),this.b={}}function tc(){return zu||(zu=new Zu),zu}function ec(t,e){switch(e){case"session":return t.i;case"none":return t.m;default:return t.g}}function nc(t,e){return"firebase:"+t.name+(e?":"+e:"")}function rc(t,e,r){var i=nc(e,r),o=ec(t,e.A);return t.get(e,r).then(function(a){var s=null;try{s=Fr(n.localStorage.getItem(i))}catch(u){}if(s&&!a)return n.localStorage.removeItem(i),t.set(e,s,r);s&&a&&"localStorage"!=o.type&&n.localStorage.removeItem(i)})}function ic(t,e,n){return n=nc(e,n),"local"==e.A&&(t.b[n]=null),ec(t,e.A).P(n)}function oc(t){ac(t),t.c=setInterval(function(){for(var e in t.a){var r=n.localStorage.getItem(e),i=t.b[e];r!=i&&(t.b[e]=r,r=new ye({type:"storage",key:e,target:window,oldValue:i,newValue:r,a:!0}),t.Pb(r))}},1e3)}function ac(t){t.c&&(clearInterval(t.c),t.c=null)}function sc(t){this.a=t,this.b=tc()}t=Zu.prototype,t.get=function(t,e){return ec(this,t.A).get(nc(t,e))},t.set=function(t,e,n){var r=nc(t,n),i=this,o=ec(this,t.A);return o.set(r,e).then(function(){return o.get(r)}).then(function(e){"local"==t.A&&(i.b[r]=e)})},t.addListener=function(t,e,r){t=nc(t,e),this.l&&(this.b[t]=n.localStorage.getItem(t)),at(this.a)&&(ec(this,"local").Y(this.f),this.h||(or()||!zr())&&n.indexedDB||!this.l||oc(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(r)},t.removeListener=function(t,e,n){t=nc(t,e),this.a[t]&&(B(this.a[t],function(t){return t==n}),0==this.a[t].length&&delete this.a[t]),at(this.a)&&(ec(this,"local").ca(this.f),ac(this))},t.Pb=function(t){if(t&&t.f){var e=t.a.key;if(null==e)for(var r in this.a){var i=this.b[r];"undefined"===typeof i&&(i=null);var o=n.localStorage.getItem(r);o!==i&&(this.b[r]=o,this.Xa(r))}else if(0==e.indexOf("firebase:")&&this.a[e]){if("undefined"!==typeof t.a.a?ec(this,"local").ca(this.f):ac(this),this.o)if(r=n.localStorage.getItem(e),i=t.a.newValue,i!==r)null!==i?n.localStorage.setItem(e,i):n.localStorage.removeItem(e);else if(this.b[e]===i&&"undefined"===typeof t.a.a)return;var a=this;r=function(){"undefined"===typeof t.a.a&&a.b[e]===n.localStorage.getItem(e)||(a.b[e]=n.localStorage.getItem(e),a.Xa(e))},$t&&se&&10==se&&n.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(r,10):r()}}else R(t,g(this.Xa,this))},t.Xa=function(t){this.a[t]&&R(this.a[t],function(t){t()})};var uc,cc={name:"authEvent",A:"local"};function lc(t){return t.b.get(cc,t.a).then(function(t){return xo(t)})}function hc(){this.a=tc()}function fc(){this.b=-1}function dc(t,e){this.b=pc,this.f=n.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=n.Int32Array?new Int32Array(64):Array(64),void 0!==uc||(uc=n.Int32Array?new Int32Array(_c):_c),this.reset()}w(dc,fc);for(var pc=64,vc=pc-1,yc=[],gc=0;gc<vc;gc++)yc[gc]=0;var mc=U(128,yc);function bc(t){for(var e=t.f,n=t.l,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){i=0|n[e-15],r=0|n[e-2];var o=(0|n[e-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[e-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+a|0}r=0|t.a[0],i=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],l=0|t.a[5],h=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=c&l^~c&h,o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0,a=a+(0|uc[e])|0,a=o+(a+(0|n[e])|0)|0,o=h,h=l,l=c,c=u+a|0,u=s,s=i,i=r,r=a+f|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+l|0,t.a[6]=t.a[6]+h|0,t.a[7]=t.a[7]+o|0}function wc(t,e,n){void 0===n&&(n=e.length);var r=0,o=t.c;if(i(e))for(;r<n;)t.f[o++]=e.charCodeAt(r++),o==t.b&&(bc(t),o=0);else{if(!l(e))throw Error("message must be string or array");for(;r<n;){var a=e[r++];if(!("number"==typeof a&&0<=a&&255>=a&&a==(0|a)))throw Error("message must be a byte array");t.f[o++]=a,o==t.b&&(bc(t),o=0)}}t.c=o,t.g+=n}dc.prototype.reset=function(){this.g=this.c=0,this.a=n.Int32Array?new Int32Array(this.h):q(this.h)};var _c=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function kc(){dc.call(this,8,Ec)}w(kc,dc);var Ec=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function Tc(t,e,n,r,i){this.m=t,this.i=e,this.l=n,this.o=r||null,this.u=i||null,this.h=e+":"+n,this.v=new hc,this.g=new sc(this.h),this.f=null,this.b=[],this.a=this.c=null}function Sc(t){return new pi("invalid-cordova-configuration",t)}function Cc(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}function Oc(t){var e=new kc;wc(e,t),t=[];var n=8*e.g;56>e.c?wc(e,mc,56-e.c):wc(e,mc,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(bc(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return Ii(t)}function Ac(t,e,r,i){var o=Cc(),a=new Io(e,i,null,o,new pi("no-auth-event")),s=xr("BuildInfo.packageName",n);if("string"!==typeof s)throw new pi("invalid-cordova-configuration");var u=xr("BuildInfo.displayName",n),c={};if(Ir().toLowerCase().match(/iphone|ipad|ipod/))c.ibi=s;else{if(!Ir().toLowerCase().match(/android/))return Ot(new pi("operation-not-supported-in-this-environment"));c.apn=s}u&&(c.appDisplayName=u),o=Oc(o),c.sessionId=o;var l=hu(t.m,t.i,t.l,e,r,null,i,t.o,c,t.u);return t.ga().then(function(){var e=t.h;return t.v.a.set(cc,a.C(),e)}).then(function(){var e=xr("cordova.plugins.browsertab.isAvailable",n);if("function"!==typeof e)throw new pi("invalid-cordova-configuration");var r=null;e(function(e){if(e){if(r=xr("cordova.plugins.browsertab.openUrl",n),"function"!==typeof r)throw new pi("invalid-cordova-configuration");r(l)}else{if(r=xr("cordova.InAppBrowser.open",n),"function"!==typeof r)throw new pi("invalid-cordova-configuration");e=Ir(),e=!(!e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)&&!e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)),t.a=r(l,e?"_blank":"_system","location=yes")}})})}function Ic(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(r){}}function xc(t){return t.f||(t.f=t.ga().then(function(){return new bt(function(e){function n(r){return e(r),t.Ka(n),!1}t.wa(n),Nc(t)})})),t.f}function Pc(t){var e=null;return lc(t.g).then(function(n){return e=n,n=t.g,ic(n.b,cc,n.a)}).then(function(){return e})}function Nc(t){function e(e){i=!0,o&&o.cancel(),Pc(t).then(function(n){var i=r;if(n&&e&&e.url){var o=null;i=eo(e.url),-1!=i.indexOf("/__/auth/callback")&&(o=sn(i),o=Fr(an(o,"firebaseError")||null),o=(o="object"===typeof o?vi(o):null)?new Io(n.b,n.c,null,null,o):new Io(n.b,n.c,i,n.g)),i=o||r}Ic(t,i)})}var r=new Io("unknown",null,null,null,new pi("no-auth-event")),i=!1,o=He(500).then(function(){return Pc(t).then(function(){i||Ic(t,r)})}),a=n.handleOpenURL;n.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(xr("BuildInfo.packageName",n).toLowerCase()+"://")&&e({url:t}),"function"===typeof a)try{a(t)}catch(r){console.error(r)}},Ro||(Ro=new Po),Ro.subscribe(e)}function Rc(t){this.a=t,this.b=tc()}t=Tc.prototype,t.ga=function(){return this.za?this.za:this.za=gr().then(function(){if("function"!==typeof xr("universalLinks.subscribe",n))throw Sc("cordova-universal-links-plugin-fix is not installed");if("undefined"===typeof xr("BuildInfo.packageName",n))throw Sc("cordova-plugin-buildinfo is not installed");if("function"!==typeof xr("cordova.plugins.browsertab.openUrl",n))throw Sc("cordova-plugin-browsertab is not installed");if("function"!==typeof xr("cordova.InAppBrowser.open",n))throw Sc("cordova-plugin-inappbrowser is not installed")},function(){throw new pi("cordova-not-ready")})},t.Ea=function(t,e){return e(new pi("operation-not-supported-in-this-environment")),Ct()},t.Cb=function(){return Ot(new pi("operation-not-supported-in-this-environment"))},t.Qb=function(){return!1},t.Mb=function(){return!0},t.Hb=function(){return!0},t.Ca=function(t,e,r){if(this.c)return Ot(new pi("redirect-operation-pending"));var i=this,o=n.document,a=null,s=null,u=null,c=null;return this.c=Ct().then(function(){return Ao(e),xc(i)}).then(function(){return Ac(i,t,e,r)}).then(function(){return new bt(function(t,e){s=function(){var e=xr("cordova.plugins.browsertab.close",n);return t(),"function"===typeof e&&e(),i.a&&"function"===typeof i.a.close&&(i.a.close(),i.a=null),!1},i.wa(s),u=function(){a||(a=He(2e3).then(function(){e(new pi("redirect-cancelled-by-user"))}))},c=function(){Wr()&&u()},o.addEventListener("resume",u,!1),Ir().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",c,!1)}).s(function(t){return Pc(i).then(function(){throw t})})}).ia(function(){u&&o.removeEventListener("resume",u,!1),c&&o.removeEventListener("visibilitychange",c,!1),a&&a.cancel(),s&&i.Ka(s),i.c=null})},t.wa=function(t){this.b.push(t),xc(this).s(function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Io("unknown",null,null,null,new pi("no-auth-event")),t(e))})},t.Ka=function(t){B(this.b,function(e){return e==t})};var Dc={name:"pendingRedirect",A:"session"};function jc(t){return t.b.set(Dc,"pending",t.a)}function Mc(t){return ic(t.b,Dc,t.a)}function Lc(t){return t.b.get(Dc,t.a).then(function(t){return"pending"==t})}function Fc(t,e,n){this.u=t,this.l=e,this.m=n,this.h=[],this.f=!1,this.i=g(this.bb,this),this.b=new Qc,this.o=new el,this.g=new Rc(this.l+":"+this.m),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.o,this.c.linkViaPopup=this.o,this.c.reauthViaPopup=this.o,this.a=Vc(this.u,this.l,this.m,Fi)}function Vc(t,e,n,i){var o=r.a.SDK_VERSION||null;return mr()?new Tc(t,e,n,o,i):new su(t,e,n,o,i)}function Bc(t){t.f||(t.f=!0,t.a.wa(t.i));var e=t.a;return t.a.ga().s(function(n){throw t.a==e&&t.reset(),n})}function Uc(t){t.a.Mb()&&Bc(t).s(function(e){var n=new Io("unknown",null,null,null,new pi("operation-not-supported-in-this-environment"));Hc(e)&&t.bb(n)}),t.a.Hb()||Yc(t.b)}t=Fc.prototype,t.reset=function(){this.f=!1,this.a.Ka(this.i),this.a=Vc(this.u,this.l,this.m)},t.Ya=function(){this.b.Ya()},t.subscribe=function(t){if(F(this.h,t)||this.h.push(t),!this.f){var e=this;Lc(this.g).then(function(t){t?Mc(e.g).then(function(){Bc(e).s(function(t){var n=new Io("unknown",null,null,null,new pi("operation-not-supported-in-this-environment"));Hc(t)&&e.bb(n)})}):Uc(e)}).s(function(){Uc(e)})}},t.unsubscribe=function(t){B(this.h,function(e){return e==t})},t.bb=function(t){if(!t)throw new pi("invalid-auth-event");for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.vb(t.b,t.c)){(e=this.c[t.b])&&e.h(t,r),e=!0;break}}return Yc(this.b),e};var qc=new qr(2e3,1e4),Wc=new qr(3e4,6e4);function Kc(t,e,n,r,i,o){return t.a.Cb(e,n,r,function(){t.f||(t.f=!0,t.a.wa(t.i))},function(){t.reset()},i,o)}function Hc(t){return!(!t||"auth/cordova-not-ready"!=t.code)}Fc.prototype.fa=function(){return this.b.fa()},Fc.prototype.Ca=function(t,e,n){var r,i=this;return jc(this.g).then(function(){return i.a.Ca(t,e,n).s(function(t){if(Hc(t))throw new pi("operation-not-supported-in-this-environment");return r=t,Mc(i.g).then(function(){throw r})}).then(function(){return i.a.Qb()?new bt(function(){}):Mc(i.g).then(function(){return i.fa()}).then(function(){}).s(function(){})})})},Fc.prototype.Ea=function(t,e,n,r){return this.a.Ea(n,function(n){t.ha(e,null,n,r)},qc.get())};var zc={};function Gc(t,e,n){var r=e+":"+n;return zc[r]||(zc[r]=new Fc(t,e,n)),zc[r]}function Qc(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Yc(t){t.g||(t.g=!0,Zc(t,!1,null,null))}function Xc(t,e,n){n=n.xa(e.b,e.c);var r=e.f,i=e.g,o=e.h,a=!!e.b.match(/Redirect$/);n(r,i,o).then(function(e){Zc(t,a,e,null)}).s(function(e){Zc(t,a,null,e)})}function Jc(t,e){if(t.b=function(){return Ot(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}function $c(t,e){if(t.b=function(){return Ct(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function Zc(t,e,n,r){e?r?Jc(t,r):$c(t,n):$c(t,{user:null}),t.f=[],t.c=[]}function tl(t){var e=new pi("timeout");t.a&&t.a.cancel(),t.a=He(Wc.get()).then(function(){t.b||(t.g=!0,Zc(t,!0,null,e))})}function el(){}function nl(t,e){var n=t.c,r=t.b;e.xa(r,n)(t.f,t.g,t.h).then(function(t){e.ha(r,t,null,n)}).s(function(t){e.ha(r,null,t,n)})}function rl(){this.sb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.sb},set:function(t){this.sb=t},enumerable:!1})}function il(t,e){this.a=e,Zr(this,"verificationId",t)}function ol(t,e,n,r){return new So(t).Ua(e,n).then(function(t){return new il(t,r)})}function al(t){var e=Li(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new pi("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");ti(this,{token:t,expirationTime:Hr(1e3*e.exp),authTime:Hr(1e3*e.auth_time),issuedAtTime:Hr(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,claims:e})}function sl(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function ul(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}function cl(t,e){t.stop(),t.b=He(ul(t,e)).then(function(){return Kr()}).then(function(){return t.h()}).then(function(){cl(t,!0)}).s(function(e){t.i(e)&&cl(t,!1)})}function ll(t){this.f=t,this.b=this.a=null,this.c=0}function hl(t,e){var n=e[Wa],r=e.refreshToken;e=dl(e.expiresIn),t.b=n,t.c=e,t.a=r}function fl(t,e){t.b=e.b,t.a=e.a,t.c=e.c}function dl(t){return b()+1e3*parseInt(t,10)}function pl(t,e){return ts(t.f,e).then(function(e){return t.b=e.access_token,t.c=dl(e.expires_in),t.a=e.refresh_token,{accessToken:t.b,expirationTime:t.c,refreshToken:t.a}}).s(function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e})}function vl(t,e){this.a=t||null,this.b=e||null,ti(this,{lastSignInTime:Hr(e||null),creationTime:Hr(t||null)})}function yl(t){return new vl(t.a,t.b)}function gl(t,e,n,r,i,o){ti(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function ml(t,e){for(var n in ve.call(this,t),e)this[n]=e[n]}function bl(t,e,n){this.G=[],this.m=t.apiKey,this.o=t.appName,this.u=t.authDomain||null,t=r.a.SDK_VERSION?Ar(r.a.SDK_VERSION):null,this.b=new Ua(this.m,Bi(Fi),t),this.h=new ll(this.b),Ol(this,e[Wa]),hl(this.h,e),Zr(this,"refreshToken",this.h.a),Pl(this,n||{}),Be.call(this),this.I=!1,this.u&&Nr()&&(this.a=Gc(this.u,this.m,this.o)),this.N=[],this.i=null,this.w=Tl(this),this.V=g(this.Ha,this);var i=this;this.ka=null,this.ta=function(t){i.pa(t.g)},this.X=null,this.O=[],this.sa=function(t){_l(i,t.c)},this.W=null}function wl(t,e){t.X&&Pe(t.X,"languageCodeChanged",t.ta),(t.X=e)&&Oe(e,"languageCodeChanged",t.ta)}function _l(t,e){t.O=e,Ya(t.b,r.a.SDK_VERSION?Ar(r.a.SDK_VERSION,t.O):null)}function kl(t,e){t.W&&Pe(t.W,"frameworkChanged",t.sa),(t.W=e)&&Oe(e,"frameworkChanged",t.sa)}function El(t){try{return r.a.app(t.o).auth()}catch(e){throw new pi("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.o+"'!")}}function Tl(t){return new sl(function(){return t.F(!0)},function(t){return!(!t||"auth/network-request-failed"!=t.code)},function(){var e=t.h.c-b()-3e5;return 0<e?e:0})}function Sl(t){t.D||t.w.b||(t.w.start(),Pe(t,"tokenChanged",t.V),Oe(t,"tokenChanged",t.V))}function Cl(t){Pe(t,"tokenChanged",t.V),t.w.stop()}function Ol(t,e){t.ra=e,Zr(t,"_lat",e)}function Al(t,e){B(t.N,function(t){return t==e})}function Il(t){for(var e=[],n=0;n<t.N.length;n++)e.push(t.N[n](t));return xt(e).then(function(){return t})}function xl(t){t.a&&!t.I&&(t.I=!0,t.a.subscribe(t))}function Pl(t,e){ti(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,metadata:new vl(e.createdAt,e.lastLoginAt),providerData:[]})}function Nl(){}function Rl(t){return Ct().then(function(){if(t.D)throw new pi("app-deleted")})}function Dl(t){return j(t.providerData,function(t){return t.providerId})}function jl(t,e){e&&(Ml(t,e.providerId),t.providerData.push(e))}function Ml(t,e){B(t.providerData,function(t){return t.providerId==e})}function Ll(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&Zr(t,e,n)}function Fl(t,e){t!=e&&(ti(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,providerData:[]}),e.metadata?Zr(t,"metadata",yl(e.metadata)):Zr(t,"metadata",new vl),R(e.providerData,function(e){jl(t,e)}),fl(t.h,e.h),Zr(t,"refreshToken",t.h.a))}function Vl(t){return t.F().then(function(e){var n=t.isAnonymous;return Ul(t,e).then(function(){return n||Ll(t,"isAnonymous",!1),e})})}function Bl(t,e){e[Wa]&&t.ra!=e[Wa]&&(hl(t.h,e),t.dispatchEvent(new ml("tokenChanged")),Ol(t,e[Wa]),Ll(t,"refreshToken",t.h.a))}function Ul(t,e){return zs(t.b,Os,{idToken:e}).then(g(t.xc,t))}function ql(t){return(t=t.providerUserInfo)&&t.length?j(t,function(t){return new gl(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)}):[]}function Wl(t,e){return Vl(t).then(function(){if(F(Dl(t),e))return Il(t).then(function(){throw new pi("provider-already-linked")})})}function Kl(t,e,n){var r=Oo(e);return e=Hi(e),ei({user:t,credential:r,additionalUserInfo:e,operationType:n})}function Hl(t,e){return Bl(t,e),t.reload().then(function(){return t})}function zl(t,e,n,i,o){if(!Nr())return Ot(new pi("operation-not-supported-in-this-environment"));if(t.i&&!o)return Ot(t.i);var a=Ki(n.providerId),s=Vr(t.uid+":::"),u=null;(!jr()||br())&&t.u&&n.isOAuthProvider&&(u=hu(t.u,t.m,t.o,e,n,null,s,r.a.SDK_VERSION||null));var c=fr(u,a&&a.Ba,a&&a.Aa);return i=i().then(function(){if(Ql(t),!o)return t.F().then(function(){})}).then(function(){return Kc(t.a,c,e,n,s,!!u)}).then(function(){return new bt(function(n,r){t.ha(e,null,new pi("cancelled-popup-request"),t.g||null),t.f=n,t.v=r,t.g=s,t.c=t.a.Ea(t,e,c,s)})}).then(function(t){return c&&hr(c),t?ei(t):null}).s(function(t){throw c&&hr(c),t}),Yl(t,i,o)}function Gl(t,e,n,r,i){if(!Nr())return Ot(new pi("operation-not-supported-in-this-environment"));if(t.i&&!i)return Ot(t.i);var o=null,a=Vr(t.uid+":::");return r=r().then(function(){if(Ql(t),!i)return t.F().then(function(){})}).then(function(){return t.aa=a,Il(t)}).then(function(e){return t.ba&&(e=t.ba,e=e.b.set(eh,t.C(),e.a)),e}).then(function(){return t.a.Ca(e,n,a)}).s(function(e){if(o=e,t.ba)return nh(t.ba);throw o}).then(function(){if(o)throw o}),Yl(t,r,i)}function Ql(t){if(!t.a||!t.I){if(t.a&&!t.I)throw new pi("internal-error");throw new pi("auth-domain-config-required")}}function Yl(t,e,n){var r=Xl(t,e,n);return t.G.push(r),r.ia(function(){V(t.G,r)}),r}function Xl(t,e,n){return t.i&&!n?(e.cancel(),Ot(t.i)):e.s(function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.i||t.dispatchEvent(new ml("userInvalidated")),t.i=e),e})}function Jl(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName},n={};if(!(t.stsTokenManager&&t.stsTokenManager.accessToken&&t.stsTokenManager.expirationTime))return null;n[Wa]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null,n.expiresIn=(t.stsTokenManager.expirationTime-b())/1e3;var r=new bl(e,n,t);return t.providerData&&R(t.providerData,function(t){t&&jl(r,ei(t))}),t.redirectEventId&&(r.aa=t.redirectEventId),r}function $l(t,e,n,r){var i=new bl(t,e);return n&&(i.ba=n),r&&_l(i,r),i.reload().then(function(){return i})}function Zl(t,e,n,r){e=e||{apiKey:t.m,authDomain:t.u,appName:t.o};var i=t.h,o={};return o[Wa]=i.b,o.refreshToken=i.a,o.expiresIn=(i.c-b())/1e3,e=new bl(e,o),n&&(e.ba=n),r&&_l(e,r),Fl(e,t),e}function th(t){this.a=t,this.b=tc()}Qc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Qc.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.b,r=t.c,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?t.a?(Zc(this,!0,null,t.a),Ct()):e.xa(n,r)?Xc(this,t,e):Ot(new pi("invalid-auth-event")):(Zc(this,!1,null,null),Ct())}else Ot(new pi("invalid-auth-event"))},Qc.prototype.Ya=function(){this.g&&!this.i&&Zc(this,!1,null,null)},Qc.prototype.fa=function(){var t=this;return new bt(function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),tl(t))})},el.prototype.h=function(t,e){if(t){var n=t.b,r=t.c;t.a?(e.ha(t.b,null,t.a,t.c),Ct()):e.xa(n,r)?nl(t,e):Ot(new pi("invalid-auth-event"))}else Ot(new pi("invalid-auth-event"))},il.prototype.confirm=function(t){return t=Co(this.verificationId,t),this.a(t)},sl.prototype.start=function(){this.a=this.c,cl(this,!0)},sl.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},ll.prototype.C=function(){return{apiKey:this.f.b,refreshToken:this.a,accessToken:this.b,expirationTime:this.c}},ll.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?Ot(new pi("user-token-expired")):t||!this.b||b()>this.c-3e4?this.a?pl(this,{grant_type:"refresh_token",refresh_token:this.a}):Ct(null):Ct({accessToken:this.b,expirationTime:this.c,refreshToken:this.a})},vl.prototype.C=function(){return{lastLoginAt:this.b,createdAt:this.a}},w(ml,ve),w(bl,Be),bl.prototype.pa=function(t){this.ka=t,Qa(this.b,t)},bl.prototype.ea=function(){return this.ka},bl.prototype.ya=function(){return q(this.O)},bl.prototype.Ha=function(){this.w.b&&(this.w.stop(),this.w.start())},Zr(bl.prototype,"providerId","firebase"),t=bl.prototype,t.reload=function(){var t=this;return Yl(this,Rl(this).then(function(){return Vl(t).then(function(){return Il(t)}).then(Nl)}))},t.dc=function(t){return this.F(t).then(function(t){return new al(t)})},t.F=function(t){var e=this;return Yl(this,Rl(this).then(function(){return e.h.getToken(t)}).then(function(t){if(!t)throw new pi("internal-error");return t.accessToken!=e.ra&&(Ol(e,t.accessToken),e.dispatchEvent(new ml("tokenChanged"))),Ll(e,"refreshToken",t.refreshToken),t.accessToken}))},t.xc=function(t){if(t=t.users,!t||!t.length)throw new pi("internal-error");t=t[0],Pl(this,{uid:t.localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt});for(var e=ql(t),n=0;n<e.length;n++)jl(this,e[n]);Ll(this,"isAnonymous",!(this.email&&t.passwordHash)&&!(this.providerData&&this.providerData.length))},t.gb=function(t){var e=this,n=null;return Yl(this,t.f(this.b,this.uid).then(function(t){return Bl(e,t),n=Kl(e,t,"reauthenticate"),e.i=null,e.reload()}).then(function(){return n}),!0)},t.yc=function(t){return Jr("firebase.User.prototype.reauthenticateWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential instead."),this.gb(t).then(function(){})},t.eb=function(t){var e=this,n=null;return Yl(this,Wl(this,t.providerId).then(function(){return e.F()}).then(function(n){return t.b(e.b,n)}).then(function(t){return n=Kl(e,t,"link"),Hl(e,t)}).then(function(){return n}))},t.pc=function(t){return Jr("firebase.User.prototype.linkWithCredential is deprecated. Please use firebase.User.prototype.linkAndRetrieveDataWithCredential instead."),this.eb(t).then(function(t){return t.user})},t.qc=function(t,e){var n=this;return Yl(this,Wl(this,"phone").then(function(){return ol(El(n),t,e,g(n.eb,n))}))},t.zc=function(t,e){var n=this;return Yl(this,Ct().then(function(){return ol(El(n),t,e,g(n.gb,n))}),!0)},t.pb=function(t){var e=this;return Yl(this,this.F().then(function(n){return e.b.pb(n,t)}).then(function(t){return Bl(e,t),e.reload()}))},t.Rc=function(t){var e=this;return Yl(this,this.F().then(function(n){return t.b(e.b,n)}).then(function(t){return Bl(e,t),e.reload()}))},t.qb=function(t){var e=this;return Yl(this,this.F().then(function(n){return e.b.qb(n,t)}).then(function(t){return Bl(e,t),e.reload()}))},t.rb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return Rl(this);var e=this;return Yl(this,this.F().then(function(n){return e.b.rb(n,{displayName:t.displayName,photoUrl:t.photoURL})}).then(function(t){return Bl(e,t),Ll(e,"displayName",t.displayName||null),Ll(e,"photoURL",t.photoUrl||null),R(e.providerData,function(t){"password"===t.providerId&&(Zr(t,"displayName",e.displayName),Zr(t,"photoURL",e.photoURL))}),Il(e)}).then(Nl))},t.Pc=function(t){var e=this;return Yl(this,Vl(this).then(function(n){return F(Dl(e),t)?hs(e.b,n,[t]).then(function(t){var n={};return R(t.providerUserInfo||[],function(t){n[t.providerId]=!0}),R(Dl(e),function(t){n[t]||Ml(e,t)}),n[So.PROVIDER_ID]||Zr(e,"phoneNumber",null),Il(e)}):Il(e).then(function(){throw new pi("no-such-provider")})}))},t.delete=function(){var t=this;return Yl(this,this.F().then(function(e){return zs(t.b,Es,{idToken:e})}).then(function(){t.dispatchEvent(new ml("userDeleted"))})).then(function(){for(var e=0;e<t.G.length;e++)t.G[e].cancel("app-deleted");wl(t,null),kl(t,null),t.G=[],t.D=!0,Cl(t),Zr(t,"refreshToken",null),t.a&&t.a.unsubscribe(t)})},t.vb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.aa||null)==e||"reauthViaRedirect"==t&&(this.aa||null)==e)},t.ha=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.g||null)||(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},t.xa=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?g(this.Ab,this):"reauthViaPopup"==t&&e==(this.g||null)?g(this.Bb,this):"linkViaRedirect"==t&&(this.aa||null)==e?g(this.Ab,this):"reauthViaRedirect"==t&&(this.aa||null)==e?g(this.Bb,this):null},t.rc=function(t){var e=this;return zl(this,"linkViaPopup",t,function(){return Wl(e,t.providerId).then(function(){return Il(e)})},!1)},t.Ac=function(t){return zl(this,"reauthViaPopup",t,function(){return Ct()},!0)},t.sc=function(t){var e=this;return Gl(this,"linkViaRedirect",t,function(){return Wl(e,t.providerId)},!1)},t.Bc=function(t){return Gl(this,"reauthViaRedirect",t,function(){return Ct()},!0)},t.Ab=function(t,e,n){var r=this;this.c&&(this.c.cancel(),this.c=null);var i=null,o=this.F().then(function(i){return ys(r.b,{requestUri:t,postBody:n,sessionId:e,idToken:i})}).then(function(t){return i=Kl(r,t,"link"),Hl(r,t)}).then(function(){return i});return Yl(this,o)},t.Bb=function(t,e,n){var r=this;this.c&&(this.c.cancel(),this.c=null);var i=null,o=Ct().then(function(){return no(gs(r.b,{requestUri:t,sessionId:e,postBody:n}),r.uid)}).then(function(t){return i=Kl(r,t,"reauthenticate"),Bl(r,t),r.i=null,r.reload()}).then(function(){return i});return Yl(this,o,!0)},t.jb=function(t){var e=this,n=null;return Yl(this,this.F().then(function(e){return n=e,"undefined"===typeof t||at(t)?{}:Ai(new mi(t))}).then(function(t){return e.b.jb(n,t)}).then(function(t){if(e.email!=t)return e.reload()}).then(function(){}))},t.toJSON=function(){return this.C()},t.C=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,providerData:[],apiKey:this.m,appName:this.o,authDomain:this.u,stsTokenManager:this.h.C(),redirectEventId:this.aa||null};return this.metadata&&ht(t,this.metadata.C()),R(this.providerData,function(e){t.providerData.push(ni(e))}),t};var eh={name:"redirectUser",A:"session"};function nh(t){return ic(t.b,eh,t.a)}function rh(t,e){return t.b.get(eh,t.a).then(function(t){return t&&e&&(t.authDomain=e),Jl(t||{})})}function ih(t){this.a=t,this.b=tc(),this.c=null,this.f=ah(this),this.b.addListener(uh("local"),this.a,g(this.g,this))}function oh(t,e){var n,r=[];for(n in Ju)Ju[n]!==e&&r.push(ic(t.b,uh(Ju[n]),t.a));return r.push(ic(t.b,sh,t.a)),It(r)}function ah(t){var e=uh("local"),n=uh("session"),r=uh("none");return rc(t.b,e,t.a).then(function(){return t.b.get(n,t.a)}).then(function(i){return i?n:t.b.get(r,t.a).then(function(n){return n?r:t.b.get(e,t.a).then(function(n){return n?e:t.b.get(sh,t.a).then(function(t){return t?uh(t):e})})})}).then(function(e){return t.c=e,oh(t,e.A)}).s(function(){t.c||(t.c=e)})}ih.prototype.g=function(){var t=this,e=uh("local");dh(this,function(){return Ct().then(function(){return t.c&&"local"!=t.c.A?t.b.get(e,t.a):null}).then(function(n){if(n)return oh(t,"local").then(function(){t.c=e})})})};var sh={name:"persistence",A:"session"};function uh(t){return{name:"authUser",A:t}}function ch(t){return dh(t,function(){return t.b.set(sh,t.c.A,t.a)})}function lh(t,e){return dh(t,function(){return t.b.set(t.c,e.C(),t.a)})}function hh(t){return dh(t,function(){return ic(t.b,t.c,t.a)})}function fh(t,e){return dh(t,function(){return t.b.get(t.c,t.a).then(function(t){return t&&e&&(t.authDomain=e),Jl(t||{})})})}function dh(t,e){return t.f=t.f.then(e,e),t.f}function ph(t){if(this.m=!1,Zr(this,"settings",new rl),Zr(this,"app",t),!Ch(this).options||!Ch(this).options.apiKey)throw new pi("invalid-api-key");t=r.a.SDK_VERSION?Ar(r.a.SDK_VERSION):null,this.b=new Ua(Ch(this).options&&Ch(this).options.apiKey,Bi(Fi),t),this.N=[],this.o=[],this.I=[],this.Tb=r.a.INTERNAL.createSubscribe(g(this.mc,this)),this.O=void 0,this.Ub=r.a.INTERNAL.createSubscribe(g(this.nc,this)),_h(this,null),this.h=new ih(Ch(this).options.apiKey+":"+Ch(this).name),this.w=new th(Ch(this).options.apiKey+":"+Ch(this).name),this.V=Ph(this,Eh(this)),this.i=Ph(this,Th(this)),this.X=!1,this.ka=g(this.Mc,this),this.Ha=g(this.Z,this),this.ra=g(this.bc,this),this.sa=g(this.jc,this),this.ta=g(this.kc,this),bh(this),this.INTERNAL={},this.INTERNAL["delete"]=g(this.delete,this),this.INTERNAL.logFramework=g(this.tc,this),this.u=0,Be.call(this),gh(this),this.G=[]}function vh(t){ve.call(this,"languageCodeChanged"),this.g=t}function yh(t){ve.call(this,"frameworkChanged"),this.c=t}function gh(t){Object.defineProperty(t,"lc",{get:function(){return this.ea()},set:function(t){this.pa(t)},enumerable:!1}),t.W=null}function mh(t){return t.Sb||Ot(new pi("auth-domain-config-required"))}function bh(t){var e=Ch(t).options.authDomain,n=Ch(t).options.apiKey;e&&Nr()&&(t.Sb=t.V.then(function(){if(!t.m){if(t.a=Gc(e,n,Ch(t).name),t.a.subscribe(t),Oh(t)&&xl(Oh(t)),t.D){xl(t.D);var r=t.D;r.pa(t.ea()),wl(r,t),r=t.D,_l(r,t.G),kl(r,t),t.D=null}return t.a}}))}function wh(t,e){var n={};return n.apiKey=Ch(t).options.apiKey,n.authDomain=Ch(t).options.authDomain,n.appName=Ch(t).name,t.V.then(function(){return $l(n,e,t.w,t.ya())}).then(function(e){return Oh(t)&&e.uid==Oh(t).uid?(Fl(Oh(t),e),t.Z(e)):(_h(t,e),xl(e),t.Z(e))}).then(function(){Ih(t)})}function _h(t,e){Oh(t)&&(Al(Oh(t),t.Ha),Pe(Oh(t),"tokenChanged",t.ra),Pe(Oh(t),"userDeleted",t.sa),Pe(Oh(t),"userInvalidated",t.ta),Cl(Oh(t))),e&&(e.N.push(t.Ha),Oe(e,"tokenChanged",t.ra),Oe(e,"userDeleted",t.sa),Oe(e,"userInvalidated",t.ta),0<t.u&&Sl(e)),Zr(t,"currentUser",e),e&&(e.pa(t.ea()),wl(e,t),_l(e,t.G),kl(e,t))}function kh(t){var e=rh(t.w,Ch(t).options.authDomain).then(function(e){return(t.D=e)&&(e.ba=t.w),nh(t.w)});return Ph(t,e)}function Eh(t){var e=Ch(t).options.authDomain,n=kh(t).then(function(){return fh(t.h,e)}).then(function(e){return e?(e.ba=t.w,t.D&&(t.D.aa||null)==(e.aa||null)?e:e.reload().then(function(){return lh(t.h,e).then(function(){return e})}).s(function(n){return"auth/network-request-failed"==n.code?e:hh(t.h)})):null}).then(function(e){_h(t,e||null)});return Ph(t,n)}function Th(t){return t.V.then(function(){return t.fa()}).s(function(){}).then(function(){if(!t.m)return t.ka()}).s(function(){}).then(function(){if(!t.m){t.X=!0;var e=t.h;e.b.addListener(uh("local"),e.a,t.ka)}})}function Sh(t,e){var n=null,r=null;return Ph(t,e.then(function(e){return n=Oo(e),r=Hi(e),wh(t,e)}).then(function(){return ei({user:Oh(t),credential:n,additionalUserInfo:r,operationType:"signIn"})}))}function Ch(t){return t.app}function Oh(t){return t.currentUser}function Ah(t){return Oh(t)&&Oh(t)._lat||null}function Ih(t){if(t.X){for(var e=0;e<t.o.length;e++)t.o[e]&&t.o[e](Ah(t));if(t.O!==t.getUid()&&t.I.length)for(t.O=t.getUid(),e=0;e<t.I.length;e++)t.I[e]&&t.I[e](Ah(t))}}function xh(t,e){t.I.push(e),Ph(t,t.i.then(function(){!t.m&&F(t.I,e)&&t.O!==t.getUid()&&(t.O=t.getUid(),e(Ah(t)))}))}function Ph(t,e){return t.N.push(e),e.ia(function(){V(t.N,e)}),e}function Nh(){}function Rh(){this.a={},this.b=1e12}ih.prototype.mb=function(t){var e=null,n=this;return $u(t),dh(this,function(){return t!=n.c.A?n.b.get(n.c,n.a).then(function(r){return e=r,oh(n,t)}).then(function(){if(n.c=uh(t),e)return n.b.set(n.c,e,n.a)}):Ct()})},w(ph,Be),w(vh,ve),w(yh,ve),t=ph.prototype,t.mb=function(t){return t=this.h.mb(t),Ph(this,t)},t.pa=function(t){this.W===t||this.m||(this.W=t,Qa(this.b,this.W),this.dispatchEvent(new vh(this.ea())))},t.ea=function(){return this.W},t.Sc=function(){var t=n.navigator;this.pa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},t.tc=function(t){this.G.push(t),Ya(this.b,r.a.SDK_VERSION?Ar(r.a.SDK_VERSION,this.G):null),this.dispatchEvent(new yh(this.G))},t.ya=function(){return q(this.G)},t.toJSON=function(){return{apiKey:Ch(this).options.apiKey,authDomain:Ch(this).options.authDomain,appName:Ch(this).name,currentUser:Oh(this)&&Oh(this).C()}},t.vb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},t.ha=function(t,e,n,r){"signInViaPopup"==t&&this.g==r&&(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},t.xa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?g(this.ac,this):null},t.ac=function(t,e,n){var r=this;t={requestUri:t,postBody:n,sessionId:e},this.c&&(this.c.cancel(),this.c=null);var i=null,o=null,a=vs(r.b,t).then(function(t){return i=Oo(t),o=Hi(t),t});return t=r.V.then(function(){return a}).then(function(t){return wh(r,t)}).then(function(){return ei({user:Oh(r),credential:i,additionalUserInfo:o,operationType:"signIn"})}),Ph(this,t)},t.Kc=function(t){if(!Nr())return Ot(new pi("operation-not-supported-in-this-environment"));var e=this,n=Ki(t.providerId),i=Vr(),o=null;(!jr()||br())&&Ch(this).options.authDomain&&t.isOAuthProvider&&(o=hu(Ch(this).options.authDomain,Ch(this).options.apiKey,Ch(this).name,"signInViaPopup",t,null,i,r.a.SDK_VERSION||null));var a=fr(o,n&&n.Ba,n&&n.Aa);return n=mh(this).then(function(e){return Kc(e,a,"signInViaPopup",t,i,!!o)}).then(function(){return new bt(function(t,n){e.ha("signInViaPopup",null,new pi("cancelled-popup-request"),e.g),e.f=t,e.v=n,e.g=i,e.c=e.a.Ea(e,"signInViaPopup",a,i)})}).then(function(t){return a&&hr(a),t?ei(t):null}).s(function(t){throw a&&hr(a),t}),Ph(this,n)},t.Lc=function(t){if(!Nr())return Ot(new pi("operation-not-supported-in-this-environment"));var e=this,n=mh(this).then(function(){return ch(e.h)}).then(function(){return e.a.Ca("signInViaRedirect",t)});return Ph(this,n)},t.fa=function(){if(!Nr())return Ot(new pi("operation-not-supported-in-this-environment"));var t=this,e=mh(this).then(function(){return t.a.fa()}).then(function(t){return t?ei(t):null});return Ph(this,e)},t.Qc=function(t){if(!t)return Ot(new pi("null-user"));var e=this,n={};n.apiKey=Ch(this).options.apiKey,n.authDomain=Ch(this).options.authDomain,n.appName=Ch(this).name;var r=Zl(t,n,e.w,e.ya());return Ph(this,this.i.then(function(){if(Ch(e).options.apiKey!=t.m)return r.reload()}).then(function(){return Oh(e)&&t.uid==Oh(e).uid?(Fl(Oh(e),t),e.Z(t)):(_h(e,r),xl(r),e.Z(r))}).then(function(){Ih(e)}))},t.nb=function(){var t=this,e=this.i.then(function(){return Oh(t)?(_h(t,null),hh(t.h).then(function(){Ih(t)})):Ct()});return Ph(this,e)},t.Mc=function(){var t=this;return fh(this.h,Ch(this).options.authDomain).then(function(e){if(!t.m){var n;if(n=Oh(t)&&e){n=Oh(t).uid;var r=e.uid;n=void 0!==n&&null!==n&&""!==n&&void 0!==r&&null!==r&&""!==r&&n==r}if(n)return Fl(Oh(t),e),Oh(t).F();(Oh(t)||e)&&(_h(t,e),e&&(xl(e),e.ba=t.w),t.a&&t.a.subscribe(t),Ih(t))}})},t.Z=function(t){return lh(this.h,t)},t.bc=function(){Ih(this),this.Z(Oh(this))},t.jc=function(){this.nb()},t.kc=function(){this.nb()},t.mc=function(t){var e=this;this.addAuthTokenListener(function(){t.next(Oh(e))})},t.nc=function(t){var e=this;xh(this,function(){t.next(Oh(e))})},t.vc=function(t,e,n){var i=this;return this.X&&r.a.Promise.resolve().then(function(){h(t)?t(Oh(i)):h(t.next)&&t.next(Oh(i))}),this.Tb(t,e,n)},t.uc=function(t,e,n){var i=this;return this.X&&r.a.Promise.resolve().then(function(){i.O=i.getUid(),h(t)?t(Oh(i)):h(t.next)&&t.next(Oh(i))}),this.Ub(t,e,n)},t.cc=function(t){var e=this,n=this.i.then(function(){return Oh(e)?Oh(e).F(t).then(function(t){return{accessToken:t}}):null});return Ph(this,n)},t.Nb=function(t){var e=this;return this.i.then(function(){return Sh(e,zs(e.b,Us,{token:t}))}).then(function(t){var n=t.user;return Ll(n,"isAnonymous",!1),e.Z(n),t})},t.Ec=function(t){return Jr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCustomToken is deprecated. Please use firebase.auth.Auth.prototype.signInWithCustomToken instead."),this.Nb(t)},t.Fc=function(t,e){return Jr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithEmailAndPassword is deprecated. Please use firebase.auth.Auth.prototype.signInWithEmailAndPassword instead."),this.Ob(t,e)},t.Ob=function(t,e){var n=this;return this.i.then(function(){return Sh(n,zs(n.b,qs,{email:t,password:e}))})},t.xb=function(t,e){var n=this;return this.i.then(function(){return Sh(n,zs(n.b,_s,{email:t,password:e}))})},t.Wb=function(t,e){return Jr("firebase.auth.Auth.prototype.createUserAndRetrieveDataWithEmailAndPassword is deprecated. Please use firebase.auth.Auth.prototype.createUserWithEmailAndPassword instead."),this.xb(t,e)},t.Hc=function(t){return Jr("firebase.auth.Auth.prototype.signInWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential instead."),this.Pa(t).then(function(t){return t.user})},t.Pa=function(t){var e=this;return this.i.then(function(){return Sh(e,t.la(e.b))})},t.Qa=function(){var t=this;return this.i.then(function(){var e=Oh(t);if(e&&e.isAnonymous){var n=ei({providerId:null,isNewUser:!1});return ei({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return Sh(t,t.b.Qa()).then(function(e){var n=e.user;return Ll(n,"isAnonymous",!0),t.Z(n),e})})},t.Gc=function(){return Jr("firebase.auth.Auth.prototype.signInAnonymouslyAndRetrieveData is deprecated. Please use firebase.auth.Auth.prototype.signInAnonymously instead."),this.Qa()},t.getUid=function(){return Oh(this)&&Oh(this).uid||null},t.Vb=function(t){this.addAuthTokenListener(t),this.u++,0<this.u&&Oh(this)&&Sl(Oh(this))},t.Cc=function(t){var e=this;R(this.o,function(n){n==t&&e.u--}),0>this.u&&(this.u=0),0==this.u&&Oh(this)&&Cl(Oh(this)),this.removeAuthTokenListener(t)},t.addAuthTokenListener=function(t){var e=this;this.o.push(t),Ph(this,this.i.then(function(){e.m||F(e.o,t)&&t(Ah(e))}))},t.removeAuthTokenListener=function(t){B(this.o,function(e){return e==t})},t.delete=function(){this.m=!0;for(var t=0;t<this.N.length;t++)this.N[t].cancel("app-deleted");return this.N=[],this.h&&(t=this.h,t.b.removeListener(uh("local"),t.a,this.ka)),this.a&&(this.a.unsubscribe(this),this.a.Ya()),r.a.Promise.resolve()},t.Zb=function(t){return Jr("firebase.auth.Auth.prototype.fetchProvidersForEmail is deprecated. Please use firebase.auth.Auth.prototype.fetchSignInMethodsForEmail instead."),Ph(this,is(this.b,t))},t.$b=function(t){return Ph(this,os(this.b,t))},t.oc=function(t){return!!ko(t)},t.lb=function(t,e){var n=this;return Ph(this,Ct().then(function(){var t=new mi(e);if(!t.c)throw new pi("argument-error",_i+" must be true when sending sign in link to email");return Ai(t)}).then(function(e){return n.b.lb(t,e)}).then(function(){}))},t.Tc=function(t){return this.Ja(t).then(function(t){return t.data.email})},t.Za=function(t,e){return Ph(this,this.b.Za(t,e).then(function(){}))},t.Ja=function(t){return Ph(this,this.b.Ja(t).then(function(t){return new oi(t)}))},t.Wa=function(t){return Ph(this,this.b.Wa(t).then(function(){}))},t.kb=function(t,e){var n=this;return Ph(this,Ct().then(function(){return"undefined"===typeof e||at(e)?{}:Ai(new mi(e))}).then(function(e){return n.b.kb(t,e)}).then(function(){}))},t.Jc=function(t,e){return Ph(this,ol(this,t,e,g(this.Pa,this)))},t.Ic=function(t,e){var n=this;return Ph(this,Ct().then(function(){var r=_o(t,e||ar());return n.Pa(r)}))},Nh.prototype.render=function(){},Nh.prototype.reset=function(){},Nh.prototype.getResponse=function(){},Nh.prototype.execute=function(){};var Dh=null;function jh(t,e){return(e=Mh(e))&&t.a[e]||null}function Mh(t){return(t="undefined"===typeof t?1e12:t)?t.toString():null}function Lh(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=Gn(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():Oe(this.f,"click",this.i)}function Fh(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function Vh(){}Rh.prototype.render=function(t,e){return this.a[this.b.toString()]=new Lh(t,e),this.b++},Rh.prototype.reset=function(t){var e=jh(this,t);t=Mh(t),e&&t&&(e.delete(),delete this.a[t])},Rh.prototype.getResponse=function(t){return(t=jh(this,t))?t.getResponse():null},Rh.prototype.execute=function(t){(t=jh(this,t))&&t.execute()},Lh.prototype.getResponse=function(){return Fh(this),this.b},Lh.prototype.execute=function(){Fh(this);var t=this;this.a||(this.a=setTimeout(function(){t.b=Er();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(r){}t.a=setTimeout(function(){if(t.a=null,t.b=null,n)try{n()}catch(r){}t.h&&t.execute()},6e4)},500))},Lh.prototype.delete=function(){Fh(this),this.g=!0,clearTimeout(this.a),this.a=null,Pe(this.f,"click",this.i)},Vh.prototype.g=function(){return Dh||(Dh=new Rh),Ct(Dh)},Vh.prototype.c=function(){};var Bh=null;function Uh(){this.b=n.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var qh=In("https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),Wh=new qr(3e4,6e4);Uh.prototype.g=function(t){var e=this;return new bt(function(r,i){var o=setTimeout(function(){i(new pi("network-request-failed"))},Wh.get());if(!n.grecaptcha||t!==e.f&&!e.b){n[e.a]=function(){if(n.grecaptcha){e.f=t;var a=n.grecaptcha.render;n.grecaptcha.render=function(t,n){return t=a(t,n),e.b++,t},clearTimeout(o),r(n.grecaptcha)}else clearTimeout(o),i(new pi("internal-error"));delete n[e.a]};var a=Nn(qh,{onload:e.a,hl:t||""});Ct(Ra(a)).s(function(){clearTimeout(o),i(new pi("internal-error","Unable to load external reCAPTCHA dependencies!"))})}else clearTimeout(o),r(n.grecaptcha)})},Uh.prototype.c=function(){this.b--};var Kh=null;function Hh(t,e,r,i,o,a,s){if(Zr(this,"type","recaptcha"),this.c=this.f=null,this.D=!1,this.m=e,this.g=null,s?(Bh||(Bh=new Vh),s=Bh):(Kh||(Kh=new Uh),s=Kh),this.o=s,this.a=r||{theme:"light",type:"image"},this.h=[],this.a[Qh])throw new pi("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Yh],!n.document)throw new pi("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!Gn(e)||!this.i&&Gn(e).hasChildNodes())throw new pi("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.u=new Ua(t,a||null,o||null),this.v=i||function(){return null};var u=this;this.l=[];var c=this.a[zh];this.a[zh]=function(t){if(Xh(u,t),"function"===typeof c)c(t);else if("string"===typeof c){var e=xr(c,n);"function"===typeof e&&e(t)}};var l=this.a[Gh];this.a[Gh]=function(){if(Xh(u,null),"function"===typeof l)l();else if("string"===typeof l){var t=xr(l,n);"function"===typeof t&&t()}}}var zh="callback",Gh="expired-callback",Qh="sitekey",Yh="size";function Xh(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(r){}}function Jh(t,e){B(t.l,function(t){return t==e})}function $h(t,e){return t.h.push(e),e.ia(function(){V(t.h,e)}),e}function Zh(t){if(t.D)throw new pi("internal-error","RecaptchaVerifier instance has been destroyed.")}function tf(t,e,n){var i=!1;try{this.b=n||r.a.app()}catch(s){throw new pi("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new pi("invalid-api-key");n=this.b.options.apiKey;var o=this,a=null;try{a=this.b.auth().ya()}catch(s){}try{i=this.b.auth().settings.appVerificationDisabledForTesting}catch(s){}a=r.a.SDK_VERSION?Ar(r.a.SDK_VERSION,a):null,Hh.call(this,n,t,e,function(){try{var t=o.b.auth().ea()}catch(e){t=null}return t},a,Bi(Fi),i)}function ef(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new pi("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].M(n[i])&&!o){if(e=e[i],0>i||i>=nf.length)throw new pi("internal-error","Argument validator received an unsupported number of arguments.");n=nf[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.K+".";break t}r=null}}if(r)throw new pi("argument-error",t+" failed: "+r)}t=Hh.prototype,t.za=function(){var t=this;return this.f?this.f:this.f=$h(this,Ct().then(function(){if(Rr()&&!wr())return yr();throw new pi("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return t.o.g(t.v())}).then(function(e){return t.g=e,zs(t.u,Ns,{})}).then(function(e){t.a[Qh]=e.recaptchaSiteKey}).s(function(e){throw t.f=null,e}))},t.render=function(){Zh(this);var t=this;return $h(this,this.za().then(function(){if(null===t.c){var e=t.m;if(!t.i){var n=Gn(e);e=Xn("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c}))},t.verify=function(){Zh(this);var t=this;return $h(this,this.render().then(function(e){return new bt(function(n){var r=t.g.getResponse(e);if(r)n(r);else{var i=function(e){e&&(Jh(t,i),n(e))};t.l.push(i),t.i&&t.g.execute(t.c)}})}))},t.reset=function(){Zh(this),null!==this.c&&this.g.reset(this.c)},t.clear=function(){Zh(this),this.D=!0,this.o.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=Gn(this.m);for(var e;e=t.firstChild;)t.removeChild(e)}},w(tf,Hh);var nf="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function rf(t,e){return{name:t||"",K:"a valid string",optional:!!e,M:i}}function of(t,e){return{name:t||"",K:"a boolean",optional:!!e,M:o}}function af(t,e){return{name:t||"",K:"a valid object",optional:!!e,M:f}}function sf(t,e){return{name:t||"",K:"a function",optional:!!e,M:h}}function uf(t,e){return{name:t||"",K:"null",optional:!!e,M:u}}function cf(){return{name:"",K:"an HTML element",optional:!1,M:function(t){return!!(t&&t instanceof Element)}}}function lf(){return{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(t){return!!(t&&t instanceof ph)}}}function hf(){return{name:"app",K:"an instance of Firebase App",optional:!0,M:function(t){return!!(t&&t instanceof r.a.app.App)}}}function ff(t){return{name:t?t+"Credential":"credential",K:t?"a valid "+t+" credential":"a valid credential",optional:!1,M:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.la||!n)}}}function df(){return{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}}function pf(){return{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!!(t&&i(t.type)&&h(t.verify))}}}function vf(t,e,n,r){return{name:n||"",K:t.K+" or "+e.K,optional:!!r,M:function(n){return t.M(n)||e.M(n)}}}function yf(t,e){for(var n in e){var r=e[n].name;t[r]=bf(r,t[n],e[n].j)}}function gf(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:m(function(t){return this[t]},n),set:m(function(t,e,n,r){ef(t,[n],[r],!0),this[e]=r},r,n,e[n].tb),enumerable:!0})}}function mf(t,e,n,r){t[e]=bf(e,n,r)}function bf(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return ef(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=wf(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}function wf(t){return t=t.split("."),t[t.length-1]}yf(ph.prototype,{Wa:{name:"applyActionCode",j:[rf("code")]},Ja:{name:"checkActionCode",j:[rf("code")]},Za:{name:"confirmPasswordReset",j:[rf("code"),rf("newPassword")]},xb:{name:"createUserWithEmailAndPassword",j:[rf("email"),rf("password")]},Wb:{name:"createUserAndRetrieveDataWithEmailAndPassword",j:[rf("email"),rf("password")]},Zb:{name:"fetchProvidersForEmail",j:[rf("email")]},$b:{name:"fetchSignInMethodsForEmail",j:[rf("email")]},fa:{name:"getRedirectResult",j:[]},oc:{name:"isSignInWithEmailLink",j:[rf("emailLink")]},uc:{name:"onAuthStateChanged",j:[vf(af(),sf(),"nextOrObserver"),sf("opt_error",!0),sf("opt_completed",!0)]},vc:{name:"onIdTokenChanged",j:[vf(af(),sf(),"nextOrObserver"),sf("opt_error",!0),sf("opt_completed",!0)]},kb:{name:"sendPasswordResetEmail",j:[rf("email"),vf(af("opt_actionCodeSettings",!0),uf(null,!0),"opt_actionCodeSettings",!0)]},lb:{name:"sendSignInLinkToEmail",j:[rf("email"),af("actionCodeSettings")]},mb:{name:"setPersistence",j:[rf("persistence")]},Pa:{name:"signInAndRetrieveDataWithCredential",j:[ff()]},Qa:{name:"signInAnonymously",j:[]},Gc:{name:"signInAnonymouslyAndRetrieveData",j:[]},Hc:{name:"signInWithCredential",j:[ff()]},Nb:{name:"signInWithCustomToken",j:[rf("token")]},Ec:{name:"signInAndRetrieveDataWithCustomToken",j:[rf("token")]},Ob:{name:"signInWithEmailAndPassword",j:[rf("email"),rf("password")]},Ic:{name:"signInWithEmailLink",j:[rf("email"),rf("emailLink",!0)]},Fc:{name:"signInAndRetrieveDataWithEmailAndPassword",j:[rf("email"),rf("password")]},Jc:{name:"signInWithPhoneNumber",j:[rf("phoneNumber"),pf()]},Kc:{name:"signInWithPopup",j:[df()]},Lc:{name:"signInWithRedirect",j:[df()]},Qc:{name:"updateCurrentUser",j:[vf(function(t){return{name:"user",K:"an instance of Firebase User",optional:!!t,M:function(t){return!!(t&&t instanceof bl)}}}(),uf(),"user")]},nb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[rf(null,!0)]},Sc:{name:"useDeviceLanguage",j:[]},Tc:{name:"verifyPasswordResetCode",j:[rf("code")]}}),gf(ph.prototype,{lc:{name:"languageCode",tb:vf(rf(),uf(),"languageCode")}}),ph.Persistence=Ju,ph.Persistence.LOCAL="local",ph.Persistence.SESSION="session",ph.Persistence.NONE="none",yf(bl.prototype,{delete:{name:"delete",j:[]},dc:{name:"getIdTokenResult",j:[of("opt_forceRefresh",!0)]},F:{name:"getIdToken",j:[of("opt_forceRefresh",!0)]},eb:{name:"linkAndRetrieveDataWithCredential",j:[ff()]},pc:{name:"linkWithCredential",j:[ff()]},qc:{name:"linkWithPhoneNumber",j:[rf("phoneNumber"),pf()]},rc:{name:"linkWithPopup",j:[df()]},sc:{name:"linkWithRedirect",j:[df()]},gb:{name:"reauthenticateAndRetrieveDataWithCredential",j:[ff()]},yc:{name:"reauthenticateWithCredential",j:[ff()]},zc:{name:"reauthenticateWithPhoneNumber",j:[rf("phoneNumber"),pf()]},Ac:{name:"reauthenticateWithPopup",j:[df()]},Bc:{name:"reauthenticateWithRedirect",j:[df()]},reload:{name:"reload",j:[]},jb:{name:"sendEmailVerification",j:[vf(af("opt_actionCodeSettings",!0),uf(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[rf(null,!0)]},Pc:{name:"unlink",j:[rf("provider")]},pb:{name:"updateEmail",j:[rf("email")]},qb:{name:"updatePassword",j:[rf("password")]},Rc:{name:"updatePhoneNumber",j:[ff("phone")]},rb:{name:"updateProfile",j:[af("profile")]}}),yf(Rh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),yf(Nh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),yf(bt.prototype,{ia:{name:"finally"},s:{name:"catch"},then:{name:"then"}}),gf(rl.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",tb:of("appVerificationDisabledForTesting")}}),yf(il.prototype,{confirm:{name:"confirm",j:[rf("verificationCode")]}}),mf(wo,"credential",function(t,e){return new bo(t,e)},[rf("email"),rf("password")]),yf(lo.prototype,{ua:{name:"addScope",j:[rf("scope")]},Da:{name:"setCustomParameters",j:[af("customOAuthParameters")]}}),mf(lo,"credential",ho,[vf(rf(),af(),"token")]),mf(wo,"credentialWithLink",_o,[rf("email"),rf("emailLink")]),yf(fo.prototype,{ua:{name:"addScope",j:[rf("scope")]},Da:{name:"setCustomParameters",j:[af("customOAuthParameters")]}}),mf(fo,"credential",po,[vf(rf(),af(),"token")]),yf(vo.prototype,{ua:{name:"addScope",j:[rf("scope")]},Da:{name:"setCustomParameters",j:[af("customOAuthParameters")]}}),mf(vo,"credential",yo,[vf(rf(),vf(af(),uf()),"idToken"),vf(rf(),uf(),"accessToken",!0)]),yf(go.prototype,{Da:{name:"setCustomParameters",j:[af("customOAuthParameters")]}}),mf(go,"credential",mo,[vf(rf(),af(),"token"),rf("secret",!0)]),yf(co.prototype,{ua:{name:"addScope",j:[rf("scope")]},credential:{name:"credential",j:[vf(rf(),uf(),"idToken",!0),vf(rf(),uf(),"accessToken",!0),vf(rf(),uf(),"nonce",!0)]},Da:{name:"setCustomParameters",j:[af("customOAuthParameters")]}}),mf(So,"credential",Co,[rf("verificationId"),rf("verificationCode")]),yf(So.prototype,{Ua:{name:"verifyPhoneNumber",j:[rf("phoneNumber"),pf()]}}),yf(pi.prototype,{toJSON:{name:"toJSON",j:[rf(null,!0)]}}),yf(jo.prototype,{toJSON:{name:"toJSON",j:[rf(null,!0)]}}),yf(Do.prototype,{toJSON:{name:"toJSON",j:[rf(null,!0)]}}),yf(tf.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),function(){if("undefined"===typeof r.a||!r.a.INTERNAL||!r.a.INTERNAL.registerService)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={Auth:ph,Error:pi};mf(t,"EmailAuthProvider",wo,[]),mf(t,"FacebookAuthProvider",lo,[]),mf(t,"GithubAuthProvider",fo,[]),mf(t,"GoogleAuthProvider",vo,[]),mf(t,"TwitterAuthProvider",go,[]),mf(t,"OAuthProvider",co,[rf("providerId")]),mf(t,"SAMLAuthProvider",uo,[rf("providerId")]),mf(t,"PhoneAuthProvider",So,[lf()]),mf(t,"RecaptchaVerifier",tf,[vf(rf(),cf(),"recaptchaContainer"),af("recaptchaParameters",!0),hf()]),r.a.INTERNAL.registerService("auth",function(t,e){return t=new ph(t),e({INTERNAL:{getUid:g(t.getUid,t),getToken:g(t.cc,t),addAuthTokenListener:g(t.Vb,t),removeAuthTokenListener:g(t.Cc,t)}}),t},t,function(t,e){if("create"===t)try{e.auth()}catch(n){}}),r.a.INTERNAL.extendNamespace({User:bl})}()}).apply("undefined"!==typeof t?t:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})}.call(this,n("c8ba"))},b7b7:function(t,e,n){"use strict";n.r(e),n.d(e,"__extends",function(){return i}),n.d(e,"__assign",function(){return o}),n.d(e,"__rest",function(){return a}),n.d(e,"__decorate",function(){return s}),n.d(e,"__param",function(){return u}),n.d(e,"__metadata",function(){return c}),n.d(e,"__awaiter",function(){return l}),n.d(e,"__generator",function(){return h}),n.d(e,"__exportStar",function(){return f}),n.d(e,"__values",function(){return d}),n.d(e,"__read",function(){return p}),n.d(e,"__spread",function(){return v}),n.d(e,"__await",function(){return y}),n.d(e,"__asyncGenerator",function(){return g}),n.d(e,"__asyncDelegator",function(){return m}),n.d(e,"__asyncValues",function(){return b}),n.d(e,"__makeTemplateObject",function(){return w}),n.d(e,"__importStar",function(){return _}),n.d(e,"__importDefault",function(){return k});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};function a(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&(n[r[i]]=t[r[i]])}return n}function s(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}function u(t,e){return function(n,r){e(n,r,t)}}function c(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)}function l(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})}function h(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return u([t,e])}}function u(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}function f(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}function d(t){var e="function"===typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function p(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{while((void 0===e||e-- >0)&&!(r=o.next()).done)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}return a}function v(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(p(arguments[e]));return t}function y(t){return this instanceof y?(this.v=t,this):new y(t)}function g(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(t){i[t]&&(r[t]=function(e){return new Promise(function(n,r){o.push([t,e,n,r])>1||s(t,e)})})}function s(t,e){try{u(i[t](e))}catch(n){h(o[0][3],n)}}function u(t){t.value instanceof y?Promise.resolve(t.value.v).then(c,l):h(o[0][2],t)}function c(t){s("next",t)}function l(t){s("throw",t)}function h(t,e){t(e),o.shift(),o.length&&s(o[0][0],o[0][1])}}function m(t){var e,n;return e={},r("next"),r("throw",function(t){throw t}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){t[r]&&(e[r]=function(e){return(n=!n)?{value:y(t[r](e)),done:"return"===r}:i?i(e):e})}}function b(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator];return e?e.call(t):"function"===typeof d?d(t):t[Symbol.iterator]()}function w(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function _(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function k(t){return t&&t.__esModule?t:{default:t}}},b9e9:function(t,e,n){n("7445"),t.exports=n("584a").parseInt},ba92:function(t,e,n){"use strict";var r=n("4bf8"),i=n("77f1"),o=n("9def");t.exports=[].copyWithin||function(t,e){var n=r(this),a=o(n.length),s=i(t,a),u=i(e,a),c=arguments.length>2?arguments[2]:void 0,l=Math.min((void 0===c?a:i(c,a))-u,a-s),h=1;u<s&&s<u+l&&(h=-1,u+=l-1,s+=l-1);while(l-- >0)u in n?n[s]=n[u]:delete n[s],s+=h,u+=h;return n}},bc13:function(t,e,n){var r=n("e53d"),i=r.navigator;t.exports=i&&i.userAgent||""},bcf9:function(t,e,n){},bf90:function(t,e,n){var r=n("36c3"),i=n("bf0b").f;n("ce7e")("getOwnPropertyDescriptor",function(){return function(t,e){return i(r(t),e)}})},bfac:function(t,e,n){var r=n("0b64");t.exports=function(t,e){return new(r(t))(e)}},c189:function(t,e,n){"use strict";var r=n("79aa"),i=n("f772"),o=n("3024"),a=[].slice,s={},u=function(t,e,n){if(!(e in s)){for(var r=[],i=0;i<e;i++)r[i]="a["+i+"]";s[e]=Function("F,a","return new F("+r.join(",")+")")}return s[e](t,n)};t.exports=Function.bind||function(t){var e=r(this),n=a.call(arguments,1),s=function(){var r=n.concat(a.call(arguments));return this instanceof s?u(e,r.length,r):o(e,r,t)};return i(e.prototype)&&(s.prototype=e.prototype),s}},c20e:function(t,e){t.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M18 3.75a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 8a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 4a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75zm0-8a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75z"/></svg>'},c23d:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("cd51"),i=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o="[DEFAULT]",a=[],s=function(){function t(t,e,n){this.firebase_=n,this.isDeleted_=!1,this.services_={},this.name_=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled||!1,this.options_=r.deepCopy(t),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(t){a.push(t),setTimeout(function(){return t(null)},0)},removeAuthTokenListener:function(t){a=a.filter(function(e){return e!==t})}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this._automaticDataCollectionEnabled},set:function(t){this.checkDestroyed_(),this._automaticDataCollectionEnabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise(function(e){t.checkDestroyed_(),e()}).then(function(){t.firebase_.INTERNAL.removeApp(t.name_);var e=[];return Object.keys(t.services_).forEach(function(n){Object.keys(t.services_[n]).forEach(function(r){e.push(t.services_[n][r])})}),Promise.all(e.map(function(t){return t.INTERNAL.delete()}))}).then(function(){t.isDeleted_=!0,t.services_={}})},t.prototype._getService=function(t,e){if(void 0===e&&(e=o),this.checkDestroyed_(),this.services_[t]||(this.services_[t]={}),!this.services_[t][e]){var n=e!==o?e:void 0,r=this.firebase_.INTERNAL.factories[t](this,this.extendApp.bind(this),n);this.services_[t][e]=r}return this.services_[t][e]},t.prototype.extendApp=function(t){var e=this;r.deepExtend(this,t),t.INTERNAL&&t.INTERNAL.addAuthTokenListener&&(a.forEach(function(t){e.INTERNAL.addAuthTokenListener(t)}),a=[])},t.prototype.checkDestroyed_=function(){this.isDeleted_&&c("app-deleted",{name:this.name_})},t}();function u(){var t={},e={},n={},a={__esModule:!0,initializeApp:f,app:h,apps:null,Promise:Promise,SDK_VERSION:"5.5.9",INTERNAL:{registerService:p,createFirebaseNamespace:u,extendNamespace:v,createSubscribe:r.createSubscribe,ErrorFactory:r.ErrorFactory,removeApp:l,factories:e,useAsService:g,Promise:Promise,deepExtend:r.deepExtend}};function l(e){var n=t[e];y(n,"delete"),delete t[e]}function h(e){return e=e||o,i(t,e)||c("no-app",{name:e}),t[e]}function f(e,n){if(void 0===n&&(n={}),"object"!==typeof n||null===n){var r=n;n={name:r}}var u=n;void 0===u.name&&(u.name=o);var l=u.name;"string"===typeof l&&l||c("bad-app-name",{name:l+""}),i(t,l)&&c("duplicate-app",{name:l});var h=new s(e,u,a);return t[l]=h,y(h,"create"),h}function d(){return Object.keys(t).map(function(e){return t[e]})}function p(t,i,o,u,l){e[t]&&c("duplicate-service",{name:t}),e[t]=i,u&&(n[t]=u,d().forEach(function(t){u("create",t)}));var f=function(e){return void 0===e&&(e=h()),"function"!==typeof e[t]&&c("invalid-app-argument",{name:t}),e[t]()};return void 0!==o&&r.deepExtend(f,o),a[t]=f,s.prototype[t]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=this._getService.bind(this,t);return r.apply(this,l?e:[])},f}function v(t){r.deepExtend(a,t)}function y(t,r){Object.keys(e).forEach(function(e){var i=g(t,e);null!==i&&n[i]&&n[i](r,t)})}function g(t,e){if("serverAuth"===e)return null;var n=e;t.options;return n}return r.patchProperty(a,"default",a),Object.defineProperty(a,"apps",{get:d}),r.patchProperty(h,"App",s),a}function c(t,e){throw h.create(t,e)}s.prototype.name&&s.prototype.options||s.prototype.delete||console.log("dc");var l={"no-app":"No Firebase App '{$name}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$name}","duplicate-app":"Firebase App named '{$name}' already exists","app-deleted":"Firebase App named '{$name}' already deleted","duplicate-service":"Firebase service named '{$name}' already registered","sa-not-supported":"Initializing the Firebase SDK with a service account is only allowed in a Node.js environment. On client devices, you should instead initialize the SDK with an api key and auth domain","invalid-app-argument":"firebase.{$name}() takes either no argument or a Firebase App instance."},h=new r.ErrorFactory("app","Firebase",l),f=u();e.firebase=f,e.default=f},c44c:function(t,e,n){},c5f6:function(t,e,n){"use strict";var r=n("7726"),i=n("69a8"),o=n("2d95"),a=n("5dbc"),s=n("6a99"),u=n("79e5"),c=n("9093").f,l=n("11e9").f,h=n("86cc").f,f=n("aa77").trim,d="Number",p=r[d],v=p,y=p.prototype,g=o(n("2aeb")(y))==d,m="trim"in String.prototype,b=function(t){var e=s(t,!1);if("string"==typeof e&&e.length>2){e=m?e.trim():f(e,3);var n,r,i,o=e.charCodeAt(0);if(43===o||45===o){if(n=e.charCodeAt(2),88===n||120===n)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+e}for(var a,u=e.slice(2),c=0,l=u.length;c<l;c++)if(a=u.charCodeAt(c),a<48||a>i)return NaN;return parseInt(u,r)}}return+e};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof p&&(g?u(function(){y.valueOf.call(n)}):o(n)!=d)?a(new v(b(e)),n,p):b(e)};for(var w,_=n("9e1e")?c(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),k=0;_.length>k;k++)i(v,w=_[k])&&!i(p,w)&&h(p,w,l(v,w));p.prototype=y,y.constructor=p,n("2aba")(r,d,p)}},c6eb:function(t,e,n){"use strict";(function(t){var r=n("5ea3"),i="object"==typeof exports&&exports&&!exports.nodeType&&exports,o=i&&"object"==typeof t&&t&&!t.nodeType&&t,a=o&&o.exports===i,s=a&&r["a"].process,u=function(){try{var t=o&&o.require&&o.require("util").types;return t||s&&s.binding&&s.binding("util")}catch(e){}}();e["a"]=u}).call(this,n("dd40")(t))},c6fb:function(t,e,n){n("7075")("Set")},c7b2:function(t,e,n){"use strict";n.r(e),function(t){n.d(e,"createWebChannelTransport",function(){return Yn}),n.d(e,"ErrorCode",function(){return Xn}),n.d(e,"EventType",function(){return Jn}),n.d(e,"WebChannel",function(){return $n}),n.d(e,"XhrIoPool",function(){return Zn});var r,i="undefined"!==typeof window?window:"undefined"!==typeof t?t:"undefined"!==typeof self?self:{},o=o||{},a=i;function s(t){return"string"==typeof t}function u(t,e){t=t.split("."),e=e||a;for(var n=0;n<t.length;n++)if(e=e[t[n]],null==e)return null;return e}function c(){}function l(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&"undefined"!=typeof t.splice&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||"undefined"!=typeof t.call&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&"undefined"==typeof t.call)return"object";return e}function h(t){return"array"==l(t)}function f(t){var e=l(t);return"array"==e||"object"==e&&"number"==typeof t.length}function d(t){return"function"==l(t)}function p(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var v="closure_uid_"+(1e9*Math.random()>>>0),y=0;function g(t,e,n){return t.call.apply(t.bind,arguments)}function m(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function b(t,e,n){return b=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?g:m,b.apply(null,arguments)}function w(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var _=Date.now||function(){return+new Date};function k(t,e){function n(){}n.prototype=e.prototype,t.L=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.mh=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function E(t){if(Error.captureStackTrace)Error.captureStackTrace(this,E);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function T(t,e){t=t.split("%s");for(var n="",r=t.length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");E.call(this,n+t[r])}function S(t,e){throw new T("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function C(){0!=O&&(A[this[v]||(this[v]=++y)]=this),this.Ka=this.Ka,this.Qa=this.Qa}k(E,Error),E.prototype.name="CustomError",k(T,E),T.prototype.name="AssertionError";var O=0,A={};C.prototype.Ka=!1,C.prototype.bb=function(){if(!this.Ka&&(this.Ka=!0,this.F(),0!=O)){var t=this[v]||(this[v]=++y);if(0!=O&&this.Qa&&0<this.Qa.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete A[t]}},C.prototype.F=function(){if(this.Qa)for(;this.Qa.length;)this.Qa.shift()()};var I=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(s(t))return s(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},x=Array.prototype.lastIndexOf?function(t,e){return Array.prototype.lastIndexOf.call(t,e,t.length-1)}:function(t,e){var n=t.length-1;if(0>n&&(n=Math.max(0,t.length+n)),s(t))return s(e)&&1==e.length?t.lastIndexOf(e,n):-1;for(;0<=n;n--)if(n in t&&t[n]===e)return n;return-1},P=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=s(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)},N=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=s(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function R(t){t:{for(var e=On,n=t.length,r=s(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:s(t)?t.charAt(e):t[e]}function D(t){if(!h(t))for(var e=t.length-1;0<=e;e--)delete t[e];t.length=0}function j(t,e){var n;return e=I(t,e),(n=0<=e)&&Array.prototype.splice.call(t,e,1),n}function M(t){return Array.prototype.concat.apply([],arguments)}function L(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function F(t){return/^[\s\xa0]*$/.test(t)}var V,B=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function U(t,e){return t<e?-1:t>e?1:0}t:{var q=a.navigator;if(q){var W=q.userAgent;if(W){V=W;break t}}V=""}function K(t){return-1!=V.indexOf(t)}function H(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function z(t){var e,n=[],r=0;for(e in t)n[r++]=t[e];return n}function G(t){var e,n=[],r=0;for(e in t)n[r++]=e;return n}function Q(t){var e,n={};for(e in t)n[e]=t[e];return n}var Y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function X(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i],r)t[n]=r[n];for(var o=0;o<Y.length;o++)n=Y[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function J(t){return J[" "](t),t}function $(t,e){var n=ht;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}J[" "]=c;var Z,tt=K("Opera"),et=K("Trident")||K("MSIE"),nt=K("Edge"),rt=nt||et,it=K("Gecko")&&!(-1!=V.toLowerCase().indexOf("webkit")&&!K("Edge"))&&!(K("Trident")||K("MSIE"))&&!K("Edge"),ot=-1!=V.toLowerCase().indexOf("webkit")&&!K("Edge");function at(){var t=a.document;return t?t.documentMode:void 0}t:{var st="",ut=function(){var t=V;return it?/rv:([^\);]+)(\)|;)/.exec(t):nt?/Edge\/([\d\.]+)/.exec(t):et?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):ot?/WebKit\/(\S+)/.exec(t):tt?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(ut&&(st=ut?ut[1]:""),et){var ct=at();if(null!=ct&&ct>parseFloat(st)){Z=String(ct);break t}}Z=st}var lt,ht={};function ft(t){return $(t,function(){for(var e=0,n=B(String(Z)).split("."),r=B(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=U(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||U(0==a[2].length,0==s[2].length)||U(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e})}var dt=a.document;lt=dt&&et?at()||("CSS1Compat"==dt.compatMode?parseInt(Z,10):5):void 0;var pt=Object.freeze||function(t){return t},vt=!et||9<=Number(lt),yt=et&&!ft("9"),gt=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{a.addEventListener("test",c,e),a.removeEventListener("test",c,e)}catch(n){}return t}();function mt(t,e){this.type=t,this.currentTarget=this.target=e,this.defaultPrevented=this.Ea=!1,this.Be=!0}function bt(t,e){mt.call(this,t?t.type:""),this.relatedTarget=this.currentTarget=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=this.offsetY=this.offsetX=0,this.key="",this.charCode=this.keyCode=0,this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.fb=null,t&&this.Kf(t,e)}mt.prototype.stopPropagation=function(){this.Ea=!0},mt.prototype.preventDefault=function(){this.defaultPrevented=!0,this.Be=!1},k(bt,mt);var wt=pt({2:"touch",3:"pen",4:"mouse"});bt.prototype.Kf=function(t,e){var n=this.type=t.type,r=t.changedTouches?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.currentTarget=e,e=t.relatedTarget){if(it){t:{try{J(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,null===r?(this.offsetX=ot||void 0!==t.offsetX?t.offsetX:t.layerX,this.offsetY=ot||void 0!==t.offsetY?t.offsetY:t.layerY,this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0):(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0),this.button=t.button,this.keyCode=t.keyCode||0,this.key=t.key||"",this.charCode=t.charCode||("keypress"==n?t.keyCode:0),this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=s(t.pointerType)?t.pointerType:wt[t.pointerType]||"",this.state=t.state,this.fb=t,t.defaultPrevented&&this.preventDefault()},bt.prototype.stopPropagation=function(){bt.L.stopPropagation.call(this),this.fb.stopPropagation?this.fb.stopPropagation():this.fb.cancelBubble=!0},bt.prototype.preventDefault=function(){bt.L.preventDefault.call(this);var t=this.fb;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,yt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var _t="closure_listenable_"+(1e6*Math.random()|0);function kt(t){return!(!t||!t[_t])}var Et=0;function Tt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Ob=i,this.key=++Et,this.Sa=this.Eb=!1}function St(t){this.src=t,this.J={},this.xb=0}function Ct(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Sa&&o.listener==e&&o.capture==!!n&&o.Ob==r)return i}return-1}Tt.prototype.Vb=function(){this.Sa=!0,this.Ob=this.src=this.proxy=this.listener=null},r=St.prototype,r.add=function(t,e,n,r,i){var o=t.toString();t=this.J[o],t||(t=this.J[o]=[],this.xb++);var a=Ct(t,e,r,i);return-1<a?(e=t[a],n||(e.Eb=!1)):(e=new Tt(e,this.src,o,!!r,i),e.Eb=n,t.push(e)),e},r.remove=function(t,e,n,r){if(t=t.toString(),!(t in this.J))return!1;var i=this.J[t];return e=Ct(i,e,n,r),-1<e&&(i[e].Vb(),Array.prototype.splice.call(i,e,1),0==i.length&&(delete this.J[t],this.xb--),!0)},r.ye=function(t){var e=t.type;e in this.J&&j(this.J[e],t)&&(t.Vb(),0==this.J[e].length&&(delete this.J[e],this.xb--))},r.pb=function(t){var e;for(e in t=t&&t.toString(),this.J)if(!t||e==t){for(var n=this.J[e],r=0;r<n.length;r++)n[r].Vb();delete this.J[e],this.xb--}},r.jb=function(t,e,n,r){t=this.J[t.toString()];var i=-1;return t&&(i=Ct(t,e,n,r)),-1<i?t[i]:null};var Ot="closure_lm_"+(1e6*Math.random()|0),At={};function It(t,e,n,r,i){if(r&&r.once)return Nt(t,e,n,r,i);if(h(e)){for(var o=0;o<e.length;o++)It(t,e[o],n,r,i);return null}return n=Ut(n),kt(t)?t.nb(e,n,p(r)?!!r.capture:!!r,i):xt(t,e,n,!1,r,i)}function xt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=p(i)?!!i.capture:!!i,s=Vt(t);if(s||(t[Ot]=s=new St(t)),n=s.add(e,n,r,a,o),n.proxy)return n;if(r=Pt(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)gt||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(jt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Pt(){var t=Ft,e=vt?function(n){return t.call(e.src,e.listener,n)}:function(n){if(n=t.call(e.src,e.listener,n),!n)return n};return e}function Nt(t,e,n,r,i){if(h(e)){for(var o=0;o<e.length;o++)Nt(t,e[o],n,r,i);return null}return n=Ut(n),kt(t)?t.Oc(e,n,p(r)?!!r.capture:!!r,i):xt(t,e,n,!0,r,i)}function Rt(t,e,n,r,i){if(h(e))for(var o=0;o<e.length;o++)Rt(t,e[o],n,r,i);else r=p(r)?!!r.capture:!!r,n=Ut(n),kt(t)?t.ed(e,n,r,i):t&&(t=Vt(t))&&(e=t.jb(e,n,r,i))&&Dt(e)}function Dt(t){if("number"!=typeof t&&t&&!t.Sa){var e=t.src;if(kt(e))e.Le(t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(jt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Vt(e))?(n.ye(t),0==n.xb&&(n.src=null,e[Ot]=null)):t.Vb()}}}function jt(t){return t in At?At[t]:At[t]="on"+t}function Mt(t,e,n,r){var i=!0;if((t=Vt(t))&&(e=t.J[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.Sa&&(o=Lt(o,r),i=i&&!1!==o)}return i}function Lt(t,e){var n=t.listener,r=t.Ob||t.src;return t.Eb&&Dt(t),n.call(r,e)}function Ft(t,e){if(t.Sa)return!0;if(!vt){var n=e||u("window.event");e=new bt(n,this);var r=!0;if(!(0>n.keyCode||void 0!=n.returnValue)){t:{var i=!1;if(0==n.keyCode)try{n.keyCode=-1;break t}catch(a){i=!0}(i||void 0==n.returnValue)&&(n.returnValue=!0)}for(n=[],i=e.currentTarget;i;i=i.parentNode)n.push(i);for(t=t.type,i=n.length-1;!e.Ea&&0<=i;i--){e.currentTarget=n[i];var o=Mt(n[i],t,!0,e);r=r&&o}for(i=0;!e.Ea&&i<n.length;i++)e.currentTarget=n[i],o=Mt(n[i],t,!1,e),r=r&&o}return r}return Lt(t,new bt(e,this))}function Vt(t){return t=t[Ot],t instanceof St?t:null}var Bt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ut(t){return d(t)?t:(t[Bt]||(t[Bt]=function(e){return t.handleEvent(e)}),t[Bt])}function qt(){C.call(this),this.ka=new St(this),this.Pe=this,this.Uc=null}k(qt,C),qt.prototype[_t]=!0,r=qt.prototype,r.addEventListener=function(t,e,n,r){It(this,t,e,n,r)},r.removeEventListener=function(t,e,n,r){Rt(this,t,e,n,r)},r.dispatchEvent=function(t){var e,n=this.Uc;if(n)for(e=[];n;n=n.Uc)e.push(n);n=this.Pe;var r=t.type||t;if(s(t))t=new mt(t,n);else if(t instanceof mt)t.target=t.target||n;else{var i=t;t=new mt(r,n),X(t,i)}if(i=!0,e)for(var o=e.length-1;!t.Ea&&0<=o;o--){var a=t.currentTarget=e[o];i=a.Lb(r,!0,t)&&i}if(t.Ea||(a=t.currentTarget=n,i=a.Lb(r,!0,t)&&i,t.Ea||(i=a.Lb(r,!1,t)&&i)),e)for(o=0;!t.Ea&&o<e.length;o++)a=t.currentTarget=e[o],i=a.Lb(r,!1,t)&&i;return i},r.F=function(){qt.L.F.call(this),this.pg(),this.Uc=null},r.nb=function(t,e,n,r){return this.ka.add(String(t),e,!1,n,r)},r.Oc=function(t,e,n,r){return this.ka.add(String(t),e,!0,n,r)},r.ed=function(t,e,n,r){this.ka.remove(String(t),e,n,r)},r.Le=function(t){this.ka.ye(t)},r.pg=function(){this.ka&&this.ka.pb(void 0)},r.Lb=function(t,e,n){if(t=this.ka.J[String(t)],!t)return!0;t=t.concat();for(var r=!0,i=0;i<t.length;++i){var o=t[i];if(o&&!o.Sa&&o.capture==e){var a=o.listener,s=o.Ob||o.src;o.Eb&&this.Le(o),r=!1!==a.call(s,n)&&r}}return r&&0!=n.Be},r.jb=function(t,e,n,r){return this.ka.jb(String(t),e,n,r)};var Wt=a.JSON.stringify;function Kt(t,e){this.Sf=100,this.ef=t,this.ug=e,this.Zb=0,this.Pb=null}function Ht(){this.lc=this.Va=null}Kt.prototype.get=function(){if(0<this.Zb){this.Zb--;var t=this.Pb;this.Pb=t.next,t.next=null}else t=this.ef();return t},Kt.prototype.put=function(t){this.ug(t),this.Zb<this.Sf&&(this.Zb++,t.next=this.Pb,this.Pb=t)};var zt,Gt,Qt=new Kt(function(){return new Yt},function(t){t.reset()});function Yt(){this.next=this.scope=this.Gc=null}function Xt(t){a.setTimeout(function(){throw t},0)}function Jt(){var t=a.MessageChannel;if("undefined"===typeof t&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!K("Presto")&&(t=function(){var t=document.createElement("IFRAME");t.style.display="none",t.src="",document.documentElement.appendChild(t);var e=t.contentWindow;t=e.document,t.open(),t.write(""),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=b(function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()},this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),"undefined"!==typeof t&&!K("Trident")&&!K("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){n=n.next;var t=n.rd;n.rd=null,t()}},function(t){r.next={rd:t},r=r.next,e.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(t){var e=document.createElement("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){a.setTimeout(t,0)}}function $t(){if(a.Promise&&a.Promise.resolve){var t=a.Promise.resolve(void 0);Gt=function(){t.then(ee)}}else Gt=function(){var t=ee;!d(a.setImmediate)||a.Window&&a.Window.prototype&&!K("Edge")&&a.Window.prototype.setImmediate==a.setImmediate?(zt||(zt=Jt()),zt(t)):a.setImmediate(t)}}Ht.prototype.add=function(t,e){var n=this.Af();n.set(t,e),this.lc?this.lc.next=n:this.Va=n,this.lc=n},Ht.prototype.remove=function(){var t=null;return this.Va&&(t=this.Va,this.Va=this.Va.next,this.Va||(this.lc=null),t.next=null),t},Ht.prototype.wg=function(t){Qt.put(t)},Ht.prototype.Af=function(){return Qt.get()},Yt.prototype.set=function(t,e){this.Gc=t,this.scope=e,this.next=null},Yt.prototype.reset=function(){this.next=this.scope=this.Gc=null};var Zt=!1,te=new Ht;function ee(){for(var t;t=te.remove();){try{t.Gc.call(t.scope)}catch(e){Xt(e)}te.wg(t)}Zt=!1}function ne(t,e){qt.call(this),this.Na=t||1,this.wb=e||a,this.nd=b(this.Rg,this),this.ie=_()}function re(t,e,n){if(d(t))n&&(t=b(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=b(t.handleEvent,t)}return 2147483647<Number(e)?-1:a.setTimeout(t,e||0)}function ie(t,e,n){C.call(this),this.Uf=null!=n?b(t,n):t,this.Na=e,this.Xe=b(this.fg,this),this.qc=[]}function oe(t){C.call(this),this.i=t,this.o={}}k(ne,qt),r=ne.prototype,r.enabled=!1,r.B=null,r.setInterval=function(t){this.Na=t,this.B&&this.enabled?(this.stop(),this.start()):this.B&&this.stop()},r.Rg=function(){if(this.enabled){var t=_()-this.ie;0<t&&t<.8*this.Na?this.B=this.wb.setTimeout(this.nd,this.Na-t):(this.B&&(this.wb.clearTimeout(this.B),this.B=null),this.ff(),this.enabled&&(this.stop(),this.start()))}},r.ff=function(){this.dispatchEvent("tick")},r.start=function(){this.enabled=!0,this.B||(this.B=this.wb.setTimeout(this.nd,this.Na),this.ie=_())},r.stop=function(){this.enabled=!1,this.B&&(this.wb.clearTimeout(this.B),this.B=null)},r.F=function(){ne.L.F.call(this),this.stop(),delete this.wb},k(ie,C),r=ie.prototype,r.Ta=!1,r.ob=0,r.B=null,r.mf=function(t){this.qc=arguments,this.B||this.ob?this.Ta=!0:this.Cc()},r.stop=function(){this.B&&(a.clearTimeout(this.B),this.B=null,this.Ta=!1,this.qc=[])},r.pause=function(){this.ob++},r.resume=function(){this.ob--,this.ob||!this.Ta||this.B||(this.Ta=!1,this.Cc())},r.F=function(){ie.L.F.call(this),this.stop()},r.fg=function(){this.B=null,this.Ta&&!this.ob&&(this.Ta=!1,this.Cc())},r.Cc=function(){this.B=re(this.Xe,this.Na),this.Uf.apply(null,this.qc)},k(oe,C);var ae=[];function se(t,e,n){this.reset(t,e,n,void 0,void 0)}function ue(t){this.pe=t,this.Zd=this.uc=this.mb=this.$b=null}function ce(t,e){this.name=t,this.value=e}r=oe.prototype,r.nb=function(t,e,n,r){return this.Tf(t,e,n,r)},r.Tf=function(t,e,n,r){h(e)||(e&&(ae[0]=e.toString()),e=ae);for(var i=0;i<e.length;i++){var o=It(t,e[i],n||this.handleEvent,r||!1,this.i||this);if(!o)break;this.o[o.key]=o}return this},r.Oc=function(t,e,n,r){return this.je(t,e,n,r)},r.je=function(t,e,n,r,i){if(h(e))for(var o=0;o<e.length;o++)this.je(t,e[o],n,r,i);else{if(t=Nt(t,e,n||this.handleEvent,r,i||this.i||this),!t)return this;this.o[t.key]=t}return this},r.ed=function(t,e,n,r,i){if(h(e))for(var o=0;o<e.length;o++)this.ed(t,e[o],n,r,i);else n=n||this.handleEvent,r=p(r)?!!r.capture:!!r,i=i||this.i||this,n=Ut(n),r=!!r,e=kt(t)?t.jb(e,n,r,i):t&&(t=Vt(t))?t.jb(e,n,r,i):null,e&&(Dt(e),delete this.o[e.key])},r.pb=function(){H(this.o,function(t,e){this.o.hasOwnProperty(e)&&Dt(t)},this),this.o={}},r.F=function(){oe.L.F.call(this),this.pb()},r.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},se.prototype.Md=null,se.prototype.reset=function(t,e,n,r,i){this.mb=t,delete this.Md},se.prototype.Bg=function(t){this.Md=t},se.prototype.Ge=function(t){this.mb=t},ce.prototype.toString=function(){return this.name};var le=new ce("SEVERE",1e3),he=new ce("WARNING",900),fe=new ce("INFO",800),de=new ce("CONFIG",700),pe=new ce("FINE",500);r=ue.prototype,r.getName=function(){return this.pe},r.getParent=function(){return this.$b},r.pf=function(){return this.uc||(this.uc={}),this.uc},r.Ge=function(t){this.mb=t},r.Qd=function(){return this.mb?this.mb:this.$b?this.$b.Qd():(S("Root logger has no level set."),null)},r.Pf=function(t){return t.value>=this.Qd().value},r.log=function(t,e,n){this.Pf(t)&&(d(e)&&(e=e()),this.gf(this.uf(t,e,n)))},r.uf=function(t,e,n){return t=new se(t,String(e),this.pe),n&&t.Bg(n),t},r.ca=function(t,e){this.log(le,t,e)},r.T=function(t,e){this.log(he,t,e)},r.info=function(t,e){this.log(fe,t,e)},r.lf=function(t){this.log(pe,t,void 0)},r.gf=function(t){for(var e=this;e;)e.We(t),e=e.getParent()},r.We=function(t){if(this.Zd)for(var e,n=0;e=this.Zd[n];n++)e(t)},r.Fg=function(t){this.$b=t},r.Qe=function(t,e){this.pf()[t]=e};var ve={},ye=null;function ge(t){var e;if(ye||(ye=new ue(""),ve[""]=ye,ye.Ge(de)),!(e=ve[t])){e=new ue(t);var n=t.lastIndexOf("."),r=t.substr(n+1);n=ge(t.substr(0,n)),n.Qe(r,e),e.Fg(n),ve[t]=e}return e}function me(t,e){t&&t.info(e,void 0)}function be(t,e){t&&t.lf(e)}function we(){this.s=ge("goog.labs.net.webChannel.WebChannelDebug"),this.Wc=!0}r=we.prototype,r.Id=function(){this.Wc=!1},r.Tg=function(t,e,n,r,i){var o=this;this.info(function(){return"XMLHTTP REQ ("+n+") [attempt "+r+"]: "+t+"\n"+e+"\n"+o.Xf(i)})},r.Ug=function(t,e,n,r,i,o){this.info(function(){return"XMLHTTP RESP ("+n+") [ attempt "+r+"]: "+t+"\n"+e+"\n"+i+" "+o})},r.Wa=function(t,e,n){var r=this;this.info(function(){return"XMLHTTP TEXT ("+t+"): "+r.ng(e)+(n?" "+n:"")})},r.Sg=function(t){this.info(function(){return"TIMEOUT: "+t})},r.debug=function(t){be(this.s,t)},r.cb=function(t,e){var n=this.s;n&&n.ca(e||"Exception",t)},r.info=function(t){me(this.s,t)},r.T=function(t){var e=this.s;e&&e.T(t,void 0)},r.ca=function(t){var e=this.s;e&&e.ca(t,void 0)},r.ng=function(t){if(!this.Wc)return t;if(!t)return null;try{var e=JSON.parse(t);if(e)for(var n=0;n<e.length;n++)h(e[n])&&this.Wf(e[n]);return Wt(e)}catch(r){return this.debug("Exception parsing expected JS array - probably was not JS"),t}},r.Wf=function(t){if(!(2>t.length||(t=t[1],!h(t)||1>t.length))){var e=t[0];if("noop"!=e&&"stop"!=e&&"close"!=e)for(e=1;e<t.length;e++)t[e]=""}},r.Xf=function(t){if(!this.Wc)return t;if(!t)return null;var e="";t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].split("=");if(1<r.length){var i=r[0];r=r[1];var o=i.split("_");e=2<=o.length&&"type"==o[1]?e+(i+"=")+r+"&":e+(i+"=redacted&")}}return e};var _e=new qt;function ke(t){mt.call(this,"serverreachability",t)}function Ee(t){_e.dispatchEvent(new ke(_e,t))}function Te(t,e){mt.call(this,"statevent",t),this.stat=e}function Se(t){_e.dispatchEvent(new Te(_e,t))}function Ce(t,e,n){mt.call(this,"timingevent",t),this.size=e,this.rtt=n}function Oe(t,e,n){_e.dispatchEvent(new Ce(_e,t,e,n))}function Ae(t,e){if(!d(t))throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){t()},e)}k(ke,mt),k(Te,mt),k(Ce,mt);var Ie={NO_ERROR:0,Vg:1,bh:2,ah:3,Yg:4,$g:5,dh:6,Ne:7,TIMEOUT:8,gh:9},xe={Xg:"complete",kh:"success",Oe:"error",Ne:"abort",ih:"ready",jh:"readystatechange",TIMEOUT:"timeout",eh:"incrementaldata",hh:"progress",Zg:"downloadprogress",lh:"uploadprogress"};function Pe(){}function Ne(){}Pe.prototype.pd=null,Pe.prototype.Vd=function(){return this.pd||(this.pd=this.Mf())};var Re,De={OPEN:"a",Wg:"b",Oe:"c",fh:"d"};function je(){mt.call(this,"d")}function Me(){mt.call(this,"c")}function Le(){}function Fe(t,e,n,r,i){this.b=t,this.a=e,this.ra=n,this.R=r,this.Xc=i||1,this.Fc=new oe(this),this.Ua=Ve,t=rt?125:void 0,this.Vc=new ne(t),this.A=null,this.S=!1,this.Da=this.pa=this.ua=this.ic=this.qb=this.hd=this.Ga=null,this.ba=[],this.h=null,this.Bb=0,this.I=this.Fa=null,this.w=-1,this.Za=!1,this.Ra=0,this.ac=null,this.lb=this.Ed=this.yc=!1}k(je,mt),k(Me,mt),k(Le,Pe),Le.prototype.Dd=function(){var t=this.Wd();return t?new ActiveXObject(t):new XMLHttpRequest},Le.prototype.Mf=function(){var t={};return this.Wd()&&(t[0]=!0,t[1]=!0),t},Le.prototype.Wd=function(){if(!this.be&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var t=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],e=0;e<t.length;e++){var n=t[e];try{return new ActiveXObject(n),this.be=n}catch(r){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return this.be},Re=new Le;var Ve=45e3;function Be(t,e){switch(t){case 0:return"Non-200 return code ("+e+")";case 1:return"XMLHTTP failure (no data)";case 2:return"HttpConnection timeout";default:return"Unknown error"}}var Ue={},qe={};function We(t){if(t.H&&"function"==typeof t.H)return t.H();if(s(t))return t.split("");if(f(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}return z(t)}function Ke(t,e,n){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,n);else if(f(t)||s(t))P(t,e,n);else{if(t.W&&"function"==typeof t.W)var r=t.W();else if(t.H&&"function"==typeof t.H)r=void 0;else if(f(t)||s(t)){r=[];for(var i=t.length,o=0;o<i;o++)r.push(o)}else r=G(t);i=We(t),o=i.length;for(var a=0;a<o;a++)e.call(n,i[a],r&&r[a],t)}}function He(t,e){this.D={},this.o=[],this.j=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else t&&this.addAll(t)}function ze(t,e){return Object.prototype.hasOwnProperty.call(t,e)}r=Fe.prototype,r.ga=function(t){this.A=t},r.setTimeout=function(t){this.Ua=t},r.He=function(t){this.Ra=t},r.Gg=function(t){this.ba=t},r.la=function(){return this.ba},r.kd=function(t,e){this.ic=1,this.ua=t.clone().Ub(),this.Da=e,this.yc=!0,this.Ce(null)},r.jd=function(t,e,n){this.ic=1,this.ua=t.clone().Ub(),this.Da=null,this.yc=e,this.Ce(n)},r.Ce=function(t){this.qb=_(),this.eb(),this.pa=this.ua.clone(),this.pa.dc("t",this.Xc),this.Bb=0,this.h=this.b.Jb(this.b.fc()?t:null),0<this.Ra&&(this.ac=new ie(b(this.Me,this,this.h),this.Ra)),this.Fc.nb(this.h,"readystatechange",this.mg),t=this.A?Q(this.A):{},this.Da?(this.Fa||(this.Fa="POST"),t["Content-Type"]="application/x-www-form-urlencoded",this.h.send(this.pa,this.Fa,this.Da,t)):(this.Fa="GET",this.h.send(this.pa,this.Fa,null,t)),Ee(1),this.a.Tg(this.Fa,this.pa,this.R,this.Xc,this.Da)},r.mg=function(t){t=t.target;var e=this.ac;e&&3==t.ma()?(this.a.debug("Throttling readystatechange."),e.mf()):this.Me(t)},r.Me=function(t){try{t==this.h?this.hg():this.a.T("Called back with an unexpected xmlhttp")}catch(n){if(this.a.debug("Failed call to OnXmlHttpReadyStateChanged_"),this.h&&this.h.ya()){var e=this;this.a.cb(n,function(){return"ResponseText: "+e.h.ya()})}else this.a.cb(n,"No response text")}},r.hg=function(){var t=this.h.ma(),e=this.h.Ud(),n=this.h.za();if(!(3>t||3==t&&!rt&&!this.h.ya())){this.Za||4!=t||7==e||Ee(8==e||0>=n?3:2),this.Fb();var r=this.h.za();if(this.w=r,e=this.h.ya(),!e){var i=this;this.a.debug(function(){return"No response text for uri "+i.pa+" status "+r})}if(this.S=200==r,this.a.Ug(this.Fa,this.pa,this.R,this.Xc,t,r),this.S){if(this.Ig()){if(!(n=this.sf()))return this.S=!1,this.I=3,Se(12),this.a.T("XMLHTTP Missing X_HTTP_INITIAL_RESPONSE ("+this.R+")"),this.Ia(),void this.Kb();this.a.Wa(this.R,n,"Initial handshake response via X-HTTP-Initial-Response"),this.lb=!0,this.Yc(n)}this.yc?(this.Fd(t,e),rt&&this.S&&3==t&&this.Ng()):(this.a.Wa(this.R,e,null),this.Yc(e)),4==t&&this.Ia(),this.S&&!this.Za&&(4==t?this.b.Tc(this):(this.S=!1,this.eb()))}else 400==r&&0<e.indexOf("Unknown SID")?(this.I=3,Se(12),this.a.T("XMLHTTP Unknown SID ("+this.R+")")):(this.I=0,Se(13),this.a.T("XMLHTTP Bad status "+r+" ("+this.R+")")),this.Ia(),this.Kb()}},r.Ig=function(){return this.Ed&&!this.lb},r.sf=function(){if(this.h){var t=this.h.kb("X-HTTP-Initial-Response");if(t&&!F(t))return t}return null},r.Ag=function(){this.Ed=!0},r.Fd=function(t,e){for(var n=!0;!this.Za&&this.Bb<e.length;){var r=this.vf(e);if(r==qe){4==t&&(this.I=4,Se(14),n=!1),this.a.Wa(this.R,null,"[Incomplete Response]");break}if(r==Ue){this.I=4,Se(15),this.a.Wa(this.R,e,"[Invalid Chunk]"),n=!1;break}this.a.Wa(this.R,r,null),this.Yc(r)}4==t&&0==e.length&&(this.I=1,Se(16),n=!1),this.S=this.S&&n,n||(this.a.Wa(this.R,e,"[Invalid Chunked Response]"),this.Ia(),this.Kb())},r.kg=function(){if(this.h){var t=this.h.ma(),e=this.h.ya();this.Bb<e.length&&(this.Fb(),this.Fd(t,e),this.S&&4!=t&&this.eb())}},r.Ng=function(){this.Fc.nb(this.Vc,"tick",this.kg),this.Vc.start()},r.vf=function(t){var e=this.Bb,n=t.indexOf("\n",e);return-1==n?qe:(e=Number(t.substring(e,n)),isNaN(e)?Ue:(n+=1,n+e>t.length?qe:(t=t.substr(n,e),this.Bb=n+e,t)))},r.yg=function(t){this.ic=2,this.ua=t.clone().Ub(),t=!1,a.navigator&&a.navigator.sendBeacon&&(t=a.navigator.sendBeacon(this.ua.toString(),"")),!t&&a.Image&&((new Image).src=this.ua,t=!0),t||(this.h=this.b.Jb(null),this.h.send(this.ua)),this.qb=_(),this.eb()},r.cancel=function(){this.Za=!0,this.Ia()},r.tg=function(t){t&&this.setTimeout(t),this.Ga&&(this.Fb(),this.eb())},r.eb=function(){this.hd=_()+this.Ua,this.Ke(this.Ua)},r.Ke=function(t){if(null!=this.Ga)throw Error("WatchDog timer not null");this.Ga=Ae(b(this.gg,this),t)},r.Fb=function(){this.Ga&&(a.clearTimeout(this.Ga),this.Ga=null)},r.gg=function(){this.Ga=null;var t=_();0<=t-this.hd?this.Df():(this.a.T("WatchDog timer called too early"),this.Ke(this.hd-t))},r.Df=function(){this.S&&this.a.ca("Received watchdog timeout even though request loaded successfully"),this.a.Sg(this.pa),2!=this.ic&&(Ee(3),Se(17)),this.Ia(),this.I=2,this.Kb()},r.Kb=function(){this.b.de()||this.Za||this.b.Tc(this)},r.Ia=function(){this.Fb();var t=this.ac;t&&"function"==typeof t.bb&&t.bb(),this.ac=null,this.Vc.stop(),this.Fc.pb(),this.h&&(t=this.h,this.h=null,t.abort(),t.bb())},r.Hc=function(){return this.I},r.Yc=function(t){try{this.b.ue(this,t),Ee(4)}catch(e){this.a.cb(e,"Error in httprequest callback")}},r=He.prototype,r.C=function(){return this.j},r.H=function(){this.wc();for(var t=[],e=0;e<this.o.length;e++)t.push(this.D[this.o[e]]);return t},r.W=function(){return this.wc(),this.o.concat()},r.va=function(t){return ze(this.D,t)},r.X=function(){return 0==this.j},r.clear=function(){this.D={},this.j=this.o.length=0},r.remove=function(t){return!!ze(this.D,t)&&(delete this.D[t],this.j--,this.o.length>2*this.j&&this.wc(),!0)},r.wc=function(){if(this.j!=this.o.length){for(var t=0,e=0;t<this.o.length;){var n=this.o[t];ze(this.D,n)&&(this.o[e++]=n),t++}this.o.length=e}if(this.j!=this.o.length){var r={};for(e=t=0;t<this.o.length;)n=this.o[t],ze(r,n)||(this.o[e++]=n,r[n]=1),t++;this.o.length=e}},r.get=function(t,e){return ze(this.D,t)?this.D[t]:e},r.set=function(t,e){ze(this.D,t)||(this.j++,this.o.push(t)),this.D[t]=e},r.addAll=function(t){if(t instanceof He)for(var e=t.W(),n=0;n<e.length;n++)this.set(e[n],t.get(e[n]));else for(e in t)this.set(e,t[e])},r.forEach=function(t,e){for(var n=this.W(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}},r.clone=function(){return new He(this)};var Ge=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Qe(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Ye(t,e){var n;this.xa=this.zb=this.qa="",this.Ca=null,this.ib=this.K="",this.O=this.Qf=!1,t instanceof Ye?(this.O=void 0!==e?e:t.O,this.tb(t.qa),this.cd(t.zb),this.rb(t.xa),this.sb(t.Ca),this.ec(t.K),this.bd(t.P.clone()),this.$c(t.ib)):t&&(n=String(t).match(Ge))?(this.O=!!e,this.tb(n[1]||"",!0),this.cd(n[2]||"",!0),this.rb(n[3]||"",!0),this.sb(n[4]),this.ec(n[5]||"",!0),this.bd(n[6]||"",!0),this.$c(n[7]||"",!0)):(this.O=!!e,this.P=new sn(null,this.O))}function Xe(t){return t instanceof Ye?t.clone():new Ye(t,void 0)}function Je(t,e,n,r){var i=new Ye(null,void 0);return t&&i.tb(t),e&&i.rb(e),n&&i.sb(n),r&&i.ec(r),i}function $e(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ze(t,e,n){return s(t)?(t=encodeURI(t).replace(e,tn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function tn(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(15&t).toString(16)}r=Ye.prototype,r.toString=function(){var t=[],e=this.qa;e&&t.push(Ze(e,en,!0),":");var n=this.xa;return(n||"file"==e)&&(t.push("//"),(e=this.zb)&&t.push(Ze(e,en,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.Ca,null!=n&&t.push(":",String(n))),(n=this.K)&&(this.Ic()&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ze(n,"/"==n.charAt(0)?rn:nn,!0))),(n=this.Rd())&&t.push("?",n),(n=this.ib)&&t.push("#",Ze(n,an)),t.join("")},r.resolve=function(t){var e=this.clone(),n=t.Hf();n?e.tb(t.qa):n=t.If(),n?e.cd(t.zb):n=t.Ic(),n?e.rb(t.xa):n=t.Ff();var r=t.K;if(n)e.sb(t.Ca);else if(n=t.ae()){if("/"!=r.charAt(0))if(this.Ic()&&!this.ae())r="/"+r;else{var i=e.K.lastIndexOf("/");-1!=i&&(r=e.K.substr(0,i+1)+r)}if(i=r,".."==i||"."==i)r="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.ec(r):n=t.Gf(),n?e.bd(t.P.clone()):n=t.Ef(),n&&e.$c(t.ib),e},r.clone=function(){return new Ye(this)},r.tb=function(t,e){this.U(),(this.qa=e?$e(t,!0):t)&&(this.qa=this.qa.replace(/:$/,""))},r.Hf=function(){return!!this.qa},r.cd=function(t,e){this.U(),this.zb=e?$e(t):t},r.If=function(){return!!this.zb},r.rb=function(t,e){this.U(),this.xa=e?$e(t,!0):t},r.Ic=function(){return!!this.xa},r.sb=function(t){if(this.U(),t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);this.Ca=t}else this.Ca=null},r.Ff=function(){return null!=this.Ca},r.ec=function(t,e){this.U(),this.K=e?$e(t,!0):t},r.ae=function(){return!!this.K},r.Gf=function(){return""!==this.P.toString()},r.bd=function(t,e){this.U(),t instanceof sn?(this.P=t,this.P.ad(this.O)):(e||(t=Ze(t,on)),this.P=new sn(t,this.O))},r.Rd=function(){return this.P.toString()},r.getQuery=function(){return this.Rd()},r.l=function(t,e){this.U(),this.P.set(t,e)},r.dc=function(t,e){this.U(),h(e)||(e=[String(e)]),this.P.Ie(t,e)},r.$c=function(t,e){this.U(),this.ib=e?$e(t):t},r.Ef=function(){return!!this.ib},r.Ub=function(){return this.U(),this.l("zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^_()).toString(36)),this},r.removeParameter=function(t){return this.U(),this.P.remove(t),this},r.U=function(){if(this.Qf)throw Error("Tried to modify a read-only Uri")},r.ad=function(t){this.O=t,this.P&&this.P.ad(t)};var en=/[#\/\?@]/g,nn=/[#\?:]/g,rn=/[#\?]/g,on=/[#\?@]/g,an=/#/g;function sn(t,e){this.j=this.m=null,this.ja=t||null,this.O=!!e}function un(){}function cn(){}function ln(t,e){this.b=t,this.a=e,this.f=this.A=null,this.bc=!1,this.K=null,this.w=-1,this.Ad=this.na=null}function hn(){this.od=this.$d=null}function fn(t){this.D=new He,t&&this.addAll(t)}function dn(t){var e=typeof t;return"object"==e&&t||"function"==e?"o"+(t[v]||(t[v]=++y)):e.substr(0,1)+t}function pn(t,e){this.Pc=t,this.map=e,this.context=null}function vn(t){this.me=t||yn,a.PerformanceNavigationTiming?(t=a.performance.getEntriesByType("navigation"),t=0<t.length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol)):t=!!(a.vc&&a.vc.ke&&a.vc.ke()&&a.vc.ke().nh),this.Xb=t?this.me:1,this.v=null,1<this.Xb&&(this.v=new fn),this.f=null,this.ba=[]}r=sn.prototype,r.$=function(){if(!this.m&&(this.m=new He,this.j=0,this.ja)){var t=this;Qe(this.ja,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})}},r.C=function(){return this.$(),this.j},r.add=function(t,e){this.$(),this.Oa(),t=this.Ma(t);var n=this.m.get(t);return n||this.m.set(t,n=[]),n.push(e),this.j+=1,this},r.remove=function(t){return this.$(),t=this.Ma(t),!!this.m.va(t)&&(this.Oa(),this.j-=this.m.get(t).length,this.m.remove(t))},r.clear=function(){this.Oa(),this.m=null,this.j=0},r.X=function(){return this.$(),0==this.j},r.va=function(t){return this.$(),t=this.Ma(t),this.m.va(t)},r.forEach=function(t,e){this.$(),this.m.forEach(function(n,r){P(n,function(n){t.call(e,n,r,this)},this)},this)},r.W=function(){this.$();for(var t=this.m.H(),e=this.m.W(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},r.H=function(t){this.$();var e=[];if(s(t))this.va(t)&&(e=M(e,this.m.get(this.Ma(t))));else{t=this.m.H();for(var n=0;n<t.length;n++)e=M(e,t[n])}return e},r.set=function(t,e){return this.$(),this.Oa(),t=this.Ma(t),this.va(t)&&(this.j-=this.m.get(t).length),this.m.set(t,[e]),this.j+=1,this},r.get=function(t,e){return t?(t=this.H(t),0<t.length?String(t[0]):e):e},r.Ie=function(t,e){this.remove(t),0<e.length&&(this.Oa(),this.m.set(this.Ma(t),L(e)),this.j+=e.length)},r.toString=function(){if(this.ja)return this.ja;if(!this.m)return"";for(var t=[],e=this.m.W(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.H(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.ja=t.join("&")},r.Oa=function(){this.ja=null},r.clone=function(){var t=new sn;return t.ja=this.ja,this.m&&(t.m=this.m.clone(),t.j=this.j),t},r.Ma=function(t){return t=String(t),this.O&&(t=t.toLowerCase()),t},r.ad=function(t){t&&!this.O&&(this.$(),this.Oa(),this.m.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(this.remove(e),this.Ie(n,t))},this)),this.O=t},r.extend=function(t){for(var e=0;e<arguments.length;e++)Ke(arguments[e],function(t,e){this.add(e,t)},this)},k(cn,un),r=ln.prototype,r.g=null,r.ga=function(t){this.A=t},r.connect=function(t){this.K=t,t=this.b.Sd(this.K),Se(3);var e=this.b.Ib.$d;null!=e?(this.na=this.b.$a(e[0]),this.g=1,this.xd()):(t.dc("MODE","init"),!this.b.ta&&this.b.aa&&t.dc("X-HTTP-Session-Id",this.b.aa),this.f=new Fe(this,this.a,void 0,void 0,void 0),this.f.ga(this.A),this.f.jd(t,!1,null),this.g=0)},r.xd=function(){this.a.debug("TestConnection: starting stage 2");var t=this.b.Ib.od;if(null!=t)this.a.debug(function(){return"Buffered"}),Se(4),t?(Se(10),this.b.ub(this,!1)):(Se(11),this.b.ub(this,!0));else{this.f=new Fe(this,this.a,void 0,void 0,void 0),this.f.ga(this.A);var e=this.b.Pd(this.na,this.K);Se(4),e.dc("TYPE","xmlhttp");var n=this.b.aa,r=this.b.Kc;n&&r&&e.l(n,r),this.f.jd(e,!1,this.na)}},r.Jb=function(t){return this.b.Jb(t)},r.abort=function(){this.f&&(this.f.cancel(),this.f=null),this.w=-1},r.de=function(){return!1},r.ue=function(t,e){if(this.w=t.w,0==this.g)if(this.a.debug("TestConnection: Got data for stage 1"),this.pc(t),e){try{var n=this.b.kc.zc(e)}catch(r){return this.a.cb(r),void this.b.dd(this)}this.na=this.b.$a(n[0])}else this.a.debug("TestConnection: Null responseText"),this.b.dd(this);else 1==this.g&&(this.bc?Se(6):"11111"==e?(Se(5),this.bc=!0,this.Ze()&&(this.w=200,this.f.cancel(),this.a.debug("Test connection succeeded; using streaming connection"),Se(11),this.b.ub(this,!0))):(Se(7),this.bc=!1))},r.Tc=function(){this.w=this.f.w,this.f.S?0==this.g?(this.g=1,this.a.debug("TestConnection: request complete for initial check"),this.xd()):1==this.g&&(this.a.debug("TestConnection: request complete for stage 2"),this.bc?(this.a.debug("Test connection succeeded; using streaming connection"),Se(11),this.b.ub(this,!0)):(this.a.debug("Test connection failed; not using streaming"),Se(10),this.b.ub(this,!1))):(this.a.debug("TestConnection: request failed, in state "+this.g),0==this.g?Se(8):1==this.g&&Se(9),this.b.dd(this))},r.pc=function(t){if(!this.b.ta&&(t=t.h)){var e=t.kb("X-Client-Wire-Protocol");this.Ad=e||null,this.b.aa&&((t=t.kb("X-HTTP-Session-Id"))?this.b.Fe(t):this.a.T("Missing X_HTTP_SESSION_ID in the handshake response"))}},r.fc=function(){return this.b.fc()},r.Ba=function(){return this.b.Ba()},r.Ze=function(){return!et||10<=Number(lt)},r=fn.prototype,r.C=function(){return this.D.C()},r.add=function(t){this.D.set(dn(t),t)},r.addAll=function(t){t=We(t);for(var e=t.length,n=0;n<e;n++)this.add(t[n])},r.pb=function(t){t=We(t);for(var e=t.length,n=0;n<e;n++)this.remove(t[n])},r.remove=function(t){return this.D.remove(dn(t))},r.clear=function(){this.D.clear()},r.X=function(){return this.D.X()},r.contains=function(t){return this.D.va(dn(t))},r.H=function(){return this.D.H()},r.clone=function(){return new fn(this)};var yn=10;function gn(){this.xg=this.rg=void 0}function mn(){this.jg=new gn}function bn(t,e){var n=new we;n.debug("TestLoadImage: loading "+t);var r=new Image;r.onload=w(wn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=w(wn,n,r,"TestLoadImage: error",!1,e),r.onabort=w(wn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=w(wn,n,r,"TestLoadImage: timeout",!1,e),a.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}function wn(t,e,n,r,i){try{t.debug(n),e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){t.cb(o)}}r=vn.prototype,r.ld=function(t){this.v||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(this.Xb=this.me,this.v=new fn,this.f&&(this.oc(this.f),this.f=null))},r.ee=function(){return!!this.f||!!this.v&&this.v.C()>=this.Xb},r.xf=function(){return this.f?1:this.v?this.v.C():0},r.Jc=function(t){return this.f?this.f==t:!!this.v&&this.v.contains(t)},r.oc=function(t){this.v?this.v.add(t):this.f=t},r.ze=function(t){this.f&&this.f==t?this.f=null:this.v&&this.v.contains(t)&&this.v.remove(t)},r.cancel=function(){this.ba=this.la(),this.f?(this.f.cancel(),this.f=null):this.v&&!this.v.X()&&(P(this.v.H(),function(t){t.cancel()}),this.v.clear())},r.la=function(){if(null!=this.f)return this.ba.concat(this.f.la());if(null!=this.v&&!this.v.X()){var t=this.ba;return P(this.v.H(),function(e){t=t.concat(e.la())}),t}return L(this.ba)},r.Re=function(t){this.ba=this.ba.concat(t)},r.$e=function(){this.ba.length=0},gn.prototype.stringify=function(t){return a.JSON.stringify(t,this.rg)},gn.prototype.parse=function(t){return a.JSON.parse(t,this.xg)},mn.prototype.hf=function(t,e,n){var r=n||"";try{Ke(t,function(t,n){var i=t;p(t)&&(i=Wt(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}},mn.prototype.jf=function(t,e,n){for(var r=-1;;){var i=["count="+e];-1==r?0<e?(r=t[0].Pc,i.push("ofs="+r)):r=0:i.push("ofs="+r);for(var o=!0,a=0;a<e;a++){var s=t[a].Pc,u=t[a].map;if(s-=r,0>s)r=Math.max(0,t[a].Pc-100),o=!1;else try{this.hf(u,i,"req"+s+"_")}catch(c){n&&n(u)}}if(o)return i.join("&")}},mn.prototype.zc=function(t){return this.jg.parse(t)};var _n=a.JSON.parse;function kn(t){qt.call(this),this.headers=new He,this.Xa=t||null,this.ha=!1,this.mc=this.c=null,this.ge=this.Tb="",this.Pa=0,this.I="",this.Aa=this.Lc=this.Qb=this.Ec=!1,this.vb=0,this.hc=null,this.Ae=En,this.jc=this.lg=this.Ab=!1}k(kn,qt);var En="";kn.prototype.s=ge("goog.net.XhrIo");var Tn=/^https?$/i,Sn=["POST","PUT"];function Cn(t){return et&&ft(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}function On(t){return"content-type"==t.toLowerCase()}function An(t,e){return{type:e,lengthComputable:t.lengthComputable,loaded:t.loaded,total:t.total}}function In(t){var e="";return H(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}function xn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}if(r)return t;if(n=In(n),s(t)){if(e=encodeURIComponent(String(e)),n=null!=n?"="+encodeURIComponent(String(n)):"",e+=n){if(n=t.indexOf("#"),0>n&&(n=t.length),r=t.indexOf("?"),0>r||r>n){r=n;var i=""}else i=t.substring(r+1,n);t=[t.substr(0,r),i,t.substr(n)],n=t[1],t[1]=e?n?n+"&"+e:e:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return t.l(e,n),t}function Pn(t){this.Bd=22,this.De=0,this.M=[],this.a=new we,this.Ib=new hn,this.na=this.md=this.hb=this.K=this.u=this.Kc=this.aa=this.gb=this.N=this.Rb=this.A=null,this.Te=!0,this.ag=this.Yb=0,this.kf=!!u("internalChannelParams.failFast",t),this.fd=this.Ja=this.wa=this.ia=this.ea=this.i=null,this.Se=!0,this.w=this.he=this.Sb=-1,this.rc=this.Ha=this.La=0,this.Ve=u("internalChannelParams.baseRetryDelayMs",t)||5e3,this.vg=u("internalChannelParams.retryDelaySeedMs",t)||1e4,this.nf=u("internalChannelParams.forwardChannelMaxRetries",t)||2,this.Od=u("internalChannelParams.forwardChannelRequestTimeoutMs",t)||2e4,this.Xa=t&&t.oh||void 0,this.Db=void 0,this.Ra=0,this.gc=t&&t.supportsCrossDomainXhr||!1,this.ra="",this.G=new vn(t&&t.concurrentRequestLimit),this.kc=new mn,this.ta=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,(this.Nd=t&&t.fastHandshake||!1)&&!this.ta&&(this.a.T("Force backgroundChannelTest when fastHandshake is enabled."),this.ta=!0),t&&t.Id&&this.a.Id()}function Nn(){}function Rn(t){for(var e=arguments[0],n=1;n<arguments.length;n++){var r,i=arguments[n];if(0==i.lastIndexOf("/",0))e=i;else(r=""==e)||(r=e.length-1,r=0<=r&&e.indexOf("/",r)==r),e=r?e+i:e+"/"+i}return e}function Dn(){if(et&&!(10<=Number(lt)))throw Error("Environmental error: no available transport.")}function jn(t,e){qt.call(this),this.b=new Pn(e),this.yb=t,this.Qg=e&&e.testUrl?e.testUrl:Rn(this.yb,"test"),this.s=ge("goog.labs.net.webChannel.WebChannelBaseTransport"),this.Rc=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.b.ga(t),t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.zd&&(t?t["X-WebChannel-Client-Profile"]=e.zd:t={"X-WebChannel-Client-Profile":e.zd}),this.b.Eg(t),(t=e&&e.httpHeadersOverwriteParam)&&!F(t)&&this.b.Cg(t),this.Og=e&&e.supportsCrossDomainXhr||!1,this.zg=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!F(e)&&(this.b.Dg(e),t=this.Rc,null!==t&&e in t&&(t=this.Rc,e in t&&delete t[e],(t=this.s)&&t.T("Ignore httpSessionIdParam also specified with messageUrlParams: "+e,void 0))),this.vd=new Fn(this)}function Mn(t){je.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.ne=t)&&(t=this.ne,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Ln(t){Me.call(this),this.status=1,this.errorCode=t}function Fn(t){this.b=t}r=kn.prototype,r.Je=function(t){this.Ab=t},r.send=function(t,e,n,r){if(this.c)throw Error("[goog.net.XhrIo] Object is active with another request="+this.Tb+"; newUri="+t);e=e?e.toUpperCase():"GET",this.Tb=t,this.I="",this.Pa=0,this.ge=e,this.Ec=!1,this.ha=!0,this.c=this.df(),this.mc=this.Xa?this.Xa.Vd():Re.Vd(),this.c.onreadystatechange=b(this.te,this),this.lg&&"onprogress"in this.c&&(this.c.onprogress=b(function(t){this.re(t,!0)},this),this.c.upload&&(this.c.upload.onprogress=b(this.re,this)));try{be(this.s,this.da("Opening Xhr")),this.Lc=!0,this.c.open(e,String(t),!0),this.Lc=!1}catch(o){return be(this.s,this.da("Error opening Xhr: "+o.message)),void this.Ld(o)}t=n||"";var i=this.headers.clone();r&&Ke(r,function(t,e){i.set(e,t)}),r=R(i.W()),n=a.FormData&&t instanceof a.FormData,!(0<=I(Sn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.c.setRequestHeader(e,t)},this),this.Ae&&(this.c.responseType=this.Ae),"withCredentials"in this.c&&this.c.withCredentials!==this.Ab&&(this.c.withCredentials=this.Ab);try{this.yd(),0<this.vb&&(this.jc=Cn(this.c),be(this.s,this.da("Will abort after "+this.vb+"ms if incomplete, xhr2 "+this.jc)),this.jc?(this.c.timeout=this.vb,this.c.ontimeout=b(this.Ua,this)):this.hc=re(this.Ua,this.vb,this)),be(this.s,this.da("Sending request")),this.Qb=!0,this.c.send(t),this.Qb=!1}catch(o){be(this.s,this.da("Send error: "+o.message)),this.Ld(o)}},r.df=function(){return this.Xa?this.Xa.Dd():Re.Dd()},r.Ua=function(){"undefined"!=typeof o&&this.c&&(this.I="Timed out after "+this.vb+"ms, aborting",this.Pa=8,be(this.s,this.da(this.I)),this.dispatchEvent("timeout"),this.abort(8))},r.Ld=function(t){this.ha=!1,this.c&&(this.Aa=!0,this.c.abort(),this.Aa=!1),this.I=t,this.Pa=5,this.Jd(),this.Gb()},r.Jd=function(){this.Ec||(this.Ec=!0,this.dispatchEvent("complete"),this.dispatchEvent("error"))},r.abort=function(t){this.c&&this.ha&&(be(this.s,this.da("Aborting")),this.ha=!1,this.Aa=!0,this.c.abort(),this.Aa=!1,this.Pa=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),this.Gb())},r.F=function(){this.c&&(this.ha&&(this.ha=!1,this.Aa=!0,this.c.abort(),this.Aa=!1),this.Gb(!0)),kn.L.F.call(this)},r.te=function(){this.Ka||(this.Lc||this.Qb||this.Aa?this.se():this.eg())},r.eg=function(){this.se()},r.se=function(){if(this.ha&&"undefined"!=typeof o)if(this.mc[1]&&4==this.ma()&&2==this.za())be(this.s,this.da("Local request error detected and ignored"));else if(this.Qb&&4==this.ma())re(this.te,0,this);else if(this.dispatchEvent("readystatechange"),this.Mc()){be(this.s,this.da("Request complete")),this.ha=!1;try{this.Rf()?(this.dispatchEvent("complete"),this.dispatchEvent("success")):(this.Pa=6,this.I=this.Yd()+" ["+this.za()+"]",this.Jd())}finally{this.Gb()}}},r.re=function(t,e){this.dispatchEvent(An(t,"progress")),this.dispatchEvent(An(t,e?"downloadprogress":"uploadprogress"))},r.Gb=function(t){if(this.c){this.yd();var e=this.c,n=this.mc[0]?c:null;this.mc=this.c=null,t||this.dispatchEvent("ready");try{e.onreadystatechange=n}catch(r){(t=this.s)&&t.ca("Problem encountered resetting onreadystatechange: "+r.message,void 0)}}},r.yd=function(){this.c&&this.jc&&(this.c.ontimeout=null),this.hc&&(a.clearTimeout(this.hc),this.hc=null)},r.Ba=function(){return!!this.c},r.Mc=function(){return 4==this.ma()},r.Rf=function(){var t=this.za();t:switch(t){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}return e||0===t&&!this.Of()},r.Of=function(){var t=String(this.Tb).match(Ge)[1]||null;return!t&&a.self&&a.self.location&&(t=a.self.location.protocol,t=t.substr(0,t.length-1)),Tn.test(t?t.toLowerCase():"")},r.ma=function(){return this.c?this.c.readyState:0},r.za=function(){try{return 2<this.ma()?this.c.status:-1}catch(t){return-1}},r.Yd=function(){try{return 2<this.ma()?this.c.statusText:""}catch(t){return be(this.s,"Can not get status: "+t.message),""}},r.ya=function(){try{return this.c?this.c.responseText:""}catch(t){return be(this.s,"Can not get responseText: "+t.message),""}},r.yf=function(t){if(this.c){var e=this.c.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),_n(e)}},r.getResponseHeader=function(t){if(this.c&&this.Mc())return t=this.c.getResponseHeader(t),null===t?void 0:t},r.getAllResponseHeaders=function(){return this.c&&this.Mc()&&this.c.getAllResponseHeaders()||""},r.kb=function(t){return this.c?this.c.getResponseHeader(t):null},r.Ud=function(){return this.Pa},r.Hc=function(){return s(this.I)?this.I:String(this.I)},r.da=function(t){return t+" ["+this.ge+" "+this.Tb+" "+this.za()+"]"},r=Pn.prototype,r.tc=8,r.g=1,r.connect=function(t,e,n,r,i){this.a.debug("connect()"),Se(0),this.K=e,this.gb=n||{},r&&void 0!==i&&(this.gb.OSID=r,this.gb.OAID=i),this.ta&&(this.a.debug("connect() bypassed channel-test."),this.Ib.$d=[],this.Ib.od=!1),this.bf(t)},r.disconnect=function(){if(this.a.debug("disconnect()"),this.qd(),3==this.g){var t=this.Yb++,e=this.hb.clone();e.l("SID",this.ra),e.l("RID",t),e.l("TYPE","terminate"),this.Ya(e),new Fe(this,this.a,this.ra,t,void 0).yg(e)}this.qe()},r.bf=function(t){this.a.debug("connectTest_()"),this.Ja=new ln(this,this.a),null===this.N&&this.Ja.ga(this.A);var e=t;this.N&&this.A&&(e=xn(t,this.N,this.A)),this.Ja.connect(e)},r.af=function(){this.a.debug("connectChannel_()"),this.hb=this.Sd(this.K),this.Dc()},r.qd=function(){this.Ja&&(this.Ja.abort(),this.Ja=null),this.u&&(this.u.cancel(),this.u=null),this.ia&&(a.clearTimeout(this.ia),this.ia=null),this.Hb(),this.G.cancel(),this.ea&&(a.clearTimeout(this.ea),this.ea=null)},r.ga=function(t){this.A=t},r.Eg=function(t){this.Rb=t},r.Cg=function(t){this.N=t},r.Dg=function(t){this.aa=t},r.Fe=function(t){this.Kc=t},r.He=function(t){this.Ra=t},r.Hg=function(){this.gc=!0},r.Ee=function(t){this.i=t},r.Nf=function(){return!this.fd},r.Zc=function(t){1e3==this.M.length&&this.a.ca(function(){return"Already have 1000 queued maps upon queueing "+Wt(t)}),this.M.push(new pn(this.ag++,t)),3==this.g&&this.Dc()},r.qf=function(){return this.kf?0:this.nf},r.de=function(){return 0==this.g},r.getState=function(){return this.g},r.Dc=function(){this.G.ee()||this.ea||(this.ea=Ae(b(this.we,this),0),this.La=0)},r.Yf=function(t){return this.G.xf()>=this.G.Xb-(this.ea?1:0)?(this.a.ca("Unexpected retry request is scheduled."),!1):this.ea?(this.a.debug("Use the retry request that is already scheduled."),this.M=t.la().concat(this.M),!0):!(1==this.g||2==this.g||this.La>=this.qf())&&(this.a.debug("Going to retry POST"),this.ea=Ae(b(this.we,this,t),this.Xd(this.La)),this.La++,!0)},r.we=function(t){this.ea=null,this.Mg(t)},r.Mg=function(t){this.a.debug("startForwardChannel_"),1==this.g?t?this.a.ca("Not supposed to retry the open"):(this.ig(),this.g=2):3==this.g&&(t?this.le(t):0==this.M.length?this.a.debug("startForwardChannel_ returned: nothing to send"):this.G.ee()?this.a.ca("startForwardChannel_ returned: connection already in progress"):(this.le(),this.a.debug("startForwardChannel_ finished, sent request")))},r.ig=function(){this.a.debug("open_()"),this.Yb=Math.floor(1e5*Math.random());var t=this.Yb++,e=new Fe(this,this.a,"",t,void 0),n=this.A;this.Rb&&(n?(n=Q(n),X(n,this.Rb)):n=this.Rb),null===this.N&&e.ga(n);var r=this.Hd(e),i=this.hb.clone();i.l("RID",t),0<this.Bd&&i.l("CVER",this.Bd),this.ta&&this.aa&&i.l("X-HTTP-Session-Id",this.aa),this.Ya(i),this.N&&n&&xn(i,this.N,n),this.G.oc(e),this.Nd?(i.l("$req",r),i.l("SID","null"),e.Ag(),e.kd(i,null)):e.kd(i,r)},r.le=function(t){var e=t?t.R:this.Yb++,n=this.hb.clone();n.l("SID",this.ra),n.l("RID",e),n.l("AID",this.Sb),this.Ya(n),this.N&&this.A&&xn(n,this.N,this.A),e=new Fe(this,this.a,this.ra,e,this.La+1),null===this.N&&e.ga(this.A),t&&this.sg(t),t=this.Hd(e),e.setTimeout(Math.round(.5*this.Od)+Math.round(.5*this.Od*Math.random())),this.G.oc(e),e.kd(n,t)},r.Ya=function(t){this.i&&Ke({},function(e,n){t.l(n,e)})},r.Hd=function(t){var e=Math.min(this.M.length,1e3),n=this.i?b(this.i.Ue,this.i,this):null;return n=this.kc.jf(this.M,e,n),t.Gg(this.M.splice(0,e)),n},r.sg=function(t){this.M=t.la().concat(this.M)},r.Kd=function(){if(!this.u&&!this.ia){this.rc=1;var t=this.ve;Gt||$t(),Zt||(Gt(),Zt=!0),te.add(t,this),this.Ha=0}},r.Qc=function(){return this.u||this.ia?(this.a.ca("Request already in progress"),!1):!(3<=this.Ha)&&(this.a.debug("Going to retry GET"),this.rc++,this.ia=Ae(b(this.ve,this),this.Xd(this.Ha)),this.Ha++,!0)},r.ve=function(){this.ia=null,this.Kg()},r.Kg=function(){this.a.debug("Creating new HttpRequest"),this.u=new Fe(this,this.a,this.ra,"rpc",this.rc),null===this.N&&this.u.ga(this.A),this.u.He(this.Ra);var t=this.md.clone();t.l("RID","rpc"),t.l("SID",this.ra),t.l("CI",this.fd?"0":"1"),t.l("AID",this.Sb),this.Ya(t),t.l("TYPE","xmlhttp"),this.N&&this.A&&xn(t,this.N,this.A),this.Db&&this.u.setTimeout(this.Db),this.u.jd(t,!0,this.na),this.a.debug("New Request created")},r.ub=function(t,e){this.a.debug("Test Connection Finished");var n=t.Ad;n&&this.G.ld(n),this.fd=this.Se&&e,this.w=t.w,this.af()},r.dd=function(t){this.a.debug("Test Connection Failed"),this.w=t.w,this.sa(2)},r.ue=function(t,e){if(0!=this.g&&(this.u==t||this.G.Jc(t)))if(this.w=t.w,!t.lb&&this.G.Jc(t)&&3==this.g){try{var n=this.kc.zc(e)}catch(r){n=null}h(n)&&3==n.length?this.Cf(n,t):(this.a.debug("Bad POST response data returned"),this.sa(11))}else(t.lb||this.u==t)&&this.Hb(),F(e)||(n=this.kc.zc(e),this.dg(n,t))},r.Cf=function(t,e){0==t[0]?this.Bf(e):(this.he=t[1],e=this.he-this.Sb,0<e&&(t=t[2],this.a.debug(t+" bytes (in "+e+" arrays) are outstanding on the BackChannel"),this.Jg(t)&&!this.wa&&(this.wa=Ae(b(this.bg,this),6e3))))},r.Bf=function(t){if(this.a.debug("Server claims our backchannel is missing."),this.ia)this.a.debug("But we are currently starting the request.");else{if(this.u){if(!(this.u.qb+3e3<t.qb))return;this.Hb(),this.u.cancel(),this.u=null}else this.a.T("We do not have a BackChannel established");this.Qc(),Se(18)}},r.Jg=function(t){return 37500>t&&!this.Nf()&&0==this.Ha},r.$a=function(t){return this.Te?this.i?this.i.$a(t):t:null},r.bg=function(){null!=this.wa&&(this.wa=null,this.u.cancel(),this.u=null,this.Qc(),Se(19))},r.Hb=function(){null!=this.wa&&(a.clearTimeout(this.wa),this.wa=null)},r.Tc=function(t){this.a.debug("Request complete");var e=null;if(this.u==t){this.Hb(),this.u=null;var n=2}else{if(!this.G.Jc(t))return;e=t.la(),this.G.ze(t),n=1}if(this.w=t.w,0!=this.g)if(t.S)1==n?(Oe(t.Da?t.Da.length:0,_()-t.qb,this.La),this.Dc()):this.Kd();else{var r=t.Hc();if(3==r||0==r&&0<this.w)this.a.debug("Not retrying due to error type");else{var i=this;if(this.a.debug(function(){return"Maybe retrying, last error: "+Be(r,i.w)}),1==n&&this.Yf(t)||2==n&&this.Qc())return;this.a.debug("Exceeded max number of retries")}switch(e&&0<e.length&&this.G.Re(e),this.a.debug("Error: HTTP request failed"),r){case 1:this.sa(5);break;case 4:this.sa(10);break;case 3:this.sa(6);break;default:this.sa(2)}}},r.Xd=function(t){var e=this.Ve+Math.floor(Math.random()*this.vg);return this.Ba()||(this.a.debug("Inactive channel"),e*=2),e*t},r.pc=function(t){if(this.ta&&(t=t.h)){var e=t.kb("X-Client-Wire-Protocol");e&&this.G.ld(e),this.aa&&((t=t.kb("X-HTTP-Session-Id"))?(this.Fe(t),this.hb.l(this.aa,t)):this.a.T("Missing X_HTTP_SESSION_ID in the handshake response"))}},r.dg=function(t,e){for(var n=this.i&&this.i.sc?[]:null,r=0;r<t.length;r++){var i=t[r];if(this.Sb=i[0],i=i[1],2==this.g)if("c"==i[0]){this.ra=i[1],this.na=this.$a(i[2]);var o=i[3];null!=o&&(this.tc=o,this.a.info("VER="+this.tc)),o=i[4],null!=o&&(this.De=o,this.a.info("SVER="+this.De)),i=i[5],null!=i&&"number"==typeof i&&0<i&&(this.Db=i*=1.5,this.a.info("backChannelRequestTimeoutMs_="+i)),this.pc(e),this.g=3,this.i&&this.i.wd(),this.Lg(e)}else"stop"!=i[0]&&"close"!=i[0]||this.sa(7);else 3==this.g&&("stop"==i[0]||"close"==i[0]?(n&&0!=n.length&&(this.i.sc(this,n),n.length=0),"stop"==i[0]?this.sa(7):this.disconnect()):"noop"!=i[0]&&(n?n.push(i):this.i&&this.i.ud(i)),this.Ha=0)}n&&0!=n.length&&this.i.sc(this,n)},r.Lg=function(t){this.md=this.Pd(this.na,this.K),t.lb?(this.a.debug("Upgrade the handshake request to a backchannel."),this.G.ze(t),t.tg(this.Db),this.u=t):this.Kd()},r.sa=function(t){if(this.a.info("Error code "+t),2==t){var e=null;this.i&&(e=null);var n=b(this.Pg,this);e||(e=new Ye("//www.google.com/images/cleardot.gif"),a.location&&"http"==a.location.protocol||e.tb("https"),e.Ub()),bn(e.toString(),n)}else Se(2);this.cg(t)},r.Pg=function(t){t?(this.a.info("Successfully pinged google.com"),Se(2)):(this.a.info("Failed to ping google.com"),Se(1))},r.cg=function(t){this.a.debug("HttpChannel: error - "+t),this.g=0,this.i&&this.i.td(t),this.qe(),this.qd()},r.qe=function(){if(this.g=0,this.w=-1,this.i){var t=this.G.la();if(0!=t.length||0!=this.M.length){var e=this;this.a.debug(function(){return"Number of undelivered maps, pending: "+t.length+", outgoing: "+e.M.length}),this.G.$e(),L(this.M),this.M.length=0}this.i.sd()}},r.Sd=function(t){return t=this.Cd(null,t),this.a.debug("GetForwardChannelUri: "+t),t},r.Pd=function(t,e){return t=this.Cd(this.fc()?t:null,e),this.a.debug("GetBackChannelUri: "+t),t},r.Cd=function(t,e){var n=Xe(e);if(""!=n.xa)t&&n.rb(t+"."+n.xa),n.sb(n.Ca);else{var r=a.location;n=Je(r.protocol,t?t+"."+r.hostname:r.hostname,+r.port,e)}return this.gb&&H(this.gb,function(t,e){n.l(e,t)}),t=this.aa,e=this.Kc,t&&e&&n.l(t,e),n.l("VER",this.tc),this.Ya(n),n},r.Jb=function(t){if(t&&!this.gc)throw Error("Can't create secondary domain capable XhrIo object.");return t=new kn(this.Xa),t.Je(this.gc),t},r.Ba=function(){return!!this.i&&this.i.Ba()},r.fc=function(){return this.gc},r=Nn.prototype,r.sc=null,r.wd=function(){},r.ud=function(){},r.td=function(){},r.sd=function(){},r.Ba=function(){return!0},r.Ue=function(){},r.$a=function(t){return t},Dn.prototype.cf=function(t,e){return new jn(t,e)},k(jn,qt),r=jn.prototype,r.addEventListener=function(t,e,n,r){jn.L.addEventListener.call(this,t,e,n,r)},r.removeEventListener=function(t,e,n,r){jn.L.removeEventListener.call(this,t,e,n,r)},r.open=function(){this.b.Ee(this.vd),this.Og&&this.b.Hg(),this.b.connect(this.Qg,this.yb,this.Rc||void 0)},r.close=function(){this.b.disconnect()},r.send=function(t){if(s(t)){var e={};e.__data__=t,this.b.Zc(e)}else this.zg?(e={},e.__data__=Wt(t),this.b.Zc(e)):this.b.Zc(t)},r.F=function(){this.b.Ee(null),delete this.vd,this.b.disconnect(),delete this.b,jn.L.F.call(this)},k(Mn,je),k(Ln,Me),k(Fn,Nn),Fn.prototype.wd=function(){me(this.b.s,"WebChannel opened on "+this.b.yb),this.b.dispatchEvent("a")},Fn.prototype.ud=function(t){this.b.dispatchEvent(new Mn(t))},Fn.prototype.td=function(t){me(this.b.s,"WebChannel aborted on "+this.b.yb+" due to channel error: "+t),this.b.dispatchEvent(new Ln(t))},Fn.prototype.sd=function(){me(this.b.s,"WebChannel closed on "+this.b.yb),this.b.dispatchEvent("b")};var Vn=w(function(t,e){function n(){}n.prototype=t.prototype;var r=new n;return t.apply(r,Array.prototype.slice.call(arguments,1)),r},Dn);function Bn(){this.V=[],this.Z=[]}function Un(t,e){if(C.call(this),this.oe=t||0,this.Wb=e||10,this.oe>this.Wb)throw Error(qn);this.fa=new Bn,this.oa=new fn,this.Ac=0,this.Nc=null,this.Cb()}r=Bn.prototype,r.Vf=function(){0==this.V.length&&(this.V=this.Z,this.V.reverse(),this.Z=[])},r.enqueue=function(t){this.Z.push(t)},r.ab=function(){return this.Vf(),this.V.pop()},r.C=function(){return this.V.length+this.Z.length},r.X=function(){return 0==this.V.length&&0==this.Z.length},r.clear=function(){this.V=[],this.Z=[]},r.contains=function(t){return 0<=I(this.V,t)||0<=I(this.Z,t)},r.remove=function(t){var e=this.V,n=x(e,t);return 0<=n?(Array.prototype.splice.call(e,n,1),e=!0):e=!1,e||j(this.Z,t)},r.H=function(){for(var t=[],e=this.V.length-1;0<=e;--e)t.push(this.V[e]);var n=this.Z.length;for(e=0;e<n;++e)t.push(this.Z[e]);return t},k(Un,C);var qn="[goog.structs.Pool] Min can not be greater than max";function Wn(t,e){this.fe=t,this.gd=e}function Kn(t){this.Y=[],t&&this.Lf(t)}function Hn(){Kn.call(this)}function zn(t,e){this.Gd=void 0,this.cc=new Hn,Un.call(this,t,e)}function Gn(t,e,n,r){this.Jf=t,this.Ab=!!r,zn.call(this,e,n)}r=Un.prototype,r.Mb=function(){var t=_();if(!(null!=this.Nc&&t-this.Nc<this.Ac)){var e=this.qg();return e&&(this.Nc=t,this.oa.add(e)),e}},r.og=function(t){return!!this.oa.remove(t)&&(this.nc(t),!0)},r.qg=function(){for(var t;0<this.Td()&&(t=this.fa.ab(),!this.Sc(t));)this.Cb();return!t&&this.C()<this.Wb&&(t=this.xc()),t},r.nc=function(t){this.oa.remove(t),this.Sc(t)&&this.C()<this.Wb?this.fa.enqueue(t):this.Bc(t)},r.Cb=function(){for(var t=this.fa;this.C()<this.oe;)t.enqueue(this.xc());for(;this.C()>this.Wb&&0<this.Td();)this.Bc(t.ab())},r.xc=function(){return{}},r.Bc=function(t){if("function"==typeof t.bb)t.bb();else for(var e in t)t[e]=null},r.Sc=function(t){return"function"!=typeof t.Ye||t.Ye()},r.contains=function(t){return this.fa.contains(t)||this.oa.contains(t)},r.C=function(){return this.fa.C()+this.oa.C()},r.rf=function(){return this.oa.C()},r.Td=function(){return this.fa.C()},r.X=function(){return this.fa.X()&&this.oa.X()},r.F=function(){if(Un.L.F.call(this),0<this.rf())throw Error("[goog.structs.Pool] Objects not released");delete this.oa;for(var t=this.fa;!t.X();)this.Bc(t.ab());delete this.fa},Wn.prototype.getKey=function(){return this.fe},Wn.prototype.clone=function(){return new Wn(this.fe,this.gd)},r=Kn.prototype,r.ce=function(t,e){var n=this.Y;n.push(new Wn(t,e)),this.$f(n.length-1)},r.Lf=function(t){if(t instanceof Kn){var e=t.W();if(t=t.H(),0>=this.C()){for(var n=this.Y,r=0;r<e.length;r++)n.push(new Wn(e[r],t[r]));return}}else e=G(t),t=z(t);for(r=0;r<e.length;r++)this.ce(e[r],t[r])},r.remove=function(){var t=this.Y,e=t.length,n=t[0];if(!(0>=e))return 1==e?D(t):(t[0]=t.pop(),this.Zf()),n.gd},r.Zf=function(){for(var t=0,e=this.Y,n=e.length,r=e[t];t<n>>1;){var i=this.tf(t),o=this.zf(t);if(i=o<n&&e[o].getKey()<e[i].getKey()?o:i,e[i].getKey()>r.getKey())break;e[t]=e[i],t=i}e[t]=r},r.$f=function(t){for(var e=this.Y,n=e[t];0<t;){var r=this.wf(t);if(!(e[r].getKey()>n.getKey()))break;e[t]=e[r],t=r}e[t]=n},r.tf=function(t){return 2*t+1},r.zf=function(t){return 2*t+2},r.wf=function(t){return t-1>>1},r.H=function(){for(var t=this.Y,e=[],n=t.length,r=0;r<n;r++)e.push(t[r].gd);return e},r.W=function(){for(var t=this.Y,e=[],n=t.length,r=0;r<n;r++)e.push(t[r].getKey());return e},r.va=function(t){return N(this.Y,function(e){return e.getKey()==t})},r.clone=function(){return new Kn(this)},r.C=function(){return this.Y.length},r.X=function(){return 0==this.Y.length},r.clear=function(){D(this.Y)},k(Hn,Kn),Hn.prototype.enqueue=function(t,e){this.ce(t,e)},Hn.prototype.ab=function(){return this.remove()},k(zn,Un),r=zn.prototype,r.Mb=function(t,e){if(!t)return(t=zn.L.Mb.call(this))&&this.Ac&&(this.Gd=a.setTimeout(b(this.Nb,this),this.Ac)),t;this.cc.enqueue(void 0!==e?e:100,t),this.Nb()},r.Nb=function(){for(var t=this.cc;0<t.C();){var e=this.Mb();if(!e)break;t.ab().apply(this,[e])}},r.nc=function(t){zn.L.nc.call(this,t),this.Nb()},r.Cb=function(){zn.L.Cb.call(this),this.Nb()},r.F=function(){zn.L.F.call(this),a.clearTimeout(this.Gd),this.cc.clear(),this.cc=null},k(Gn,zn),Gn.prototype.xc=function(){var t=new kn,e=this.Jf;return e&&e.forEach(function(e,n){t.headers.set(n,e)}),this.Ab&&t.Je(!0),t},Gn.prototype.Sc=function(t){return!t.Ka&&!t.Ba()},Dn.prototype.createWebChannel=Dn.prototype.cf,jn.prototype.send=jn.prototype.send,jn.prototype.open=jn.prototype.open,jn.prototype.close=jn.prototype.close,Ie.NO_ERROR=0,Ie.TIMEOUT=8,Ie.HTTP_ERROR=6,xe.COMPLETE="complete",Ne.EventType=De,De.OPEN="a",De.CLOSE="b",De.ERROR="c",De.MESSAGE="d",qt.prototype.listen=qt.prototype.nb,Gn.prototype.getObject=Gn.prototype.Mb,Gn.prototype.releaseObject=Gn.prototype.og,kn.prototype.listenOnce=kn.prototype.Oc,kn.prototype.getLastError=kn.prototype.Hc,kn.prototype.getLastErrorCode=kn.prototype.Ud,kn.prototype.getStatus=kn.prototype.za,kn.prototype.getStatusText=kn.prototype.Yd,kn.prototype.getResponseJson=kn.prototype.yf,kn.prototype.getResponseText=kn.prototype.ya,kn.prototype.getResponseText=kn.prototype.ya,kn.prototype.send=kn.prototype.send;var Qn={createWebChannelTransport:Vn,ErrorCode:Ie,EventType:xe,WebChannel:Ne,XhrIoPool:Gn},Yn=Qn.createWebChannelTransport,Xn=Qn.ErrorCode,Jn=Qn.EventType,$n=Qn.WebChannel,Zn=Qn.XhrIoPool;e["default"]=Qn}.call(this,n("c8ba"))},c7f9:function(t,e,n){n("c207"),n("6c1c"),n("153a"),n("5a79"),n("782c"),t.exports=n("584a").WeakSet},c8bb:function(t,e,n){t.exports=n("54a1")},cd1c:function(t,e,n){var r=n("e853");t.exports=function(t,e){return new(r(t))(e)}},cd4b:function(t,e,n){"use strict";var r=n("f2ea"),i={error:function(t,e){console.error(Object(r["a"])(t),e)},warn:function(t,e){console.warn(Object(r["a"])(t),e)}};
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */e["a"]=i},cd51:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("fbb0"),i={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(t,e){if(!t)throw a(e)},a=function(t){return new Error("Firebase Database ("+i.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},s=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},u=function(t){var e=[],n=0,r=0;while(n<t.length){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){o=t[n++];var a=t[n++],s=t[n++],u=((7&i)<<18|(63&o)<<12|(63&a)<<6|63&s)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(1023&u))}else{o=t[n++],a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")},c={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],a=i+1<t.length,s=a?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,l=o>>2,h=(3&o)<<4|s>>4,f=(15&s)<<2|c>>6,d=63&c;u||(d=64,a||(f=64)),r.push(n[l],n[h],n[f],n[d])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(s(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):u(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],a=i<t.length,s=a?n[t.charAt(i)]:0;++i;var u=i<t.length,c=u?n[t.charAt(i)]:64;++i;var l=i<t.length,h=l?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==c||null==h)throw Error();var f=o<<2|s>>4;if(r.push(f),64!=c){var d=s<<4&240|c>>2;if(r.push(d),64!=h){var p=c<<6&192|h;r.push(p)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},l=function(t){var e=s(t);return c.encodeByteArray(e,!0)},h=function(t){try{return c.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function f(t){return d(void 0,t)}function d(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:var n=e;return new Date(n.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var r in e)e.hasOwnProperty(r)&&(t[r]=d(t[r],e[r]));return t}function p(t,e,n){t[e]=n}var v=function(){function t(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"===typeof t&&(e.promise.catch(function(){}),1===t.length?t(n):t(n,r))}},t}(),y=function(){return"undefined"!==typeof navigator&&"string"===typeof navigator["userAgent"]?navigator["userAgent"]:""},g=function(){return"undefined"!==typeof window&&!!(window["cordova"]||window["phonegap"]||window["PhoneGap"])&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(y())},m=function(){return"object"===typeof navigator&&"ReactNative"===navigator["product"]},b=function(){return!0===i.NODE_CLIENT||!0===i.NODE_ADMIN},w="FirebaseError",_=Error.captureStackTrace;function k(t){var e=_;return _=t,e}var E=function(){function t(t,e){if(this.code=t,this.message=e,_)_(this,T.prototype.create);else try{throw Error.apply(this,arguments)}catch(n){this.name=w,Object.defineProperty(this,"stack",{get:function(){return n.stack}})}}return t}();E.prototype=Object.create(Error.prototype),E.prototype.constructor=E,E.prototype.name=w;var T=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n,this.pattern=/\{\$([^}]+)}/g}return t.prototype.create=function(t,e){void 0===e&&(e={});var n,r=this.errors[t],i=this.service+"/"+t;n=void 0===r?"Error":r.replace(this.pattern,function(t,n){var r=e[n];return void 0!==r?r.toString():"<"+n+"?>"}),n=this.serviceName+": "+n+" ("+i+").";var o=new E(i,n);for(var a in e)e.hasOwnProperty(a)&&"_"!==a.slice(-1)&&(o[a]=e[a]);return o},t}();function S(t){return JSON.parse(t)}function C(t){return JSON.stringify(t)}var O=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=S(h(o[0])||""),n=S(h(o[1])||""),i=o[2],r=n["d"]||{},delete n["d"]}catch(a){}return{header:e,claims:n,data:r,signature:i}},A=function(t){var e,n,r=O(t).claims,i=Math.floor((new Date).getTime()/1e3);return"object"===typeof r&&(r.hasOwnProperty("nbf")?e=r["nbf"]:r.hasOwnProperty("iat")&&(e=r["iat"]),n=r.hasOwnProperty("exp")?r["exp"]:e+86400),i&&e&&n&&i>=e&&i<=n},I=function(t){var e=O(t).claims;return"object"===typeof e&&e.hasOwnProperty("iat")?e["iat"]:null},x=function(t){var e=O(t),n=e.claims;return!!n&&"object"===typeof n&&n.hasOwnProperty("iat")},P=function(t){var e=O(t).claims;return"object"===typeof e&&!0===e["admin"]},N=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},R=function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]},D=function(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])},j=function(t,e){return D(e,function(e,n){t[e]=n}),t},M=function(t){return j({},t)},L=function(t){return"object"===typeof t&&null!==t},F=function(t){for(var e in t)return!1;return!0},V=function(t){var e=0;for(var n in t)e++;return e},B=function(t,e,n){var r={};for(var i in t)r[i]=e.call(n,t[i],i,t);return r},U=function(t,e,n){for(var r in t)if(e.call(n,t[r],r,t))return r},q=function(t,e,n){var r=U(t,e,n);return r&&t[r]},W=function(t){for(var e in t)return e},K=function(t){var e=[],n=0;for(var r in t)e[n++]=t[r];return e},H=function(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&!e(n,t[n]))return!1;return!0},z=function(t){var e=[];return D(t,function(t,n){Array.isArray(n)?n.forEach(function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}),e.length?"&"+e.join("&"):""},G=function(t){var e={},n=t.replace(/^\?/,"").split("&");return n.forEach(function(t){if(t){var n=t.split("=");e[n[0]]=n[1]}}),e},Q=function(){function t(){this.blockSize=-1}return t}(),Y=function(t){function e(){var e=t.call(this)||this;e.chain_=[],e.buf_=[],e.W_=[],e.pad_=[],e.inbuf_=0,e.total_=0,e.blockSize=64,e.pad_[0]=128;for(var n=1;n<e.blockSize;++n)e.pad_[n]=0;return e.reset(),e}return r.__extends(e,t),e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"===typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],l=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=l^u&(c^l),a=1518500249):(o=u^c^l,a=1859775393):r<60?(o=u&c|l&(u|c),a=2400959708):(o=u^c^l,a=3395469782);i=(s<<5|s>>>27)+o+h+a+n[r]&4294967295;h=l,l=c,c=4294967295&(u<<30|u>>>2),u=s,s=i}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},e.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;while(r<e){if(0==o)while(r<=n)this.compress_(t,r),r+=this.blockSize;if("string"===typeof t){while(r<e)if(i[o]=t.charCodeAt(r),++o,++r,o==this.blockSize){this.compress_(i),o=0;break}}else while(r<e)if(i[o]=t[r],++o,++r,o==this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},e.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},e}(Q);function X(t,e){var n=new J(t,e);return n.subscribe.bind(n)}var J=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(function(){t(n)}).catch(function(t){n.error(t)})}return t.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},t.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},t.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");r=Z(t,["next","error","complete"])?t:{next:t,error:e,complete:n},void 0===r.next&&(r.next=tt),void 0===r.error&&(r.error=tt),void 0===r.complete&&(r.complete=tt);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}}),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(r){"undefined"!==typeof console&&console.error&&console.error(r)}})},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(function(){e.observers=void 0,e.onNoObservers=void 0}))},t}();function $(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then(function(){t.apply(void 0,n)}).catch(function(t){e&&e(t)})}}function Z(t,e){if("object"!==typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"===typeof t[i])return!0}return!1}function tt(){}var et=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i){var o=t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".";throw new Error(o)}};function nt(t,e,n){var r="";switch(e){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var i=t+" failed: ";return i+=r+" argument ",i}function rt(t,e,n,r){if((!r||n)&&"string"!==typeof n)throw new Error(nt(t,e,r)+"must be a valid firebase namespace.")}function it(t,e,n,r){if((!r||n)&&"function"!==typeof n)throw new Error(nt(t,e,r)+"must be a valid function.")}function ot(t,e,n,r){if((!r||n)&&("object"!==typeof n||null===n))throw new Error(nt(t,e,r)+"must be a valid context object.")}var at=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;r++,o(r<t.length,"Surrogate pair missing trail surrogate.");var s=t.charCodeAt(r)-56320;i=65536+(a<<10)+s}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},st=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};e.assert=o,e.assertionError=a,e.base64=c,e.base64Decode=h,e.base64Encode=l,e.CONSTANTS=i,e.deepCopy=f,e.deepExtend=d,e.patchProperty=p,e.Deferred=v,e.getUA=y,e.isMobileCordova=g,e.isNodeSdk=b,e.isReactNative=m,e.ErrorFactory=T,e.FirebaseError=E,e.patchCapture=k,e.jsonEval=S,e.stringify=C,e.decode=O,e.isAdmin=P,e.issuedAtTime=I,e.isValidFormat=x,e.isValidTimestamp=A,e.clone=M,e.contains=N,e.every=H,e.extend=j,e.findKey=U,e.findValue=q,e.forEach=D,e.getAnyKey=W,e.getCount=V,e.getValues=K,e.isEmpty=F,e.isNonNullObject=L,e.map=B,e.safeGet=R,e.querystring=z,e.querystringDecode=G,e.Sha1=Y,e.async=$,e.createSubscribe=X,e.errorPrefix=nt,e.validateArgCount=et,e.validateCallback=it,e.validateContextObject=ot,e.validateNamespace=rt,e.stringLength=st,e.stringToByteArray=at},cd78:function(t,e,n){var r=n("e4ae"),i=n("f772"),o=n("656e");t.exports=function(t,e){if(r(t),i(e)&&e.constructor===t)return e;var n=o.f(t),a=n.resolve;return a(e),n.promise}},cf28:function(t,e,n){},d2c8:function(t,e,n){var r=n("aae3"),i=n("be13");t.exports=function(t,e,n){if(r(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(t))}},d2d5:function(t,e,n){n("1654"),n("549b"),t.exports=n("584a").Array.from},d842:function(t,e,n){},da97:function(t,e,n){},dd40:function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}},dde1:function(t,e){t.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM3.5 3v5H2V3.7H1v-1h2.5V3zM.343 17.857l2.59-3.257H2.92a.6.6 0 1 0-1.04 0H.302a2 2 0 1 1 3.995 0h-.001c-.048.405-.16.734-.333.988-.175.254-.59.692-1.244 1.312H4.3v1h-4l.043-.043zM7 14.75a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75z"/></svg>'},df7c:function(t,e,n){(function(t){function n(t,e){for(var n=0,r=t.length-1;r>=0;r--){var i=t[r];"."===i?t.splice(r,1):".."===i?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,i=function(t){return r.exec(t).slice(1)};function o(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}e.resolve=function(){for(var e="",r=!1,i=arguments.length-1;i>=-1&&!r;i--){var a=i>=0?arguments[i]:t.cwd();if("string"!==typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(e=a+"/"+e,r="/"===a.charAt(0))}return e=n(o(e.split("/"),function(t){return!!t}),!r).join("/"),(r?"/":"")+e||"."},e.normalize=function(t){var r=e.isAbsolute(t),i="/"===a(t,-1);return t=n(o(t.split("/"),function(t){return!!t}),!r).join("/"),t||r||(t="."),t&&i&&(t+="/"),(r?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(o(t,function(t,e){if("string"!==typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},e.relative=function(t,n){function r(t){for(var e=0;e<t.length;e++)if(""!==t[e])break;for(var n=t.length-1;n>=0;n--)if(""!==t[n])break;return e>n?[]:t.slice(e,n-e+1)}t=e.resolve(t).substr(1),n=e.resolve(n).substr(1);for(var i=r(t.split("/")),o=r(n.split("/")),a=Math.min(i.length,o.length),s=a,u=0;u<a;u++)if(i[u]!==o[u]){s=u;break}var c=[];for(u=s;u<i.length;u++)c.push("..");return c=c.concat(o.slice(s)),c.join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){var e=i(t),n=e[0],r=e[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},e.basename=function(t,e){var n=i(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},e.extname=function(t){return i(t)[3]};var a="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}).call(this,n("4362"))},dff1:function(t,e,n){"use strict";(function(t){var r=n("26ee"),i="object"==typeof exports&&exports&&!exports.nodeType&&exports,o=i&&"object"==typeof t&&t&&!t.nodeType&&t,a=o&&o.exports===i,s=a?r["a"].Buffer:void 0,u=s?s.allocUnsafe:void 0;function c(t,e){if(e)return t.slice();var n=t.length,r=u?u(n):new t.constructor(n);return t.copy(r),r}e["a"]=c}).call(this,n("dd40")(t))},e005:function(t,e){t.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>'},e265:function(t,e,n){t.exports=n("ed33")},e281:function(t,e,n){},e4d7:function(t,e){t.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path class="ck-icon__fill" d="M10.126 2.268L2.002 13.874l1.895 1.852 2.521 1.402L14.47 5.481l-1.543-2.568-2.801-.645z"/><path d="M4.5 18.088l-2.645-1.852-.04-2.95-.006-.005.006-.008v-.025l.011.008L8.73 2.97c.165-.233.356-.417.567-.557l-1.212.308L4.604 7.9l-.83-.558 3.694-5.495 2.708-.69 1.65 1.145.046.018.85-1.216 2.16 1.512-.856 1.222c.828.967 1.144 2.141.432 3.158L7.55 17.286l.006.005-3.055.797H4.5zm-.634.166l-1.976.516-.026-1.918 2.002 1.402zM9.968 3.817l-.006-.004-6.123 9.184 3.277 2.294 6.108-9.162.005.003c.317-.452-.16-1.332-1.064-1.966-.891-.624-1.865-.776-2.197-.349zM8.245 18.5L9.59 17h9.406v1.5H8.245z"/></svg>'},e5b8:function(t,e,n){n("1271");var r=n("584a").Object;t.exports=function(t){return r.getOwnPropertyNames(t)}},e692:function(t,e){t.exports="\t\n\v\f\r \u2028\u2029\ufeff"},e800:function(t,e,n){"use strict";(function(t){var e=n("7618"),r=n("cd4b"),i=n("0b3e"),o="object"===("undefined"===typeof window?"undefined":Object(e["a"])(window))?window:t;o.CKEDITOR_VERSION?r["a"].error("ckeditor-version-collision: The global CKEDITOR_VERSION constant has already been set.",{collidingVersion:o.CKEDITOR_VERSION,version:i["a"]}):o.CKEDITOR_VERSION=i["a"]}).call(this,n("c8ba"))},e814:function(t,e,n){t.exports=n("b9e9")},e829:function(t,e,n){n("2f37"),t.exports=n("584a").Date.now},e853:function(t,e,n){var r=n("d3f4"),i=n("1169"),o=n("2b4c")("species");t.exports=function(t){var e;return i(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!i(e.prototype)||(e=void 0),r(e)&&(e=e[o],null===e&&(e=void 0))),void 0===e?Array:e}},e89a:function(t,e,n){"use strict";function r(t){return t&&"object"===typeof t&&"default"in t?t["default"]:t}Object.defineProperty(e,"__esModule",{value:!0});var i,o=r(n("c23d")),a=n("abfd"),s=n("a2cd"),u=n("c7b2"),c=o.SDK_VERSION,l=new a.Logger("@firebase/firestore");function h(){return l.logLevel===a.LogLevel.DEBUG?i.DEBUG:l.logLevel===a.LogLevel.SILENT?i.SILENT:i.ERROR}function f(t){switch(t){case i.DEBUG:l.logLevel=a.LogLevel.DEBUG;break;case i.ERROR:l.logLevel=a.LogLevel.ERROR;break;case i.SILENT:l.logLevel=a.LogLevel.SILENT;break;default:l.error("Firestore ("+c+"): Invalid value passed to `setLogLevel`")}}function d(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(l.logLevel<=a.LogLevel.DEBUG){var i=n.map(v);l.debug.apply(l,["Firestore ("+c+") ["+t+"]: "+e].concat(i))}}function p(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(l.logLevel<=a.LogLevel.ERROR){var r=e.map(v);l.error.apply(l,["Firestore ("+c+"): "+t].concat(r))}}function v(t){if("string"===typeof t)return t;var e=m.getPlatform();try{return e.formatJSON(t)}catch(n){return t}}function y(t){var e="FIRESTORE ("+c+") INTERNAL ASSERTION FAILED: "+t;throw p(e),new Error(e)}function g(t,e){t||y(e)}(function(t){t[t["DEBUG"]=0]="DEBUG",t[t["ERROR"]=1]="ERROR",t[t["SILENT"]=2]="SILENT"})(i||(i={}));var m=function(){function t(){}return t.setPlatform=function(e){t.platform&&y("Platform already defined"),t.platform=e},t.getPlatform=function(){return t.platform||y("Platform not set"),t.platform},t}();function b(){return m.getPlatform().emptyByteString}var w={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},_=function(t){function e(e,n){var r=t.call(this,n)||this;return r.code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return s.__extends(e,t),e}(Error);function k(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new _(w.INVALID_ARGUMENT,t)}for(var r in n.prototype=t.prototype,t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n}function E(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function T(t,e){return void 0!==t?t:e}function S(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=Number(n);isNaN(r)||e(r,t[n])}}function C(t){var e=[];return O(t,function(t,n){return e.push(n)}),e}function O(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function A(t){for(var e in g(null!=t&&"object"===typeof t,"isEmpty() expects object parameter."),t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function I(t){g(t&&"object"===typeof t,"shallowCopy() expects object parameter.");var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function x(t,e,n){if(e.length!==n)throw new _(w.INVALID_ARGUMENT,"Function "+t+"() requires "+X(n,"argument")+", but was called with "+X(e.length,"argument")+".")}function P(t,e,n){if(e.length<n)throw new _(w.INVALID_ARGUMENT,"Function "+t+"() requires at least "+X(n,"argument")+", but was called with "+X(e.length,"argument")+".")}function N(t,e,n,r){if(e.length<n||e.length>r)throw new _(w.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+X(e.length,"argument")+".")}function R(t,e,n,r){if(!(e instanceof Array)||e.length<r)throw new _(w.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" argument to be an array with at least "+X(r,"element")+".")}function D(t,e,n,r){q(t,e,Y(n)+" argument",r)}function j(t,e,n,r){void 0!==r&&D(t,e,n,r)}function M(t,e,n,r){q(t,e,n+" option",r)}function L(t,e,n,r){void 0!==r&&M(t,e,n,r)}function F(t,e,n,r,i){if(!(r instanceof Array))throw new _(w.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+K(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new _(w.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be "+n+", but the value at index "+o+" was: "+K(r[o]))}function V(t,e,n,r,i){void 0!==r&&F(t,e,n,r,i)}function B(t,e,n,r,i){for(var o=[],a=0,s=i;a<s.length;a++){var u=s[a];if(u===r)return;o.push(K(u))}var c=K(r);throw new _(w.INVALID_ARGUMENT,"Invalid value "+c+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+o.join(", "))}function U(t,e,n,r,i){void 0!==r&&B(t,e,n,r,i)}function q(t,e,n,r){var i=!1;if(i="object"===e?W(r):"non-empty string"===e?"string"===typeof r&&""!==r:typeof r===e,!i){var o=K(r);throw new _(w.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+o)}}function W(t){return"object"===typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function K(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"===typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"===typeof t||"boolean"===typeof t)return""+t;if("object"===typeof t){if(t instanceof Array)return"an array";var e=H(t);return e?"a custom "+e+" object":"an object"}return"function"===typeof t?"a function":y("Unknown wrong type: "+typeof t)}function H(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/,n=e.exec(t.constructor.toString());if(n&&n.length>1)return n[1]}return null}function z(t,e,n){if(void 0===n)throw new _(w.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Y(e)+" argument, but it was undefined.")}function G(t,e,n){O(e,function(e,r){if(n.indexOf(e)<0)throw new _(w.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))})}function Q(t,e,n,r){var i=K(r);return new _(w.INVALID_ARGUMENT,"Function "+t+"() requires its "+Y(n)+" argument to be a "+e+", but it was: "+i)}function Y(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function X(t,e){return t+" "+e+(1===t?"":"s")}var J=function(){function t(){}return t.newId=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",n=0;n<20;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return g(20===e.length,"Invalid auto ID: "+e),e},t}();function $(t,e){return t<e?-1:t>e?1:0}function Z(t,e){return null!==t&&void 0!==t?!(!e||!t.isEqual(e)):t===e}function tt(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].isEqual(e[n]))return!1;return!0}function et(t){return t+"\0"}function nt(){if("undefined"===typeof Uint8Array)throw new _(w.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function rt(){if(!m.getPlatform().base64Available)throw new _(w.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var it,ot,at=function(){function t(t){rt(),this._binaryString=t}return t.fromBase64String=function(e){x("Blob.fromBase64String",arguments,1),D("Blob.fromBase64String","string",1,e),rt();try{var n=m.getPlatform().atob(e);return new t(n)}catch(r){throw new _(w.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+r)}},t.fromUint8Array=function(e){if(x("Blob.fromUint8Array",arguments,1),nt(),!(e instanceof Uint8Array))throw Q("Blob.fromUint8Array","Uint8Array",1,e);var n=Array.prototype.map.call(e,function(t){return String.fromCharCode(t)}).join("");return new t(n)},t.prototype.toBase64=function(){return x("Blob.toBase64",arguments,0),rt(),m.getPlatform().btoa(this._binaryString)},t.prototype.toUint8Array=function(){x("Blob.toUint8Array",arguments,0),nt();for(var t=new Uint8Array(this._binaryString.length),e=0;e<this._binaryString.length;e++)t[e]=this._binaryString.charCodeAt(e);return t},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._binaryString===t._binaryString},t.prototype._compareTo=function(t){return $(this._binaryString,t._binaryString)},t}(),st=k(at,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),ut=function(){function t(t,e){if(x("GeoPoint",arguments,2),D("GeoPoint","number",1,t),D("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new _(w.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new _(w.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype._compareTo=function(t){return $(this._lat,t._lat)||$(this._long,t._long)},t}(),ct=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new _(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new _(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new _(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new _(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3),r=1e6*(e-1e3*n);return new t(n,r)},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?$(this.nanoseconds,t.nanoseconds):$(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t}(),lt=function(){function t(t,e,n,r){this.databaseId=t,this.persistenceKey=e,this.host=n,this.ssl=r}return t}(),ht="(default)",ft=function(){function t(t,e){this.projectId=t,this.database=e||ht}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return this.database===ht},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.compareTo=function(t){return $(this.projectId,t.projectId)||$(this.database,t.database)},t}(),dt="__name__",pt=function(){function t(t,e,n){this.init(t,e,n)}return t.prototype.init=function(t,e,n){void 0===e?e=0:e>t.length&&y("offset "+e+" out of range "+t.length),void 0===n?n=t.length-e:n>t.length-e&&y("length "+n+" out of range "+(t.length-e)),this.segments=t,this.offset=e,this.len=n},t.prototype.construct=function(t,e,n){var r=Object.create(Object.getPrototypeOf(this));return r.init(t,e,n),r},Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):"string"===typeof e?n.push(e):y("Unknown parameter type for Path.child(): "+e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,g(this.length>=t,"Can't call popFirst() with less segments"),this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return g(!this.isEmpty(),"Can't call popLast() on empty path"),this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return g(!this.isEmpty(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},t.prototype.lastSegment=function(){return g(!this.isEmpty(),"Can't call lastSegment() on empty path"),this.segments[this.limit()-1]},t.prototype.get=function(t){return g(t<this.length,"Index out of range"),this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),vt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(t){if(t.indexOf("//")>=0)throw new _(w.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");var n=t.split("/").filter(function(t){return t.length>0});return new e(n)},e.EMPTY_PATH=new e([]),e}(pt),yt=/^[_a-zA-Z][_a-zA-Z0-9]*$/,gt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),e.isValidIdentifier=function(t){return yt.test(t)},e.prototype.canonicalString=function(){return this.toArray().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&this.get(0)===dt},e.keyField=function(){return new e([dt])},e.fromServerFormat=function(t){var n=[],r="",i=0,o=function(){if(0===r.length)throw new _(w.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;while(i<t.length){var s=t[i];if("\\"===s){if(i+1===t.length)throw new _(w.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new _(w.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new _(w.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.EMPTY_PATH=new e([]),e}(pt),mt=function(){function t(e){this.path=e,g(t.isDocumentKey(e),"Invalid DocumentKey with an odd number of segments: "+e.toArray().join("/"))}return t.prototype.isEqual=function(t){return null!==t&&0===vt.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return vt.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2===0},t.fromSegments=function(e){return new t(new vt(e.slice()))},t.fromPathString=function(e){return new t(vt.fromString(e))},t.EMPTY=new t(new vt([])),t}(),bt=function(){function t(t,e){this.key=t,this.version=e}return t.compareByKey=function(t,e){return mt.comparator(t.key,e.key)},t}(),wt=function(t){function e(e,n,r,i,o){var a=t.call(this,e,n)||this;return a.data=r,a.proto=o,a.hasLocalMutations=!!i.hasLocalMutations,a.hasCommittedMutations=!!i.hasCommittedMutations,a}return s.__extends(e,t),e.prototype.field=function(t){return this.data.field(t)},e.prototype.fieldValue=function(t){var e=this.field(t);return e?e.value():void 0},e.prototype.value=function(){return this.data.value()},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.data.isEqual(t.data)&&this.hasLocalMutations===t.hasLocalMutations&&this.hasCommittedMutations===t.hasCommittedMutations},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.data.toString()+", {hasLocalMutations: "+this.hasLocalMutations+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.compareByField=function(t,e,n){var r=e.field(t),i=n.field(t);return void 0!==r&&void 0!==i?r.compareTo(i):y("Trying to compare documents on fields that don't exist")},e}(bt),_t=function(t){function e(e,n,r){var i=t.call(this,e,n)||this;return i.hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return s.__extends(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(bt),kt=function(t){function e(e,n){return t.call(this,e,n)||this}return s.__extends(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(bt),Et=function(){function t(t,e){this.comparator=t,this.root=e||St.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,St.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,St.BLACK,null,null))},t.prototype.get=function(t){var e=this.root;while(!e.isEmpty()){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){var e=0,n=this.root;while(!n.isEmpty()){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal(function(e,n){return t(e,n),!1})},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new Tt(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new Tt(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new Tt(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new Tt(this.root,t,this.comparator,!0)},t}(),Tt=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];var i=1;while(!t.isEmpty())if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){g(this.nodeStack.length>0,"getNext() called on iterator when hasNext() is false.");var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse){t=t.left;while(!t.isEmpty())this.nodeStack.push(t),t=t.right}else{t=t.right;while(!t.isEmpty())this.nodeStack.push(t),t=t.left}return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),St=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n)),r.fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw y("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed())throw y("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check();if(t!==this.right.check())throw y("Black depths differ");return t+(this.isRed()?0:1)},t.EMPTY=null,t.RED=!0,t.BLACK=!1,t}(),Ct=function(){function t(){this.size=0}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new St(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}();St.EMPTY=new Ct,function(t){t[t["NullValue"]=0]="NullValue",t[t["BooleanValue"]=1]="BooleanValue",t[t["NumberValue"]=2]="NumberValue",t[t["TimestampValue"]=3]="TimestampValue",t[t["StringValue"]=4]="StringValue",t[t["BlobValue"]=5]="BlobValue",t[t["RefValue"]=6]="RefValue",t[t["GeoPointValue"]=7]="GeoPointValue",t[t["ArrayValue"]=8]="ArrayValue",t[t["ObjectValue"]=9]="ObjectValue"}(it||(it={})),function(t){t[t["Default"]=0]="Default",t[t["Estimate"]=1]="Estimate",t[t["Previous"]=2]="Previous"}(ot||(ot={}));var Ot=function(){function t(t,e){this.serverTimestampBehavior=t,this.timestampsInSnapshots=e}return t.fromSnapshotOptions=function(e,n){switch(e.serverTimestamps){case"estimate":return new t(ot.Estimate,n);case"previous":return new t(ot.Previous,n);case"none":case void 0:return new t(ot.Default,n);default:return y("fromSnapshotOptions() called with invalid options.")}},t}(),At=function(){function t(){}return t.prototype.toString=function(){var t=this.value();return null===t?"null":t.toString()},t.prototype.defaultCompareTo=function(t){g(this.typeOrder!==t.typeOrder,"Default compareTo should not be used for values of same type.");var e=$(this.typeOrder,t.typeOrder);return e},t}(),It=function(t){function e(){var e=t.call(this)||this;return e.typeOrder=it.NullValue,e.internalValue=null,e}return s.__extends(e,t),e.prototype.value=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e},e.prototype.compareTo=function(t){return t instanceof e?0:this.defaultCompareTo(t)},e.INSTANCE=new e,e}(At),xt=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=it.BooleanValue,n}return s.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?$(this,t):this.defaultCompareTo(t)},e.of=function(t){return t?e.TRUE:e.FALSE},e.TRUE=new e(!0),e.FALSE=new e(!1),e}(At),Pt=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=it.NumberValue,n}return s.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.compareTo=function(t){return t instanceof e?Nt(this.internalValue,t.internalValue):this.defaultCompareTo(t)},e}(At);function Nt(t,e){return t<e?-1:t>e?1:t===e?0:isNaN(t)?isNaN(e)?0:-1:1}function Rt(t,e){return t===e?0!==t||1/t===1/e:t!==t&&e!==e}var Dt=function(t){function e(e){return t.call(this,e)||this}return s.__extends(e,t),e.prototype.isEqual=function(t){return t instanceof e&&Rt(this.internalValue,t.internalValue)},e}(Pt),jt=function(t){function e(e){var n=t.call(this,e)||this;return n.internalValue=e,n}return s.__extends(e,t),e.prototype.isEqual=function(t){return t instanceof e&&Rt(this.internalValue,t.internalValue)},e.NAN=new e(NaN),e.POSITIVE_INFINITY=new e(1/0),e.NEGATIVE_INFINITY=new e(-1/0),e}(Pt),Mt=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=it.StringValue,n}return s.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?$(this.internalValue,t.internalValue):this.defaultCompareTo(t)},e}(At),Lt=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=it.TimestampValue,n}return s.__extends(e,t),e.prototype.value=function(t){return t&&t.timestampsInSnapshots?this.internalValue:this.internalValue.toDate()},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):t instanceof Ft?-1:this.defaultCompareTo(t)},e}(At),Ft=function(t){function e(e,n){var r=t.call(this)||this;return r.localWriteTime=e,r.previousValue=n,r.typeOrder=it.TimestampValue,r}return s.__extends(e,t),e.prototype.value=function(t){return t&&t.serverTimestampBehavior===ot.Estimate?new Lt(this.localWriteTime).value(t):t&&t.serverTimestampBehavior===ot.Previous&&this.previousValue?this.previousValue.value(t):null},e.prototype.isEqual=function(t){return t instanceof e&&this.localWriteTime.isEqual(t.localWriteTime)},e.prototype.compareTo=function(t){return t instanceof e?this.localWriteTime._compareTo(t.localWriteTime):t instanceof Lt?1:this.defaultCompareTo(t)},e.prototype.toString=function(){return"<ServerTimestamp localTime="+this.localWriteTime.toString()+">"},e}(At),Vt=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=it.BlobValue,n}return s.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(At),Bt=function(t){function e(e,n){var r=t.call(this)||this;return r.databaseId=e,r.key=n,r.typeOrder=it.RefValue,r}return s.__extends(e,t),e.prototype.value=function(t){return this.key},e.prototype.isEqual=function(t){return t instanceof e&&(this.key.isEqual(t.key)&&this.databaseId.isEqual(t.databaseId))},e.prototype.compareTo=function(t){if(t instanceof e){var n=this.databaseId.compareTo(t.databaseId);return 0!==n?n:mt.comparator(this.key,t.key)}return this.defaultCompareTo(t)},e}(At),Ut=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=it.GeoPointValue,n}return s.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(At),qt=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=it.ObjectValue,n}return s.__extends(e,t),e.prototype.value=function(t){var e={};return this.internalValue.inorderTraversal(function(n,r){e[n]=r.value(t)}),e},e.prototype.forEach=function(t){this.internalValue.inorderTraversal(t)},e.prototype.isEqual=function(t){if(t instanceof e){var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();while(n.hasNext()&&r.hasNext()){var i=n.getNext(),o=r.getNext();if(i.key!==o.key||!i.value.isEqual(o.value))return!1}return!n.hasNext()&&!r.hasNext()}return!1},e.prototype.compareTo=function(t){if(t instanceof e){var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();while(n.hasNext()&&r.hasNext()){var i=n.getNext(),o=r.getNext(),a=$(i.key,o.key)||i.value.compareTo(o.value);if(a)return a}return $(n.hasNext(),r.hasNext())}return this.defaultCompareTo(t)},e.prototype.set=function(t,n){if(g(!t.isEmpty(),"Cannot set field for empty path on ObjectValue"),1===t.length)return this.setChild(t.firstSegment(),n);var r=this.child(t.firstSegment());r instanceof e||(r=e.EMPTY);var i=r.set(t.popFirst(),n);return this.setChild(t.firstSegment(),i)},e.prototype.delete=function(t){if(g(!t.isEmpty(),"Cannot delete field for empty path on ObjectValue"),1===t.length)return new e(this.internalValue.remove(t.firstSegment()));var n=this.child(t.firstSegment());if(n instanceof e){var r=n.delete(t.popFirst());return new e(this.internalValue.insert(t.firstSegment(),r))}return this},e.prototype.contains=function(t){return void 0!==this.field(t)},e.prototype.field=function(t){g(!t.isEmpty(),"Can't get field of empty path");var n=this;return t.forEach(function(t){n=n instanceof e&&n.internalValue.get(t)||void 0}),n},e.prototype.toString=function(){return JSON.stringify(this.value())},e.prototype.child=function(t){return this.internalValue.get(t)||void 0},e.prototype.setChild=function(t,n){return new e(this.internalValue.insert(t,n))},e.EMPTY=new e(new Et($)),e}(At),Wt=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=it.ArrayValue,n}return s.__extends(e,t),e.prototype.value=function(t){return this.internalValue.map(function(e){return e.value(t)})},e.prototype.forEach=function(t){this.internalValue.forEach(t)},e.prototype.isEqual=function(t){if(t instanceof e){if(this.internalValue.length!==t.internalValue.length)return!1;for(var n=0;n<this.internalValue.length;n++)if(!this.internalValue[n].isEqual(t.internalValue[n]))return!1;return!0}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=Math.min(this.internalValue.length,t.internalValue.length),r=0;r<n;r++){var i=this.internalValue[r].compareTo(t.internalValue[r]);if(i)return i}return $(this.internalValue.length,t.internalValue.length)}return this.defaultCompareTo(t)},e.prototype.toString=function(){return JSON.stringify(this.value())},e}(At),Kt=Number,Ht=Kt.MIN_SAFE_INTEGER||-(Math.pow(2,53)-1),zt=Kt.MAX_SAFE_INTEGER||Math.pow(2,53)-1,Gt=Kt.isInteger||function(t){return"number"===typeof t&&isFinite(t)&&Math.floor(t)===t};function Qt(t){return null===t||void 0===t}function Yt(t){return Gt(t)&&t<=zt&&t>=Ht}var Xt,Jt=function(){function t(t,e,n,r,i,o){void 0===e&&(e=[]),void 0===n&&(n=[]),void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=null),this.path=t,this.explicitOrderBy=e,this.filters=n,this.limit=r,this.startAt=i,this.endAt=o,this.memoizedCanonicalId=null,this.memoizedOrderBy=null,this.startAt&&this.assertValidBound(this.startAt),this.endAt&&this.assertValidBound(this.endAt)}return t.atPath=function(e){return new t(e)},Object.defineProperty(t.prototype,"orderBy",{get:function(){if(null===this.memoizedOrderBy){var t=this.getInequalityFilterField(),e=this.getFirstOrderByField();if(null!==t&&null===e)t.isKeyField()?this.memoizedOrderBy=[ae]:this.memoizedOrderBy=[new oe(t),ae];else{g(null===t||null!==e&&t.isEqual(e),"First orderBy should match inequality field."),this.memoizedOrderBy=[];for(var n=!1,r=0,i=this.explicitOrderBy;r<i.length;r++){var o=i[r];this.memoizedOrderBy.push(o),o.field.isKeyField()&&(n=!0)}if(!n){var a=this.explicitOrderBy.length>0?this.explicitOrderBy[this.explicitOrderBy.length-1].dir:re.ASCENDING;this.memoizedOrderBy.push(a===re.ASCENDING?ae:se)}}}return this.memoizedOrderBy},enumerable:!0,configurable:!0}),t.prototype.addFilter=function(e){g(null==this.getInequalityFilterField()||!(e instanceof te)||!e.isInequality()||e.field.isEqual(this.getInequalityFilterField()),"Query must only have one inequality field."),g(!mt.isDocumentKey(this.path),"No filtering allowed for document query");var n=this.filters.concat([e]);return new t(this.path,this.explicitOrderBy.slice(),n,this.limit,this.startAt,this.endAt)},t.prototype.addOrderBy=function(e){g(!mt.isDocumentKey(this.path),"No ordering allowed for document query"),g(!this.startAt&&!this.endAt,"Bounds must be set after orderBy");var n=this.explicitOrderBy.concat([e]);return new t(this.path,n,this.filters.slice(),this.limit,this.startAt,this.endAt)},t.prototype.withLimit=function(e){return new t(this.path,this.explicitOrderBy.slice(),this.filters.slice(),e,this.startAt,this.endAt)},t.prototype.withStartAt=function(e){return new t(this.path,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,e,this.endAt)},t.prototype.withEndAt=function(e){return new t(this.path,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.startAt,e)},t.prototype.canonicalId=function(){if(null===this.memoizedCanonicalId){var t=this.path.canonicalString();t+="|f:";for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];t+=r.canonicalId(),t+=","}t+="|ob:";for(var i=0,o=this.orderBy;i<o.length;i++){var a=o[i];t+=a.canonicalId(),t+=","}Qt(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.memoizedCanonicalId=t}return this.memoizedCanonicalId},t.prototype.toString=function(){var t="Query("+this.path.canonicalString();return this.filters.length>0&&(t+=", filters: ["+this.filters.join(", ")+"]"),Qt(this.limit)||(t+=", limit: "+this.limit),this.explicitOrderBy.length>0&&(t+=", orderBy: ["+this.explicitOrderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),t+")"},t.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(e=0;e<this.filters.length;e++)if(!this.filters[e].isEqual(t.filters[e]))return!1;return!!this.path.isEqual(t.path)&&(!(null!==this.startAt?!this.startAt.isEqual(t.startAt):null!==t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt))},t.prototype.docComparator=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],a=o.compare(t,e);if(0!==a)return a;n=n||o.field.isKeyField()}return g(n,"orderBy used that doesn't compare on key field"),0},t.prototype.matches=function(t){return this.matchesAncestor(t)&&this.matchesOrderBy(t)&&this.matchesFilters(t)&&this.matchesBounds(t)},t.prototype.hasLimit=function(){return!Qt(this.limit)},t.prototype.getFirstOrderByField=function(){return this.explicitOrderBy.length>0?this.explicitOrderBy[0].field:null},t.prototype.getInequalityFilterField=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof te&&n.isInequality())return n.field}return null},t.prototype.hasArrayContainsFilter=function(){return void 0!==this.filters.find(function(t){return t instanceof te&&t.op===Zt.ARRAY_CONTAINS})},t.prototype.isDocumentQuery=function(){return mt.isDocumentKey(this.path)&&0===this.filters.length},t.prototype.matchesAncestor=function(t){var e=t.key.path;return mt.isDocumentKey(this.path)?this.path.isEqual(e):this.path.isPrefixOf(e)&&this.path.length===e.length-1},t.prototype.matchesOrderBy=function(t){for(var e=0,n=this.explicitOrderBy;e<n.length;e++){var r=n[e];if(!r.field.isKeyField()&&void 0===t.field(r.field))return!1}return!0},t.prototype.matchesFilters=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(!r.matches(t))return!1}return!0},t.prototype.matchesBounds=function(t){return!(this.startAt&&!this.startAt.sortsBeforeDocument(this.orderBy,t))&&(!this.endAt||!this.endAt.sortsBeforeDocument(this.orderBy,t))},t.prototype.assertValidBound=function(t){g(t.position.length<=this.orderBy.length,"Bound is longer than orderBy")},t}(),$t=function(){function t(){}return t.create=function(t,e,n){if(n.isEqual(It.INSTANCE)){if(e!==Zt.EQUAL)throw new _(w.INVALID_ARGUMENT,"Invalid query. You can only perform equals comparisons on null.");return new ee(t)}if(n.isEqual(jt.NAN)){if(e!==Zt.EQUAL)throw new _(w.INVALID_ARGUMENT,"Invalid query. You can only perform equals comparisons on NaN.");return new ne(t)}return new te(t,e,n)},t}(),Zt=function(){function t(t){this.name=t}return t.fromString=function(e){switch(e){case"<":return t.LESS_THAN;case"<=":return t.LESS_THAN_OR_EQUAL;case"==":return t.EQUAL;case">=":return t.GREATER_THAN_OR_EQUAL;case">":return t.GREATER_THAN;case"array-contains":return t.ARRAY_CONTAINS;default:return y("Unknown relation: "+e)}},t.prototype.toString=function(){return this.name},t.prototype.isEqual=function(t){return this.name===t.name},t.LESS_THAN=new t("<"),t.LESS_THAN_OR_EQUAL=new t("<="),t.EQUAL=new t("=="),t.GREATER_THAN=new t(">"),t.GREATER_THAN_OR_EQUAL=new t(">="),t.ARRAY_CONTAINS=new t("array-contains"),t}(),te=function(t){function e(e,n,r){var i=t.call(this)||this;return i.field=e,i.op=n,i.value=r,i}return s.__extends(e,t),e.prototype.matches=function(t){if(this.field.isKeyField()){g(this.value instanceof Bt,"Comparing on key, but filter value not a RefValue"),g(this.op!==Zt.ARRAY_CONTAINS,"array-contains queries don't make sense on document keys.");var e=this.value,n=mt.comparator(t.key,e.key);return this.matchesComparison(n)}var r=t.field(this.field);return void 0!==r&&this.matchesValue(r)},e.prototype.matchesValue=function(t){var e=this;return this.op===Zt.ARRAY_CONTAINS?t instanceof Wt&&void 0!==t.internalValue.find(function(t){return t.isEqual(e.value)}):this.value.typeOrder===t.typeOrder&&this.matchesComparison(t.compareTo(this.value))},e.prototype.matchesComparison=function(t){switch(this.op){case Zt.LESS_THAN:return t<0;case Zt.LESS_THAN_OR_EQUAL:return t<=0;case Zt.EQUAL:return 0===t;case Zt.GREATER_THAN:return t>0;case Zt.GREATER_THAN_OR_EQUAL:return t>=0;default:return y("Unknown relation op"+this.op)}},e.prototype.isInequality=function(){return this.op!==Zt.EQUAL&&this.op!==Zt.ARRAY_CONTAINS},e.prototype.canonicalId=function(){return this.field.canonicalString()+this.op.toString()+this.value.toString()},e.prototype.isEqual=function(t){return t instanceof e&&(this.op.isEqual(t.op)&&this.field.isEqual(t.field)&&this.value.isEqual(t.value))},e.prototype.toString=function(){return this.field.canonicalString()+" "+this.op+" "+this.value.value()},e}($t),ee=function(t){function e(e){var n=t.call(this)||this;return n.field=e,n}return s.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return void 0!==e&&null===e.value()},e.prototype.canonicalId=function(){return this.field.canonicalString()+" IS null"},e.prototype.toString=function(){return this.field.canonicalString()+" IS null"},e.prototype.isEqual=function(t){return t instanceof e&&this.field.isEqual(t.field)},e}($t),ne=function(t){function e(e){var n=t.call(this)||this;return n.field=e,n}return s.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field),n=e&&e.value();return"number"===typeof n&&isNaN(n)},e.prototype.canonicalId=function(){return this.field.canonicalString()+" IS NaN"},e.prototype.toString=function(){return this.field.canonicalString()+" IS NaN"},e.prototype.isEqual=function(t){return t instanceof e&&this.field.isEqual(t.field)},e}($t),re=function(){function t(t){this.name=t}return t.prototype.toString=function(){return this.name},t.ASCENDING=new t("asc"),t.DESCENDING=new t("desc"),t}(),ie=function(){function t(t,e){this.position=t,this.before=e}return t.prototype.canonicalId=function(){for(var t=this.before?"b:":"a:",e=0,n=this.position;e<n.length;e++){var r=n[e];t+=r.toString()}return t},t.prototype.sortsBeforeDocument=function(t,e){g(this.position.length<=t.length,"Bound has more components than query's orderBy");for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r];if(i.field.isKeyField())g(o instanceof Bt,"Bound has a non-key value where the key path is being used."),n=mt.comparator(o.key,e.key);else{var a=e.field(i.field);g(void 0!==a,"Field should exist since document matched the orderBy already."),n=o.compareTo(a)}if(i.dir===re.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},t.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++){var n=this.position[e],r=t.position[e];return n.isEqual(r)}return!0},t}(),oe=function(){function t(t,e){this.field=t,void 0===e&&(e=re.ASCENDING),this.dir=e,this.isKeyOrderBy=t.isKeyField()}return t.prototype.compare=function(t,e){var n=this.isKeyOrderBy?wt.compareByKey(t,e):wt.compareByField(this.field,t,e);switch(this.dir){case re.ASCENDING:return n;case re.DESCENDING:return-1*n;default:return y("Unknown direction: "+this.dir)}},t.prototype.canonicalId=function(){return this.field.canonicalString()+this.dir.toString()},t.prototype.toString=function(){return this.field.canonicalString()+" ("+this.dir+")"},t.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},t}(),ae=new oe(gt.keyField(),re.ASCENDING),se=new oe(gt.keyField(),re.DESCENDING),ue=function(){function t(t){this.timestamp=t}return t.fromMicroseconds=function(e){var n=Math.floor(e/1e6),r=e%1e6*1e3;return new t(new ct(n,r))},t.fromTimestamp=function(e){return new t(e)},t.forDeletedDoc=function(){return t.MIN},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t.MIN=new t(new ct(0,0)),t}();(function(t){t[t["Listen"]=0]="Listen",t[t["ExistenceFilterMismatch"]=1]="ExistenceFilterMismatch",t[t["LimboResolution"]=2]="LimboResolution"})(Xt||(Xt={}));var ce,le=function(){function t(t,e,n,r,i,o){void 0===i&&(i=ue.MIN),void 0===o&&(o=b()),this.query=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.resumeToken=o}return t.prototype.copy=function(e){return new t(this.query,this.targetId,this.purpose,void 0===e.sequenceNumber?this.sequenceNumber:e.sequenceNumber,void 0===e.snapshotVersion?this.snapshotVersion:e.snapshotVersion,void 0===e.resumeToken?this.resumeToken:e.resumeToken)},t.prototype.isEqual=function(t){return this.targetId===t.targetId&&this.purpose===t.purpose&&this.sequenceNumber===t.sequenceNumber&&this.snapshotVersion.isEqual(t.snapshotVersion)&&this.resumeToken===t.resumeToken&&this.query.isEqual(t.query)},t}(),he=function(){function t(t){this.comparator=t,this.data=new Et(this.comparator)}return t.fromMapKeys=function(e){var n=new t(e.comparator);return e.forEach(function(t){n=n.add(t)}),n},t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.forEachInRange=function(t,e){var n=this.data.getIteratorFrom(t[0]);while(n.hasNext()){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();while(n.hasNext()){var r=n.getNext(),i=t(r.key);if(!i)return}},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new fe(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new fe(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;var n=this.data.getIterator(),r=e.data.getIterator();while(n.hasNext()){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),fe=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),de=function(){function t(t){this.fields=t}return t.fromArray=function(e){var n=new he(gt.comparator);return e.forEach(function(t){return n=n.add(t)}),new t(n)},t.prototype.covers=function(t){var e=!1;return this.fields.forEach(function(n){n.isPrefixOf(t)&&(e=!0)}),e},t.prototype.isEqual=function(t){return this.fields.isEqual(t.fields)},t}(),pe=function(){function t(t,e){this.field=t,this.transform=e}return t.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},t}(),ve=function(){function t(t,e){this.version=t,this.transformResults=e}return t}();(function(t){t[t["Set"]=0]="Set",t[t["Patch"]=1]="Patch",t[t["Transform"]=2]="Transform",t[t["Delete"]=3]="Delete"})(ce||(ce={}));var ye=function(){function t(t,e){this.updateTime=t,this.exists=e,g(void 0===t||void 0===e,'Precondition can specify "exists" or "updateTime" but not both')}return t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),t.prototype.isValidFor=function(t){return void 0!==this.updateTime?t instanceof wt&&t.version.isEqual(this.updateTime):void 0!==this.exists?this.exists===t instanceof wt:(g(this.isNone,"Precondition should be empty"),!0)},t.prototype.isEqual=function(t){return Z(this.updateTime,t.updateTime)&&this.exists===t.exists},t.NONE=new t,t}(),ge=function(){function t(){}return t.prototype.verifyKeyMatches=function(t){null!=t&&g(t.key.isEqual(this.key),"Can only apply a mutation to a document with the same key")},t.getPostMutationVersion=function(t){return t instanceof wt?t.version:ue.MIN},t}(),me=function(t){function e(e,n,r){var i=t.call(this)||this;return i.key=e,i.value=n,i.precondition=r,i.type=ce.Set,i}return s.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){this.verifyKeyMatches(t),g(null==e.transformResults,"Transform results received by SetMutation.");var n=e.version;return new wt(this.key,n,this.value,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=ge.getPostMutationVersion(t);return new wt(this.key,r,this.value,{hasLocalMutations:!0})},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.precondition.isEqual(t.precondition)},e}(ge),be=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.key=e,o.data=n,o.fieldMask=r,o.precondition=i,o.type=ce.Patch,o}return s.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),g(null==e.transformResults,"Transform results received by PatchMutation."),!this.precondition.isValidFor(t))return new kt(this.key,e.version);var n=this.patchDocument(t);return new wt(this.key,e.version,n,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=ge.getPostMutationVersion(t),i=this.patchDocument(t);return new wt(this.key,r,i,{hasLocalMutations:!0})},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.fieldMask.isEqual(t.fieldMask)&&this.precondition.isEqual(t.precondition)},e.prototype.patchDocument=function(t){var e;return e=t instanceof wt?t.data:qt.EMPTY,this.patchObject(e)},e.prototype.patchObject=function(t){var e=this;return this.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=e.data.field(n);t=void 0!==r?t.set(n,r):t.delete(n)}}),t},e}(ge),we=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.fieldTransforms=n,r.type=ce.Transform,r.precondition=ye.exists(!0),r}return s.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),g(null!=e.transformResults,"Transform results missing for TransformMutation."),!this.precondition.isValidFor(t))return new kt(this.key,e.version);var n=this.requireDocument(t),r=this.serverTransformResults(t,e.transformResults),i=e.version,o=this.transformObject(n.data,r);return new wt(this.key,i,o,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=this.requireDocument(t),i=this.localTransformResults(n,e),o=this.transformObject(r.data,i);return new wt(this.key,r.version,o,{hasLocalMutations:!0})},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&tt(this.fieldTransforms,t.fieldTransforms)&&this.precondition.isEqual(t.precondition)},e.prototype.requireDocument=function(t){g(t instanceof wt,"Unknown MaybeDocument type "+t);var e=t;return g(e.key.isEqual(this.key),"Can only transform a document with the same key"),e},e.prototype.serverTransformResults=function(t,e){var n=[];g(this.fieldTransforms.length===e.length,"server transform result count ("+e.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],o=i.transform,a=null;t instanceof wt&&(a=t.field(i.field)||null),n.push(o.applyToRemoteDocument(a,e[r]))}return n},e.prototype.localTransformResults=function(t,e){for(var n=[],r=0,i=this.fieldTransforms;r<i.length;r++){var o=i[r],a=o.transform,s=null;e instanceof wt&&(s=e.field(o.field)||null),n.push(a.applyToLocalView(s,t))}return n},e.prototype.transformObject=function(t,e){g(e.length===this.fieldTransforms.length,"TransformResults length mismatch.");for(var n=0;n<this.fieldTransforms.length;n++){var r=this.fieldTransforms[n],i=r.field;t=t.set(i,e[n])}return t},e}(ge),_e=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.precondition=n,r.type=ce.Delete,r}return s.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){return this.verifyKeyMatches(t),g(null==e.transformResults,"Transform results received by DeleteMutation."),new _t(this.key,e.version,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){return this.verifyKeyMatches(t),this.precondition.isValidFor(t)?(t&&g(t.key.isEqual(this.key),"Can only apply mutation to document with same key"),new _t(this.key,ue.forDeletedDoc())):t},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.precondition.isEqual(t.precondition)},e}(ge),ke=function(){function t(){}return t.prototype.applyToLocalView=function(t,e){return new Ft(e,t)},t.prototype.applyToRemoteDocument=function(t,e){return e},t.prototype.isEqual=function(e){return e instanceof t},t.instance=new t,t}(),Ee=function(){function t(t){this.elements=t}return t.prototype.applyToLocalView=function(t,e){return this.apply(t)},t.prototype.applyToRemoteDocument=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=Se(t),n=function(t){e.find(function(e){return e.isEqual(t)})||e.push(t)},r=0,i=this.elements;r<i.length;r++){var o=i[r];n(o)}return new Wt(e)},t.prototype.isEqual=function(e){return e instanceof t&&tt(e.elements,this.elements)},t}(),Te=function(){function t(t){this.elements=t}return t.prototype.applyToLocalView=function(t,e){return this.apply(t)},t.prototype.applyToRemoteDocument=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=Se(t),n=function(t){e=e.filter(function(e){return!e.isEqual(t)})},r=0,i=this.elements;r<i.length;r++){var o=i[r];n(o)}return new Wt(e)},t.prototype.isEqual=function(e){return e instanceof t&&tt(e.elements,this.elements)},t}();function Se(t){return t instanceof Wt?t.internalValue.slice():[]}var Ce,Oe=function(){function t(t){this.count=t}return t.prototype.isEqual=function(t){return t&&t.count===this.count},t}();function Ae(t){switch(t){case w.OK:return y("Treated status OK as error");case w.CANCELLED:case w.UNKNOWN:case w.DEADLINE_EXCEEDED:case w.RESOURCE_EXHAUSTED:case w.INTERNAL:case w.UNAVAILABLE:case w.UNAUTHENTICATED:return!1;case w.INVALID_ARGUMENT:case w.NOT_FOUND:case w.ALREADY_EXISTS:case w.PERMISSION_DENIED:case w.FAILED_PRECONDITION:case w.ABORTED:case w.OUT_OF_RANGE:case w.UNIMPLEMENTED:case w.DATA_LOSS:return!0;default:return y("Unknown status code: "+t)}}function Ie(t){var e=Ce[t];if(void 0!==e)return xe(e)}function xe(t){if(void 0===t)return p("GRPC error has no .code"),w.UNKNOWN;switch(t){case Ce.OK:return w.OK;case Ce.CANCELLED:return w.CANCELLED;case Ce.UNKNOWN:return w.UNKNOWN;case Ce.DEADLINE_EXCEEDED:return w.DEADLINE_EXCEEDED;case Ce.RESOURCE_EXHAUSTED:return w.RESOURCE_EXHAUSTED;case Ce.INTERNAL:return w.INTERNAL;case Ce.UNAVAILABLE:return w.UNAVAILABLE;case Ce.UNAUTHENTICATED:return w.UNAUTHENTICATED;case Ce.INVALID_ARGUMENT:return w.INVALID_ARGUMENT;case Ce.NOT_FOUND:return w.NOT_FOUND;case Ce.ALREADY_EXISTS:return w.ALREADY_EXISTS;case Ce.PERMISSION_DENIED:return w.PERMISSION_DENIED;case Ce.FAILED_PRECONDITION:return w.FAILED_PRECONDITION;case Ce.ABORTED:return w.ABORTED;case Ce.OUT_OF_RANGE:return w.OUT_OF_RANGE;case Ce.UNIMPLEMENTED:return w.UNIMPLEMENTED;case Ce.DATA_LOSS:return w.DATA_LOSS;default:return y("Unknown status code: "+t)}}function Pe(t){if(void 0===t)return Ce.OK;switch(t){case w.OK:return Ce.OK;case w.CANCELLED:return Ce.CANCELLED;case w.UNKNOWN:return Ce.UNKNOWN;case w.DEADLINE_EXCEEDED:return Ce.DEADLINE_EXCEEDED;case w.RESOURCE_EXHAUSTED:return Ce.RESOURCE_EXHAUSTED;case w.INTERNAL:return Ce.INTERNAL;case w.UNAVAILABLE:return Ce.UNAVAILABLE;case w.UNAUTHENTICATED:return Ce.UNAUTHENTICATED;case w.INVALID_ARGUMENT:return Ce.INVALID_ARGUMENT;case w.NOT_FOUND:return Ce.NOT_FOUND;case w.ALREADY_EXISTS:return Ce.ALREADY_EXISTS;case w.PERMISSION_DENIED:return Ce.PERMISSION_DENIED;case w.FAILED_PRECONDITION:return Ce.FAILED_PRECONDITION;case w.ABORTED:return Ce.ABORTED;case w.OUT_OF_RANGE:return Ce.OUT_OF_RANGE;case w.UNIMPLEMENTED:return Ce.UNIMPLEMENTED;case w.DATA_LOSS:return Ce.DATA_LOSS;default:return y("Unknown status code: "+t)}}function Ne(t){switch(t){case 200:return w.OK;case 400:return w.INVALID_ARGUMENT;case 401:return w.UNAUTHENTICATED;case 403:return w.PERMISSION_DENIED;case 404:return w.NOT_FOUND;case 409:return w.ABORTED;case 416:return w.OUT_OF_RANGE;case 429:return w.RESOURCE_EXHAUSTED;case 499:return w.CANCELLED;case 500:return w.UNKNOWN;case 501:return w.UNIMPLEMENTED;case 503:return w.UNAVAILABLE;case 504:return w.DEADLINE_EXCEEDED;default:return t>=200&&t<300?w.OK:t>=400&&t<500?w.FAILED_PRECONDITION:t>=500&&t<600?w.INTERNAL:w.UNKNOWN}}(function(t){t[t["OK"]=0]="OK",t[t["CANCELLED"]=1]="CANCELLED",t[t["UNKNOWN"]=2]="UNKNOWN",t[t["INVALID_ARGUMENT"]=3]="INVALID_ARGUMENT",t[t["DEADLINE_EXCEEDED"]=4]="DEADLINE_EXCEEDED",t[t["NOT_FOUND"]=5]="NOT_FOUND",t[t["ALREADY_EXISTS"]=6]="ALREADY_EXISTS",t[t["PERMISSION_DENIED"]=7]="PERMISSION_DENIED",t[t["UNAUTHENTICATED"]=16]="UNAUTHENTICATED",t[t["RESOURCE_EXHAUSTED"]=8]="RESOURCE_EXHAUSTED",t[t["FAILED_PRECONDITION"]=9]="FAILED_PRECONDITION",t[t["ABORTED"]=10]="ABORTED",t[t["OUT_OF_RANGE"]=11]="OUT_OF_RANGE",t[t["UNIMPLEMENTED"]=12]="UNIMPLEMENTED",t[t["INTERNAL"]=13]="INTERNAL",t[t["UNAVAILABLE"]=14]="UNAVAILABLE",t[t["DATA_LOSS"]=15]="DATA_LOSS"})(Ce||(Ce={}));var Re=new Et(mt.comparator);function De(){return Re}function je(){return De()}var Me=new Et(mt.comparator);function Le(){return Me}var Fe=new Et(mt.comparator);function Ve(){return Fe}var Be=new he(mt.comparator);function Ue(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Be,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var qe=new he($);function We(){return qe}var Ke,He,ze=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||mt.comparator(e.key,n.key)}:function(t,e){return mt.comparator(t.key,e.key)},this.keyedMap=Le(),this.sortedSet=new Et(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();while(n.hasNext()){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}();(function(t){t[t["Added"]=0]="Added",t[t["Removed"]=1]="Removed",t[t["Modified"]=2]="Modified",t[t["Metadata"]=3]="Metadata"})(Ke||(Ke={})),function(t){t[t["Local"]=0]="Local",t[t["Synced"]=1]="Synced"}(He||(He={}));var Ge,Qe=function(){function t(){this.changeMap=new Et(mt.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.changeMap.get(e);n?t.type!==Ke.Added&&n.type===Ke.Metadata?this.changeMap=this.changeMap.insert(e,t):t.type===Ke.Metadata&&n.type!==Ke.Removed?this.changeMap=this.changeMap.insert(e,{type:n.type,doc:t.doc}):t.type===Ke.Modified&&n.type===Ke.Modified?this.changeMap=this.changeMap.insert(e,{type:Ke.Modified,doc:t.doc}):t.type===Ke.Modified&&n.type===Ke.Added?this.changeMap=this.changeMap.insert(e,{type:Ke.Added,doc:t.doc}):t.type===Ke.Removed&&n.type===Ke.Added?this.changeMap=this.changeMap.remove(e):t.type===Ke.Removed&&n.type===Ke.Modified?this.changeMap=this.changeMap.insert(e,{type:Ke.Removed,doc:n.doc}):t.type===Ke.Added&&n.type===Ke.Removed?this.changeMap=this.changeMap.insert(e,{type:Ke.Modified,doc:t.doc}):y("unsupported combination of changes: "+JSON.stringify(t)+" after "+JSON.stringify(n)):this.changeMap=this.changeMap.insert(e,t)},t.prototype.getChanges=function(){var t=[];return this.changeMap.inorderTraversal(function(e,n){t.push(n)}),t},t}(),Ye=function(){function t(t,e,n,r,i,o,a,s){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:Ke.Added,doc:t})}),new t(e,n,ze.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){if(this.fromCache!==t.fromCache||this.syncStateChanged!==t.syncStateChanged||!this.mutatedKeys.isEqual(t.mutatedKeys)||!this.query.isEqual(t.query)||!this.docs.isEqual(t.docs)||!this.oldDocs.isEqual(t.oldDocs))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Xe=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r,i=(r={},r[e]=Je.createSynthesizedTargetChangeForCurrentChange(e,n),r);return new t(ue.MIN,i,We(),De(),Ue())},t}(),Je=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(b(),n,Ue(),Ue(),Ue())},t}(),$e=function(){function t(t,e,n,r){this.updatedTargetIds=t,this.removedTargetIds=e,this.key=n,this.newDoc=r}return t}(),Ze=function(){function t(t,e){this.targetId=t,this.existenceFilter=e}return t}();(function(t){t[t["NoChange"]=0]="NoChange",t[t["Added"]=1]="Added",t[t["Removed"]=2]="Removed",t[t["Current"]=3]="Current",t[t["Reset"]=4]="Reset"})(Ge||(Ge={}));var tn=function(){function t(t,e,n,r){void 0===n&&(n=b()),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}return t}(),en=function(){function t(){this.pendingResponses=0,this.documentChanges=on(),this._resumeToken=b(),this._current=!1,this._hasPendingChanges=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this._current},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this._resumeToken},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPending",{get:function(){return 0!==this.pendingResponses},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingChanges",{get:function(){return this._hasPendingChanges},enumerable:!0,configurable:!0}),t.prototype.updateResumeToken=function(t){t.length>0&&(this._hasPendingChanges=!0,this._resumeToken=t)},t.prototype.toTargetChange=function(){var t=Ue(),e=Ue(),n=Ue();return this.documentChanges.forEach(function(r,i){switch(i){case Ke.Added:t=t.add(r);break;case Ke.Modified:e=e.add(r);break;case Ke.Removed:n=n.add(r);break;default:y("Encountered invalid change type: "+i)}}),new Je(this._resumeToken,this._current,t,e,n)},t.prototype.clearPendingChanges=function(){this._hasPendingChanges=!1,this.documentChanges=on()},t.prototype.addDocumentChange=function(t,e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(t,e)},t.prototype.removeDocumentChange=function(t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(t)},t.prototype.recordPendingTargetRequest=function(){this.pendingResponses+=1},t.prototype.recordTargetResponse=function(){this.pendingResponses-=1},t.prototype.markCurrent=function(){this._hasPendingChanges=!0,this._current=!0},t}(),nn=function(){function t(t){this.metadataProvider=t,this.targetStates={},this.pendingDocumentUpdates=De(),this.pendingDocumentTargetMapping=rn(),this.pendingTargetResets=new he($)}return t.prototype.handleDocumentChange=function(t){for(var e=0,n=t.updatedTargetIds;e<n.length;e++){var r=n[e];t.newDoc instanceof wt?this.addDocumentToTarget(r,t.newDoc):t.newDoc instanceof _t&&this.removeDocumentFromTarget(r,t.key,t.newDoc)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){r=o[i];this.removeDocumentFromTarget(r,t.key,t.newDoc)}},t.prototype.handleTargetChange=function(t){var e=this;this.forEachTarget(t,function(n){var r=e.ensureTargetState(n);switch(t.state){case Ge.NoChange:e.isActiveTarget(n)&&r.updateResumeToken(t.resumeToken);break;case Ge.Added:r.recordTargetResponse(),r.isPending||r.clearPendingChanges(),r.updateResumeToken(t.resumeToken);break;case Ge.Removed:r.recordTargetResponse(),r.isPending||e.removeTarget(n),g(!t.cause,"WatchChangeAggregator does not handle errored targets");break;case Ge.Current:e.isActiveTarget(n)&&(r.markCurrent(),r.updateResumeToken(t.resumeToken));break;case Ge.Reset:e.isActiveTarget(n)&&(e.resetTarget(n),r.updateResumeToken(t.resumeToken));break;default:y("Unknown target watch change state: "+t.state)}})},t.prototype.forEachTarget=function(t,e){t.targetIds.length>0?t.targetIds.forEach(e):S(this.targetStates,e)},t.prototype.handleExistenceFilter=function(t){var e=t.targetId,n=t.existenceFilter.count,r=this.queryDataForActiveTarget(e);if(r){var i=r.query;if(i.isDocumentQuery())if(0===n){var o=new mt(i.path);this.removeDocumentFromTarget(e,o,new _t(o,ue.forDeletedDoc()))}else g(1===n,"Single document existence filter with count: "+n);else{var a=this.getCurrentDocumentCountForTarget(e);a!==n&&(this.resetTarget(e),this.pendingTargetResets=this.pendingTargetResets.add(e))}}},t.prototype.createRemoteEvent=function(t){var e=this,n={};S(this.targetStates,function(r,i){var o=e.queryDataForActiveTarget(r);if(o){if(i.current&&o.query.isDocumentQuery()){var a=new mt(o.query.path);null!==e.pendingDocumentUpdates.get(a)||e.targetContainsDocument(r,a)||e.removeDocumentFromTarget(r,a,new _t(a,t))}i.hasPendingChanges&&(n[r]=i.toTargetChange(),i.clearPendingChanges())}});var r=Ue();this.pendingDocumentTargetMapping.forEach(function(t,n){var i=!0;n.forEachWhile(function(t){var n=e.queryDataForActiveTarget(t);return!n||n.purpose===Xt.LimboResolution||(i=!1,!1)}),i&&(r=r.add(t))});var i=new Xe(t,n,this.pendingTargetResets,this.pendingDocumentUpdates,r);return this.pendingDocumentUpdates=De(),this.pendingDocumentTargetMapping=rn(),this.pendingTargetResets=new he($),i},t.prototype.addDocumentToTarget=function(t,e){if(this.isActiveTarget(t)){var n=this.targetContainsDocument(t,e.key)?Ke.Modified:Ke.Added,r=this.ensureTargetState(t);r.addDocumentChange(e.key,n),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(e.key,e),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e.key,this.ensureDocumentTargetMapping(e.key).add(t))}},t.prototype.removeDocumentFromTarget=function(t,e,n){if(this.isActiveTarget(t)){var r=this.ensureTargetState(t);this.targetContainsDocument(t,e)?r.addDocumentChange(e,Ke.Removed):r.removeDocumentChange(e),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,this.ensureDocumentTargetMapping(e).delete(t)),n&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(e,n))}},t.prototype.removeTarget=function(t){delete this.targetStates[t]},t.prototype.getCurrentDocumentCountForTarget=function(t){var e=this.ensureTargetState(t),n=e.toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(t).size+n.addedDocuments.size-n.removedDocuments.size},t.prototype.recordPendingTargetRequest=function(t){var e=this.ensureTargetState(t);e.recordPendingTargetRequest()},t.prototype.ensureTargetState=function(t){return this.targetStates[t]||(this.targetStates[t]=new en),this.targetStates[t]},t.prototype.ensureDocumentTargetMapping=function(t){var e=this.pendingDocumentTargetMapping.get(t);return e||(e=new he($),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,e)),e},t.prototype.isActiveTarget=function(t){return null!==this.queryDataForActiveTarget(t)},t.prototype.queryDataForActiveTarget=function(t){var e=this.targetStates[t];return e&&e.isPending?null:this.metadataProvider.getQueryDataForTarget(t)},t.prototype.resetTarget=function(t){var e=this;g(!this.targetStates[t].isPending,"Should only reset active targets"),this.targetStates[t]=new en;var n=this.metadataProvider.getRemoteKeysForTarget(t);n.forEach(function(n){e.removeDocumentFromTarget(t,n,null)})},t.prototype.targetContainsDocument=function(t,e){var n=this.metadataProvider.getRemoteKeysForTarget(t);return n.has(e)},t}();function rn(){return new Et(mt.comparator)}function on(){return new Et(mt.comparator)}var an=function(){var t={};return t[re.ASCENDING.name]="ASCENDING",t[re.DESCENDING.name]="DESCENDING",t}(),sn=function(){var t={};return t[Zt.LESS_THAN.name]="LESS_THAN",t[Zt.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",t[Zt.GREATER_THAN.name]="GREATER_THAN",t[Zt.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",t[Zt.EQUAL.name]="EQUAL",t[Zt.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",t}(),un=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function cn(t,e){g(!Qt(t),e+" is missing")}function ln(t){return"number"===typeof t?t:"string"===typeof t?Number(t):y("can't parse "+t)}var hn=function(){function t(t,e){this.databaseId=t,this.options=e}return t.prototype.emptyByteString=function(){return this.options.useProto3Json?"":new Uint8Array(0)},t.prototype.unsafeCastProtoByteString=function(t){return t},t.prototype.fromRpcStatus=function(t){var e=void 0===t.code?w.UNKNOWN:xe(t.code);return new _(e,t.message||"")},t.prototype.toInt32Value=function(t){return Qt(t)?void 0:{value:t}},t.prototype.fromInt32Value=function(t){var e;return e="object"===typeof t?t.value:t,Qt(e)?null:e},t.prototype.toTimestamp=function(t){return{seconds:t.seconds,nanos:t.nanoseconds}},t.prototype.fromTimestamp=function(t){if("string"===typeof t)return this.fromIso8601String(t);g(!!t,"Cannot deserialize null or undefined timestamp.");var e=ln(t.seconds||"0"),n=t.nanos||0;return new ct(e,n)},t.prototype.fromIso8601String=function(t){var e=0,n=un.exec(t);if(g(!!n,"invalid timestamp: "+t),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t),o=Math.floor(i.getTime()/1e3);return new ct(o,e)},t.prototype.toBytes=function(t){return this.options.useProto3Json?t.toBase64():this.unsafeCastProtoByteString(t.toUint8Array())},t.prototype.fromBlob=function(t){return"string"===typeof t?(g(this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),at.fromBase64String(t)):(g(!this.options.useProto3Json,"Expected bytes to be passed in as string, but got something else instead."),at.fromUint8Array(t))},t.prototype.toVersion=function(t){return this.toTimestamp(t.toTimestamp())},t.prototype.fromVersion=function(t){return g(!!t,"Trying to deserialize version that isn't set"),ue.fromTimestamp(this.fromTimestamp(t))},t.prototype.toResourceName=function(t,e){return this.fullyQualifiedPrefixPath(t).child("documents").child(e).canonicalString()},t.prototype.fromResourceName=function(t){var e=vt.fromString(t);return g(this.isValidResourceName(e),"Tried to deserialize invalid key "+e.toString()),e},t.prototype.toName=function(t){return this.toResourceName(this.databaseId,t.path)},t.prototype.fromName=function(t){var e=this.fromResourceName(t);return g(e.get(1)===this.databaseId.projectId,"Tried to deserialize key from different project: "+e.get(1)+" vs "+this.databaseId.projectId),g(!e.get(3)&&!this.databaseId.database||e.get(3)===this.databaseId.database,"Tried to deserialize key from different database: "+e.get(3)+" vs "+this.databaseId.database),new mt(this.extractLocalPathFromResourceName(e))},t.prototype.toQueryPath=function(t){return 0===t.length?this.encodedDatabaseId:this.toResourceName(this.databaseId,t)},t.prototype.fromQueryPath=function(t){var e=this.fromResourceName(t);return 4===e.length?vt.EMPTY_PATH:this.extractLocalPathFromResourceName(e)},Object.defineProperty(t.prototype,"encodedDatabaseId",{get:function(){var t=new vt(["projects",this.databaseId.projectId,"databases",this.databaseId.database]);return t.canonicalString()},enumerable:!0,configurable:!0}),t.prototype.fullyQualifiedPrefixPath=function(t){return new vt(["projects",t.projectId,"databases",t.database])},t.prototype.extractLocalPathFromResourceName=function(t){return g(t.length>4&&"documents"===t.get(4),"tried to deserialize invalid key "+t.toString()),t.popFirst(5)},t.prototype.isValidResourceName=function(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)},t.prototype.toValue=function(t){if(t instanceof It)return{nullValue:"NULL_VALUE"};if(t instanceof xt)return{booleanValue:t.value()};if(t instanceof Dt)return{integerValue:""+t.value()};if(t instanceof jt){var e=t.value();if(this.options.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:t.value()}}return t instanceof Mt?{stringValue:t.value()}:t instanceof qt?{mapValue:this.toMapValue(t)}:t instanceof Wt?{arrayValue:this.toArrayValue(t)}:t instanceof Lt?{timestampValue:this.toTimestamp(t.internalValue)}:t instanceof Ut?{geoPointValue:{latitude:t.value().latitude,longitude:t.value().longitude}}:t instanceof Vt?{bytesValue:this.toBytes(t.value())}:t instanceof Bt?{referenceValue:this.toResourceName(t.databaseId,t.key.path)}:y("Unknown FieldValue "+JSON.stringify(t))},t.prototype.fromValue=function(t){var e=this,n=t["value_type"];if(fn(t,n,"nullValue"))return It.INSTANCE;if(fn(t,n,"booleanValue"))return xt.of(t.booleanValue);if(fn(t,n,"integerValue"))return new Dt(ln(t.integerValue));if(fn(t,n,"doubleValue")){if(this.options.useProto3Json){if("NaN"===t.doubleValue)return jt.NAN;if("Infinity"===t.doubleValue)return jt.POSITIVE_INFINITY;if("-Infinity"===t.doubleValue)return jt.NEGATIVE_INFINITY}return new jt(t.doubleValue)}if(fn(t,n,"stringValue"))return new Mt(t.stringValue);if(fn(t,n,"mapValue"))return this.fromFields(t.mapValue.fields||{});if(fn(t,n,"arrayValue")){cn(t.arrayValue,"arrayValue");var r=t.arrayValue.values||[];return new Wt(r.map(function(t){return e.fromValue(t)}))}if(fn(t,n,"timestampValue"))return cn(t.timestampValue,"timestampValue"),new Lt(this.fromTimestamp(t.timestampValue));if(fn(t,n,"geoPointValue")){cn(t.geoPointValue,"geoPointValue");var i=t.geoPointValue.latitude||0,o=t.geoPointValue.longitude||0;return new Ut(new ut(i,o))}if(fn(t,n,"bytesValue")){cn(t.bytesValue,"bytesValue");var a=this.fromBlob(t.bytesValue);return new Vt(a)}if(fn(t,n,"referenceValue")){cn(t.referenceValue,"referenceValue");var s=this.fromResourceName(t.referenceValue),u=new ft(s.get(1),s.get(3)),c=new mt(this.extractLocalPathFromResourceName(s));return new Bt(u,c)}return y("Unknown Value proto "+JSON.stringify(t))},t.prototype.toMutationDocument=function(t,e){return{name:this.toName(t),fields:this.toFields(e)}},t.prototype.toDocument=function(t){return g(!t.hasLocalMutations,"Can't serialize documents with mutations."),{name:this.toName(t.key),fields:this.toFields(t.data),updateTime:this.toTimestamp(t.version.toTimestamp())}},t.prototype.fromDocument=function(t,e){return new wt(this.fromName(t.name),this.fromVersion(t.updateTime),this.fromFields(t.fields||{}),{hasCommittedMutations:!!e})},t.prototype.toFields=function(t){var e=this,n={};return t.forEach(function(t,r){n[t]=e.toValue(r)}),n},t.prototype.fromFields=function(t){var e=this,n=t,r=qt.EMPTY;return O(n,function(t,n){r=r.set(new gt([t]),e.fromValue(n))}),r},t.prototype.toMapValue=function(t){return{fields:this.toFields(t)}},t.prototype.toArrayValue=function(t){var e=this,n=[];return t.forEach(function(t){n.push(e.toValue(t))}),{values:n}},t.prototype.fromFound=function(t){g(!!t.found,"Tried to deserialize a found document from a missing document."),cn(t.found.name,"doc.found.name"),cn(t.found.updateTime,"doc.found.updateTime");var e=this.fromName(t.found.name),n=this.fromVersion(t.found.updateTime),r=this.fromFields(t.found.fields||{});return new wt(e,n,r,{},t.found)},t.prototype.fromMissing=function(t){g(!!t.missing,"Tried to deserialize a missing document from a found document."),g(!!t.readTime,"Tried to deserialize a missing document without a read time.");var e=this.fromName(t.missing),n=this.fromVersion(t.readTime);return new _t(e,n)},t.prototype.fromMaybeDocument=function(t){var e=t["result"];return fn(t,e,"found")?this.fromFound(t):fn(t,e,"missing")?this.fromMissing(t):y("invalid batch get response: "+JSON.stringify(t))},t.prototype.toWatchTargetChangeState=function(t){switch(t){case Ge.Added:return"ADD";case Ge.Current:return"CURRENT";case Ge.NoChange:return"NO_CHANGE";case Ge.Removed:return"REMOVE";case Ge.Reset:return"RESET";default:return y("Unknown WatchTargetChangeState: "+t)}},t.prototype.toTestWatchChange=function(t){if(t instanceof Ze)return{filter:{count:t.existenceFilter.count,targetId:t.targetId}};if(t instanceof $e){if(t.newDoc instanceof wt){var e=t.newDoc;return{documentChange:{document:{name:this.toName(e.key),fields:this.toFields(e.data),updateTime:this.toVersion(e.version)},targetIds:t.updatedTargetIds,removedTargetIds:t.removedTargetIds}}}if(t.newDoc instanceof _t){e=t.newDoc;return{documentDelete:{document:this.toName(e.key),readTime:this.toVersion(e.version),removedTargetIds:t.removedTargetIds}}}if(null===t.newDoc)return{documentRemove:{document:this.toName(t.key),removedTargetIds:t.removedTargetIds}}}if(t instanceof tn){var n=void 0;return t.cause&&(n={code:Pe(t.cause.code),message:t.cause.message}),{targetChange:{targetChangeType:this.toWatchTargetChangeState(t.state),targetIds:t.targetIds,resumeToken:this.unsafeCastProtoByteString(t.resumeToken),cause:n}}}return y("Unrecognized watch change: "+JSON.stringify(t))},t.prototype.fromWatchChange=function(t){var e,n=t["response_type"];if(fn(t,n,"targetChange")){cn(t.targetChange,"targetChange");var r=this.fromWatchTargetChangeState(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=t.targetChange.resumeToken||this.emptyByteString(),a=t.targetChange.cause,s=a&&this.fromRpcStatus(a);e=new tn(r,i,o,s||null)}else if(fn(t,n,"documentChange")){cn(t.documentChange,"documentChange"),cn(t.documentChange.document,"documentChange.name"),cn(t.documentChange.document.name,"documentChange.document.name"),cn(t.documentChange.document.updateTime,"documentChange.document.updateTime");var u=t.documentChange,c=this.fromName(u.document.name),l=this.fromVersion(u.document.updateTime),h=this.fromFields(u.document.fields||{}),f=new wt(c,l,h,{},u.document),d=u.targetIds||[],p=u.removedTargetIds||[];e=new $e(d,p,f.key,f)}else if(fn(t,n,"documentDelete")){cn(t.documentDelete,"documentDelete"),cn(t.documentDelete.document,"documentDelete.document");var v=t.documentDelete;c=this.fromName(v.document),l=v.readTime?this.fromVersion(v.readTime):ue.forDeletedDoc(),f=new _t(c,l),p=v.removedTargetIds||[];e=new $e([],p,f.key,f)}else if(fn(t,n,"documentRemove")){cn(t.documentRemove,"documentRemove"),cn(t.documentRemove.document,"documentRemove");var g=t.documentRemove;c=this.fromName(g.document),p=g.removedTargetIds||[];e=new $e([],p,c,null)}else{if(!fn(t,n,"filter"))return y("Unknown change type "+JSON.stringify(t));cn(t.filter,"filter"),cn(t.filter.targetId,"filter.targetId");var m=t.filter,b=m.count||0,w=new Oe(b),_=m.targetId;e=new Ze(_,w)}return e},t.prototype.fromWatchTargetChangeState=function(t){return"NO_CHANGE"===t?Ge.NoChange:"ADD"===t?Ge.Added:"REMOVE"===t?Ge.Removed:"CURRENT"===t?Ge.Current:"RESET"===t?Ge.Reset:y("Got unexpected TargetChange.state: "+t)},t.prototype.versionFromListenResponse=function(t){var e=t["response_type"];if(!fn(t,e,"targetChange"))return ue.MIN;var n=t.targetChange;return n.targetIds&&n.targetIds.length?ue.MIN:n.readTime?this.fromVersion(n.readTime):ue.MIN},t.prototype.toMutation=function(t){var e,n=this;if(t instanceof me)e={update:this.toMutationDocument(t.key,t.value)};else if(t instanceof _e)e={delete:this.toName(t.key)};else if(t instanceof be)e={update:this.toMutationDocument(t.key,t.data),updateMask:this.toDocumentMask(t.fieldMask)};else{if(!(t instanceof we))return y("Unknown mutation type "+t.type);e={transform:{document:this.toName(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.toFieldTransform(t)})}}}return t.precondition.isNone||(e.currentDocument=this.toPrecondition(t.precondition)),e},t.prototype.fromMutation=function(t){var e=this,n=t.currentDocument?this.fromPrecondition(t.currentDocument):ye.NONE;if(t.update){cn(t.update.name,"name");var r=this.fromName(t.update.name),i=this.fromFields(t.update.fields||{});if(t.updateMask){var o=this.fromDocumentMask(t.updateMask);return new be(r,i,o,n)}return new me(r,i,n)}if(t.delete){r=this.fromName(t.delete);return new _e(r,n)}if(t.transform){r=this.fromName(t.transform.document);var a=t.transform.fieldTransforms.map(function(t){return e.fromFieldTransform(t)});return g(!0===n.exists,'Transforms only support precondition "exists == true"'),new we(r,a)}return y("unknown mutation proto: "+JSON.stringify(t))},t.prototype.toPrecondition=function(t){return g(!t.isNone,"Can't serialize an empty precondition"),void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:y("Unknown precondition")},t.prototype.fromPrecondition=function(t){return void 0!==t.updateTime?ye.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?ye.exists(t.exists):ye.NONE},t.prototype.fromWriteResult=function(t,e){var n=this,r=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e),i=null;return t.transformResults&&t.transformResults.length>0&&(i=t.transformResults.map(function(t){return n.fromValue(t)})),new ve(r,i)},t.prototype.fromWriteResults=function(t,e){var n=this;return t&&t.length>0?(g(void 0!==e,"Received a write result without a commit time"),t.map(function(t){return n.fromWriteResult(t,e)})):[]},t.prototype.toFieldTransform=function(t){var e=this,n=t.transform;if(n instanceof ke)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ee)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements.map(function(t){return e.toValue(t)})}};if(n instanceof Te)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements.map(function(t){return e.toValue(t)})}};throw y("Unknown transform: "+t.transform)},t.prototype.fromFieldTransform=function(t){var e=this,n=t["transform_type"],r=null;if(fn(t,n,"setToServerValue"))g("REQUEST_TIME"===t.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(t)),r=ke.instance;else if(fn(t,n,"appendMissingElements")){var i=t.appendMissingElements.values||[];r=new Ee(i.map(function(t){return e.fromValue(t)}))}else if(fn(t,n,"removeAllFromArray")){i=t.removeAllFromArray.values||[];r=new Te(i.map(function(t){return e.fromValue(t)}))}else y("Unknown transform proto: "+JSON.stringify(t));var o=gt.fromServerFormat(t.fieldPath);return new pe(o,r)},t.prototype.toDocumentsTarget=function(t){return{documents:[this.toQueryPath(t.path)]}},t.prototype.fromDocumentsTarget=function(t){var e=t.documents.length;g(1===e,"DocumentsTarget contained other than 1 document: "+e);var n=t.documents[0];return Jt.atPath(this.fromQueryPath(n))},t.prototype.toQueryTarget=function(t){var e={structuredQuery:{}};if(t.path.isEmpty())e.parent=this.toQueryPath(vt.EMPTY_PATH);else{var n=t.path;g(n.length%2!==0,"Document queries with filters are not supported."),e.parent=this.toQueryPath(n.popLast()),e.structuredQuery.from=[{collectionId:n.lastSegment()}]}var r=this.toFilter(t.filters);r&&(e.structuredQuery.where=r);var i=this.toOrder(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.toInt32Value(t.limit);return void 0!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.toCursor(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.toCursor(t.endAt)),e},t.prototype.fromQueryTarget=function(t){var e=this.fromQueryPath(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0;if(r>0){g(1===r,"StructuredQuery.from with more than one collection is not supported.");var i=n.from[0];e=e.child(i.collectionId)}var o=[];n.where&&(o=this.fromFilter(n.where));var a=[];n.orderBy&&(a=this.fromOrder(n.orderBy));var s=null;n.limit&&(s=this.fromInt32Value(n.limit));var u=null;n.startAt&&(u=this.fromCursor(n.startAt));var c=null;return n.endAt&&(c=this.fromCursor(n.endAt)),new Jt(e,a,o,s,u,c)},t.prototype.toListenRequestLabels=function(t){var e=this.toLabel(t.purpose);return null==e?null:{"goog-listen-tags":e}},t.prototype.toLabel=function(t){switch(t){case Xt.Listen:return null;case Xt.ExistenceFilterMismatch:return"existence-filter-mismatch";case Xt.LimboResolution:return"limbo-document";default:return y("Unrecognized query purpose: "+t)}},t.prototype.toTarget=function(t){var e,n=t.query;return e=n.isDocumentQuery()?{documents:this.toDocumentsTarget(n)}:{query:this.toQueryTarget(n)},e.targetId=t.targetId,t.resumeToken.length>0&&(e.resumeToken=this.unsafeCastProtoByteString(t.resumeToken)),e},t.prototype.toFilter=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof te?e.toRelationFilter(t):e.toUnaryFilter(t)});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},t.prototype.fromFilter=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.fromUnaryFilter(t)]:void 0!==t.fieldFilter?[this.fromRelationFilter(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.fromFilter(t)}).reduce(function(t,e){return t.concat(e)}):y("Unknown filter: "+JSON.stringify(t)):[]},t.prototype.toOrder=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.toPropertyOrder(t)})},t.prototype.fromOrder=function(t){var e=this;return t.map(function(t){return e.fromPropertyOrder(t)})},t.prototype.toCursor=function(t){var e=this;return{before:t.before,values:t.position.map(function(t){return e.toValue(t)})}},t.prototype.fromCursor=function(t){var e=this,n=!!t.before,r=t.values.map(function(t){return e.fromValue(t)});return new ie(r,n)},t.prototype.toDirection=function(t){return an[t.name]},t.prototype.fromDirection=function(t){switch(t){case"ASCENDING":return re.ASCENDING;case"DESCENDING":return re.DESCENDING;default:return}},t.prototype.toOperatorName=function(t){return sn[t.name]},t.prototype.fromOperatorName=function(t){switch(t){case"EQUAL":return Zt.EQUAL;case"GREATER_THAN":return Zt.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return Zt.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return Zt.LESS_THAN;case"LESS_THAN_OR_EQUAL":return Zt.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return Zt.ARRAY_CONTAINS;case"OPERATOR_UNSPECIFIED":return y("Unspecified relation");default:return y("Unknown relation")}},t.prototype.toFieldPathReference=function(t){return{fieldPath:t.canonicalString()}},t.prototype.fromFieldPathReference=function(t){return gt.fromServerFormat(t.fieldPath)},t.prototype.toPropertyOrder=function(t){return{field:this.toFieldPathReference(t.field),direction:this.toDirection(t.dir)}},t.prototype.fromPropertyOrder=function(t){return new oe(this.fromFieldPathReference(t.field),this.fromDirection(t.direction))},t.prototype.toRelationFilter=function(t){return t instanceof te?{fieldFilter:{field:this.toFieldPathReference(t.field),op:this.toOperatorName(t.op),value:this.toValue(t.value)}}:y("Unrecognized filter: "+JSON.stringify(t))},t.prototype.fromRelationFilter=function(t){return new te(this.fromFieldPathReference(t.fieldFilter.field),this.fromOperatorName(t.fieldFilter.op),this.fromValue(t.fieldFilter.value))},t.prototype.toUnaryFilter=function(t){return t instanceof ne?{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NAN"}}:t instanceof ee?{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NULL"}}:y("Unrecognized filter: "+JSON.stringify(t))},t.prototype.fromUnaryFilter=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.fromFieldPathReference(t.unaryFilter.field);return new ne(e);case"IS_NULL":var n=this.fromFieldPathReference(t.unaryFilter.field);return new ee(n);case"OPERATOR_UNSPECIFIED":return y("Unspecified filter");default:return y("Unknown filter")}},t.prototype.toDocumentMask=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.canonicalString())}),{fieldPaths:e}},t.prototype.fromDocumentMask=function(t){var e=t.fieldPaths||[],n=e.map(function(t){return gt.fromServerFormat(t)});return de.fromArray(n)},t}();function fn(t,e,n){return e===n||!e&&n in t}var dn=function(){return"object"===typeof navigator&&"ReactNative"===navigator["product"]},pn="FirebaseError",vn=Error.captureStackTrace,yn=function(){function t(t,e){if(this.code=t,this.message=e,vn)vn(this,gn.prototype.create);else try{throw Error.apply(this,arguments)}catch(n){this.name=pn,Object.defineProperty(this,"stack",{get:function(){return n.stack}})}}return t}();yn.prototype=Object.create(Error.prototype),yn.prototype.constructor=yn,yn.prototype.name=pn;var gn=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n,this.pattern=/\{\$([^}]+)}/g}return t.prototype.create=function(t,e){void 0===e&&(e={});var n,r=this.errors[t],i=this.service+"/"+t;n=void 0===r?"Error":r.replace(this.pattern,function(t,n){var r=e[n];return void 0!==r?r.toString():"<"+n+"?>"}),n=this.serviceName+": "+n+" ("+i+").";var o=new yn(i,n);for(var a in e)e.hasOwnProperty(a)&&"_"!==a.slice(-1)&&(o[a]=e[a]);return o},t}(),mn=function(){function t(){this.blockSize=-1}return t}(),bn=(function(t){function e(){var e=t.call(this)||this;e.chain_=[],e.buf_=[],e.W_=[],e.pad_=[],e.inbuf_=0,e.total_=0,e.blockSize=64,e.pad_[0]=128;for(var n=1;n<e.blockSize;++n)e.pad_[n]=0;return e.reset(),e}s.__extends(e,t),e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"===typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],l=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=l^u&(c^l),a=1518500249):(o=u^c^l,a=1859775393):r<60?(o=u&c|l&(u|c),a=2400959708):(o=u^c^l,a=3395469782);i=(s<<5|s>>>27)+o+h+a+n[r]&4294967295;h=l,l=c,c=4294967295&(u<<30|u>>>2),u=s,s=i}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},e.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;while(r<e){if(0==o)while(r<=n)this.compress_(t,r),r+=this.blockSize;if("string"===typeof t){while(r<e)if(i[o]=t.charCodeAt(r),++o,++r,o==this.blockSize){this.compress_(i),o=0;break}}else while(r<e)if(i[o]=t[r],++o,++r,o==this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},e.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t}}(mn),function(){function t(t){this.sendFn=t.sendFn,this.closeFn=t.closeFn}return t.prototype.onOpen=function(t){g(!this.wrappedOnOpen,"Called onOpen on stream twice!"),this.wrappedOnOpen=t},t.prototype.onClose=function(t){g(!this.wrappedOnClose,"Called onClose on stream twice!"),this.wrappedOnClose=t},t.prototype.onMessage=function(t){g(!this.wrappedOnMessage,"Called onMessage on stream twice!"),this.wrappedOnMessage=t},t.prototype.close=function(){this.closeFn()},t.prototype.send=function(t){this.sendFn(t)},t.prototype.callOnOpen=function(){g(void 0!==this.wrappedOnOpen,"Cannot call onOpen because no callback was set"),this.wrappedOnOpen()},t.prototype.callOnClose=function(t){g(void 0!==this.wrappedOnClose,"Cannot call onClose because no callback was set"),this.wrappedOnClose(t)},t.prototype.callOnMessage=function(t){g(void 0!==this.wrappedOnMessage,"Cannot call onMessage because no callback was set"),this.wrappedOnMessage(t)},t}()),wn="Connection",_n="google.firestore.v1beta1.Firestore",kn="v1beta1",En={BatchGetDocuments:"batchGet",Commit:"commit"},Tn="gl-js/ fire/"+c,Sn=15,Cn=function(){function t(t){this.databaseId=t.databaseId,this.pool=new u.XhrIoPool;var e=t.ssl?"https":"http";this.baseUrl=e+"://"+t.host}return t.prototype.modifyHeadersForRequest=function(t,e){if(e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n]);t["X-Goog-Api-Client"]=Tn},t.prototype.invokeRPC=function(t,e,n){var r=this,i=this.makeUrl(t);return new Promise(function(o,a){r.pool.getObject(function(s){s.listenOnce(u.EventType.COMPLETE,function(){try{switch(s.getLastErrorCode()){case u.ErrorCode.NO_ERROR:var e=s.getResponseJson();d(wn,"XHR received:",JSON.stringify(e)),o(e);break;case u.ErrorCode.TIMEOUT:d(wn,'RPC "'+t+'" timed out'),a(new _(w.DEADLINE_EXCEEDED,"Request time out"));break;case u.ErrorCode.HTTP_ERROR:var n=s.getStatus();d(wn,'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0?a(new _(Ne(n),"Server responded with status "+s.getStatusText())):(d(wn,'RPC "'+t+'" failed'),a(new _(w.UNAVAILABLE,"Connection failed.")));break;default:y('RPC "'+t+'" failed with unanticipated webchannel error '+s.getLastErrorCode()+": "+s.getLastError()+", giving up.")}}finally{d(wn,'RPC "'+t+'" completed.'),r.pool.releaseObject(s)}});var c=JSON.stringify(e);d(wn,"XHR sending: ",i+" "+c);var l={"Content-Type":"text/plain"};r.modifyHeadersForRequest(l,n),s.send(i,"POST",c,l,Sn)})})},t.prototype.invokeStreamingRPC=function(t,e,n){return this.invokeRPC(t,e,n)},t.prototype.openStream=function(t,e){var n=[this.baseUrl,"/",_n,"/",t,"/channel"],r=u.createWebChannelTransport(),i={backgroundChannelTest:!0,httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0};this.modifyHeadersForRequest(i.initMessageHeaders,e),dn()||(i["httpHeadersOverwriteParam"]="$httpHeaders");var o=n.join("");d(wn,"Creating WebChannel: "+o+" "+i);var a=r.createWebChannel(o,i),s=!1,c=!1,l=new bn({sendFn:function(t){c?d(wn,"Not sending because WebChannel is closed:",t):(s||(d(wn,"Opening WebChannel transport."),a.open(),s=!0),d(wn,"WebChannel sending:",t),a.send(t))},closeFn:function(){return a.close()}}),h=function(t,e){a.listen(t,function(t){try{e(t)}catch(n){setTimeout(function(){throw n},0)}})};return h(u.WebChannel.EventType.OPEN,function(){c||d(wn,"WebChannel transport opened.")}),h(u.WebChannel.EventType.CLOSE,function(){c||(c=!0,d(wn,"WebChannel transport closed"),l.callOnClose())}),h(u.WebChannel.EventType.ERROR,function(t){c||(c=!0,d(wn,"WebChannel transport errored:",t),l.callOnClose(new _(w.UNAVAILABLE,"The operation could not be completed")))}),h(u.WebChannel.EventType.MESSAGE,function(t){if(!c){var e=t.data[0];g(!!e,"Got a webchannel message without data.");var n=e.error||e[0]&&e[0].error;if(n){d(wn,"WebChannel received error:",n);var r=n.status,i=Ie(r),o=n.message;void 0===i&&(i=w.INTERNAL,o="Unknown error status: "+r+" with message "+n.message),c=!0,l.callOnClose(new _(i,o)),a.close()}else d(wn,"WebChannel received:",e),l.callOnMessage(e)}}),setTimeout(function(){l.callOnOpen()},0),l},t.prototype.makeUrl=function(t){var e=En[t];g(void 0!==e,"Unknown REST mapping for: "+t);var n=[this.baseUrl,"/",kn];return n.push("/projects/"),n.push(this.databaseId.projectId),n.push("/databases/"),n.push(this.databaseId.database),n.push("/documents"),n.push(":"),n.push(e),n.join("")},t}(),On=function(){function t(){this.emptyByteString="",this.base64Available="undefined"!==typeof atob}return Object.defineProperty(t.prototype,"document",{get:function(){return"undefined"!==typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return"undefined"!==typeof window?window:null},enumerable:!0,configurable:!0}),t.prototype.loadConnection=function(t){return Promise.resolve(new Cn(t))},t.prototype.newSerializer=function(t){return new hn(t,{useProto3Json:!0})},t.prototype.formatJSON=function(t){return JSON.stringify(t)},t.prototype.atob=function(t){return atob(t)},t.prototype.btoa=function(t){return btoa(t)},t}();m.setPlatform(new On);var An,In=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.setPreviousValue(t)},this.writeNewSequenceNumber=function(t){return e.writeSequenceNumber(t)})}return t.prototype.setPreviousValue=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(t),t},t.INVALID=-1,t}(),xn=function(){function t(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return t}();(function(t){t["All"]="all",t["ListenStreamIdle"]="listen_stream_idle",t["ListenStreamConnectionBackoff"]="listen_stream_connection_backoff",t["WriteStreamIdle"]="write_stream_idle",t["WriteStreamConnectionBackoff"]="write_stream_connection_backoff",t["OnlineStateTimeout"]="online_state_timeout",t["ClientMetadataRefresh"]="client_metadata_refresh",t["LruGarbageCollection"]="lru_garbage_collection"})(An||(An={}));var Pn=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new xn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.catch=this.deferred.promise.catch.bind(this.deferred.promise),this.deferred.promise.catch(function(t){})}return t.createAndSchedule=function(e,n,r,i,o){var a=Date.now()+r,s=new t(e,n,a,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout(function(){return e.handleDelayElapsed()},t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new _(w.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget(function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then(function(e){return t.deferred.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}(),Nn=function(){function t(){this.tail=Promise.resolve(),this.delayedOperations=[],this.operationInProgress=!1}return t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueue=function(t){var e=this;this.verifyNotFailed();var n=this.tail.then(function(){return e.operationInProgress=!0,t().catch(function(t){e.failure=t,e.operationInProgress=!1;var n=t.stack||t.message||"";throw p("INTERNAL UNHANDLED ERROR: ",n),n.indexOf("Firestore Test Simulated Error")<0&&setTimeout(function(){throw t},0),t}).then(function(t){return e.operationInProgress=!1,t})});return this.tail=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.verifyNotFailed(),g(e>=0,"Attempted to schedule an operation with a negative delay of "+e),g(!this.containsDelayedOperation(t),"Attempted to schedule multiple operations with timer id "+t+".");var i=Pn.createAndSchedule(this,t,e,n,function(t){return r.removeDelayedOperation(t)});return this.delayedOperations.push(i),i},t.prototype.verifyNotFailed=function(){this.failure&&y("AsyncQueue is already failed: "+(this.failure.stack||this.failure.message))},t.prototype.verifyOperationInProgress=function(){g(this.operationInProgress,"verifyOpInProgress() called when no op in progress on this queue.")},t.prototype.drain=function(){return this.enqueue(function(){return Promise.resolve()})},t.prototype.containsDelayedOperation=function(t){for(var e=0,n=this.delayedOperations;e<n.length;e++){var r=n[e];if(r.timerId===t)return!0}return!1},t.prototype.runDelayedOperationsEarly=function(t){var e=this;return this.drain().then(function(){g(t===An.All||e.containsDelayedOperation(t),"Attempted to drain to missing operation "+t),e.delayedOperations.sort(function(t,e){return t.targetTimeMs-e.targetTimeMs});for(var n=0,r=e.delayedOperations;n<r.length;n++){var i=r[n];if(i.skipDelay(),t!==An.All&&i.timerId===t)break}return e.drain()})},t.prototype.removeDelayedOperation=function(t){var e=this.delayedOperations.indexOf(t);g(e>=0,"Delayed operation not found."),this.delayedOperations.splice(e,1)},t}(),Rn="",Dn="",jn="",Mn="";function Ln(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Vn(e)),e=Fn(t.get(n),e);return Vn(e)}function Fn(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+=Rn+jn;break;case Rn:n+=Rn+Mn;break;default:n+=o}}return n}function Vn(t){return t+Rn+Dn}function Bn(t){var e=t.length;if(g(e>=2,"Invalid path "+t),2===e)return g(t.charAt(0)===Rn&&t.charAt(1)===Dn,"Non-empty path "+t+" had length 2"),vt.EMPTY_PATH;for(var n=e-2,r=[],i="",o=0;o<e;){var a=t.indexOf(Rn,o);(a<0||a>n)&&y('Invalid encoded resource path: "'+t+'"');var s=t.charAt(a+1);switch(s){case Dn:var u=t.substring(o,a),c=void 0;0===i.length?c=u:(i+=u,c=i,i=""),r.push(c);break;case jn:i+=t.substring(o,a),i+="\0";break;case Mn:i+=t.substring(o,a+1);break;default:y('Invalid encoded resource path: "'+t+'"')}o=a+2}return new vt(r)}var Un,qn=-1,Wn=function(){function t(t,e,n){this.batchId=t,this.localWriteTime=e,this.mutations=n,g(n.length>0,"Cannot create an empty mutation batch")}return t.prototype.applyToRemoteDocument=function(t,e,n){e&&g(e.key.isEqual(t),"applyToRemoteDocument: key "+t+" should match maybeDoc key\n        "+e.key);var r=n.mutationResults;g(r.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+r.length+").");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.isEqual(t)){var a=r[i];e=o.applyToRemoteDocument(e,a)}}return e},t.prototype.applyToLocalView=function(t,e){e&&g(e.key.isEqual(t),"applyToLocalDocument: key "+t+" should match maybeDoc key\n        "+e.key);for(var n=e,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t)&&(e=i.applyToLocalView(e,n,this.localWriteTime))}return e},t.prototype.keys=function(){for(var t=Ue(),e=0,n=this.mutations;e<n.length;e++){var r=n[e];t=t.add(r.key)}return t},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&tt(this.mutations,t.mutations)},t}(),Kn=function(){function t(t,e,n,r,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.streamToken=r,this.docVersions=i}return t.from=function(e,n,r,i){g(e.mutations.length===r.length,"Mutations sent "+e.mutations.length+" must equal results received "+r.length);for(var o=Ve(),a=e.mutations,s=0;s<a.length;s++)o=o.insert(a[s].key,r[s].version);return new t(e,n,r,i,o)},t}(),Hn=1;(function(t){t[t["QueryCache"]=0]="QueryCache",t[t["SyncEngine"]=1]="SyncEngine"})(Un||(Un={}));var zn=function(){function t(t,e){this.generatorId=t,g((t&Hn)===t,"Generator ID "+t+" contains more than "+Hn+" reserved bits"),this.seek(void 0!==e?e:this.generatorId)}return t.prototype.next=function(){var t=this.nextId;return this.nextId+=1<<Hn,t},t.prototype.after=function(t){return this.seek(t+(1<<Hn)),this.next()},t.prototype.seek=function(t){g((t&Hn)===this.generatorId,"Cannot supply target ID from different generator ID"),this.nextId=t},t.forQueryCache=function(){var e=new t(Un.QueryCache,2);return e},t.forSyncEngine=function(){return new t(Un.SyncEngine)},t}(),Gn=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)},function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&y("Called next() or catch() twice for PersistencePromise"),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t(function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}})},t.prototype.toPromise=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(r){return t.reject(r)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.waitFor=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++){var a=o[i];r(a)}return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.waitFor(r)},t}(),Qn="SimpleDb",Yn=function(){function t(t){this.db=t}return t.openOrCreate=function(e,n,r){return g(t.isAvailable(),"IndexedDB not supported in current environment."),d(Qn,"Opening database:",e),new Gn(function(i,o){var a=window.indexedDB.open(e,n);a.onsuccess=function(e){var n=e.target.result;i(new t(n))},a.onblocked=function(){o(new _(w.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=function(t){var e=t.target.error;"VersionError"===e.name?o(new _(w.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o(e)},a.onupgradeneeded=function(t){d(Qn,'Database "'+e+'" requires upgrade from version:',t.oldVersion);var n=t.target.result,i=new Jn(a.transaction);r.createOrUpgrade(n,i,t.oldVersion,gr).next(function(){d(Qn,"Database upgrade to version "+gr+" complete")})}}).toPromise()},t.delete=function(t){return d(Qn,"Removing database:",t),Zn(window.indexedDB.deleteDatabase(t)).toPromise()},t.isAvailable=function(){if("undefined"===typeof window||null==window.indexedDB)return!1;if(void 0===window.navigator)return"YES"===Object({NODE_ENV:"production",BASE_URL:"/"}).USE_MOCK_PERSISTENCE;var t=window.navigator.userAgent;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0)},t.getStore=function(t,e){return t.store(e)},t.prototype.runTransaction=function(t,e,n){var r=Jn.open(this.db,t,e),i=n(r).catch(function(t){return r.abort(t),Gn.reject(t)}).toPromise();return r.completionPromise.then(function(){return i})},t.prototype.close=function(){this.db.close()},t}(),Xn=function(){function t(t){this.dbCursor=t,this.shouldStop=!1,this.nextKey=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.shouldStop},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skipToKey",{get:function(){return this.nextKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.dbCursor=t},enumerable:!0,configurable:!0}),t.prototype.done=function(){this.shouldStop=!0},t.prototype.skip=function(t){this.nextKey=t},t.prototype.delete=function(){return Zn(this.dbCursor.delete())},t}(),Jn=function(){function t(t){var e=this;this.transaction=t,this.aborted=!1,this.completionDeferred=new xn,this.transaction.oncomplete=function(){e.completionDeferred.resolve()},this.transaction.onabort=function(){t.error?e.completionDeferred.reject(t.error):e.completionDeferred.resolve()},this.transaction.onerror=function(t){e.completionDeferred.reject(t.target.error)}}return t.open=function(e,n,r){return new t(e.transaction(r,n))},Object.defineProperty(t.prototype,"completionPromise",{get:function(){return this.completionDeferred.promise},enumerable:!0,configurable:!0}),t.prototype.abort=function(t){t&&this.completionDeferred.reject(t),this.aborted||(d(Qn,"Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return g(!!e,"Object store not part of transaction: "+t),new $n(e)},t}(),$n=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(d(Qn,"PUT",this.store.name,t,e),n=this.store.put(e,t)):(d(Qn,"PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Zn(n)},t.prototype.add=function(t){d(Qn,"ADD",this.store.name,t,t);var e=this.store.add(t);return Zn(e)},t.prototype.get=function(t){var e=this,n=this.store.get(t);return Zn(n).next(function(n){return void 0===n&&(n=null),d(Qn,"GET",e.store.name,t,n),n})},t.prototype.delete=function(t){d(Qn,"DELETE",this.store.name,t);var e=this.store.delete(t);return Zn(e)},t.prototype.count=function(){d(Qn,"COUNT",this.store.name);var t=this.store.count();return Zn(t)},t.prototype.loadAll=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.iterateCursor(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.deleteAll=function(t,e){d(Qn,"DELETE ALL",this.store.name);var n=this.options(t,e);n.keysOnly=!1;var r=this.cursor(n);return this.iterateCursor(r,function(t,e,n){return n.delete()})},t.prototype.iterate=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.iterateCursor(r,e)},t.prototype.iterateSerial=function(t){var e=this.cursor({});return new Gn(function(n,r){e.onerror=function(t){r(t.target.error)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.iterateCursor=function(t,e){var n=[];return new Gn(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Xn(i),a=e(i.primaryKey,i.value,o);if(a instanceof Gn){var s=a.catch(function(t){return o.done(),Gn.reject(t)});n.push(s)}o.isDone?r():null===o.skipToKey?i.continue():i.continue(o.skipToKey)}else r()}}).next(function(){return Gn.waitFor(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"===typeof t?n=t:(g(void 0===e,"3rd argument must not be defined if 2nd is a range."),e=t)),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.keysOnly?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Zn(t){return new Gn(function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){n(t.target.error)}})}var tr=function(){function t(t,e){this.referenceDelegate=t,this.serializer=e,this.targetIdGenerator=zn.forQueryCache()}return t.prototype.allocateTargetId=function(t){var e=this;return this.retrieveMetadata(t).next(function(n){return n.highestTargetId=e.targetIdGenerator.after(n.highestTargetId),e.saveMetadata(t,n).next(function(){return n.highestTargetId})})},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.retrieveMetadata(t).next(function(t){return ue.fromTimestamp(new ct(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.getHighestSequenceNumber=function(t){return ir(t.simpleDbTransaction)},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.retrieveMetadata(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.saveMetadata(t,i)})},t.prototype.addQueryData=function(t,e){var n=this;return this.saveQueryData(t,e).next(function(){return n.retrieveMetadata(t).next(function(r){return r.targetCount+=1,n.updateMetadataFromQueryData(e,r),n.saveMetadata(t,r)})})},t.prototype.updateQueryData=function(t,e){return this.saveQueryData(t,e)},t.prototype.removeQueryData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next(function(){return er(t).delete(e.targetId)}).next(function(){return n.retrieveMetadata(t)}).next(function(e){return g(e.targetCount>0,"Removing from an empty query cache"),e.targetCount-=1,n.saveMetadata(t,e)})},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return er(t).iterate(function(a,s){var u=r.serializer.fromDbTarget(s);u.sequenceNumber<=e&&void 0===n[u.targetId]&&(i++,o.push(r.removeQueryData(t,u)))}).next(function(){return Gn.waitFor(o)}).next(function(){return i})},t.prototype.forEachTarget=function(t,e){var n=this;return er(t).iterate(function(t,r){var i=n.serializer.fromDbTarget(r);e(i)})},t.prototype.retrieveMetadata=function(t){return rr(t.simpleDbTransaction)},t.prototype.saveMetadata=function(t,e){return nr(t).put(Mr.key,e)},t.prototype.saveQueryData=function(t,e){return er(t).put(this.serializer.toDbTarget(e))},t.prototype.updateMetadataFromQueryData=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getQueryCount=function(t){return this.retrieveMetadata(t).next(function(t){return t.targetCount})},t.prototype.getQueryData=function(t,e){var n=this,r=e.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return er(t).iterate({range:i,index:Dr.queryTargetsIndexName},function(t,r,i){var a=n.serializer.fromDbTarget(r);e.isEqual(a.query)&&(o=a,i.done())}).next(function(){return o})},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=or(t);return e.forEach(function(e){var a=Ln(e.path);i.push(o.put(new jr(n,a))),i.push(r.referenceDelegate.addReference(t,e))}),Gn.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=or(t);return Gn.forEach(e,function(e){var o=Ln(e.path);return Gn.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,e)])})},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=or(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=or(t),i=Ue();return r.iterate({range:n,keysOnly:!0},function(t,e,n){var r=Bn(t[1]),o=new mt(r);i=i.add(o)}).next(function(){return i})},t.prototype.containsKey=function(t,e){var n=Ln(e.path),r=IDBKeyRange.bound([n],[et(n)],!1,!0),i=0;return or(t).iterate({index:jr.documentTargetsIndex,keysOnly:!0,range:r},function(t,e,n){var r=t[0];t[1];0!==r&&(i++,n.done())}).next(function(){return i>0})},t.prototype.getQueryDataForTarget=function(t,e){var n=this;return er(t).get(e).next(function(t){return t?n.serializer.fromDbTarget(t):null})},t}();function er(t){return Ei.getStore(t,Dr.store)}function nr(t){return Ei.getStore(t,Mr.store)}function rr(t){var e=Yn.getStore(t,Mr.store);return e.get(Mr.key).next(function(t){return g(null!==t,"Missing metadata row."),t})}function ir(t){return rr(t).next(function(t){return t.highestListenSequenceNumber})}function or(t){return Ei.getStore(t,jr.store)}var ar=function(){function t(t){this.mapKeyFn=t,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(a.isEqual(t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){O(this.inner,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];t(a,s)}})},t.prototype.isEmpty=function(){return A(this.inner)},t}(),sr=function(){function t(){this.changes=De(),this.documentSizes=new ar(function(t){return t.toString()})}return t.prototype.addEntry=function(t){var e=this.assertChanges();this.changes=e.insert(t.key,t)},t.prototype.getEntry=function(t,e){var n=this,r=this.assertChanges(),i=r.get(e);return i?Gn.resolve(i):this.getFromCache(t,e).next(function(t){return null===t?(n.documentSizes.set(e,0),null):(n.documentSizes.set(e,t.size),t.maybeDocument)})},t.prototype.getEntries=function(t,e){var n=this;return this.getAllFromCache(t,e).next(function(t){var e=t.maybeDocuments,r=t.sizeMap;return r.forEach(function(t,e){n.documentSizes.set(t,e)}),e})},t.prototype.apply=function(t){var e=this.applyChanges(t);return this.changes=null,e},t.prototype.assertChanges=function(){return g(null!==this.changes,"Changes have already been applied."),this.changes},t}(),ur="The remote document changelog no longer contains all changes for all local query views. It may be necessary to rebuild these views.",cr=function(){function t(t,e){this.serializer=t,this.keepDocumentChangeLog=e,this._lastProcessedDocumentChangeId=0}return Object.defineProperty(t.prototype,"lastProcessedDocumentChangeId",{get:function(){return this._lastProcessedDocumentChangeId},enumerable:!0,configurable:!0}),t.prototype.start=function(t){var e=Yn.getStore(t,Br.store);return this.synchronizeLastDocumentChangeId(e)},t.prototype.addEntries=function(t,e,n){var r=[];if(e.length>0){for(var i=dr(t),o=Ue(),a=0,s=e;a<s.length;a++){var u=s[a],c=u.key,l=u.doc;r.push(i.put(vr(c),l)),o=o.add(c)}this.keepDocumentChangeLog&&r.push(pr(t).put({changes:this.serializer.toDbResourcePaths(o)})),r.push(this.updateSize(t,n))}return Gn.waitFor(r)},t.prototype.removeEntry=function(t,e){var n=dr(t),r=vr(e);return n.get(r).next(function(t){return t?n.delete(r).next(function(){return yr(t)}):Gn.resolve(0)})},t.prototype.getEntry=function(t,e){var n=this;return dr(t).get(vr(e)).next(function(t){return t?n.serializer.fromDbRemoteDocument(t):null})},t.prototype.getSizedEntry=function(t,e){var n=this;return dr(t).get(vr(e)).next(function(t){return t?{maybeDocument:n.serializer.fromDbRemoteDocument(t),size:yr(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=je();return this.forEachDbEntry(t,e,function(t,e){r=e?r.insert(t,n.serializer.fromDbRemoteDocument(e)):r.insert(t,null)}).next(function(){return r})},t.prototype.getSizedEntries=function(t,e){var n=this,r=je(),i=new Et(mt.comparator);return this.forEachDbEntry(t,e,function(t,e){e?(r=r.insert(t,n.serializer.fromDbRemoteDocument(e)),i=i.insert(t,yr(e))):(r=r.insert(t,null),i=i.insert(t,0))}).next(function(){return{maybeDocuments:r,sizeMap:i}})},t.prototype.forEachDbEntry=function(t,e,n){if(e.isEmpty())return Gn.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return dr(t).iterate({range:r},function(t,e,r){var a=mt.fromSegments(t);while(o&&mt.comparator(o,a)<0)n(o,null),o=i.getNext();o&&o.isEqual(a)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.skip(o.path.toArray()):r.done()}).next(function(){while(o)n(o,null),o=i.hasNext()?i.getNext():null})},t.prototype.getDocumentsMatchingQuery=function(t,e){var n=this,r=Le(),i=e.path.toArray(),o=IDBKeyRange.lowerBound(i);return dr(t).iterate({range:o},function(t,i,o){var a=n.serializer.fromDbRemoteDocument(i);e.path.isPrefixOf(a.key.path)?a instanceof wt&&e.matches(a)&&(r=r.insert(a.key,a)):o.done()}).next(function(){return r})},t.prototype.getNewDocumentChanges=function(t){var e=this;g(this.keepDocumentChangeLog,"Can only call getNewDocumentChanges() when document change log is enabled");var n=Ue(),r=De(),i=IDBKeyRange.lowerBound(this._lastProcessedDocumentChangeId+1),o=!0,a=pr(t);return a.iterate({range:i},function(t,r){if(o&&(o=!1,e._lastProcessedDocumentChangeId+1!==r.id))return e.synchronizeLastDocumentChangeId(a).next(function(){return Gn.reject(new _(w.DATA_LOSS,ur))});n=n.unionWith(e.serializer.fromDbResourcePaths(r.changes)),e._lastProcessedDocumentChangeId=r.id}).next(function(){var i=[];return n.forEach(function(n){i.push(e.getEntry(t,n).next(function(t){var e=t||new _t(n,ue.forDeletedDoc());r=r.insert(n,e)}))}),Gn.waitFor(i)}).next(function(){return r})},t.prototype.removeDocumentChangesThroughChangeId=function(t,e){var n=IDBKeyRange.upperBound(e);return pr(t).delete(n)},t.prototype.synchronizeLastDocumentChangeId=function(t){var e=this;return this._lastProcessedDocumentChangeId=0,t.iterate({keysOnly:!0,reverse:!0},function(t,n,r){e._lastProcessedDocumentChangeId=t,r.done()})},t.prototype.newChangeBuffer=function(){return new hr(this)},t.prototype.getSize=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return lr(t).get(Nr.key).next(function(t){return g(!!t,"Missing document cache metadata"),t})},t.prototype.setMetadata=function(t,e){return lr(t).put(Nr.key,e)},t.prototype.updateSize=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.setMetadata(t,r)})},t}();function lr(t){return Ei.getStore(t,Nr.store)}var hr=function(t){function e(e){var n=t.call(this)||this;return n.documentCache=e,n}return s.__extends(e,t),e.prototype.applyChanges=function(t){var e=this,n=this.assertChanges(),r=0,i=[];return n.forEach(function(t,n){var o=e.documentCache.serializer.toDbRemoteDocument(n),a=e.documentSizes.get(t);g(void 0!==a,"Attempting to change document "+t.toString()+" without having read it first");var s=yr(o);r+=s-a,i.push({key:t,doc:o})}),this.documentCache.addEntries(t,i,r)},e.prototype.getFromCache=function(t,e){return this.documentCache.getSizedEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.documentCache.getSizedEntries(t,e)},e}(sr);function fr(t){return t.code===w.DATA_LOSS&&t.message===ur}function dr(t){return Ei.getStore(t,Pr.store)}function pr(t){return Ei.getStore(t,Br.store)}function vr(t){return t.path.toArray()}function yr(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw y("Unknown remote document type");e=t.noDocument}return JSON.stringify(e).length}var gr=7,mr=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;g(n<r&&n>=0&&r<=gr,"Unexpected schema upgrade from v"+n+" to v{toVersion}."),n<1&&r>=1&&(kr(t),Sr(t),Lr(t),Ar(t));var o=Gn.resolve();return n<3&&r>=3&&(0!==n&&(Fr(t),Lr(t)),o=o.next(function(){return Vr(e)})),n<4&&r>=4&&(0!==n&&(o=o.next(function(){return Cr(t,e)})),o=o.next(function(){Wr(t),Ur(t)})),n<5&&r>=5&&(o=o.next(function(){return i.removeAcknowledgedMutations(e)})),n<6&&r>=6&&(o=o.next(function(){return Rr(t),i.addDocumentGlobal(e)})),n<7&&r>=7&&(o=o.next(function(){return i.ensureSequenceNumbers(e)})),o},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(Pr.store).iterate(function(t,n){e+=yr(n)}).next(function(){var n=new Nr(e);return t.store(Nr.store).put(Nr.key,n)})},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(Er.store),r=t.store(Tr.store);return n.loadAll().next(function(n){return Gn.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,qn],[n.userId,n.lastAcknowledgedBatchId]);return r.loadAll(Tr.userMutationsIndex,i).next(function(r){return Gn.forEach(r,function(r){g(r.userId===n.userId,"Cannot process batch "+r.batchId+" from unexpected user");var i=e.serializer.fromDbMutationBatch(r);return $r(t,n.userId,i).next(function(){})})})})})},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(jr.store),n=t.store(Pr.store);return ir(t).next(function(t){var r=function(n){return e.put(new jr(0,Ln(n),t))},i=[];return n.iterate(function(t,n){var o=new vt(t),a=br(o);i.push(e.get(a).next(function(t){return t?Gn.resolve():r(o)}))}).next(function(){return Gn.waitFor(i)})})},t}();function br(t){return[0,Ln(t)]}var wr=function(){function t(t,e){this.seconds=t,this.nanoseconds=e}return t}(),_r=function(){function t(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}return t.store="owner",t.key="owner",t}();function kr(t){t.createObjectStore(_r.store)}var Er=function(){function t(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}return t.store="mutationQueues",t.keyPath="userId",t}(),Tr=function(){function t(t,e,n,r){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.mutations=r}return t.store="mutations",t.keyPath="batchId",t.userMutationsIndex="userMutationsIndex",t.userMutationsKeyPath=["userId","batchId"],t}();function Sr(t){t.createObjectStore(Er.store,{keyPath:Er.keyPath});var e=t.createObjectStore(Tr.store,{keyPath:Tr.keyPath,autoIncrement:!0});e.createIndex(Tr.userMutationsIndex,Tr.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Or.store)}function Cr(t,e){var n=e.store(Tr.store);return n.loadAll().next(function(n){t.deleteObjectStore(Tr.store);var r=t.createObjectStore(Tr.store,{keyPath:Tr.keyPath,autoIncrement:!0});r.createIndex(Tr.userMutationsIndex,Tr.userMutationsKeyPath,{unique:!0});var i=e.store(Tr.store),o=n.map(function(t){return i.put(t)});return Gn.waitFor(o)})}var Or=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Ln(e)]},t.key=function(t,e,n){return[t,Ln(e),n]},t.store="documentMutations",t.PLACEHOLDER=new t,t}();function Ar(t){t.createObjectStore(Pr.store)}var Ir=function(){function t(t,e){this.path=t,this.readTime=e}return t}(),xr=function(){function t(t,e){this.path=t,this.version=e}return t}(),Pr=function(){function t(t,e,n,r){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r}return t.store="remoteDocuments",t}(),Nr=function(){function t(t){this.byteSize=t}return t.store="remoteDocumentGlobal",t.key="remoteDocumentGlobalKey",t}();function Rr(t){t.createObjectStore(Nr.store)}var Dr=function(){function t(t,e,n,r,i,o){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.query=o}return t.store="targets",t.keyPath="targetId",t.queryTargetsIndexName="queryTargetsIndex",t.queryTargetsKeyPath=["canonicalId","targetId"],t}(),jr=function(){function t(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n,g(0===t===(void 0!==n),"A target-document row must either have targetId == 0 and a defined sequence number, or a non-zero targetId and no sequence number")}return t.store="targetDocuments",t.keyPath=["targetId","path"],t.documentTargetsIndex="documentTargetsIndex",t.documentTargetsKeyPath=["path","targetId"],t}(),Mr=function(){function t(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}return t.key="targetGlobalKey",t.store="targetGlobal",t}();function Lr(t){var e=t.createObjectStore(jr.store,{keyPath:jr.keyPath});e.createIndex(jr.documentTargetsIndex,jr.documentTargetsKeyPath,{unique:!0});var n=t.createObjectStore(Dr.store,{keyPath:Dr.keyPath});n.createIndex(Dr.queryTargetsIndexName,Dr.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Mr.store)}function Fr(t){t.deleteObjectStore(jr.store),t.deleteObjectStore(Dr.store),t.deleteObjectStore(Mr.store)}function Vr(t){var e=t.store(Mr.store),n=new Mr(0,0,ue.MIN.toTimestamp(),0);return e.put(Mr.key,n)}var Br=function(){function t(t){this.changes=t}return t.store="remoteDocumentChanges",t.keyPath="id",t}();function Ur(t){t.createObjectStore(Br.store,{keyPath:"id",autoIncrement:!0})}var qr=function(){function t(t,e,n,r,i){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r,this.lastProcessedDocumentChangeId=i}return t.store="clientMetadata",t.keyPath="clientId",t}();function Wr(t){t.createObjectStore(qr.store,{keyPath:qr.keyPath})}var Kr=[Er.store,Tr.store,Or.store,Pr.store,Dr.store,_r.store,Mr.store,jr.store],Hr=Kr,zr=Hr.concat([qr.store,Br.store]),Gr=zr.concat([Nr.store]),Qr=Gr,Yr=function(){function t(t,e,n){this.userId=t,this.serializer=e,this.referenceDelegate=n,this.documentKeysByBatchId={}}return t.forUser=function(e,n,r){g(""!==e.uid,"UserID must not be an empty string.");var i=e.isAuthenticated()?e.uid:"";return new t(i,n,r)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ti(t).iterate({index:Tr.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.acknowledgeBatch=function(t,e,n){return this.getMutationQueueMetadata(t).next(function(r){var i=e.batchId;return g(i>r.lastAcknowledgedBatchId,"Mutation batchIDs must be acknowledged in order"),r.lastAcknowledgedBatchId=i,r.lastStreamToken=Zr(n),ni(t).put(r)})},t.prototype.getLastStreamToken=function(t){return this.getMutationQueueMetadata(t).next(function(t){return t.lastStreamToken})},t.prototype.setLastStreamToken=function(t,e){return this.getMutationQueueMetadata(t).next(function(n){return n.lastStreamToken=Zr(e),ni(t).put(n)})},t.prototype.addMutationBatch=function(t,e,n){var r=this,i=ei(t),o=ti(t);return o.add({}).next(function(t){g("number"===typeof t,"Auto-generated key is not a number");var a=new Wn(t,e,n),s=r.serializer.toDbMutationBatch(r.userId,a);r.documentKeysByBatchId[t]=a.keys();for(var u=[],c=0,l=n;c<l.length;c++){var h=l[c],f=Or.key(r.userId,h.key.path,t);u.push(o.put(s)),u.push(i.put(f,Or.PLACEHOLDER))}return Gn.waitFor(u).next(function(){return a})})},t.prototype.lookupMutationBatch=function(t,e){var n=this;return ti(t).get(e).next(function(t){return t?(g(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),n.serializer.fromDbMutationBatch(t)):null})},t.prototype.lookupMutationKeys=function(t,e){var n=this;return this.documentKeysByBatchId[e]?Gn.resolve(this.documentKeysByBatchId[e]):this.lookupMutationBatch(t,e).next(function(t){if(t){var r=t.keys();return n.documentKeysByBatchId[e]=r,r}return null})},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this;return this.getMutationQueueMetadata(t).next(function(r){var i=Math.max(e,r.lastAcknowledgedBatchId)+1,o=IDBKeyRange.lowerBound([n.userId,i]),a=null;return ti(t).iterate({index:Tr.userMutationsIndex,range:o},function(t,e,r){e.userId===n.userId&&(g(e.batchId>=i,"Should have found mutation after "+i),a=n.serializer.fromDbMutationBatch(e)),r.done()}).next(function(){return a})})},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,qn],[this.userId,Number.POSITIVE_INFINITY]);return ti(t).loadAll(Tr.userMutationsIndex,n).next(function(t){return t.map(function(t){return e.serializer.fromDbMutationBatch(t)})})},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=Or.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return ei(t).iterate({range:i},function(r,i,a){var s=r[0],u=r[1],c=r[2],l=Bn(u);if(s===n.userId&&e.path.isEqual(l))return ti(t).get(c).next(function(t){if(!t)throw y("Dangling document-mutation reference found: "+r+" which points to "+c);g(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+c),o.push(n.serializer.fromDbMutationBatch(t))});a.done()}).next(function(){return o})},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new he($),i=[];return e.forEach(function(e){var o=Or.prefixForPath(n.userId,e.path),a=IDBKeyRange.lowerBound(o),s=ei(t).iterate({range:a},function(t,i,o){var a=t[0],s=t[1],u=t[2],c=Bn(s);a===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()});i.push(s)}),Gn.waitFor(i).next(function(){return n.lookupMutationBatches(t,r)})},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this;g(!e.isDocumentQuery(),"Document queries shouldn't go down this path");var r=e.path,i=r.length+1,o=Or.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new he($);return ei(t).iterate({range:a},function(t,e,o){var a=t[0],u=t[1],c=t[2],l=Bn(u);a===n.userId&&r.isPrefixOf(l)?l.length===i&&(s=s.add(c)):o.done()}).next(function(){return n.lookupMutationBatches(t,s)})},t.prototype.lookupMutationBatches=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(ti(t).get(e).next(function(t){if(null===t)throw y("Dangling document-mutation reference found, which points to "+e);g(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),r.push(n.serializer.fromDbMutationBatch(t))}))}),Gn.waitFor(i).next(function(){return r})},t.prototype.removeMutationBatch=function(t,e){var n=this;return $r(t.simpleDbTransaction,this.userId,e).next(function(r){return n.removeCachedMutationKeys(e.batchId),Gn.forEach(r,function(e){return n.referenceDelegate.removeMutationReference(t,e)})})},t.prototype.removeCachedMutationKeys=function(t){delete this.documentKeysByBatchId[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next(function(n){if(!n)return Gn.resolve();var r=IDBKeyRange.lowerBound(Or.prefixForUser(e.userId)),i=[];return ei(t).iterate({range:r},function(t,n,r){var o=t[0];if(o===e.userId){var a=Bn(t[1]);i.push(a)}else r.done()}).next(function(){g(0===i.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+i.map(function(t){return t.canonicalString()}))})})},t.prototype.containsKey=function(t,e){return Xr(t,this.userId,e)},t.prototype.getMutationQueueMetadata=function(t){var e=this;return ni(t).get(this.userId).next(function(t){return t||new Er(e.userId,qn,"")})},t}();function Xr(t,e,n){var r=Or.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return ei(t).iterate({range:o,keysOnly:!0},function(t,n,r){var o=t[0],s=t[1];t[2];o===e&&s===i&&(a=!0),r.done()}).next(function(){return a})}function Jr(t,e){var n=!1;return ni(t).iterateSerial(function(r){return Xr(t,r,e).next(function(t){return t&&(n=!0),Gn.resolve(!t)})}).next(function(){return n})}function $r(t,e,n){var r=t.store(Tr.store),i=t.store(Or.store),o=[],a=IDBKeyRange.only(n.batchId),s=0,u=r.iterate({range:a},function(t,e,n){return s++,n.delete()});o.push(u.next(function(){g(1===s,"Dangling document-mutation reference found: Missing batch "+n.batchId)}));for(var c=[],l=0,h=n.mutations;l<h.length;l++){var f=h[l],d=Or.key(e,f.key.path,n.batchId);o.push(i.delete(d)),c.push(f.key)}return Gn.waitFor(o).next(function(){return c})}function Zr(t){return t instanceof Uint8Array?(g("YES"===Object({NODE_ENV:"production",BASE_URL:"/"}).USE_MOCK_PERSISTENCE,"Persisting non-string stream tokens is only supported with mock persistence."),t.toString()):t}function ti(t){return Ei.getStore(t,Tr.store)}function ei(t){return Ei.getStore(t,Or.store)}function ni(t){return Ei.getStore(t,Er.store)}var ri=function(){function t(t){this.remoteSerializer=t}return t.prototype.fromDbRemoteDocument=function(t){if(t.document)return this.remoteSerializer.fromDocument(t.document,!!t.hasCommittedMutations);if(t.noDocument){var e=mt.fromSegments(t.noDocument.path),n=this.fromDbTimestamp(t.noDocument.readTime);return new _t(e,n,{hasCommittedMutations:!!t.hasCommittedMutations})}if(t.unknownDocument){e=mt.fromSegments(t.unknownDocument.path),n=this.fromDbTimestamp(t.unknownDocument.version);return new kt(e,n)}return y("Unexpected DbRemoteDocument")},t.prototype.toDbRemoteDocument=function(t){if(t instanceof wt){var e=t.proto?t.proto:this.remoteSerializer.toDocument(t),n=t.hasCommittedMutations;return new Pr(null,null,e,n)}if(t instanceof _t){var r=t.key.path.toArray(),i=this.toDbTimestamp(t.version);n=t.hasCommittedMutations;return new Pr(null,new Ir(r,i),null,n)}if(t instanceof kt){r=t.key.path.toArray(),i=this.toDbTimestamp(t.version);return new Pr(new xr(r,i),null,null,!0)}return y("Unexpected MaybeDocumment")},t.prototype.toDbTimestamp=function(t){var e=t.toTimestamp();return new wr(e.seconds,e.nanoseconds)},t.prototype.fromDbTimestamp=function(t){var e=new ct(t.seconds,t.nanoseconds);return ue.fromTimestamp(e)},t.prototype.toDbMutationBatch=function(t,e){var n=this,r=e.mutations.map(function(t){return n.remoteSerializer.toMutation(t)});return new Tr(t,e.batchId,e.localWriteTime.toMillis(),r)},t.prototype.fromDbMutationBatch=function(t){var e=this,n=t.mutations.map(function(t){return e.remoteSerializer.fromMutation(t)}),r=ct.fromMillis(t.localWriteTimeMs);return new Wn(t.batchId,r,n)},t.prototype.toDbResourcePaths=function(t){var e=[];return t.forEach(function(t){e.push(Ln(t.path))}),e},t.prototype.fromDbResourcePaths=function(t){for(var e=Ue(),n=0,r=t;n<r.length;n++){var i=r[n];e=e.add(new mt(Bn(i)))}return e},t.prototype.fromDbTarget=function(t){var e,n=this.fromDbTimestamp(t.readTime);return e=ii(t.query)?this.remoteSerializer.fromDocumentsTarget(t.query):this.remoteSerializer.fromQueryTarget(t.query),new le(e,t.targetId,Xt.Listen,t.lastListenSequenceNumber,n,t.resumeToken)},t.prototype.toDbTarget=function(t){g(Xt.Listen===t.purpose,"Only queries with purpose "+Xt.Listen+" may be stored, got "+t.purpose);var e,n,r=this.toDbTimestamp(t.snapshotVersion);return e=t.query.isDocumentQuery()?this.remoteSerializer.toDocumentsTarget(t.query):this.remoteSerializer.toQueryTarget(t.query),t.resumeToken instanceof Uint8Array?(g("YES"===Object({NODE_ENV:"production",BASE_URL:"/"}).USE_MOCK_PERSISTENCE,"Persisting non-string stream tokens is only supported with mock persistence ."),n=t.resumeToken.toString()):n=t.resumeToken,new Dr(t.targetId,t.query.canonicalId(),r,n,t.sequenceNumber,e)},t}();function ii(t){return void 0!==t.documents}function oi(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],a=$(n,i);return 0===a?$(r,o):a}var ai=function(){function t(t){this.maxElements=t,this.buffer=new he(oi),this.previousIndex=0}return t.prototype.nextIndex=function(){return++this.previousIndex},t.prototype.addElement=function(t){var e=[t,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();oi(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),t}(),si={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},ui=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t.COLLECTION_DISABLED=-1,t.MINIMUM_CACHE_SIZE_BYTES=1048576,t.DEFAULT_CACHE_SIZE_BYTES=41943040,t.DEFAULT_COLLECTION_PERCENTILE=10,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,t.DEFAULT=new t(t.DEFAULT_CACHE_SIZE_BYTES,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),t.DISABLED=new t(t.COLLECTION_DISABLED,0,0),t}(),ci=6e4,li=3e5,hi=function(){function t(t,e,n){this.garbageCollector=t,this.asyncQueue=e,this.localStore=n,this.gcTask=null}return t.prototype.start=function(){g(null===this.gcTask,"Cannot start an already started LruScheduler"),this.garbageCollector.params.cacheSizeCollectionThreshold!==Ia&&this.scheduleGC()},t.prototype.stop=function(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.gcTask},enumerable:!0,configurable:!0}),t.prototype.scheduleGC=function(){var t=this;g(null===this.gcTask,"Cannot schedule GC while a task is pending");var e=this.hasRun?li:ci;d("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.gcTask=this.asyncQueue.enqueueAfterDelay(An.LruGarbageCollection,e,function(){return t.gcTask=null,t.hasRun=!0,t.localStore.collectGarbage(t.garbageCollector).then(function(){return t.scheduleGC()}).catch(Si)})},t}(),fi=function(){function t(t,e){this.delegate=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.delegate.getSequenceNumberCount(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return Gn.resolve(In.INVALID);var r=new ai(e);return this.delegate.forEachTarget(t,function(t){return r.addElement(t.sequenceNumber)}).next(function(){return n.delegate.forEachOrphanedDocumentSequenceNumber(t,function(t){return r.addElement(t)})}).next(function(){return r.maxValue})},t.prototype.removeTargets=function(t,e,n){return this.delegate.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.delegate.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return this.params.cacheSizeCollectionThreshold===ui.COLLECTION_DISABLED?(d("LruGarbageCollector","Garbage collection skipped; disabled"),Gn.resolve(si)):this.getCacheSize(t).next(function(r){return r<n.params.cacheSizeCollectionThreshold?(d("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),si):n.runGarbageCollection(t,e)})},t.prototype.getCacheSize=function(t){return this.delegate.getCacheSize(t)},t.prototype.runGarbageCollection=function(t,e){var n,r,o,a,s,u,c,l,f=this;return a=Date.now(),this.calculateTargetCount(t,this.params.percentileToCollect).next(function(e){return e>f.params.maximumSequenceNumbersToCollect?(d("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+f.params.maximumSequenceNumbersToCollect+" from "+e),r=f.params.maximumSequenceNumbersToCollect):r=e,s=Date.now(),f.nthSequenceNumber(t,r)}).next(function(r){return n=r,u=Date.now(),f.removeTargets(t,n,e)}).next(function(e){return o=e,c=Date.now(),f.removeOrphanedDocuments(t,n)}).next(function(t){if(l=Date.now(),h()<=i.DEBUG){var e="LRU Garbage Collection\n\tCounted targets in "+(s-a)+"ms\n\tDetermined least recently used "+r+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(c-u)+"ms\n\tRemoved "+t+" documents in "+(l-c)+"ms\nTotal Duration: "+(l-a)+"ms";d("LruGarbageCollector",e)}return Gn.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:o,documentsRemoved:t})})},t}(),di=function(){function t(){}return t}(),pi="IndexedDbPersistence",vi=18e5,yi=5e3,gi=4e3,mi="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",bi="Another tab has exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `experimentalTabSynchronization:true` in all tabs.",wi="This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.",_i="firestore_zombie",ki=function(t){function e(e,n){var r=t.call(this)||this;return r.simpleDbTransaction=e,r.currentSequenceNumber=n,r}return s.__extends(e,t),e}(di),Ei=function(){function t(e,n,r,i,o,a,s){if(this.persistenceKey=e,this.clientId=n,this.queue=i,this.multiClientParams=s,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.inForeground=!1,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=function(t){return Promise.resolve()},!t.isAvailable())throw new _(w.UNIMPLEMENTED,wi);if(this.referenceDelegate=new Ai(this,a),this.dbName=e+t.MAIN_DATABASE,this.serializer=new ri(o),this.document=r.document,this.allowTabSynchronization=void 0!==s,this.queryCache=new tr(this.referenceDelegate,this.serializer),this.remoteDocumentCache=new cr(this.serializer,this.allowTabSynchronization),!r.window||!r.window.localStorage)throw new _(w.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");this.window=r.window,this.webStorage=this.window.localStorage}return t.getStore=function(t,e){if(t instanceof ki)return Yn.getStore(t.simpleDbTransaction,e);throw y("IndexedDbPersistence must use instances of IndexedDbTransaction")},t.createIndexedDbPersistence=function(e,n,r,i,o,a){return s.__awaiter(this,void 0,void 0,function(){var u;return s.__generator(this,function(s){switch(s.label){case 0:return u=new t(e,n,r,i,o,a),[4,u.start()];case 1:return s.sent(),[2,u]}})})},t.createMultiClientIndexedDbPersistence=function(e,n,r,i,o,a,u){return s.__awaiter(this,void 0,void 0,function(){var c;return s.__generator(this,function(s){switch(s.label){case 0:return c=new t(e,n,r,i,o,a,u),[4,c.start()];case 1:return s.sent(),[2,c]}})})},t.prototype.start=function(){var t=this;return g(!this.started,"IndexedDbPersistence double-started!"),g(null!==this.window,"Expected 'window' to be defined"),Yn.openOrCreate(this.dbName,gr,new mr(this.serializer)).then(function(e){t.simpleDb=e}).then(function(){return t.startRemoteDocumentCache()}).then(function(){return t.attachVisibilityHandler(),t.attachWindowUnloadHook(),t.updateClientMetadataAndTryBecomePrimary().then(function(){return t.scheduleClientMetadataAndPrimaryLeaseRefreshes()})}).then(function(){return t.simpleDb.runTransaction("readonly",[Mr.store],function(e){return ir(e).next(function(e){var n=t.multiClientParams?t.multiClientParams.sequenceNumberSyncer:void 0;t.listenSequence=new In(e,n)})})}).then(function(){t._started=!0}).catch(function(e){return t.simpleDb&&t.simpleDb.close(),Promise.reject(e)})},t.prototype.startRemoteDocumentCache=function(){var t=this;return this.simpleDb.runTransaction("readonly",Qr,function(e){return t.remoteDocumentCache.start(e)})},t.prototype.setPrimaryStateListener=function(t){var e=this;return this.primaryStateListener=function(n){return s.__awaiter(e,void 0,void 0,function(){return s.__generator(this,function(e){return this.started?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.queue.enqueueAndForget(function(){return s.__awaiter(e,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return this.started?[4,this.updateClientMetadataAndTryBecomePrimary()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.updateClientMetadataAndTryBecomePrimary=function(){var t=this;return this.simpleDb.runTransaction("readwrite",Qr,function(e){var n=Oi(e);return n.put(new qr(t.clientId,Date.now(),t.networkEnabled,t.inForeground,t.remoteDocumentCache.lastProcessedDocumentChangeId)).next(function(){if(t.isPrimary)return t.verifyPrimaryLease(e).next(function(e){e||(t.isPrimary=!1,t.queue.enqueueAndForget(function(){return t.primaryStateListener(!1)}))})}).next(function(){return t.canActAsPrimary(e)}).next(function(n){var r=t.isPrimary;return t.isPrimary=n,r!==t.isPrimary&&t.queue.enqueueAndForget(function(){return t.primaryStateListener(t.isPrimary)}),r&&!t.isPrimary?t.releasePrimaryLeaseIfHeld(e):t.isPrimary?t.acquireOrExtendPrimaryLease(e):void 0})})},t.prototype.verifyPrimaryLease=function(t){var e=this,n=Ci(t);return n.get(_r.key).next(function(t){return Gn.resolve(e.isLocalClient(t))})},t.prototype.removeClientMetadata=function(t){var e=Oi(t);return e.delete(this.clientId)},t.prototype.maybeGarbageCollectMultiClientState=function(){return s.__awaiter(this,void 0,void 0,function(){var e,n,r=this;return s.__generator(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.isWithinAge(this.lastGarbageCollectionTime,vi)?[3,2]:(this.lastGarbageCollectionTime=Date.now(),n=[],[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(i){var o=t.getStore(i,qr.store);return o.loadAll().next(function(t){e=r.filterActiveClients(t,vi),n=t.filter(function(t){return-1===e.indexOf(t)})}).next(function(){return Gn.forEach(n,function(t){return o.delete(t.clientId)})}).next(function(){if(e=e.filter(function(t){return t.clientId!==r.clientId}),e.length>0){var t=e.map(function(t){return t.lastProcessedDocumentChangeId||0}),n=Math.min.apply(Math,t);return r.remoteDocumentCache.removeDocumentChangesThroughChangeId(i,n)}})})]);case 1:i.sent(),n.forEach(function(t){r.window.localStorage.removeItem(r.zombiedClientLocalStorageKey(t.clientId))}),i.label=2;case 2:return[2]}})})},t.prototype.scheduleClientMetadataAndPrimaryLeaseRefreshes=function(){var t=this;this.clientMetadataRefresher=this.queue.enqueueAfterDelay(An.ClientMetadataRefresh,gi,function(){return t.updateClientMetadataAndTryBecomePrimary().then(function(){return t.maybeGarbageCollectMultiClientState()}).then(function(){return t.scheduleClientMetadataAndPrimaryLeaseRefreshes()})})},t.prototype.isLocalClient=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.canActAsPrimary=function(t){var e=this,n=Ci(t);return n.get(_r.key).next(function(n){var r=null!==n&&e.isWithinAge(n.leaseTimestampMs,yi)&&!e.isClientZombied(n.ownerId);if(r){if(e.isLocalClient(n)&&e.networkEnabled)return!0;if(!e.isLocalClient(n)){if(!n.allowTabSynchronization)throw new _(w.FAILED_PRECONDITION,bi);return!1}}return!(!e.networkEnabled||!e.inForeground)||Oi(t).loadAll().next(function(t){var n=e.filterActiveClients(t,yi).find(function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1});return void 0===n})}).next(function(t){return e.isPrimary!==t&&d(pi,"Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.shutdown=function(t){return s.__awaiter(this,void 0,void 0,function(){var e=this;return s.__generator(this,function(n){switch(n.label){case 0:return this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&this.clientMetadataRefresher.cancel(),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),[4,this.simpleDb.runTransaction("readwrite",[_r.store,qr.store],function(t){return e.releasePrimaryLeaseIfHeld(t).next(function(){return e.removeClientMetadata(t)})})];case 1:return n.sent(),this.simpleDb.close(),this.removeClientZombiedEntry(),t?[4,Yn.delete(this.dbName)]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}})})},t.prototype.filterActiveClients=function(t,e){var n=this;return t.filter(function(t){return n.isWithinAge(t.updateTimeMs,e)&&!n.isClientZombied(t.clientId)})},t.prototype.getActiveClients=function(){var t=this;return this.simpleDb.runTransaction("readonly",[qr.store],function(e){return Oi(e).loadAll().next(function(e){return t.filterActiveClients(e,vi).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),t.prototype.getMutationQueue=function(t){return g(this.started,"Cannot initialize MutationQueue before persistence is started."),Yr.forUser(t,this.serializer,this.referenceDelegate)},t.prototype.getQueryCache=function(){return g(this.started,"Cannot initialize QueryCache before persistence is started."),this.queryCache},t.prototype.getRemoteDocumentCache=function(){return g(this.started,"Cannot initialize RemoteDocumentCache before persistence is started."),this.remoteDocumentCache},t.prototype.runTransaction=function(t,e,n){var r=this;return d(pi,"Starting transaction:",t),this.simpleDb.runTransaction("readonly"===e?"readonly":"readwrite",Qr,function(i){return"readwrite-primary"===e?r.verifyPrimaryLease(i).next(function(e){if(!e)throw p("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.queue.enqueueAndForget(function(){return r.primaryStateListener(!1)}),new _(w.FAILED_PRECONDITION,mi);return n(new ki(i,r.listenSequence.next()))}).next(function(t){return r.acquireOrExtendPrimaryLease(i).next(function(){return t})}):r.verifyAllowTabSynchronization(i).next(function(){return n(new ki(i,r.listenSequence.next()))})})},t.prototype.verifyAllowTabSynchronization=function(t){var e=this,n=Ci(t);return n.get(_r.key).next(function(t){var n=null!==t&&e.isWithinAge(t.leaseTimestampMs,yi)&&!e.isClientZombied(t.ownerId);if(n&&!e.isLocalClient(t)&&!t.allowTabSynchronization)throw new _(w.FAILED_PRECONDITION,bi)})},t.prototype.acquireOrExtendPrimaryLease=function(t){var e=new _r(this.clientId,this.allowTabSynchronization,Date.now());return Ci(t).put(_r.key,e)},t.isAvailable=function(){return Yn.isAvailable()},t.buildStoragePrefix=function(t){var e=t.databaseId.projectId;return t.databaseId.isDefaultDatabase||(e+="."+t.databaseId.database),"firestore/"+t.persistenceKey+"/"+e+"/"},t.prototype.releasePrimaryLeaseIfHeld=function(t){var e=this,n=Ci(t);return n.get(_r.key).next(function(t){return e.isLocalClient(t)?(d(pi,"Releasing primary lease."),n.delete(_r.key)):Gn.resolve()})},t.prototype.isWithinAge=function(t,e){var n=Date.now(),r=n-e,i=n;return!(t<r)&&(!(t>i)||(p("Detected an update time that is in the future: "+t+" > "+i),!1))},t.prototype.attachVisibilityHandler=function(){var t=this;null!==this.document&&"function"===typeof this.document.addEventListener&&(this.documentVisibilityHandler=function(){t.queue.enqueueAndForget(function(){return t.inForeground="visible"===t.document.visibilityState,t.updateClientMetadataAndTryBecomePrimary()})},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)},t.prototype.detachVisibilityHandler=function(){this.documentVisibilityHandler&&(g(null!==this.document&&"function"===typeof this.document.addEventListener,"Expected 'document.addEventListener' to be a function"),this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)},t.prototype.attachWindowUnloadHook=function(){var t=this;"function"===typeof this.window.addEventListener&&(this.windowUnloadHandler=function(){t.markClientZombied(),t.queue.enqueueAndForget(function(){return t.shutdown()})},this.window.addEventListener("unload",this.windowUnloadHandler))},t.prototype.detachWindowUnloadHook=function(){this.windowUnloadHandler&&(g("function"===typeof this.window.removeEventListener,"Expected 'window.removeEventListener' to be a function"),this.window.removeEventListener("unload",this.windowUnloadHandler),this.windowUnloadHandler=null)},t.prototype.isClientZombied=function(t){try{var e=null!==this.webStorage.getItem(this.zombiedClientLocalStorageKey(t));return d(pi,"Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(n){return p(pi,"Failed to get zombied client id.",n),!1}},t.prototype.markClientZombied=function(){try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(t){p("Failed to set zombie client id.",t)}},t.prototype.removeClientZombiedEntry=function(){try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(t){}},t.prototype.zombiedClientLocalStorageKey=function(t){return _i+"_"+this.persistenceKey+"_"+t},t.MAIN_DATABASE="main",t}();function Ti(t){return t.code===w.FAILED_PRECONDITION&&t.message===mi}function Si(t){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(e){if(!Ti(t))throw t;return d(pi,"Unexpectedly lost primary lease"),[2]})})}function Ci(t){return t.store(_r.store)}function Oi(t){return t.store(qr.store)}var Ai=function(){function t(t,e){this.db=t,this.garbageCollector=new fi(this,e)}return t.prototype.getSequenceNumberCount=function(t){var e=this.orphanedDocmentCount(t),n=this.db.getQueryCache().getQueryCount(t);return n.next(function(t){return e.next(function(e){return t+e})})},t.prototype.orphanedDocmentCount=function(t){var e=0;return this.forEachOrphanedDocumentSequenceNumber(t,function(t){e++}).next(function(){return e})},t.prototype.forEachTarget=function(t,e){return this.db.getQueryCache().forEachTarget(t,e)},t.prototype.forEachOrphanedDocumentSequenceNumber=function(t,e){return this.forEachOrphanedDocument(t,function(t,n){return e(n)})},t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.addReference=function(t,e){return Pi(t,e)},t.prototype.removeReference=function(t,e){return Pi(t,e)},t.prototype.removeTargets=function(t,e,n){return this.db.getQueryCache().removeTargets(t,e,n)},t.prototype.removeMutationReference=function(t,e){return Pi(t,e)},t.prototype.isPinned=function(t,e){return this.inMemoryPins.containsKey(e)?Gn.resolve(!0):Jr(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=0,i=0,o=[],a=this.forEachOrphanedDocument(t,function(a,s){if(s<=e){var u=n.isPinned(t,a).next(function(e){if(!e)return r++,n.removeOrphanedDocument(t,a).next(function(t){i+=t})});o.push(u)}});return a.next(function(){return Gn.waitFor(o)}).next(function(){return n.db.getRemoteDocumentCache().updateSize(t,-i)}).next(function(){return r})},t.prototype.removeOrphanedDocument=function(t,e){var n=0,r=this.db.getRemoteDocumentCache();return Gn.waitFor([or(t).delete(Ii(e)),r.removeEntry(t,e).next(function(t){n+=t})]).next(function(){return n})},t.prototype.removeTarget=function(t,e){var n=e.copy({sequenceNumber:t.currentSequenceNumber});return this.db.getQueryCache().updateQueryData(t,n)},t.prototype.updateLimboDocument=function(t,e){return Pi(t,e)},t.prototype.forEachOrphanedDocument=function(t,e){var n,r=or(t),i=In.INVALID;return r.iterate({index:jr.documentTargetsIndex},function(t,r){var o=t[0],a=(t[1],r.path),s=r.sequenceNumber;0===o?(i!==In.INVALID&&e(new mt(Bn(n)),i),i=s,n=a):i=In.INVALID}).next(function(){i!==In.INVALID&&e(new mt(Bn(n)),i)})},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function Ii(t){return[0,Ln(t.path)]}function xi(t,e){return new jr(0,Ln(t.path),e)}function Pi(t,e){return or(t).put(xi(e,t.currentSequenceNumber))}var Ni=function(){function t(t,e){this.remoteDocumentCache=t,this.mutationQueue=e}return t.prototype.getDocument=function(t,e){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(t,e).next(function(r){return n.getDocumentInternal(t,e,r)})},t.prototype.getDocumentInternal=function(t,e,n){return this.remoteDocumentCache.getEntry(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++){var o=i[r];t=o.applyToLocalView(e,t)}return t})},t.prototype.applyLocalMutationsToDocuments=function(t,e,n){var r=je();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++){var a=o[i];e=a.applyToLocalView(t,e)}r=r.insert(t,e)}),r},t.prototype.getDocuments=function(t,e){var n=this;return this.remoteDocumentCache.getEntries(t,e).next(function(e){return n.getLocalViewOfDocuments(t,e)})},t.prototype.getLocalViewOfDocuments=function(t,e){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(function(r){var i=n.applyLocalMutationsToDocuments(t,e,r),o=De();return i.forEach(function(t,e){e||(e=new _t(t,ue.forDeletedDoc())),o=o.insert(t,e)}),o})},t.prototype.getDocumentsMatchingQuery=function(t,e){return mt.isDocumentKey(e.path)?this.getDocumentsMatchingDocumentQuery(t,e.path):this.getDocumentsMatchingCollectionQuery(t,e)},t.prototype.getDocumentsMatchingDocumentQuery=function(t,e){return this.getDocument(t,new mt(e)).next(function(t){var e=Le();return t instanceof wt&&(e=e.insert(t.key,t)),e})},t.prototype.getDocumentsMatchingCollectionQuery=function(t,e){var n,r=this;return this.remoteDocumentCache.getDocumentsMatchingQuery(t,e).next(function(i){return n=i,r.mutationQueue.getAllMutationBatchesAffectingQuery(t,e)}).next(function(t){for(var r=0,i=t;r<i.length;r++)for(var o=i[r],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key;if(e.path.isImmediateParentOf(c.path)){var l=n.get(c),h=u.applyToLocalView(l,l,o.localWriteTime);n=h instanceof wt?n.insert(c,h):n.remove(c)}}}).next(function(){return n.forEach(function(t,r){e.matches(r)||(n=n.remove(t))}),n})},t}(),Ri=function(){function t(){this.refsByKey=new he(Di.compareByKey),this.refsByTarget=new he(Di.compareByTargetId)}return t.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},t.prototype.addReference=function(t,e){var n=new Di(t,e);this.refsByKey=this.refsByKey.add(n),this.refsByTarget=this.refsByTarget.add(n)},t.prototype.addReferences=function(t,e){var n=this;t.forEach(function(t){return n.addReference(t,e)})},t.prototype.removeReference=function(t,e){this.removeRef(new Di(t,e))},t.prototype.removeReferences=function(t,e){var n=this;t.forEach(function(t){return n.removeReference(t,e)})},t.prototype.removeReferencesForId=function(t){var e=this,n=mt.EMPTY,r=new Di(n,t),i=new Di(n,t+1),o=[];return this.refsByTarget.forEachInRange([r,i],function(t){e.removeRef(t),o.push(t.key)}),o},t.prototype.removeAllReferences=function(){var t=this;this.refsByKey.forEach(function(e){return t.removeRef(e)})},t.prototype.removeRef=function(t){this.refsByKey=this.refsByKey.delete(t),this.refsByTarget=this.refsByTarget.delete(t)},t.prototype.referencesForId=function(t){var e=mt.EMPTY,n=new Di(e,t),r=new Di(e,t+1),i=Ue();return this.refsByTarget.forEachInRange([n,r],function(t){i=i.add(t.key)}),i},t.prototype.containsKey=function(t){var e=new Di(t,0),n=this.refsByKey.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),Di=function(){function t(t,e){this.key=t,this.targetOrBatchId=e}return t.compareByKey=function(t,e){return mt.comparator(t.key,e.key)||$(t.targetOrBatchId,e.targetOrBatchId)},t.compareByTargetId=function(t,e){return $(t.targetOrBatchId,e.targetOrBatchId)||mt.comparator(t.key,e.key)},t}(),ji="LocalStore",Mi=function(){function t(t,e){this.persistence=t,this.localViewReferences=new Ri,this.queryDataByTarget={},g(t.started,"LocalStore was passed an unstarted persistence implementation"),this.persistence.referenceDelegate.setInMemoryPins(this.localViewReferences),this.mutationQueue=t.getMutationQueue(e),this.remoteDocuments=t.getRemoteDocumentCache(),this.queryCache=t.getQueryCache(),this.localDocuments=new Ni(this.remoteDocuments,this.mutationQueue)}return t.prototype.handleUserChange=function(t){var e=this;return this.persistence.runTransaction("Handle user change","readonly",function(n){var r;return e.mutationQueue.getAllMutationBatches(n).next(function(i){return r=i,e.mutationQueue=e.persistence.getMutationQueue(t),e.localDocuments=new Ni(e.remoteDocuments,e.mutationQueue),e.mutationQueue.getAllMutationBatches(n)}).next(function(t){for(var i=[],o=[],a=Ue(),s=0,u=r;s<u.length;s++){var c=u[s];i.push(c.batchId);for(var l=0,h=c.mutations;l<h.length;l++){var f=h[l];a=a.add(f.key)}}for(var d=0,p=t;d<p.length;d++){c=p[d];o.push(c.batchId);for(var v=0,y=c.mutations;v<y.length;v++){f=y[v];a=a.add(f.key)}}return e.localDocuments.getDocuments(n,a).next(function(t){return{affectedDocuments:t,removedBatchIds:i,addedBatchIds:o}})})})},t.prototype.localWrite=function(t){var e=this;return this.persistence.runTransaction("Locally write mutations","readwrite",function(n){var r,i=ct.now();return e.mutationQueue.addMutationBatch(n,i,t).next(function(t){r=t;var i=r.keys();return e.localDocuments.getDocuments(n,i)}).next(function(t){return{batchId:r.batchId,changes:t}})})},t.prototype.lookupMutationDocuments=function(t){var e=this;return this.persistence.runTransaction("Lookup mutation documents","readonly",function(n){return e.mutationQueue.lookupMutationKeys(n,t).next(function(t){return t?e.localDocuments.getDocuments(n,t):Gn.resolve(null)})})},t.prototype.acknowledgeBatch=function(t){var e=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(n){var r=t.batch.keys(),i=e.remoteDocuments.newChangeBuffer();return e.mutationQueue.acknowledgeBatch(n,t.batch,t.streamToken).next(function(){return e.applyWriteToRemoteDocuments(n,t,i)}).next(function(){return i.apply(n)}).next(function(){return e.mutationQueue.performConsistencyCheck(n)}).next(function(){return e.localDocuments.getDocuments(n,r)})})},t.prototype.rejectBatch=function(t){var e=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(n){var r;return e.mutationQueue.lookupMutationBatch(n,t).next(function(t){return g(null!==t,"Attempt to reject nonexistent batch!"),r=t.keys(),e.mutationQueue.removeMutationBatch(n,t)}).next(function(){return e.mutationQueue.performConsistencyCheck(n)}).next(function(){return e.localDocuments.getDocuments(n,r)})})},t.prototype.getLastStreamToken=function(){var t=this;return this.persistence.runTransaction("Get last stream token","readonly",function(e){return t.mutationQueue.getLastStreamToken(e)})},t.prototype.setLastStreamToken=function(t){var e=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary",function(n){return e.mutationQueue.setLastStreamToken(n,t)})},t.prototype.getLastRemoteSnapshotVersion=function(){var t=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(e){return t.queryCache.getLastRemoteSnapshotVersion(e)})},t.prototype.applyRemoteEvent=function(e){var n=this,r=this.remoteDocuments.newChangeBuffer();return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(i){var o=[],a=Ue();S(e.targetChanges,function(r,s){var u=n.queryDataByTarget[r];if(u){s.addedDocuments.forEach(function(t){a=a.add(t)}),s.modifiedDocuments.forEach(function(t){a=a.add(t)}),o.push(n.queryCache.removeMatchingKeys(i,s.removedDocuments,r).next(function(){return n.queryCache.addMatchingKeys(i,s.addedDocuments,r)}));var c=s.resumeToken;if(c.length>0){var l=u;u=u.copy({resumeToken:c,snapshotVersion:e.snapshotVersion}),n.queryDataByTarget[r]=u,t.shouldPersistQueryData(l,u,s)&&o.push(n.queryCache.updateQueryData(i,u))}}});var s=De(),u=Ue();e.documentUpdates.forEach(function(t,e){u=u.add(t)}),o.push(r.getEntries(i,u).next(function(t){e.documentUpdates.forEach(function(u,c){var l=t.get(u);null==l||c.version.isEqual(ue.MIN)||a.has(c.key)&&!l.hasPendingWrites||c.version.compareTo(l.version)>=0?(r.addEntry(c),s=s.insert(u,c)):d(ji,"Ignoring outdated watch update for ",u,". Current version:",l.version," Watch version:",c.version),e.resolvedLimboDocuments.has(u)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(i,u))})}));var c=e.snapshotVersion;if(!c.isEqual(ue.MIN)){var l=n.queryCache.getLastRemoteSnapshotVersion(i).next(function(t){return g(c.compareTo(t)>=0,"Watch stream reverted to previous snapshot?? "+c+" < "+t),n.queryCache.setTargetsMetadata(i,i.currentSequenceNumber,c)});o.push(l)}return Gn.waitFor(o).next(function(){return r.apply(i)}).next(function(){return n.localDocuments.getLocalViewOfDocuments(i,s)})})},t.shouldPersistQueryData=function(t,e,n){if(0===e.resumeToken.length)return!1;if(0===t.resumeToken.length)return!0;var r=e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds();if(r>=this.RESUME_TOKEN_MAX_AGE_MICROS)return!0;var i=n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size;return i>0},t.prototype.notifyLocalViewChanges=function(t){var e=this;return this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Gn.forEach(t,function(t){return e.localViewReferences.addReferences(t.addedKeys,t.targetId),e.localViewReferences.removeReferences(t.removedKeys,t.targetId),Gn.forEach(t.removedKeys,function(t){return e.persistence.referenceDelegate.removeReference(n,t)})})})},t.prototype.nextMutationBatch=function(t){var e=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(n){return void 0===t&&(t=qn),e.mutationQueue.getNextMutationBatchAfterBatchId(n,t)})},t.prototype.readDocument=function(t){var e=this;return this.persistence.runTransaction("read document","readonly",function(n){return e.localDocuments.getDocument(n,t)})},t.prototype.allocateQuery=function(t){var e=this;return this.persistence.runTransaction("Allocate query","readwrite",function(n){var r;return e.queryCache.getQueryData(n,t).next(function(i){return i?(r=i,Gn.resolve()):e.queryCache.allocateTargetId(n).next(function(i){return r=new le(t,i,Xt.Listen,n.currentSequenceNumber),e.queryCache.addQueryData(n,r)})}).next(function(){return g(!e.queryDataByTarget[r.targetId],"Tried to allocate an already allocated query: "+t),e.queryDataByTarget[r.targetId]=r,r})})},t.prototype.releaseQuery=function(t,e){var n=this,r=e?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release query",r,function(r){return n.queryCache.getQueryData(r,t).next(function(i){g(null!=i,"Tried to release nonexistent query: "+t);var o=i.targetId,a=n.queryDataByTarget[o],s=n.localViewReferences.removeReferencesForId(o);return delete n.queryDataByTarget[o],e?Gn.resolve():Gn.forEach(s,function(t){return n.persistence.referenceDelegate.removeReference(r,t)}).next(function(){return n.persistence.referenceDelegate.removeTarget(r,a)})})})},t.prototype.executeQuery=function(t){var e=this;return this.persistence.runTransaction("Execute query","readonly",function(n){return e.localDocuments.getDocumentsMatchingQuery(n,t)})},t.prototype.remoteDocumentKeys=function(t){var e=this;return this.persistence.runTransaction("Remote document keys","readonly",function(n){return e.queryCache.getMatchingKeysForTargetId(n,t)})},t.prototype.getActiveClients=function(){return this.persistence.getActiveClients()},t.prototype.removeCachedMutationBatchMetadata=function(t){this.mutationQueue.removeCachedMutationKeys(t)},t.prototype.setNetworkEnabled=function(t){this.persistence.setNetworkEnabled(t)},t.prototype.applyWriteToRemoteDocuments=function(t,e,n){var r=this,i=e.batch,o=i.keys(),a=Gn.resolve();return o.forEach(function(r){a=a.next(function(){return n.getEntry(t,r)}).next(function(t){var o=t,a=e.docVersions.get(r);g(null!==a,"ackVersions should contain every doc in the write."),(!o||o.version.compareTo(a)<0)&&(o=i.applyToRemoteDocument(r,o,e),o?n.addEntry(o):g(!t,"Mutation batch "+i+" applied to document "+t+" resulted in null"))})}),a.next(function(){return r.mutationQueue.removeMutationBatch(t,i)})},t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.collect(n,e.queryDataByTarget)})},t.prototype.getQueryForTarget=function(t){var e=this;return this.queryDataByTarget[t]?Promise.resolve(this.queryDataByTarget[t].query):this.persistence.runTransaction("Get query data","readonly",function(n){return e.queryCache.getQueryDataForTarget(n,t).next(function(t){return t?t.query:null})})},t.prototype.getNewDocumentChanges=function(){var t=this;return this.persistence.runTransaction("Get new document changes","readonly",function(e){return t.remoteDocuments.getNewDocumentChanges(e)})},t.RESUME_TOKEN_MAX_AGE_MICROS=3e8,t}(),Li=function(){function t(t){this.referenceDelegate=t,this.mutationQueue=[],this.nextBatchId=1,this.highestAcknowledgedBatchId=qn,this.lastStreamToken=b(),this.batchesByDocumentKey=new he(Di.compareByKey)}return t.prototype.checkEmpty=function(t){return Gn.resolve(0===this.mutationQueue.length)},t.prototype.acknowledgeBatch=function(t,e,n){var r=e.batchId;g(r>this.highestAcknowledgedBatchId,"Mutation batchIDs must be acknowledged in order");var i=this.indexOfExistingBatchId(r,"acknowledged");g(0===i,"Can only acknowledge the first batch in the mutation queue");var o=this.mutationQueue[i];return g(r===o.batchId,"Queue ordering failure: expected batch "+r+", got batch "+o.batchId),this.highestAcknowledgedBatchId=r,this.lastStreamToken=n,Gn.resolve()},t.prototype.getLastStreamToken=function(t){return Gn.resolve(this.lastStreamToken)},t.prototype.setLastStreamToken=function(t,e){return this.lastStreamToken=e,Gn.resolve()},t.prototype.addMutationBatch=function(t,e,n){g(0!==n.length,"Mutation batches should not be empty");var r=this.nextBatchId;if(this.nextBatchId++,this.mutationQueue.length>0){var i=this.mutationQueue[this.mutationQueue.length-1];g(i.batchId<r,"Mutation batchIDs must be monotonically increasing order")}var o=new Wn(r,e,n);this.mutationQueue.push(o);for(var a=0,s=n;a<s.length;a++){var u=s[a];this.batchesByDocumentKey=this.batchesByDocumentKey.add(new Di(u.key,r))}return Gn.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return Gn.resolve(this.findMutationBatch(e))},t.prototype.lookupMutationKeys=function(t,e){var n=this.findMutationBatch(e);return g(null!=n,"Failed to find local mutation batch."),Gn.resolve(n.keys())},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=Math.max(e,this.highestAcknowledgedBatchId)+1,r=this.indexOfBatchId(n),i=r<0?0:r;return Gn.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)},t.prototype.getAllMutationBatches=function(t){return Gn.resolve(this.mutationQueue.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new Di(e,0),i=new Di(e,Number.POSITIVE_INFINITY),o=[];return this.batchesByDocumentKey.forEachInRange([r,i],function(t){g(e.isEqual(t.key),"Should only iterate over a single key's batches");var r=n.findMutationBatch(t.targetOrBatchId);g(null!==r,"Batches in the index must exist in the main table"),o.push(r)}),Gn.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new he($);return e.forEach(function(t){var e=new Di(t,0),i=new Di(t,Number.POSITIVE_INFINITY);n.batchesByDocumentKey.forEachInRange([e,i],function(e){g(t.isEqual(e.key),"For each key, should only iterate over a single key's batches"),r=r.add(e.targetOrBatchId)})}),Gn.resolve(this.findMutationBatches(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;mt.isDocumentKey(i)||(i=i.child(""));var o=new Di(new mt(i),0),a=new he($);return this.batchesByDocumentKey.forEachWhile(function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(a=a.add(t.targetOrBatchId)),!0)},o),Gn.resolve(this.findMutationBatches(a))},t.prototype.findMutationBatches=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.findMutationBatch(t);null!==r&&n.push(r)}),n},t.prototype.removeMutationBatch=function(t,e){var n=this,r=this.indexOfExistingBatchId(e.batchId,"removed");g(0===r,"Can only remove the first entry of the mutation queue"),this.mutationQueue.shift();var i=this.batchesByDocumentKey;return Gn.forEach(e.mutations,function(r){var o=new Di(r.key,e.batchId);return i=i.delete(o),n.referenceDelegate.removeMutationReference(t,r.key)}).next(function(){n.batchesByDocumentKey=i})},t.prototype.removeCachedMutationKeys=function(t){},t.prototype.containsKey=function(t,e){var n=new Di(e,0),r=this.batchesByDocumentKey.firstAfterOrEqual(n);return Gn.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return 0===this.mutationQueue.length&&g(this.batchesByDocumentKey.isEmpty(),"Document leak -- detected dangling mutation references when queue is empty."),Gn.resolve()},t.prototype.indexOfExistingBatchId=function(t,e){var n=this.indexOfBatchId(t);return g(n>=0&&n<this.mutationQueue.length,"Batches must exist to be "+e),n},t.prototype.indexOfBatchId=function(t){if(0===this.mutationQueue.length)return 0;var e=this.mutationQueue[0].batchId;return t-e},t.prototype.findMutationBatch=function(t){var e=this.indexOfBatchId(t);if(e<0||e>=this.mutationQueue.length)return null;var n=this.mutationQueue[e];return g(n.batchId===t,"If found batch must match"),n},t}(),Fi=function(){function t(t){this.persistence=t,this.queries=new ar(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=ue.MIN,this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new Ri,this.targetCount=0,this.targetIdGenerator=zn.forQueryCache()}return t.prototype.getTargetCount=function(t){return Gn.resolve(this.targetCount)},t.prototype.forEachTarget=function(t,e){return this.queries.forEach(function(t,n){return e(n)}),Gn.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return Gn.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return Gn.resolve(this.highestSequenceNumber)},t.prototype.allocateTargetId=function(t){var e=this.targetIdGenerator.after(this.highestTargetId);return this.highestTargetId=e,Gn.resolve(e)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.highestSequenceNumber&&(this.highestSequenceNumber=e),Gn.resolve()},t.prototype.saveQueryData=function(t){this.queries.set(t.query,t);var e=t.targetId;e>this.highestTargetId&&(this.highestTargetId=e),t.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=t.sequenceNumber)},t.prototype.addQueryData=function(t,e){return g(!this.queries.has(e.query),"Adding a query that already exists"),this.saveQueryData(e),this.targetCount+=1,Gn.resolve()},t.prototype.updateQueryData=function(t,e){return g(this.queries.has(e.query),"Updating a non-existent query"),this.saveQueryData(e),Gn.resolve()},t.prototype.removeQueryData=function(t,e){return g(this.targetCount>0,"Removing a target from an empty cache"),g(this.queries.has(e.query),"Removing a non-existent target from the cache"),this.queries.delete(e.query),this.references.removeReferencesForId(e.targetId),this.targetCount-=1,Gn.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.queries.forEach(function(a,s){s.sequenceNumber<=e&&!n[s.targetId]&&(r.queries.delete(a),o.push(r.removeMatchingKeysForTargetId(t,s.targetId)),i++)}),Gn.waitFor(o).next(function(){return i})},t.prototype.getQueryCount=function(t){return Gn.resolve(this.targetCount)},t.prototype.getQueryData=function(t,e){var n=this.queries.get(e)||null;return Gn.resolve(n)},t.prototype.getQueryDataForTarget=function(t,e){return y("Not yet implemented.")},t.prototype.addMatchingKeys=function(t,e,n){this.references.addReferences(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.addReference(t,e))}),Gn.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){this.references.removeReferences(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.removeReference(t,e))}),Gn.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this.references.removeReferencesForId(e),Gn.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this.references.referencesForId(e);return Gn.resolve(n)},t.prototype.containsKey=function(t,e){return Gn.resolve(this.references.containsKey(e))},t}();function Vi(){return new Et(mt.comparator)}var Bi,Ui=function(){function t(t){this.sizer=t,this.docs=Vi(),this.newDocumentChanges=Ue(),this.size=0}return t.prototype.addEntries=function(t,e,n){for(var r=0,i=e;r<i.length;r++){var o=i[r],a=o.maybeDocument.key;this.docs=this.docs.insert(a,o),this.newDocumentChanges=this.newDocumentChanges.add(a)}return this.size+=n,Gn.resolve()},t.prototype.removeEntry=function(t,e){var n=this.docs.get(e);return n?(this.docs=this.docs.remove(e),this.size-=n.size,Gn.resolve(n.size)):Gn.resolve(0)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return Gn.resolve(n?n.maybeDocument:null)},t.prototype.getSizedEntry=function(t,e){return Gn.resolve(this.docs.get(e))},t.prototype.getEntries=function(t,e){var n=this,r=je();return e.forEach(function(t){var e=n.docs.get(t);r=r.insert(t,e?e.maybeDocument:null)}),Gn.resolve(r)},t.prototype.getSizedEntries=function(t,e){var n=this,r=je(),i=new Et(mt.comparator);return e.forEach(function(t){var e=n.docs.get(t);r=r.insert(t,e?e.maybeDocument:null),i=i.insert(t,e?e.size:0)}),Gn.resolve({maybeDocuments:r,sizeMap:i})},t.prototype.getDocumentsMatchingQuery=function(t,e){var n=Le(),r=new mt(e.path.child("")),i=this.docs.getIteratorFrom(r);while(i.hasNext()){var o=i.getNext(),a=o.key,s=o.value.maybeDocument;if(!e.path.isPrefixOf(a.path))break;s instanceof wt&&e.matches(s)&&(n=n.insert(s.key,s))}return Gn.resolve(n)},t.prototype.forEachDocumentKey=function(t,e){return Gn.forEach(this.docs,function(t){return e(t)})},t.prototype.getNewDocumentChanges=function(t){var e=this,n=De();return this.newDocumentChanges.forEach(function(t){var r=e.docs.get(t),i=r?r.maybeDocument:new _t(t,ue.forDeletedDoc());n=n.insert(t,i)}),this.newDocumentChanges=Ue(),Gn.resolve(n)},t.prototype.newChangeBuffer=function(){return new qi(this.sizer,this)},t.prototype.getSize=function(t){return Gn.resolve(this.size)},t}(),qi=function(t){function e(e,n){var r=t.call(this)||this;return r.sizer=e,r.documentCache=n,r}return s.__extends(e,t),e.prototype.applyChanges=function(t){var e=this,n=this.assertChanges(),r=0,i=[];return n.forEach(function(t,n){var o=e.documentSizes.get(t);g(void 0!==o,"Attempting to change document "+t.toString()+" without having read it first");var a=e.sizer(n);r+=a-o,i.push({maybeDocument:n,size:a})}),this.documentCache.addEntries(t,i,r)},e.prototype.getFromCache=function(t,e){return this.documentCache.getSizedEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.documentCache.getSizedEntries(t,e)},e}(sr),Wi="MemoryPersistence",Ki=function(){function t(t,e){var n=this;this.clientId=t,this.mutationQueues={},this.listenSequence=new In(0),this._started=!1,this._started=!0,this.referenceDelegate=e(this),this.queryCache=new Fi(this);var r=function(t){return n.referenceDelegate.documentSize(t)};this.remoteDocumentCache=new Ui(r)}return t.createLruPersistence=function(e,n,r){var i=function(t){return new Gi(t,new ri(n),r)};return new t(e,i)},t.createEagerPersistence=function(e){var n=function(t){return new zi(t)};return new t(e,n)},t.prototype.shutdown=function(t){return this._started=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),t.prototype.getActiveClients=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){return[2,[this.clientId]]})})},t.prototype.setPrimaryStateListener=function(t){return t(!0)},t.prototype.setNetworkEnabled=function(t){},t.prototype.getMutationQueue=function(t){var e=this.mutationQueues[t.toKey()];return e||(e=new Li(this.referenceDelegate),this.mutationQueues[t.toKey()]=e),e},t.prototype.getQueryCache=function(){return this.queryCache},t.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},t.prototype.runTransaction=function(t,e,n){var r=this;d(Wi,"Starting transaction:",t);var i=new Hi(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),n(i).next(function(t){return r.referenceDelegate.onTransactionCommitted(i).next(function(){return t})}).toPromise()},t.prototype.mutationQueuesContainKey=function(t,e){return Gn.or(C(this.mutationQueues).map(function(n){return function(){return n.containsKey(t,e)}}))},t}(),Hi=function(){function t(t){this.currentSequenceNumber=t}return t}(),zi=function(){function t(t){this.persistence=t}return t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.addReference=function(t,e){return this.orphanedDocuments.delete(e),Gn.resolve()},t.prototype.removeReference=function(t,e){return this.orphanedDocuments.add(e),Gn.resolve()},t.prototype.removeMutationReference=function(t,e){return this.orphanedDocuments.add(e),Gn.resolve()},t.prototype.removeTarget=function(t,e){var n=this,r=this.persistence.getQueryCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(function(t){t.forEach(function(t){return n.orphanedDocuments.add(t)})}).next(function(){return r.removeQueryData(t,e)})},t.prototype.onTransactionStarted=function(){this.orphanedDocuments=new Set},t.prototype.onTransactionCommitted=function(t){var e=this,n=this.persistence.getRemoteDocumentCache();return Gn.forEach(this.orphanedDocuments,function(r){return e.isReferenced(t,r).next(function(e){return e?Gn.resolve():n.removeEntry(t,r).next(function(){})})})},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.isReferenced(t,e).next(function(t){t?n.orphanedDocuments.delete(e):n.orphanedDocuments.add(e)})},t.prototype.documentSize=function(t){return 0},t.prototype.isReferenced=function(t,e){var n=this;return Gn.or([function(){return n.persistence.getQueryCache().containsKey(t,e)},function(){return n.persistence.mutationQueuesContainKey(t,e)},function(){return Gn.resolve(n.inMemoryPins.containsKey(e))}])},t}(),Gi=function(){function t(t,e,n){this.persistence=t,this.serializer=e,this.orphanedSequenceNumbers=new ar(function(t){return Ln(t.path)}),this.garbageCollector=new fi(this,n)}return t.prototype.onTransactionStarted=function(){},t.prototype.onTransactionCommitted=function(t){return Gn.resolve()},t.prototype.forEachTarget=function(t,e){return this.persistence.getQueryCache().forEachTarget(t,e)},t.prototype.getSequenceNumberCount=function(t){var e=this.orphanedDocumentCount(t),n=this.persistence.getQueryCache().getTargetCount(t);return n.next(function(t){return e.next(function(e){return t+e})})},t.prototype.orphanedDocumentCount=function(t){var e=0;return this.forEachOrphanedDocumentSequenceNumber(t,function(t){e++}).next(function(){return e})},t.prototype.forEachOrphanedDocumentSequenceNumber=function(t,e){var n=this;return Gn.forEach(this.orphanedSequenceNumbers,function(r,i){return n.isPinned(t,r,i).next(function(t){return t?Gn.resolve():e(i)})})},t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.removeTargets=function(t,e,n){return this.persistence.getQueryCache().removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=0,i=this.persistence.getRemoteDocumentCache(),o=i.forEachDocumentKey(t,function(o){return n.isPinned(t,o,e).next(function(e){return e?Gn.resolve():(r++,i.removeEntry(t,o).next())})});return o.next(function(){return r})},t.prototype.removeMutationReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),Gn.resolve()},t.prototype.removeTarget=function(t,e){var n=e.copy({sequenceNumber:t.currentSequenceNumber});return this.persistence.getQueryCache().updateQueryData(t,n)},t.prototype.addReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),Gn.resolve()},t.prototype.removeReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),Gn.resolve()},t.prototype.updateLimboDocument=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),Gn.resolve()},t.prototype.documentSize=function(t){var e,n=this.serializer.toDbRemoteDocument(t);if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw y("Unknown remote document type");e=n.noDocument}return JSON.stringify(e).length},t.prototype.isPinned=function(t,e,n){var r=this;return Gn.or([function(){return r.persistence.mutationQueuesContainKey(t,e)},function(){return Gn.resolve(r.inMemoryPins.containsKey(e))},function(){return r.persistence.getQueryCache().containsKey(t,e)},function(){var t=r.orphanedSequenceNumbers.get(e);return Gn.resolve(void 0!==t&&t>n)}])},t.prototype.getCacheSize=function(t){return this.persistence.getRemoteDocumentCache().getSize(t)},t}(),Qi="ExponentialBackoff",Yi=function(){function t(t,e,n,r,i){this.queue=t,this.timerId=e,this.initialDelayMs=n,this.backoffFactor=r,this.maxDelayMs=i,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}return t.prototype.reset=function(){this.currentBaseMs=0},t.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},t.prototype.backoffAndRun=function(t){var e=this;this.cancel();var n=Math.floor(this.currentBaseMs+this.jitterDelayMs()),r=Math.max(0,Date.now()-this.lastAttemptTime),i=Math.max(0,n-r);this.currentBaseMs>0&&d(Qi,"Backing off for "+i+" ms (base delay: "+this.currentBaseMs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,i,function(){return e.lastAttemptTime=Date.now(),t()}),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)},t.prototype.cancel=function(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)},t.prototype.jitterDelayMs=function(){return(Math.random()-.5)*this.currentBaseMs},t}(),Xi="PersistentStream";(function(t){t[t["Initial"]=0]="Initial",t[t["Starting"]=1]="Starting",t[t["Open"]=2]="Open",t[t["Error"]=3]="Error",t[t["Backoff"]=4]="Backoff"})(Bi||(Bi={}));var Ji,$i,Zi=1e3,to=6e4,eo=1.5,no=6e4,ro=function(){function t(t,e,n,r,i,o){this.queue=t,this.idleTimerId=n,this.connection=r,this.credentialsProvider=i,this.listener=o,this.state=Bi.Initial,this.closeCount=0,this.idleTimer=null,this.stream=null,this.backoff=new Yi(t,e,Zi,eo,to)}return t.prototype.isStarted=function(){return this.state===Bi.Starting||this.state===Bi.Open||this.state===Bi.Backoff},t.prototype.isOpen=function(){return this.state===Bi.Open},t.prototype.start=function(){this.state!==Bi.Error?(g(this.state===Bi.Initial,"Already started"),this.auth()):this.performBackoff()},t.prototype.stop=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return this.isStarted()?[4,this.close(Bi.Initial)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.inhibitBackoff=function(){g(!this.isStarted(),"Can only inhibit backoff in a stopped state"),this.state=Bi.Initial,this.backoff.reset()},t.prototype.markIdle=function(){var t=this;this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,no,function(){return t.handleIdleCloseTimer()}))},t.prototype.sendRequest=function(t){this.cancelIdleCheck(),this.stream.send(t)},t.prototype.handleIdleCloseTimer=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){return this.isOpen()?[2,this.close(Bi.Initial)]:[2]})})},t.prototype.cancelIdleCheck=function(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)},t.prototype.close=function(t,e){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(n){switch(n.label){case 0:return g(this.isStarted(),"Only started streams should be closed."),g(t===Bi.Error||Qt(e),"Can't provide an error when not in an error state."),this.cancelIdleCheck(),this.backoff.cancel(),this.closeCount++,t!==Bi.Error?this.backoff.reset():e&&e.code===w.RESOURCE_EXHAUSTED?(p(e.toString()),p("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):e&&e.code===w.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.onClose(e)];case 1:return n.sent(),[2]}})})},t.prototype.tearDown=function(){},t.prototype.auth=function(){var t=this;g(this.state===Bi.Initial,"Must be in initial state to auth"),this.state=Bi.Starting;var e=this.getCloseGuardedDispatcher(this.closeCount),n=this.closeCount;this.credentialsProvider.getToken().then(function(e){t.closeCount===n&&t.startStream(e)},function(n){e(function(){var e=new _(w.UNKNOWN,"Fetching auth token failed: "+n.message);return t.handleStreamClose(e)})})},t.prototype.startStream=function(t){var e=this;g(this.state===Bi.Starting,"Trying to start stream in a non-starting state");var n=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(t),this.stream.onOpen(function(){n(function(){return g(e.state===Bi.Starting,"Expected stream to be in state Starting, but was "+e.state),e.state=Bi.Open,e.listener.onOpen()})}),this.stream.onClose(function(t){n(function(){return e.handleStreamClose(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.performBackoff=function(){var t=this;g(this.state===Bi.Error,"Should only perform backoff when in Error state"),this.state=Bi.Backoff,this.backoff.backoffAndRun(function(){return s.__awaiter(t,void 0,void 0,function(){return s.__generator(this,function(t){return g(this.state===Bi.Backoff,"Backoff elapsed but state is now: "+this.state),this.state=Bi.Initial,this.start(),g(this.isStarted(),"PersistentStream should have started"),[2]})})})},t.prototype.handleStreamClose=function(t){return g(this.isStarted(),"Can't handle server close on non-started stream"),d(Xi,"close with error: "+t),this.stream=null,this.close(Bi.Error,t)},t.prototype.getCloseGuardedDispatcher=function(t){var e=this;return function(n){e.queue.enqueueAndForget(function(){return e.closeCount===t?n():(d(Xi,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),io=function(t){function e(e,n,r,i,o){var a=t.call(this,e,An.ListenStreamConnectionBackoff,An.ListenStreamIdle,n,r,o)||this;return a.serializer=i,a}return s.__extends(e,t),e.prototype.startRpc=function(t){return this.connection.openStream("Listen",t)},e.prototype.onMessage=function(t){this.backoff.reset();var e=this.serializer.fromWatchChange(t),n=this.serializer.versionFromListenResponse(t);return this.listener.onWatchChange(e,n)},e.prototype.watch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.addTarget=this.serializer.toTarget(t);var n=this.serializer.toListenRequestLabels(t);n&&(e.labels=n),this.sendRequest(e)},e.prototype.unwatch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.removeTarget=t,this.sendRequest(e)},e}(ro),oo=function(t){function e(e,n,r,i,o){var a=t.call(this,e,An.WriteStreamConnectionBackoff,An.WriteStreamIdle,n,r,o)||this;return a.serializer=i,a.handshakeComplete_=!1,a}return s.__extends(e,t),Object.defineProperty(e.prototype,"handshakeComplete",{get:function(){return this.handshakeComplete_},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.handshakeComplete_=!1,t.prototype.start.call(this)},e.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},e.prototype.startRpc=function(t){return this.connection.openStream("Write",t)},e.prototype.onMessage=function(t){if(g(!!t.streamToken,"Got a write response without a stream token"),this.lastStreamToken=t.streamToken,this.handshakeComplete_){this.backoff.reset();var e=this.serializer.fromWriteResults(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.onMutationResult(n,e)}return g(!t.writeResults||0===t.writeResults.length,"Got mutation results for handshake"),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()},e.prototype.writeHandshake=function(){g(this.isOpen(),"Writing handshake requires an opened stream"),g(!this.handshakeComplete_,"Handshake already completed");var t={};t.database=this.serializer.encodedDatabaseId,this.sendRequest(t)},e.prototype.writeMutations=function(t){var e=this;g(this.isOpen(),"Writing mutations requires an opened stream"),g(this.handshakeComplete_,"Handshake must be complete before writing mutations"),g(this.lastStreamToken.length>0,"Trying to write mutation without a token");var n={streamToken:this.lastStreamToken,writes:t.map(function(t){return e.serializer.toMutation(t)})};this.sendRequest(n)},e}(ro),ao=function(){function t(t,e,n,r){this.queue=t,this.connection=e,this.credentials=n,this.serializer=r}return t.prototype.newPersistentWriteStream=function(t){return new oo(this.queue,this.connection,this.credentials,this.serializer,t)},t.prototype.newPersistentWatchStream=function(t){return new io(this.queue,this.connection,this.credentials,this.serializer,t)},t.prototype.commit=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,writes:t.map(function(t){return e.serializer.toMutation(t)})};return this.invokeRPC("Commit",n).then(function(t){return e.serializer.fromWriteResults(t.writeResults,t.commitTime)})},t.prototype.lookup=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,documents:t.map(function(t){return e.serializer.toName(t)})};return this.invokeStreamingRPC("BatchGetDocuments",n).then(function(n){var r=De();n.forEach(function(t){var n=e.serializer.fromMaybeDocument(t);r=r.insert(n.key,n)});var i=[];return t.forEach(function(t){var e=r.get(t);g(!!e,"Missing entity in write response for "+t),i.push(e)}),i})},t.prototype.invokeRPC=function(t,e){var n=this;return this.credentials.getToken().then(function(r){return n.connection.invokeRPC(t,e,r)}).catch(function(t){throw t.code===w.UNAUTHENTICATED&&n.credentials.invalidateToken(),t})},t.prototype.invokeStreamingRPC=function(t,e){var n=this;return this.credentials.getToken().then(function(r){return n.connection.invokeStreamingRPC(t,e,r)}).catch(function(t){throw t.code===w.UNAUTHENTICATED&&n.credentials.invalidateToken(),t})},t}(),so=function(){function t(t){this.datastore=t,this.readVersions=Ve(),this.mutations=[],this.committed=!1}return t.prototype.recordVersion=function(t){var e;if(t instanceof wt)e=t.version;else{if(!(t instanceof _t))throw y("Document in a transaction was a "+t.constructor.name);e=ue.forDeletedDoc()}var n=this.readVersions.get(t.key);if(null!==n){if(!e.isEqual(n))throw new _(w.ABORTED,"Document version changed between two reads.")}else this.readVersions=this.readVersions.insert(t.key,e)},t.prototype.lookup=function(t){var e=this;return this.committed?Promise.reject("Transaction has already completed."):this.mutations.length>0?Promise.reject("Transactions lookups are invalid after writes."):this.datastore.lookup(t).then(function(t){return t.forEach(function(t){t instanceof _t||t instanceof wt?e.recordVersion(t):y("Document in a transaction was a "+t.constructor.name)}),t})},t.prototype.write=function(t){if(this.committed)throw new _(w.FAILED_PRECONDITION,"Transaction has already completed.");this.mutations=this.mutations.concat(t)},t.prototype.precondition=function(t){var e=this.readVersions.get(t);return e?ye.updateTime(e):ye.NONE},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t);if(e&&e.isEqual(ue.forDeletedDoc()))throw new _(w.FAILED_PRECONDITION,"Can't update a document that doesn't exist.");return e?ye.updateTime(e):ye.exists(!0)},t.prototype.set=function(t,e){this.write(e.toMutations(t,this.precondition(t)))},t.prototype.update=function(t,e){this.write(e.toMutations(t,this.preconditionForUpdate(t)))},t.prototype.delete=function(t){this.write([new _e(t,this.precondition(t))]),this.readVersions=this.readVersions.insert(t,ue.forDeletedDoc())},t.prototype.commit=function(){var t=this,e=this.readVersions;return this.mutations.forEach(function(t){e=e.remove(t.key)}),e.isEmpty()?this.datastore.commit(this.mutations).then(function(){t.committed=!0}):Promise.reject(Error("Every document read in a transaction must also be written."))},t}();(function(t){t[t["Unknown"]=0]="Unknown",t[t["Online"]=1]="Online",t[t["Offline"]=2]="Offline"})(Ji||(Ji={})),function(t){t[t["RemoteStore"]=0]="RemoteStore",t[t["SharedClientState"]=1]="SharedClientState"}($i||($i={}));var uo="OnlineStateTracker",co=1,lo=1e4,ho=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state=Ji.Unknown,this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}return t.prototype.handleWatchStreamStart=function(){var t=this;0===this.watchStreamFailures&&(this.setAndBroadcast(Ji.Unknown),g(null===this.onlineStateTimer,"onlineStateTimer shouldn't be started yet"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay(An.OnlineStateTimeout,lo,function(){return t.onlineStateTimer=null,g(t.state===Ji.Unknown,"Timer should be canceled if we transitioned to a different state."),t.logClientOfflineWarningIfNecessary("Backend didn't respond within "+lo/1e3+" seconds."),t.setAndBroadcast(Ji.Offline),Promise.resolve()}))},t.prototype.handleWatchStreamFailure=function(t){this.state===Ji.Online?(this.setAndBroadcast(Ji.Unknown),g(0===this.watchStreamFailures,"watchStreamFailures must be 0"),g(null===this.onlineStateTimer,"onlineStateTimer must be null")):(this.watchStreamFailures++,this.watchStreamFailures>=co&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary("Connection failed "+co+" times. Most recent error: "+t.toString()),this.setAndBroadcast(Ji.Offline)))},t.prototype.set=function(t){this.clearOnlineStateTimer(),this.watchStreamFailures=0,t===Ji.Online&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(t)},t.prototype.setAndBroadcast=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.logClientOfflineWarningIfNecessary=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.shouldWarnClientIsOffline?(p(e),this.shouldWarnClientIsOffline=!1):d(uo,e)},t.prototype.clearOnlineStateTimer=function(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)},t}(),fo="RemoteStore",po=10,vo=function(){function t(t,e,n,r){this.localStore=t,this.datastore=e,this.writePipeline=[],this.listenTargets={},this.watchChangeAggregator=null,this.networkEnabled=!1,this.isPrimary=!1,this.onlineStateTracker=new ho(n,r),this.watchStream=this.datastore.newPersistentWatchStream({onOpen:this.onWatchStreamOpen.bind(this),onClose:this.onWatchStreamClose.bind(this),onWatchChange:this.onWatchStreamChange.bind(this)}),this.writeStream=this.datastore.newPersistentWriteStream({onOpen:this.onWriteStreamOpen.bind(this),onClose:this.onWriteStreamClose.bind(this),onHandshakeComplete:this.onWriteHandshakeComplete.bind(this),onMutationResult:this.onMutationResult.bind(this)})}return t.prototype.start=function(){return this.enableNetwork()},t.prototype.enableNetwork=function(){return s.__awaiter(this,void 0,void 0,function(){var t;return s.__generator(this,function(e){switch(e.label){case 0:return this.networkEnabled=!0,this.canUseNetwork()?(t=this.writeStream,[4,this.localStore.getLastStreamToken()]):[3,3];case 1:return t.lastStreamToken=e.sent(),this.shouldStartWatchStream()?this.startWatchStream():this.onlineStateTracker.set(Ji.Unknown),[4,this.fillWritePipeline()];case 2:e.sent(),e.label=3;case 3:return[2]}})})},t.prototype.disableNetwork=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.onlineStateTracker.set(Ji.Offline),[2]}})})},t.prototype.disableNetworkInternal=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return[4,this.writeStream.stop()];case 1:return t.sent(),[4,this.watchStream.stop()];case 2:return t.sent(),this.writePipeline.length>0&&(d(fo,"Stopping write stream with "+this.writePipeline.length+" pending writes"),this.writePipeline=[]),this.cleanUpWatchStreamState(),[2]}})})},t.prototype.shutdown=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return d(fo,"RemoteStore shutting down."),this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.onlineStateTracker.set(Ji.Unknown),[2]}})})},t.prototype.listen=function(t){g(!E(this.listenTargets,t.targetId),"listen called with duplicate targetId!"),this.listenTargets[t.targetId]=t,this.shouldStartWatchStream()?this.startWatchStream():this.watchStream.isOpen()&&this.sendWatchRequest(t)},t.prototype.unlisten=function(t){g(E(this.listenTargets,t),"unlisten called without assigned target ID!"),delete this.listenTargets[t],this.watchStream.isOpen()&&this.sendUnwatchRequest(t),A(this.listenTargets)&&(this.watchStream.isOpen()?this.watchStream.markIdle():this.canUseNetwork()&&this.onlineStateTracker.set(Ji.Unknown))},t.prototype.getQueryDataForTarget=function(t){return this.listenTargets[t]||null},t.prototype.getRemoteKeysForTarget=function(t){return this.syncEngine.getRemoteKeysForTarget(t)},t.prototype.sendWatchRequest=function(t){this.watchChangeAggregator.recordPendingTargetRequest(t.targetId),this.watchStream.watch(t)},t.prototype.sendUnwatchRequest=function(t){this.watchChangeAggregator.recordPendingTargetRequest(t),this.watchStream.unwatch(t)},t.prototype.startWatchStream=function(){g(this.shouldStartWatchStream(),"startWatchStream() called when shouldStartWatchStream() is false."),this.watchChangeAggregator=new nn(this),this.watchStream.start(),this.onlineStateTracker.handleWatchStreamStart()},t.prototype.shouldStartWatchStream=function(){return this.canUseNetwork()&&!this.watchStream.isStarted()&&!A(this.listenTargets)},t.prototype.canUseNetwork=function(){return this.isPrimary&&this.networkEnabled},t.prototype.cleanUpWatchStreamState=function(){this.watchChangeAggregator=null},t.prototype.onWatchStreamOpen=function(){return s.__awaiter(this,void 0,void 0,function(){var t=this;return s.__generator(this,function(e){return S(this.listenTargets,function(e,n){t.sendWatchRequest(n)}),[2]})})},t.prototype.onWatchStreamClose=function(t){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(e){return void 0===t&&g(!this.shouldStartWatchStream(),"Watch stream was stopped gracefully while still needed."),this.cleanUpWatchStreamState(),this.shouldStartWatchStream()?(this.onlineStateTracker.handleWatchStreamFailure(t),this.startWatchStream()):this.onlineStateTracker.set(Ji.Unknown),[2]})})},t.prototype.onWatchStreamChange=function(t,e){return s.__awaiter(this,void 0,void 0,function(){var n;return s.__generator(this,function(r){switch(r.label){case 0:return this.onlineStateTracker.set(Ji.Online),t instanceof tn&&t.state===Ge.Removed&&t.cause?[2,this.handleTargetError(t)]:(t instanceof $e?this.watchChangeAggregator.handleDocumentChange(t):t instanceof Ze?this.watchChangeAggregator.handleExistenceFilter(t):(g(t instanceof tn,"Expected watchChange to be an instance of WatchTargetChange"),this.watchChangeAggregator.handleTargetChange(t)),e.isEqual(ue.MIN)?[3,3]:[4,this.localStore.getLastRemoteSnapshotVersion()]);case 1:return n=r.sent(),e.compareTo(n)>=0?[4,this.raiseWatchSnapshot(e)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}})})},t.prototype.raiseWatchSnapshot=function(t){var e=this;g(!t.isEqual(ue.MIN),"Can't raise event for unknown SnapshotVersion");var n=this.watchChangeAggregator.createRemoteEvent(t);return S(n.targetChanges,function(n,r){if(r.resumeToken.length>0){var i=e.listenTargets[n];i&&(e.listenTargets[n]=i.copy({resumeToken:r.resumeToken,snapshotVersion:t}))}}),n.targetMismatches.forEach(function(t){var n=e.listenTargets[t];if(n){e.listenTargets[t]=n.copy({resumeToken:b()}),e.sendUnwatchRequest(t);var r=new le(n.query,t,Xt.ExistenceFilterMismatch,n.sequenceNumber);e.sendWatchRequest(r)}}),this.syncEngine.applyRemoteEvent(n)},t.prototype.handleTargetError=function(t){var e=this;g(!!t.cause,"Handling target error without a cause");var n=t.cause,r=Promise.resolve();return t.targetIds.forEach(function(t){r=r.then(function(){return s.__awaiter(e,void 0,void 0,function(){return s.__generator(this,function(e){return E(this.listenTargets,t)?(delete this.listenTargets[t],this.watchChangeAggregator.removeTarget(t),[2,this.syncEngine.rejectListen(t,n)]):[2]})})})}),r},t.prototype.fillWritePipeline=function(){return s.__awaiter(this,void 0,void 0,function(){var t,e;return s.__generator(this,function(n){switch(n.label){case 0:return this.canAddToWritePipeline()?(t=this.writePipeline.length>0?this.writePipeline[this.writePipeline.length-1].batchId:qn,[4,this.localStore.nextMutationBatch(t)]):[3,4];case 1:return e=n.sent(),null!==e?[3,2]:(0===this.writePipeline.length&&this.writeStream.markIdle(),[3,4]);case 2:return this.addToWritePipeline(e),[4,this.fillWritePipeline()];case 3:n.sent(),n.label=4;case 4:return this.shouldStartWriteStream()&&this.startWriteStream(),[2]}})})},t.prototype.canAddToWritePipeline=function(){return this.canUseNetwork()&&this.writePipeline.length<po},t.prototype.outstandingWrites=function(){return this.writePipeline.length},t.prototype.addToWritePipeline=function(t){g(this.canAddToWritePipeline(),"addToWritePipeline called when pipeline is full"),this.writePipeline.push(t),this.writeStream.isOpen()&&this.writeStream.handshakeComplete&&this.writeStream.writeMutations(t.mutations)},t.prototype.shouldStartWriteStream=function(){return this.canUseNetwork()&&!this.writeStream.isStarted()&&this.writePipeline.length>0},t.prototype.startWriteStream=function(){g(this.shouldStartWriteStream(),"startWriteStream() called when shouldStartWriteStream() is false."),this.writeStream.start()},t.prototype.onWriteStreamOpen=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){return this.writeStream.writeHandshake(),[2]})})},t.prototype.onWriteHandshakeComplete=function(){var t=this;return this.localStore.setLastStreamToken(this.writeStream.lastStreamToken).then(function(){for(var e=0,n=t.writePipeline;e<n.length;e++){var r=n[e];t.writeStream.writeMutations(r.mutations)}}).catch(Si)},t.prototype.onMutationResult=function(t,e){var n=this;g(this.writePipeline.length>0,"Got result for empty write pipeline");var r=this.writePipeline.shift(),i=Kn.from(r,t,e,this.writeStream.lastStreamToken);return this.syncEngine.applySuccessfulWrite(i).then(function(){return n.fillWritePipeline()})},t.prototype.onWriteStreamClose=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n=this;return s.__generator(this,function(r){return void 0===t&&g(!this.shouldStartWriteStream(),"Write stream was stopped gracefully while still needed."),t&&this.writePipeline.length>0?(e=void 0,e=this.writeStream.handshakeComplete?this.handleWriteError(t):this.handleHandshakeError(t),[2,e.then(function(){n.shouldStartWriteStream()&&n.startWriteStream()})]):[2]})})},t.prototype.handleHandshakeError=function(t){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(e){return Ae(t.code)||t.code===w.ABORTED?(d(fo,"RemoteStore error before completed handshake; resetting stream token: ",this.writeStream.lastStreamToken),this.writeStream.lastStreamToken=b(),[2,this.localStore.setLastStreamToken(b()).catch(Si)]):[2]})})},t.prototype.handleWriteError=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n=this;return s.__generator(this,function(r){return Ae(t.code)?(e=this.writePipeline.shift(),this.writeStream.inhibitBackoff(),[2,this.syncEngine.rejectFailedWrite(e.batchId,t).then(function(){return n.fillWritePipeline()})]):[2]})})},t.prototype.createTransaction=function(){return new so(this.datastore)},t.prototype.handleCredentialChange=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return this.canUseNetwork()?(d(fo,"RemoteStore restarting streams for new credential"),this.networkEnabled=!1,[4,this.disableNetworkInternal()]):[3,3];case 1:return t.sent(),this.onlineStateTracker.set(Ji.Unknown),[4,this.enableNetwork()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},t.prototype.applyPrimaryState=function(t){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(e){switch(e.label){case 0:return this.isPrimary=t,t&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return e.sent(),[3,4];case 2:return t?[3,4]:[4,this.disableNetworkInternal()];case 3:e.sent(),this.onlineStateTracker.set(Ji.Unknown),e.label=4;case 4:return[2]}})})},t}(),yo=function(){function t(){this.listeners=[]}return t}(),go=function(){function t(t){this.syncEngine=t,this.queries=new ar(function(t){return t.canonicalId()}),this.onlineState=Ji.Unknown,this.syncEngine.subscribe(this)}return t.prototype.listen=function(t){var e=t.query,n=!1,r=this.queries.get(e);return r||(n=!0,r=new yo,this.queries.set(e,r)),r.listeners.push(t),t.applyOnlineStateChange(this.onlineState),r.viewSnap&&t.onViewSnapshot(r.viewSnap),n?this.syncEngine.listen(e).then(function(t){return r.targetId=t,t}):Promise.resolve(r.targetId)},t.prototype.unlisten=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n,r,i;return s.__generator(this,function(o){return e=t.query,n=!1,r=this.queries.get(e),r&&(i=r.listeners.indexOf(t),i>=0&&(r.listeners.splice(i,1),n=0===r.listeners.length)),n?(this.queries.delete(e),[2,this.syncEngine.unlisten(e)]):[2]})})},t.prototype.onWatchChange=function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e],i=r.query,o=this.queries.get(i);if(o){for(var a=0,s=o.listeners;a<s.length;a++){var u=s[a];u.onViewSnapshot(r)}o.viewSnap=r}}},t.prototype.onWatchError=function(t,e){var n=this.queries.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++){var o=i[r];o.onError(e)}this.queries.delete(t)},t.prototype.onOnlineStateChange=function(t){this.onlineState=t,this.queries.forEach(function(e,n){for(var r=0,i=n.listeners;r<i.length;r++){var o=i[r];o.applyOnlineStateChange(t)}})},t}(),mo=function(){function t(t,e,n){this.query=t,this.queryObserver=e,this.raisedInitialEvent=!1,this.onlineState=Ji.Unknown,this.options=n||{}}return t.prototype.onViewSnapshot=function(t){if(g(t.docChanges.length>0||t.syncStateChanged,"We got a new snapshot with no changes?"),!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];i.type!==Ke.Metadata&&e.push(i)}t=new Ye(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}this.raisedInitialEvent?this.shouldRaiseEvent(t)&&this.queryObserver.next(t):this.shouldRaiseInitialEvent(t,this.onlineState)&&this.raiseInitialEvent(t),this.snap=t},t.prototype.onError=function(t){this.queryObserver.error(t)},t.prototype.applyOnlineStateChange=function(t){this.onlineState=t,this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,t)&&this.raiseInitialEvent(this.snap)},t.prototype.shouldRaiseInitialEvent=function(t,e){if(g(!this.raisedInitialEvent,"Determining whether to raise first event but already had first event"),!t.fromCache)return!0;var n=e!==Ji.Offline;return this.options.waitForSyncWhenOnline&&n?(g(t.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!t.docs.isEmpty()||e===Ji.Offline},t.prototype.shouldRaiseEvent=function(t){if(t.docChanges.length>0)return!0;var e=this.snap&&this.snap.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.raiseInitialEvent=function(t){g(!this.raisedInitialEvent,"Trying to raise initial events for second time"),t=Ye.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.raisedInitialEvent=!0,this.queryObserver.next(t)},t}(),bo=function(){function t(t,e,n){this.targetId=t,this.addedKeys=e,this.removedKeys=n}return t.fromSnapshot=function(e,n){for(var r=Ue(),i=Ue(),o=0,a=n.docChanges;o<a.length;o++){var s=a[o];switch(s.type){case Ke.Added:r=r.add(s.doc.key);break;case Ke.Removed:i=i.add(s.doc.key);break;default:}}return new t(e,r,i)},t}(),wo=function(){function t(t){this.key=t}return t}(),_o=function(){function t(t){this.key=t}return t}(),ko=function(){function t(t,e){this.query=t,this._syncedDocuments=e,this.syncState=null,this.current=!1,this.limboDocuments=Ue(),this.mutatedKeys=Ue(),this.documentSet=new ze(t.docComparator.bind(t))}return Object.defineProperty(t.prototype,"syncedDocuments",{get:function(){return this._syncedDocuments},enumerable:!0,configurable:!0}),t.prototype.computeDocChanges=function(t,e){var n=this,r=e?e.changeSet:new Qe,i=e?e.documentSet:this.documentSet,o=e?e.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=this.query.hasLimit()&&i.size===this.query.limit?i.last():null;if(t.inorderTraversal(function(t,e){var c=i.get(t),l=e instanceof wt?e:null;l&&(g(t.isEqual(l.key),"Mismatching keys found in document changes: "+t+" != "+l.key),l=n.query.matches(l)?l:null);var h=!!c&&n.mutatedKeys.has(c.key),f=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),d=!1;if(c&&l){var p=c.data.isEqual(l.data);p?h!==f&&(r.track({type:Ke.Metadata,doc:l}),d=!0):n.shouldWaitForSyncedDocument(c,l)||(r.track({type:Ke.Modified,doc:l}),d=!0,u&&n.query.docComparator(l,u)>0&&(s=!0))}else!c&&l?(r.track({type:Ke.Added,doc:l}),d=!0):c&&!l&&(r.track({type:Ke.Removed,doc:c}),d=!0,u&&(s=!0));d&&(l?(a=a.add(l),o=f?o.add(t):o.delete(t)):(a=a.delete(t),o=o.delete(t)))}),this.query.hasLimit())while(a.size>this.query.limit){var c=a.last();a=a.delete(c.key),o=o.delete(c.key),r.track({type:Ke.Removed,doc:c})}return g(!s||!e,"View was refilled using docs that themselves needed refilling."),{documentSet:a,changeSet:r,needsRefill:s,mutatedKeys:o}},t.prototype.shouldWaitForSyncedDocument=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this;g(!t.needsRefill,"Cannot apply changes that need a refill");var i=this.documentSet;this.documentSet=t.documentSet,this.mutatedKeys=t.mutatedKeys;var o=t.changeSet.getChanges();o.sort(function(t,e){return Eo(t.type,e.type)||r.query.docComparator(t.doc,e.doc)}),this.applyTargetChange(n);var a=e?this.updateLimboDocuments():[],s=0===this.limboDocuments.size&&this.current,u=s?He.Synced:He.Local,c=u!==this.syncState;if(this.syncState=u,0!==o.length||c){var l=new Ye(this.query,t.documentSet,i,o,t.mutatedKeys,u===He.Local,c,!1);return{snapshot:l,limboChanges:a}}return{limboChanges:a}},t.prototype.applyOnlineStateChange=function(t){return this.current&&t===Ji.Offline?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new Qe,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}},t.prototype.shouldBeInLimbo=function(t){return!this._syncedDocuments.has(t)&&(!!this.documentSet.has(t)&&!this.documentSet.get(t).hasLocalMutations)},t.prototype.applyTargetChange=function(t){var e=this;t&&(t.addedDocuments.forEach(function(t){return e._syncedDocuments=e._syncedDocuments.add(t)}),t.modifiedDocuments.forEach(function(t){return g(e._syncedDocuments.has(t),"Modified document "+t+" not found in view.")}),t.removedDocuments.forEach(function(t){return e._syncedDocuments=e._syncedDocuments.delete(t)}),this.current=t.current)},t.prototype.updateLimboDocuments=function(){var t=this;if(!this.current)return[];var e=this.limboDocuments;this.limboDocuments=Ue(),this.documentSet.forEach(function(e){t.shouldBeInLimbo(e.key)&&(t.limboDocuments=t.limboDocuments.add(e.key))});var n=[];return e.forEach(function(e){t.limboDocuments.has(e)||n.push(new _o(e))}),this.limboDocuments.forEach(function(t){e.has(t)||n.push(new wo(t))}),n},t.prototype.synchronizeWithPersistedState=function(t,e){this._syncedDocuments=e,this.limboDocuments=Ue();var n=this.computeDocChanges(t);return this.applyChanges(n,!0)},t.prototype.computeInitialSnapshot=function(){return Ye.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===He.Local)},t}();function Eo(t,e){var n=function(t){switch(t){case Ke.Added:return 1;case Ke.Modified:return 2;case Ke.Metadata:return 2;case Ke.Removed:return 0;default:return y("Unknown ChangeType: "+t)}};return n(t)-n(e)}var To="SyncEngine",So=function(){function t(t,e,n){this.query=t,this.targetId=e,this.view=n}return t}(),Co=function(){function t(t){this.key=t}return t}(),Oo=function(){function t(t,e,n,r){this.localStore=t,this.remoteStore=e,this.sharedClientState=n,this.currentUser=r,this.syncEngineListener=null,this.queryViewsByQuery=new ar(function(t){return t.canonicalId()}),this.queryViewsByTarget={},this.limboTargetsByKey=new Et(mt.comparator),this.limboResolutionsByTarget={},this.limboDocumentRefs=new Ri,this.mutationUserCallbacks={},this.limboTargetIdGenerator=zn.forSyncEngine(),this.isPrimary=void 0,this.onlineState=Ji.Unknown}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),t.prototype.subscribe=function(t){g(null!==t,"SyncEngine listener cannot be null"),g(null===this.syncEngineListener,"SyncEngine already has a subscriber."),this.syncEngineListener=t},t.prototype.listen=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n,r,i,o;return s.__generator(this,function(a){switch(a.label){case 0:return this.assertSubscribed("listen()"),r=this.queryViewsByQuery.get(t),r?(e=r.targetId,this.sharedClientState.addLocalQueryTarget(e),n=r.view.computeInitialSnapshot(),[3,4]):[3,1];case 1:return[4,this.localStore.allocateQuery(t)];case 2:return i=a.sent(),o=this.sharedClientState.addLocalQueryTarget(i.targetId),e=i.targetId,[4,this.initializeViewAndComputeSnapshot(i,"current"===o)];case 3:n=a.sent(),this.isPrimary&&this.remoteStore.listen(i),a.label=4;case 4:return this.syncEngineListener.onWatchChange([n]),[2,e]}})})},t.prototype.initializeViewAndComputeSnapshot=function(t,e){var n=this,r=t.query;return this.localStore.executeQuery(r).then(function(i){return n.localStore.remoteDocumentKeys(t.targetId).then(function(o){var a=new ko(r,o),s=a.computeDocChanges(i),u=Je.createSynthesizedTargetChangeForCurrentChange(t.targetId,e&&n.onlineState!==Ji.Offline),c=a.applyChanges(s,!0===n.isPrimary,u);g(0===c.limboChanges.length,"View returned limbo docs before target ack from the server."),g(!!c.snapshot,"applyChanges for new view should always return a snapshot");var l=new So(r,t.targetId,a);return n.queryViewsByQuery.set(r,l),n.queryViewsByTarget[t.targetId]=l,c.snapshot})})},t.prototype.synchronizeViewAndComputeSnapshot=function(t){var e=this;return this.localStore.executeQuery(t.query).then(function(n){return e.localStore.remoteDocumentKeys(t.targetId).then(function(r){return s.__awaiter(e,void 0,void 0,function(){var e;return s.__generator(this,function(i){return e=t.view.synchronizeWithPersistedState(n,r),this.isPrimary&&this.updateTrackedLimbos(t.targetId,e.limboChanges),[2,e]})})})})},t.prototype.unlisten=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n,r=this;return s.__generator(this,function(i){switch(i.label){case 0:return this.assertSubscribed("unlisten()"),e=this.queryViewsByQuery.get(t),g(!!e,"Trying to unlisten on query not found:"+t),this.isPrimary?(this.sharedClientState.removeLocalQueryTarget(e.targetId),n=this.sharedClientState.isActiveQueryTarget(e.targetId),n?[3,2]:[4,this.localStore.releaseQuery(t,!1).then(function(){r.sharedClientState.clearQueryState(e.targetId),r.remoteStore.unlisten(e.targetId),r.removeAndCleanupQuery(e)}).catch(Si)]):[3,3];case 1:i.sent(),i.label=2;case 2:return[3,5];case 3:return this.removeAndCleanupQuery(e),[4,this.localStore.releaseQuery(t,!0)];case 4:i.sent(),i.label=5;case 5:return[2]}})})},t.prototype.write=function(t,e){var n=this;return this.assertSubscribed("write()"),this.localStore.localWrite(t).then(function(t){return n.sharedClientState.addPendingMutation(t.batchId),n.addMutationCallback(t.batchId,e),n.emitNewSnapsAndNotifyLocalStore(t.changes)}).then(function(){return n.remoteStore.fillWritePipeline()})},t.prototype.wrapUpdateFunctionError=function(t){return t},t.prototype.runTransaction=function(t,e){var n=this;void 0===e&&(e=5),g(e>=0,"Got negative number of retries for transaction.");var r=this.remoteStore.createTransaction(),i=function(){try{var e=t(r);return!Qt(e)&&e.catch&&e.then?e.catch(function(t){return Promise.reject(n.wrapUpdateFunctionError(t))}):Promise.reject(Error("Transaction callback must return a Promise"))}catch(i){return Promise.reject(n.wrapUpdateFunctionError(i))}};return i().then(function(i){return r.commit().then(function(){return i}).catch(function(r){return 0===e?Promise.reject(r):n.runTransaction(t,e-1)})})},t.prototype.applyRemoteEvent=function(t){var e=this;return this.assertSubscribed("applyRemoteEvent()"),this.localStore.applyRemoteEvent(t).then(function(n){return O(t.targetChanges,function(t,n){var r=e.limboResolutionsByTarget[t];r&&(g(n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size<=1,"Limbo resolution for single document contains multiple changes."),n.addedDocuments.size>0?r.receivedDocument=!0:n.modifiedDocuments.size>0?g(r.receivedDocument,"Received change for limbo target document without add."):n.removedDocuments.size>0&&(g(r.receivedDocument,"Received remove for limbo target document without add."),r.receivedDocument=!1))}),e.emitNewSnapsAndNotifyLocalStore(n,t)}).catch(Si)},t.prototype.applyOnlineStateChange=function(t,e){if(this.isPrimary&&e===$i.RemoteStore||!this.isPrimary&&e===$i.SharedClientState){var n=[];this.queryViewsByQuery.forEach(function(e,r){var i=r.view.applyOnlineStateChange(t);g(0===i.limboChanges.length,"OnlineState should not affect limbo documents."),i.snapshot&&n.push(i.snapshot)}),this.syncEngineListener.onOnlineStateChange(t),this.syncEngineListener.onWatchChange(n),this.onlineState=t,this.isPrimary&&this.sharedClientState.setOnlineState(t)}},t.prototype.rejectListen=function(t,e){return s.__awaiter(this,void 0,void 0,function(){var n,r,i,o,a,u,c=this;return s.__generator(this,function(s){switch(s.label){case 0:return this.assertSubscribed("rejectListens()"),this.sharedClientState.updateQueryState(t,"rejected",e),n=this.limboResolutionsByTarget[t],r=n&&n.key,r?(this.limboTargetsByKey=this.limboTargetsByKey.remove(r),delete this.limboResolutionsByTarget[t],i=new Et(mt.comparator),i=i.insert(r,new _t(r,ue.forDeletedDoc())),o=Ue().add(r),a=new Xe(ue.MIN,{},new he($),i,o),[2,this.applyRemoteEvent(a)]):[3,1];case 1:return u=this.queryViewsByTarget[t],g(!!u,"Unknown targetId: "+t),[4,this.localStore.releaseQuery(u.query,!1).then(function(){return c.removeAndCleanupQuery(u)}).catch(Si)];case 2:s.sent(),this.syncEngineListener.onWatchError(u.query,e),s.label=3;case 3:return[2]}})})},t.prototype.applyBatchState=function(t,e,n){return s.__awaiter(this,void 0,void 0,function(){var r;return s.__generator(this,function(i){switch(i.label){case 0:return this.assertSubscribed("applyBatchState()"),[4,this.localStore.lookupMutationDocuments(t)];case 1:return r=i.sent(),null===r?(d(To,"Cannot apply mutation batch with id: "+t),[2]):"pending"!==e?[3,3]:[4,this.remoteStore.fillWritePipeline()];case 2:return i.sent(),[3,4];case 3:"acknowledged"===e||"rejected"===e?(this.processUserCallback(t,n||null),this.localStore.removeCachedMutationBatchMetadata(t)):y("Unknown batchState: "+e),i.label=4;case 4:return[4,this.emitNewSnapsAndNotifyLocalStore(r)];case 5:return i.sent(),[2]}})})},t.prototype.applySuccessfulWrite=function(t){var e=this;this.assertSubscribed("applySuccessfulWrite()");var n=t.batch.batchId;return this.processUserCallback(n,null),this.localStore.acknowledgeBatch(t).then(function(t){return e.sharedClientState.updateMutationState(n,"acknowledged"),e.emitNewSnapsAndNotifyLocalStore(t)}).catch(Si)},t.prototype.rejectFailedWrite=function(t,e){var n=this;return this.assertSubscribed("rejectFailedWrite()"),this.processUserCallback(t,e),this.localStore.rejectBatch(t).then(function(r){return n.sharedClientState.updateMutationState(t,"rejected",e),n.emitNewSnapsAndNotifyLocalStore(r)}).catch(Si)},t.prototype.addMutationCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];n||(n=new Et($)),n=n.insert(t,e),this.mutationUserCallbacks[this.currentUser.toKey()]=n},t.prototype.processUserCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];if(n){var r=n.get(t);r&&(g(t===n.minKey(),"Mutation callbacks processed out-of-order?"),e?r.reject(e):r.resolve(),n=n.remove(t)),this.mutationUserCallbacks[this.currentUser.toKey()]=n}},t.prototype.removeAndCleanupQuery=function(t){var e=this;if(this.sharedClientState.removeLocalQueryTarget(t.targetId),this.queryViewsByQuery.delete(t.query),delete this.queryViewsByTarget[t.targetId],this.isPrimary){var n=this.limboDocumentRefs.referencesForId(t.targetId);this.limboDocumentRefs.removeReferencesForId(t.targetId),n.forEach(function(t){var n=e.limboDocumentRefs.containsKey(t);n||e.removeLimboTarget(t)})}},t.prototype.removeLimboTarget=function(t){var e=this.limboTargetsByKey.get(t);null!==e&&(this.remoteStore.unlisten(e),this.limboTargetsByKey=this.limboTargetsByKey.remove(t),delete this.limboResolutionsByTarget[e])},t.prototype.updateTrackedLimbos=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i instanceof wo)this.limboDocumentRefs.addReference(i.key,t),this.trackLimboChange(i);else if(i instanceof _o){d(To,"Document no longer in limbo: "+i.key),this.limboDocumentRefs.removeReference(i.key,t);var o=this.limboDocumentRefs.containsKey(i.key);o||this.removeLimboTarget(i.key)}else y("Unknown limbo change: "+JSON.stringify(i))}},t.prototype.trackLimboChange=function(t){var e=t.key;if(!this.limboTargetsByKey.get(e)){d(To,"New document in limbo: "+e);var n=this.limboTargetIdGenerator.next(),r=Jt.atPath(e.path);this.limboResolutionsByTarget[n]=new Co(e),this.remoteStore.listen(new le(r,n,Xt.LimboResolution,In.INVALID)),this.limboTargetsByKey=this.limboTargetsByKey.insert(e,n)}},t.prototype.currentLimboDocs=function(){return this.limboTargetsByKey},t.prototype.emitNewSnapsAndNotifyLocalStore=function(t,e){return s.__awaiter(this,void 0,void 0,function(){var n,r,i,o=this;return s.__generator(this,function(a){switch(a.label){case 0:return n=[],r=[],i=[],this.queryViewsByQuery.forEach(function(a,s){i.push(Promise.resolve().then(function(){var e=s.view.computeDocChanges(t);return e.needsRefill?o.localStore.executeQuery(s.query).then(function(t){return s.view.computeDocChanges(t,e)}):e}).then(function(t){var i=e&&e.targetChanges[s.targetId],a=s.view.applyChanges(t,!0===o.isPrimary,i);if(o.updateTrackedLimbos(s.targetId,a.limboChanges),a.snapshot){o.isPrimary&&o.sharedClientState.updateQueryState(s.targetId,a.snapshot.fromCache?"not-current":"current"),n.push(a.snapshot);var u=bo.fromSnapshot(s.targetId,a.snapshot);r.push(u)}}))}),[4,Promise.all(i)];case 1:return a.sent(),this.syncEngineListener.onWatchChange(n),[4,this.localStore.notifyLocalViewChanges(r)];case 2:return a.sent(),[2]}})})},t.prototype.assertSubscribed=function(t){g(null!==this.syncEngineListener,"Trying to call "+t+" before calling subscribe().")},t.prototype.handleCredentialChange=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n;return s.__generator(this,function(r){switch(r.label){case 0:return e=!this.currentUser.isEqual(t),this.currentUser=t,e?[4,this.localStore.handleUserChange(t)]:[3,3];case 1:return n=r.sent(),this.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),[4,this.emitNewSnapsAndNotifyLocalStore(n.affectedDocuments)];case 2:r.sent(),r.label=3;case 3:return[4,this.remoteStore.handleCredentialChange()];case 4:return r.sent(),[2]}})})},t.prototype.applyPrimaryState=function(t){return s.__awaiter(this,void 0,void 0,function(){var e,n,r,i,o,a,u,c=this;return s.__generator(this,function(s){switch(s.label){case 0:return!0!==t||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.remoteStore.applyPrimaryState(!0)]);case 1:return s.sent(),e=this.sharedClientState.getAllActiveQueryTargets(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(e.toArray())];case 2:for(n=s.sent(),r=0,i=n;r<i.length;r++)o=i[r],this.remoteStore.listen(o);return[3,7];case 3:return!1!==t||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,a=[],u=Promise.resolve(),S(this.queryViewsByTarget,function(t,e){c.sharedClientState.isLocalQueryTarget(t)?a.push(t):u=u.then(function(){return c.unlisten(e.query)}),c.remoteStore.unlisten(e.targetId)}),[4,u]);case 4:return s.sent(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(a)];case 5:return s.sent(),this.resetLimboDocuments(),[4,this.remoteStore.applyPrimaryState(!1)];case 6:s.sent(),s.label=7;case 7:return[2]}})})},t.prototype.resetLimboDocuments=function(){var t=this;S(this.limboResolutionsByTarget,function(e){t.remoteStore.unlisten(e)}),this.limboDocumentRefs.removeAllReferences(),this.limboResolutionsByTarget=[],this.limboTargetsByKey=new Et(mt.comparator)},t.prototype.synchronizeQueryViewsAndRaiseSnapshots=function(t){for(var e=this,n=Promise.resolve(),r=[],i=[],o=function(t){n=n.then(function(){return s.__awaiter(e,void 0,void 0,function(){var e,n,o,a;return s.__generator(this,function(s){switch(s.label){case 0:return n=this.queryViewsByTarget[t],n?[4,this.localStore.releaseQuery(n.query,!0)]:[3,4];case 1:return s.sent(),[4,this.localStore.allocateQuery(n.query)];case 2:return e=s.sent(),[4,this.synchronizeViewAndComputeSnapshot(n)];case 3:return o=s.sent(),o.snapshot&&i.push(o.snapshot),[3,8];case 4:return g(!0===this.isPrimary,"A secondary tab should never have an active query without an active view."),[4,this.localStore.getQueryForTarget(t)];case 5:return a=s.sent(),g(!!a,"Query data for target "+t+" not found"),[4,this.localStore.allocateQuery(a)];case 6:return e=s.sent(),[4,this.initializeViewAndComputeSnapshot(e,!1)];case 7:s.sent(),s.label=8;case 8:return r.push(e),[2]}})})})},a=0,u=t;a<u.length;a++){var c=u[a];o(c)}return n.then(function(){return e.syncEngineListener.onWatchChange(i),r})},t.prototype.getActiveClients=function(){return this.localStore.getActiveClients()},t.prototype.applyTargetState=function(t,e,n){return s.__awaiter(this,void 0,void 0,function(){var r,i,o=this;return s.__generator(this,function(a){switch(a.label){case 0:if(this.isPrimary)return d(To,"Ignoring unexpected query state notification."),[2];if(!this.queryViewsByTarget[t])return[3,5];switch(r=e,r){case"current":return[3,1];case"not-current":return[3,1];case"rejected":return[3,2]}return[3,4];case 1:return[2,this.localStore.getNewDocumentChanges().then(function(n){return s.__awaiter(o,void 0,void 0,function(){var r;return s.__generator(this,function(i){switch(i.label){case 0:return r=Xe.createSynthesizedRemoteEventForCurrentChange(t,"current"===e),[4,this.emitNewSnapsAndNotifyLocalStore(n,r)];case 1:return i.sent(),[2]}})})},function(t){return s.__awaiter(o,void 0,void 0,function(){var e;return s.__generator(this,function(n){switch(n.label){case 0:return fr(t)?(e=[],S(this.queryViewsByTarget,function(t){return e.push(t)}),[4,this.synchronizeQueryViewsAndRaiseSnapshots(e)]):[3,2];case 1:return n.sent(),[3,3];case 2:throw t;case 3:return[2]}})})})];case 2:return i=this.queryViewsByTarget[t],this.removeAndCleanupQuery(i),[4,this.localStore.releaseQuery(i.query,!0)];case 3:return a.sent(),this.syncEngineListener.onWatchError(i.query,n),[3,5];case 4:y("Unexpected target state: "+e),a.label=5;case 5:return[2]}})})},t.prototype.applyActiveTargetsChange=function(t,e){return s.__awaiter(this,void 0,void 0,function(){var n,r,i,o,a,u,c,l,h,f=this;return s.__generator(this,function(d){switch(d.label){case 0:if(!this.isPrimary)return[2];n=0,r=t,d.label=1;case 1:return n<r.length?(h=r[n],g(!this.queryViewsByTarget[h],"Trying to add an already active target"),[4,this.localStore.getQueryForTarget(h)]):[3,6];case 2:return i=d.sent(),g(!!i,"Query data for active target "+h+" not found"),[4,this.localStore.allocateQuery(i)];case 3:return o=d.sent(),[4,this.initializeViewAndComputeSnapshot(o,!1)];case 4:d.sent(),this.remoteStore.listen(o),d.label=5;case 5:return n++,[3,1];case 6:a=function(t){var e;return s.__generator(this,function(n){switch(n.label){case 0:return e=u.queryViewsByTarget[t],e?[4,u.localStore.releaseQuery(e.query,!1).then(function(){f.remoteStore.unlisten(t),f.removeAndCleanupQuery(e)}).catch(Si)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})},u=this,c=0,l=e,d.label=7;case 7:return c<l.length?(h=l[c],[5,a(h)]):[3,10];case 8:d.sent(),d.label=9;case 9:return c++,[3,7];case 10:return[2]}})})},t.prototype.enableNetwork=function(){return this.localStore.setNetworkEnabled(!0),this.remoteStore.enableNetwork()},t.prototype.disableNetwork=function(){return this.localStore.setNetworkEnabled(!1),this.remoteStore.disableNetwork()},t.prototype.getRemoteKeysForTarget=function(t){var e=this.limboResolutionsByTarget[t];return e&&e.receivedDocument?Ue().add(e.key):this.queryViewsByTarget[t]?this.queryViewsByTarget[t].view.syncedDocuments:Ue()},t}(),Ao=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t.UNAUTHENTICATED=new t(null),t.GOOGLE_CREDENTIALS=new t("google-credentials-uid"),t.FIRST_PARTY=new t("first-party-uid"),t}(),Io="SharedClientState",xo="firestore_clients",Po="firestore_mutations",No="firestore_targets",Ro="firestore_online_state",Do="firestore_sequence_number",jo=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r,g(void 0!==r===("rejected"===n),"MutationMetadata must contain an error iff state is 'rejected'")}return t.fromWebStorageEntry=function(e,n,r){var i=JSON.parse(r),o="object"===typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"===typeof i.error),a=void 0;return o&&i.error&&(o="string"===typeof i.error.message&&"string"===typeof i.error.code,o&&(a=new _(i.error.code,i.error.message))),o?new t(e,n,i.state,a):(p(Io,"Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.toWebStorageJSON=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Mo=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n,g(void 0!==n===("rejected"===e),"QueryTargetMetadata must contain an error iff state is 'rejected'")}return t.fromWebStorageEntry=function(e,n){var r=JSON.parse(n),i="object"===typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"===typeof r.error),o=void 0;return i&&r.error&&(i="string"===typeof r.error.message&&"string"===typeof r.error.code,i&&(o=new _(r.error.code,r.error.message))),i?new t(e,r.state,o):(p(Io,"Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.toWebStorageJSON=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Lo=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.fromWebStorageEntry=function(e,n){for(var r=JSON.parse(n),i="object"===typeof r&&r.activeTargetIds instanceof Array,o=We(),a=0;i&&a<r.activeTargetIds.length;++a)i=Yt(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new t(e,o):(p(Io,"Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Fo=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.fromWebStorageEntry=function(e){var n=JSON.parse(e),r="object"===typeof n&&void 0!==Ji[n.onlineState]&&"string"===typeof n.clientId;return r?new t(n.clientId,Ji[n.onlineState]):(p(Io,"Failed to parse online state: "+e),null)},t}(),Vo=function(){function t(){this.activeTargetIds=We()}return t.prototype.addQueryTarget=function(t){g(!this.activeTargetIds.has(t),"Target with ID '"+t+"' already active."),this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.removeQueryTarget=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.toWebStorageJSON=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Bo=function(){function t(e,n,r,i,o){if(this.queue=e,this.platform=n,this.persistenceKey=r,this.localClientId=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.activeClients={},this.storageListener=this.handleWebStorageEvent.bind(this),this.started=!1,this.earlyEvents=[],!t.isAvailable(this.platform))throw new _(w.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=o,this.localClientStorageKey=this.toWebStorageClientStateKey(this.localClientId),this.sequenceNumberKey=Do+"_"+r,this.activeClients[this.localClientId]=new Vo,this.clientStateKeyRe=new RegExp("^"+xo+"_"+a+"_([^_]*)$"),this.mutationBatchKeyRe=new RegExp("^"+Po+"_"+a+"_(\\d+)(?:_(.*))?$"),this.queryTargetKeyRe=new RegExp("^"+No+"_"+a+"_(\\d+)$"),this.onlineStateKey=Ro+"_"+r,this.platform.window.addEventListener("storage",this.storageListener)}return t.isAvailable=function(t){return!(!t.window||null==t.window.localStorage)},t.prototype.start=function(){return s.__awaiter(this,void 0,void 0,function(){var t,e,n,r,i,o,a,u,c,l,h,f=this;return s.__generator(this,function(s){switch(s.label){case 0:return g(!this.started,"WebStorageSharedClientState already started"),g(null!==this.syncEngine,"syncEngine property must be set before calling start()"),g(null!==this.onlineStateHandler,"onlineStateHandler property must be set before calling start()"),[4,this.syncEngine.getActiveClients()];case 1:for(t=s.sent(),e=0,n=t;e<n.length;e++)r=n[e],r!==this.localClientId&&(i=this.getItem(this.toWebStorageClientStateKey(r)),i&&(o=Lo.fromWebStorageEntry(r,i),o&&(this.activeClients[o.clientId]=o)));for(this.persistClientState(),a=this.storage.getItem(this.onlineStateKey),a&&(u=this.fromWebStorageOnlineState(a),u&&this.handleOnlineStateEvent(u)),c=0,l=this.earlyEvents;c<l.length;c++)h=l[c],this.handleWebStorageEvent(h);return this.earlyEvents=[],this.platform.window.addEventListener("unload",function(){return f.shutdown()}),this.started=!0,[2]}})})},t.prototype.writeSequenceNumber=function(t){this.setItem(this.sequenceNumberKey,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){var t=We();return O(this.activeClients,function(e,n){t=t.unionWith(n.activeTargetIds)}),t},t.prototype.isActiveQueryTarget=function(t){for(var e in this.activeClients)if(this.activeClients.hasOwnProperty(e)&&this.activeClients[e].activeTargetIds.has(t))return!0;return!1},t.prototype.addPendingMutation=function(t){this.persistMutationState(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.persistMutationState(t,e,n),this.removeMutationState(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(this.toWebStorageQueryTargetMetadataKey(t));if(n){var r=Mo.fromWebStorageEntry(t,n);r&&(e=r.state)}}return this.localClientState.addQueryTarget(t),this.persistClientState(),e},t.prototype.removeLocalQueryTarget=function(t){this.localClientState.removeQueryTarget(t),this.persistClientState()},t.prototype.isLocalQueryTarget=function(t){return this.localClientState.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(this.toWebStorageQueryTargetMetadataKey(t))},t.prototype.updateQueryState=function(t,e,n){this.persistQueryTargetState(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach(function(t){r.removeMutationState(t)}),this.currentUser=t,n.forEach(function(t){r.addPendingMutation(t)})},t.prototype.setOnlineState=function(t){this.persistOnlineState(t)},t.prototype.shutdown=function(){this.started&&(this.platform.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return d(Io,"READ",t,e),e},t.prototype.setItem=function(t,e){d(Io,"SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){d(Io,"REMOVE",t),this.storage.removeItem(t)},t.prototype.handleWebStorageEvent=function(t){var e=this;if(t.storageArea===this.storage){if(d(Io,"EVENT",t.key,t.newValue),t.key===this.localClientStorageKey)return void p("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.queue.enqueueAndForget(function(){return s.__awaiter(e,void 0,void 0,function(){var e,n,r,i,o,a;return s.__generator(this,function(s){if(!this.started)return this.earlyEvents.push(t),[2];if(null===t.key)return[2];if(this.clientStateKeyRe.test(t.key)){if(null==t.newValue)return n=this.fromWebStorageClientStateKey(t.key),[2,this.handleClientStateEvent(n,null)];if(e=this.fromWebStorageClientState(t.key,t.newValue),e)return[2,this.handleClientStateEvent(e.clientId,e)]}else if(this.mutationBatchKeyRe.test(t.key)){if(null!==t.newValue&&(r=this.fromWebStorageMutationMetadata(t.key,t.newValue),r))return[2,this.handleMutationBatchEvent(r)]}else if(this.queryTargetKeyRe.test(t.key)){if(null!==t.newValue&&(i=this.fromWebStorageQueryTargetMetadata(t.key,t.newValue),i))return[2,this.handleQueryTargetEvent(i)]}else if(t.key===this.onlineStateKey){if(null!==t.newValue&&(o=this.fromWebStorageOnlineState(t.newValue),o))return[2,this.handleOnlineStateEvent(o)]}else t.key===this.sequenceNumberKey&&(g(!!this.sequenceNumberHandler,"Missing sequenceNumberHandler"),a=Uo(t.newValue),a!==In.INVALID&&this.sequenceNumberHandler(a));return[2]})})})}},Object.defineProperty(t.prototype,"localClientState",{get:function(){return this.activeClients[this.localClientId]},enumerable:!0,configurable:!0}),t.prototype.persistClientState=function(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())},t.prototype.persistMutationState=function(t,e,n){var r=new jo(this.currentUser,t,e,n),i=this.toWebStorageMutationBatchKey(t);this.setItem(i,r.toWebStorageJSON())},t.prototype.removeMutationState=function(t){var e=this.toWebStorageMutationBatchKey(t);this.removeItem(e)},t.prototype.persistOnlineState=function(t){var e={clientId:this.localClientId,onlineState:Ji[t]};this.storage.setItem(this.onlineStateKey,JSON.stringify(e))},t.prototype.persistQueryTargetState=function(t,e,n){var r=this.toWebStorageQueryTargetMetadataKey(t),i=new Mo(t,e,n);this.setItem(r,i.toWebStorageJSON())},t.prototype.toWebStorageClientStateKey=function(t){return g(-1===t.indexOf("_"),"Client key cannot contain '_', but was '"+t+"'"),xo+"_"+this.persistenceKey+"_"+t},t.prototype.toWebStorageQueryTargetMetadataKey=function(t){return No+"_"+this.persistenceKey+"_"+t},t.prototype.toWebStorageMutationBatchKey=function(t){var e=Po+"_"+this.persistenceKey+"_"+t;return this.currentUser.isAuthenticated()&&(e+="_"+this.currentUser.uid),e},t.prototype.fromWebStorageClientStateKey=function(t){var e=this.clientStateKeyRe.exec(t);return e?e[1]:null},t.prototype.fromWebStorageClientState=function(t,e){var n=this.fromWebStorageClientStateKey(t);return g(null!==n,"Cannot parse client state key '"+t+"'"),Lo.fromWebStorageEntry(n,e)},t.prototype.fromWebStorageMutationMetadata=function(t,e){var n=this.mutationBatchKeyRe.exec(t);g(null!==n,"Cannot parse mutation batch key '"+t+"'");var r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return jo.fromWebStorageEntry(new Ao(i),r,e)},t.prototype.fromWebStorageQueryTargetMetadata=function(t,e){var n=this.queryTargetKeyRe.exec(t);g(null!==n,"Cannot parse query target key '"+t+"'");var r=Number(n[1]);return Mo.fromWebStorageEntry(r,e)},t.prototype.fromWebStorageOnlineState=function(t){return Fo.fromWebStorageEntry(t)},t.prototype.handleMutationBatchEvent=function(t){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(e){return t.user.uid!==this.currentUser.uid?(d(Io,"Ignoring mutation for non-active user "+t.user.uid),[2]):[2,this.syncEngine.applyBatchState(t.batchId,t.state,t.error)]})})},t.prototype.handleQueryTargetEvent=function(t){return this.syncEngine.applyTargetState(t.targetId,t.state,t.error)},t.prototype.handleClientStateEvent=function(t,e){var n=this,r=this.getAllActiveQueryTargets();e?this.activeClients[t]=e:delete this.activeClients[t];var i=this.getAllActiveQueryTargets(),o=[],a=[];return i.forEach(function(t){return s.__awaiter(n,void 0,void 0,function(){return s.__generator(this,function(e){return r.has(t)||o.push(t),[2]})})}),r.forEach(function(t){return s.__awaiter(n,void 0,void 0,function(){return s.__generator(this,function(e){return i.has(t)||a.push(t),[2]})})}),this.syncEngine.applyActiveTargetsChange(o,a)},t.prototype.handleOnlineStateEvent=function(t){this.activeClients[t.clientId]&&this.onlineStateHandler(t.onlineState)},t}();function Uo(t){var e=In.INVALID;if(null!=t)try{var n=JSON.parse(t);g("number"===typeof n,"Found non-numeric sequence number"),e=n}catch(r){p(Io,"Failed to read sequence number from WebStorage",r)}return e}var qo=function(){function t(){this.localState=new Vo,this.queryState={},this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.localState.addQueryTarget(t),this.queryState[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.queryState[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.localState.removeQueryTarget(t)},t.prototype.isLocalQueryTarget=function(t){return this.localState.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.queryState[t]},t.prototype.getAllActiveQueryTargets=function(){return this.localState.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.localState.activeTargetIds.has(t)},t.prototype.start=function(){return this.localState=new Vo,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t}(),Wo="FirestoreClient",Ko=20,Ho=22,zo=function(){function t(t,e){this.cacheSizeBytes=t,this.experimentalTabSynchronization=e}return t.prototype.lruParams=function(){return ui.withCacheSize(this.cacheSizeBytes)},t}(),Go=function(){function t(){}return t}(),Qo=function(){function t(t,e,n,r){this.platform=t,this.databaseInfo=e,this.credentials=n,this.asyncQueue=r,this.clientId=J.newId()}return t.prototype.start=function(t){var e=this,n=new xn,r=new xn,i=!1;return this.credentials.setChangeListener(function(o){i?e.asyncQueue.enqueueAndForget(function(){return e.handleCredentialChange(o)}):(i=!0,e.initializePersistence(t,r,o).then(function(t){return e.initializeRest(o,t)}).then(n.resolve,n.reject))}),this.asyncQueue.enqueueAndForget(function(){return n.promise}),r.promise},t.prototype.enableNetwork=function(){var t=this;return this.asyncQueue.enqueue(function(){return t.syncEngine.enableNetwork()})},t.prototype.initializePersistence=function(t,e,n){var r=this;return t instanceof zo?this.startIndexedDbPersistence(n,t).then(function(t){return e.resolve(),t}).catch(function(t){if(e.reject(t),!r.canFallback(t))throw t;return console.warn("Error enabling offline storage. Falling back to storage disabled: "+t),r.startMemoryPersistence()}):(e.resolve(),this.startMemoryPersistence())},t.prototype.canFallback=function(t){return t instanceof _?t.code===w.FAILED_PRECONDITION||t.code===w.UNIMPLEMENTED:!("undefined"!==typeof DOMException&&t instanceof DOMException)||(t.code===Ho||t.code===Ko)},t.prototype.startIndexedDbPersistence=function(t,e){var n=this,r=Ei.buildStoragePrefix(this.databaseInfo),i=new hn(this.databaseInfo.databaseId,{useProto3Json:!0});return Promise.resolve().then(function(){return s.__awaiter(n,void 0,void 0,function(){var n,o;return s.__generator(this,function(a){switch(a.label){case 0:if(e.experimentalTabSynchronization&&!Bo.isAvailable(this.platform))throw new _(w.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");return o=e.lruParams(),e.experimentalTabSynchronization?(this.sharedClientState=new Bo(this.asyncQueue,this.platform,r,this.clientId,t),[4,Ei.createMultiClientIndexedDbPersistence(r,this.clientId,this.platform,this.asyncQueue,i,o,{sequenceNumberSyncer:this.sharedClientState})]):[3,2];case 1:return n=a.sent(),[3,4];case 2:return this.sharedClientState=new qo,[4,Ei.createIndexedDbPersistence(r,this.clientId,this.platform,this.asyncQueue,i,o)];case 3:n=a.sent(),a.label=4;case 4:return this.persistence=n,[2,n.referenceDelegate.garbageCollector]}})})})},t.prototype.startMemoryPersistence=function(){return this.persistence=Ki.createEagerPersistence(this.clientId),this.sharedClientState=new qo,Promise.resolve(null)},t.prototype.initializeRest=function(t,e){var n=this;return d(Wo,"Initializing. user=",t.uid),this.platform.loadConnection(this.databaseInfo).then(function(r){return s.__awaiter(n,void 0,void 0,function(){var n,i,o,a,u=this;return s.__generator(this,function(c){switch(c.label){case 0:return this.localStore=new Mi(this.persistence,t),e&&(this.lruScheduler=new hi(e,this.asyncQueue,this.localStore)),n=this.platform.newSerializer(this.databaseInfo.databaseId),i=new ao(this.asyncQueue,r,this.credentials,n),o=function(t){return u.syncEngine.applyOnlineStateChange(t,$i.RemoteStore)},a=function(t){return u.syncEngine.applyOnlineStateChange(t,$i.SharedClientState)},this.remoteStore=new vo(this.localStore,i,this.asyncQueue,o),this.syncEngine=new Oo(this.localStore,this.remoteStore,this.sharedClientState,t),this.sharedClientState.onlineStateHandler=a,this.remoteStore.syncEngine=this.syncEngine,this.sharedClientState.syncEngine=this.syncEngine,this.eventMgr=new go(this.syncEngine),[4,this.sharedClientState.start()];case 1:return c.sent(),[4,this.remoteStore.start()];case 2:return c.sent(),[4,this.persistence.setPrimaryStateListener(function(t){return s.__awaiter(u,void 0,void 0,function(){return s.__generator(this,function(e){switch(e.label){case 0:return[4,this.syncEngine.applyPrimaryState(t)];case 1:return e.sent(),this.lruScheduler&&(t&&!this.lruScheduler.started?this.lruScheduler.start():t||this.lruScheduler.stop()),[2]}})})})];case 3:return c.sent(),[2]}})})})},t.prototype.handleCredentialChange=function(t){return this.asyncQueue.verifyOperationInProgress(),d(Wo,"Credential Changed. Current user: "+t.uid),this.syncEngine.handleCredentialChange(t)},t.prototype.disableNetwork=function(){var t=this;return this.asyncQueue.enqueue(function(){return t.syncEngine.disableNetwork()})},t.prototype.shutdown=function(t){var e=this;return this.asyncQueue.enqueue(function(){return s.__awaiter(e,void 0,void 0,function(){return s.__generator(this,function(e){switch(e.label){case 0:return this.lruScheduler&&this.lruScheduler.stop(),[4,this.remoteStore.shutdown()];case 1:return e.sent(),[4,this.sharedClientState.shutdown()];case 2:return e.sent(),[4,this.persistence.shutdown(t&&t.purgePersistenceWithDataLoss)];case 3:return e.sent(),this.credentials.removeChangeListener(),[2]}})})})},t.prototype.listen=function(t,e,n){var r=this,i=new mo(t,e,n);return this.asyncQueue.enqueueAndForget(function(){return r.eventMgr.listen(i)}),i},t.prototype.unlisten=function(t){var e=this;this.asyncQueue.enqueueAndForget(function(){return e.eventMgr.unlisten(t)})},t.prototype.getDocumentFromLocalCache=function(t){var e=this;return this.asyncQueue.enqueue(function(){return e.localStore.readDocument(t)}).then(function(t){if(t instanceof wt)return t;if(t instanceof _t)return null;throw new _(w.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")})},t.prototype.getDocumentsFromLocalCache=function(t){var e=this;return this.asyncQueue.enqueue(function(){return e.localStore.executeQuery(t)}).then(function(e){var n=Ue(),r=new ko(t,n),i=r.computeDocChanges(e);return r.applyChanges(i,!1).snapshot})},t.prototype.write=function(t){var e=this,n=new xn;return this.asyncQueue.enqueueAndForget(function(){return e.syncEngine.write(t,n)}),n.promise},t.prototype.databaseId=function(){return this.databaseInfo.databaseId},t.prototype.transaction=function(t){var e=this;return this.asyncQueue.enqueue(function(){return s.__awaiter(e,void 0,void 0,function(){return s.__generator(this,function(t){return[2]})})}).then(function(){return e.syncEngine.runTransaction(t)})},t}(),Yo=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.scheduleEvent(this.observer.next,t)},t.prototype.error=function(t){this.scheduleEvent(this.observer.error,t)},t.prototype.mute=function(){this.muted=!0},t.prototype.scheduleEvent=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),Xo=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];R("FieldPath",t,"fieldNames",1);for(var n=0;n<t.length;++n)if(D("FieldPath","string",n,t[n]),0===t[n].length)throw new _(w.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new gt(t)}return t.documentId=function(){return t._DOCUMENT_ID},t.prototype.isEqual=function(e){if(!(e instanceof t))throw Q("isEqual","FieldPath",1,e);return this._internalPath.isEqual(e._internalPath)},t._DOCUMENT_ID=new t(gt.keyField().canonicalString()),t}(),Jo=new RegExp("[~\\*/\\[\\]]");function $o(t){var e=t.search(Jo);if(e>=0)throw new _(w.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Xo.bind.apply(Xo,[void 0].concat(t.split("."))))}catch(n){throw new _(w.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}var Zo=function(){function t(t,e){this.user=e,this.type="OAuth",this.authHeaders={Authorization:"Bearer "+t}}return t}(),ta=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t){g(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=t,t(Ao.UNAUTHENTICATED)},t.prototype.removeChangeListener=function(){g(null!==this.changeListener,"removeChangeListener() when no listener registered"),this.changeListener=null},t}(),ea=function(){function t(t){var e=this;this.app=t,this.tokenListener=null,this.tokenCounter=0,this.changeListener=null,this.forceRefresh=!1,this.tokenListener=function(){e.tokenCounter++,e.currentUser=e.getUser(),e.changeListener&&e.changeListener(e.currentUser)},this.tokenCounter=0,this.app.INTERNAL.addAuthTokenListener(this.tokenListener)}return t.prototype.getToken=function(){var t=this;g(null!=this.tokenListener,"getToken cannot be called after listener removed.");var e=this.tokenCounter,n=this.forceRefresh;return this.forceRefresh=!1,this.app.INTERNAL.getToken(n).then(function(n){if(t.tokenCounter!==e)throw new _(w.ABORTED,"getToken aborted due to token change.");return n?(g("string"===typeof n.accessToken,"Invalid tokenData returned from getToken():"+n),new Zo(n.accessToken,t.currentUser)):null})},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t){g(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=t,this.currentUser&&t(this.currentUser)},t.prototype.removeChangeListener=function(){g(null!=this.tokenListener,"removeChangeListener() called twice"),g(null!==this.changeListener,"removeChangeListener() called when no listener registered"),this.app.INTERNAL.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.changeListener=null},t.prototype.getUser=function(){var t=this.app.INTERNAL.getUid();return g(null===t||"string"===typeof t,"Received invalid UID: "+t),new Ao(t)},t}(),na=function(){function t(t,e){this.gapi=t,this.sessionIndex=e,this.type="FirstParty",this.user=Ao.FIRST_PARTY,g(this.gapi&&this.gapi["auth"]&&this.gapi["auth"]["getAuthHeaderValueForFirstParty"],"unexpected gapi interface")}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){return{Authorization:this.gapi["auth"]["getAuthHeaderValueForFirstParty"]([]),"X-Goog-AuthUser":this.sessionIndex}},enumerable:!0,configurable:!0}),t}(),ra=function(){function t(t,e){this.gapi=t,this.sessionIndex=e,g(this.gapi&&this.gapi["auth"]&&this.gapi["auth"]["getAuthHeaderValueForFirstParty"],"unexpected gapi interface")}return t.prototype.getToken=function(){return Promise.resolve(new na(this.gapi,this.sessionIndex))},t.prototype.setChangeListener=function(t){t(Ao.FIRST_PARTY)},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function ia(t){if(!t)return new ta;switch(t.type){case"gapi":return new ra(t.client,t.sessionIndex||"0");case"provider":return t.client;default:throw new _(w.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}function oa(t){return aa(t,["next","error","complete"])}function aa(t,e){if("object"!==typeof t||null===t)return!1;for(var n=t,r=0,i=e;r<i.length;r++){var o=i[r];if(o in n&&"function"===typeof n[o])return!0}return!1}var sa,ua=function(){function t(t){this._methodName=t}return t.delete=function(){return ca.instance},t.serverTimestamp=function(){return la.instance},t.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return P("FieldValue.arrayUnion",arguments,1),new ha(t)},t.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return P("FieldValue.arrayRemove",arguments,1),new fa(t)},t.prototype.isEqual=function(t){return this===t},t}(),ca=function(t){function e(){return t.call(this,"FieldValue.delete")||this}return s.__extends(e,t),e.instance=new e,e}(ua),la=function(t){function e(){return t.call(this,"FieldValue.serverTimestamp")||this}return s.__extends(e,t),e.instance=new e,e}(ua),ha=function(t){function e(e){var n=t.call(this,"FieldValue.arrayUnion")||this;return n._elements=e,n}return s.__extends(e,t),e}(ua),fa=function(t){function e(e){var n=t.call(this,"FieldValue.arrayRemove")||this;return n._elements=e,n}return s.__extends(e,t),e}(ua),da=k(ua,"Use FieldValue.<field>() instead."),pa=/^__.*__$/,va=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[];return null!==this.fieldMask?n.push(new be(t,this.data,this.fieldMask,e)):n.push(new me(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new we(t,this.fieldTransforms)),n},t}(),ya=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[new be(t,this.data,this.fieldMask,e)];return this.fieldTransforms.length>0&&n.push(new we(t,this.fieldTransforms)),n},t}();function ga(t){switch(t){case sa.Set:case sa.MergeSet:case sa.Update:return!0;case sa.Argument:return!1;default:throw y("Unexpected case for UserDataSource: "+t)}}(function(t){t[t["Set"]=0]="Set",t[t["Update"]=1]="Update",t[t["MergeSet"]=2]="MergeSet",t[t["Argument"]=3]="Argument"})(sa||(sa={}));var ma=function(){function t(t,e,n,r,i,o){this.dataSource=t,this.methodName=e,this.path=n,this.arrayElement=r,void 0===i&&this.validatePath(),this.arrayElement=void 0!==r&&r,this.fieldTransforms=i||[],this.fieldMask=o||[]}return t.prototype.childContextForField=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePathSegment(e),r},t.prototype.childContextForFieldPath=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePath(),r},t.prototype.childContextForArray=function(e){return new t(this.dataSource,this.methodName,null,!0,this.fieldTransforms,this.fieldMask)},t.prototype.createError=function(t){var e=null===this.path||this.path.isEmpty()?"":" (found in field "+this.path.toString()+")";return new _(w.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find(function(e){return t.isPrefixOf(e)})||void 0!==this.fieldTransforms.find(function(e){return t.isPrefixOf(e.field)})},t.prototype.validatePath=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.validatePathSegment(this.path.get(t))},t.prototype.validatePathSegment=function(t){if(ga(this.dataSource)&&pa.test(t))throw this.createError("Document fields cannot begin and end with __")},t}(),ba=function(){function t(t,e){this.databaseId=t,this.key=e}return t}(),wa=function(){function t(t){this.preConverter=t}return t.prototype.parseSetData=function(t,e){var n=new ma(sa.Set,t,gt.EMPTY_PATH);ka("Data must be an object, but it was:",n,e);var r=this.parseData(e,n);return new va(r,null,n.fieldTransforms)},t.prototype.parseMergeData=function(t,e,n){var r=new ma(sa.MergeSet,t,gt.EMPTY_PATH);ka("Data must be an object, but it was:",r,e);var i,o,a=this.parseData(e,r);if(n){for(var s=[],u=0,c=n;u<c.length;u++){var l=c[u],h=void 0;if(l instanceof Xo)h=l._internalPath;else{if("string"!==typeof l)throw y("Expected stringOrFieldPath to be a string or a FieldPath");h=Ta(t,l)}if(!r.contains(h))throw new _(w.INVALID_ARGUMENT,"Field '"+h+"' is specified in your field mask but missing from your input data.");s.push(h)}i=de.fromArray(s),o=r.fieldTransforms.filter(function(t){return i.covers(t.field)})}else i=de.fromArray(r.fieldMask),o=r.fieldTransforms;return new va(a,i,o)},t.prototype.parseUpdateData=function(t,e){var n=this,r=new ma(sa.Update,t,gt.EMPTY_PATH);ka("Data must be an object, but it was:",r,e);var i=[],o=qt.EMPTY;O(e,function(e,a){var s=Ta(t,e),u=r.childContextForFieldPath(s);if(a=n.runPreConverter(a,u),a instanceof ca)i.push(s);else{var c=n.parseData(a,u);null!=c&&(i.push(s),o=o.set(s,c))}});var a=de.fromArray(i);return new ya(o,a,r.fieldTransforms)},t.prototype.parseUpdateVarargs=function(t,e,n,r){var i=new ma(sa.Update,t,gt.EMPTY_PATH),o=[Ea(t,e)],a=[n];if(r.length%2!==0)throw new _(w.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var s=0;s<r.length;s+=2)o.push(Ea(t,r[s])),a.push(r[s+1]);var u=[],c=qt.EMPTY;for(s=0;s<o.length;++s){var l=o[s],h=i.childContextForFieldPath(l),f=this.runPreConverter(a[s],h);if(f instanceof ca)u.push(l);else{var d=this.parseData(f,h);null!=d&&(u.push(l),c=c.set(l,d))}}var p=de.fromArray(u);return new ya(c,p,i.fieldTransforms)},t.prototype.parseQueryValue=function(t,e){var n=new ma(sa.Argument,t,gt.EMPTY_PATH),r=this.parseData(e,n);return g(null!=r,"Parsed data should not be null."),g(0===n.fieldTransforms.length,"Field transforms should have been disallowed."),r},t.prototype.runPreConverter=function(t,e){try{return this.preConverter(t)}catch(r){var n=Sa(r);throw e.createError(n)}},t.prototype.parseData=function(t,e){if(t=this.runPreConverter(t,e),_a(t))return ka("Unsupported field value:",e,t),this.parseObject(t,e);if(t instanceof ua)return this.parseSentinelFieldValue(t,e),null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.arrayElement)throw e.createError("Nested arrays are not supported");return this.parseArray(t,e)}return this.parseScalarValue(t,e)},t.prototype.parseObject=function(t,e){var n=this,r=new Et($);return A(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):O(t,function(t,i){var o=n.parseData(i,e.childContextForField(t));null!=o&&(r=r.insert(t,o))}),new qt(r)},t.prototype.parseArray=function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var a=o[i],s=this.parseData(a,e.childContextForArray(r));null==s&&(s=It.INSTANCE),n.push(s),r++}return new Wt(n)},t.prototype.parseSentinelFieldValue=function(t,e){if(!ga(e.dataSource))throw e.createError(t._methodName+"() can only be used with update() and set()");if(null===e.path)throw e.createError(t._methodName+"() is not currently supported inside arrays");if(t instanceof ca){if(e.dataSource!==sa.MergeSet)throw e.dataSource===sa.Update?(g(e.path.length>0,"FieldValue.delete() at the top level should have already been handled."),e.createError("FieldValue.delete() can only appear at the top level of your update data")):e.createError("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");e.fieldMask.push(e.path)}else if(t instanceof la)e.fieldTransforms.push(new pe(e.path,ke.instance));else if(t instanceof ha){var n=this.parseArrayTransformElements(t._methodName,t._elements),r=new Ee(n);e.fieldTransforms.push(new pe(e.path,r))}else if(t instanceof fa){n=this.parseArrayTransformElements(t._methodName,t._elements);var i=new Te(n);e.fieldTransforms.push(new pe(e.path,i))}else y("Unknown FieldValue type: "+t)},t.prototype.parseScalarValue=function(t,e){if(null===t)return It.INSTANCE;if("number"===typeof t)return Yt(t)?new Dt(t):new jt(t);if("boolean"===typeof t)return xt.of(t);if("string"===typeof t)return new Mt(t);if(t instanceof Date)return new Lt(ct.fromDate(t));if(t instanceof ct)return new Lt(new ct(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)));if(t instanceof ut)return new Ut(t);if(t instanceof at)return new Vt(t);if(t instanceof ba)return new Bt(t.databaseId,t.key);throw e.createError("Unsupported field value: "+K(t))},t.prototype.parseArrayTransformElements=function(t,e){var n=this;return e.map(function(e,r){var i=new ma(sa.Argument,t,gt.EMPTY_PATH);return n.parseData(e,i.childContextForArray(r))})},t}();function _a(t){return"object"===typeof t&&null!==t&&!(t instanceof Array)&&!(t instanceof Date)&&!(t instanceof ct)&&!(t instanceof ut)&&!(t instanceof at)&&!(t instanceof ba)&&!(t instanceof ua)}function ka(t,e,n){if(!_a(n)||!W(n)){var r=K(n);throw"an object"===r?e.createError(t+" a custom object"):e.createError(t+" "+r)}}function Ea(t,e){if(e instanceof Xo)return e._internalPath;if("string"===typeof e)return Ta(t,e);var n="Field path arguments must be of type string or FieldPath.";throw new _(w.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}function Ta(t,e){try{return $o(e)._internalPath}catch(r){var n=Sa(r);throw new _(w.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function Sa(t){return t instanceof Error?t.message:t.toString()}var Ca="firestore.googleapis.com",Oa=!0,Aa=!1,Ia=ui.COLLECTION_DISABLED,xa=!1,Pa=function(){function t(t){if(void 0===t.host){if(void 0!==t.ssl)throw new _(w.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Ca,this.ssl=Oa}else M("settings","non-empty string","host",t.host),this.host=t.host,L("settings","boolean","ssl",t.ssl),this.ssl=T(t.ssl,Oa);if(G("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes"]),L("settings","object","credentials",t.credentials),this.credentials=t.credentials,L("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),this.timestampsInSnapshots=T(t.timestampsInSnapshots,Aa),L("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=ui.DEFAULT_CACHE_SIZE_BYTES;else{if(t.cacheSizeBytes!==Ia&&t.cacheSizeBytes<ui.MINIMUM_CACHE_SIZE_BYTES)throw new _(w.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+ui.MINIMUM_CACHE_SIZE_BYTES);this.cacheSizeBytes=t.cacheSizeBytes}}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes},t}(),Na=function(){function t(){}return t}(),Ra=function(){function t(e){var n=this;this._queue=new Nn,this.INTERNAL={delete:function(t){return s.__awaiter(n,void 0,void 0,function(){return s.__generator(this,function(e){return this._firestoreClient?[2,this._firestoreClient.shutdown(t)]:[2]})})}};var r=new Na;if("object"===typeof e.options){var i=e;r.firebaseApp=i,r.databaseId=t.databaseIdFromApp(i),r.persistenceKey=r.firebaseApp.name,r.credentials=new ea(i)}else{var o=e;if(!o.projectId)throw new _(w.INVALID_ARGUMENT,"Must provide projectId");r.databaseId=new ft(o.projectId,o.database),r.persistenceKey="[DEFAULT]",r.credentials=new ta}r.settings=new Pa({}),this._config=r,this._databaseId=r.databaseId}return t.prototype.settings=function(t){if(x("Firestore.settings",arguments,1),D("Firestore.settings","object",1,t),E(t,"persistence"))throw new _(w.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to firestore.enablePersistence().');var e=new Pa(t);if(this._firestoreClient&&!this._config.settings.isEqual(e))throw new _(w.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this._config.settings=e,void 0!==e.credentials&&(this._config.credentials=ia(e.credentials))},t.prototype.enableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.enableNetwork()},t.prototype.disableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.disableNetwork()},t.prototype.enablePersistence=function(t){if(this._firestoreClient)throw new _(w.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");return this.configureClient(new zo(this._config.settings.cacheSizeBytes,void 0!==t&&T(t.experimentalTabSynchronization,xa)))},t.prototype.ensureClientConfigured=function(){return this._firestoreClient||this.configureClient(new Go),this._firestoreClient},t.prototype.configureClient=function(t){var e=this;g(!!this._config.settings.host,"FirestoreSettings.host cannot be falsey"),this._config.settings.timestampsInSnapshots||p("\nThe behavior for Date objects stored in Firestore is going to change\nAND YOUR APP MAY BREAK.\nTo hide this warning and ensure your app does not break, you need to add the\nfollowing code to your app before calling any other Cloud Firestore methods:\n\n  const firestore = firebase.firestore();\n  const settings = {/* your settings... */ timestampsInSnapshots: true};\n  firestore.settings(settings);\n\nWith this change, timestamps stored in Cloud Firestore will be read back as\nFirebase Timestamp objects instead of as system Date objects. So you will also\nneed to update code expecting a Date to instead expect a Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get('created_at');\n  // New:\n  const timestamp = snapshot.get('created_at');\n  const date = timestamp.toDate();\n\nPlease audit all existing usages of Date when you enable the new behavior. In a\nfuture release, the behavior will change to the new behavior, so if you do not\nfollow these steps, YOUR APP MAY BREAK."),g(!this._firestoreClient,"configureClient() called multiple times");var n=new lt(this._config.databaseId,this._config.persistenceKey,this._config.settings.host,this._config.settings.ssl),r=function(t){if(t instanceof Ma){var n=e._config.databaseId,r=t.firestore._config.databaseId;if(!r.isEqual(n))throw new _(w.INVALID_ARGUMENT,"Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return new ba(e._config.databaseId,t._key)}return t};return this._dataConverter=new wa(r),this._firestoreClient=new Qo(m.getPlatform(),n,this._config.credentials,this._queue),this._firestoreClient.start(t)},t.databaseIdFromApp=function(t){var e=t.options;if(!E(e,"projectId"))throw new _(w.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var n=e["projectId"];if(!n||"string"!==typeof n)throw new _(w.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new ft(n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this._config.firebaseApp)throw new _(w.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._config.firebaseApp},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(x("Firestore.collection",arguments,1),D("Firestore.collection","non-empty string",1,t),!t)throw new _(w.INVALID_ARGUMENT,"Must provide a non-empty collection path to collection()");return this.ensureClientConfigured(),new Ka(vt.fromString(t),this)},t.prototype.doc=function(t){if(x("Firestore.doc",arguments,1),D("Firestore.doc","non-empty string",1,t),!t)throw new _(w.INVALID_ARGUMENT,"Must provide a non-empty document path to doc()");return this.ensureClientConfigured(),Ma.forPath(vt.fromString(t),this)},t.prototype.runTransaction=function(t){var e=this;return x("Firestore.runTransaction",arguments,1),D("Firestore.runTransaction","function",1,t),this.ensureClientConfigured().transaction(function(n){return t(new Da(e,n))})},t.prototype.batch=function(){return this.ensureClientConfigured(),new ja(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(h()){case i.DEBUG:return"debug";case i.ERROR:return"error";case i.SILENT:return"silent";default:return y("Unknown log level: "+h())}},enumerable:!0,configurable:!0}),t.setLogLevel=function(t){switch(x("Firestore.setLogLevel",arguments,1),D("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":f(i.DEBUG);break;case"error":f(i.ERROR);break;case"silent":f(i.SILENT);break;default:throw new _(w.INVALID_ARGUMENT,"Invalid log level: "+t)}},t.prototype._areTimestampsInSnapshotsEnabled=function(){return this._config.settings.timestampsInSnapshots},t}(),Da=function(){function t(t,e){this._firestore=t,this._transaction=e}return t.prototype.get=function(t){var e=this;x("Transaction.get",arguments,1);var n=Qa("Transaction.get",t,this._firestore);return this._transaction.lookup([n._key]).then(function(t){if(!t||1!==t.length)return y("Mismatch in docs returned from document lookup.");var r=t[0];if(r instanceof _t)return new Fa(e._firestore,n._key,null,!1,!1);if(r instanceof wt)return new Fa(e._firestore,n._key,r,!1,!1);throw y("BatchGetDocumentsRequest returned unexpected document type: "+r.constructor.name)})},t.prototype.set=function(t,e,n){N("Transaction.set",arguments,2,3);var r=Qa("Transaction.set",t,this._firestore);n=Ha("Transaction.set",n);var i=n.merge||n.mergeFields?this._firestore._dataConverter.parseMergeData("Transaction.set",e,n.mergeFields):this._firestore._dataConverter.parseSetData("Transaction.set",e);return this._transaction.set(r._key,i),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return"string"===typeof e||e instanceof Xo?(P("Transaction.update",arguments,3),r=Qa("Transaction.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateVarargs("Transaction.update",e,n,o)):(x("Transaction.update",arguments,2),r=Qa("Transaction.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateData("Transaction.update",e)),this._transaction.update(r._key,i),this},t.prototype.delete=function(t){x("Transaction.delete",arguments,1);var e=Qa("Transaction.delete",t,this._firestore);return this._transaction.delete(e._key),this},t}(),ja=function(){function t(t){this._firestore=t,this._mutations=[],this._committed=!1}return t.prototype.set=function(t,e,n){N("WriteBatch.set",arguments,2,3),this.verifyNotCommitted();var r=Qa("WriteBatch.set",t,this._firestore);n=Ha("WriteBatch.set",n);var i=n.merge||n.mergeFields?this._firestore._dataConverter.parseMergeData("WriteBatch.set",e,n.mergeFields):this._firestore._dataConverter.parseSetData("WriteBatch.set",e);return this._mutations=this._mutations.concat(i.toMutations(r._key,ye.NONE)),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return this.verifyNotCommitted(),"string"===typeof e||e instanceof Xo?(P("WriteBatch.update",arguments,3),r=Qa("WriteBatch.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateVarargs("WriteBatch.update",e,n,o)):(x("WriteBatch.update",arguments,2),r=Qa("WriteBatch.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateData("WriteBatch.update",e)),this._mutations=this._mutations.concat(i.toMutations(r._key,ye.exists(!0))),this},t.prototype.delete=function(t){x("WriteBatch.delete",arguments,1),this.verifyNotCommitted();var e=Qa("WriteBatch.delete",t,this._firestore);return this._mutations=this._mutations.concat(new _e(e._key,ye.NONE)),this},t.prototype.commit=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){return this.verifyNotCommitted(),this._committed=!0,this._mutations.length>0?[2,this._firestore.ensureClientConfigured().write(this._mutations)]:[2]})})},t.prototype.verifyNotCommitted=function(){if(this._committed)throw new _(w.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),Ma=function(){function t(t,e){this._key=t,this.firestore=e,this._firestoreClient=this.firestore.ensureClientConfigured()}return t.forPath=function(e,n){if(e.length%2!==0)throw new _(w.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(new mt(e),n)},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Ka(this._key.path.popLast(),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(x("DocumentReference.collection",arguments,1),D("DocumentReference.collection","non-empty string",1,t),!t)throw new _(w.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=vt.fromString(t);return new Ka(this._key.path.child(e),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw Q("isEqual","DocumentReference",1,e);return this.firestore===e.firestore&&this._key.isEqual(e._key)},t.prototype.set=function(t,e){N("DocumentReference.set",arguments,1,2),e=Ha("DocumentReference.set",e);var n=e.merge||e.mergeFields?this.firestore._dataConverter.parseMergeData("DocumentReference.set",t,e.mergeFields):this.firestore._dataConverter.parseSetData("DocumentReference.set",t);return this._firestoreClient.write(n.toMutations(this._key,ye.NONE))},t.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return"string"===typeof t||t instanceof Xo?(P("DocumentReference.update",arguments,2),n=this.firestore._dataConverter.parseUpdateVarargs("DocumentReference.update",t,e,r)):(x("DocumentReference.update",arguments,1),n=this.firestore._dataConverter.parseUpdateData("DocumentReference.update",t)),this._firestoreClient.write(n.toMutations(this._key,ye.exists(!0)))},t.prototype.delete=function(){return x("DocumentReference.delete",arguments,0),this._firestoreClient.write([new _e(this._key,ye.NONE)])},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];N("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!==typeof t[i]||oa(t[i])||(r=t[i],G("DocumentReference.onSnapshot",r,["includeMetadataChanges"]),L("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};return oa(t[i])?n=t[i]:(D("DocumentReference.onSnapshot","function",i,t[i]),j("DocumentReference.onSnapshot","function",i+1,t[i+1]),j("DocumentReference.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(o,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Yo({next:function(t){if(e.next){g(t.docs.size<=1,"Too many documents returned on a document query");var r=t.docs.get(n._key);e.next(new Fa(n.firestore,n._key,r,t.fromCache,t.hasPendingWrites))}},error:r}),o=this._firestoreClient.listen(Jt.atPath(this._key.path),i,t);return function(){i.mute(),n._firestoreClient.unlisten(o)}},t.prototype.get=function(t){var e=this;return N("DocumentReference.get",arguments,0,1),Ga("DocumentReference.get",t),new Promise(function(n,r){t&&"cache"===t.source?e.firestore.ensureClientConfigured().getDocumentFromLocalCache(e._key).then(function(t){n(new Fa(e.firestore,e._key,t,!0,t instanceof wt&&t.hasLocalMutations))},r):e.getViaSnapshotListener(n,r,t)})},t.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),!i.exists&&i.metadata.fromCache?e(new _(w.UNAVAILABLE,"Failed to get document because the client is offline.")):i.exists&&i.metadata.fromCache&&n&&"server"===n.source?e(new _(w.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):t(i)},error:e})},t}(),La=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Fa=function(){function t(t,e,n,r,i){this._firestore=t,this._key=e,this._document=n,this._fromCache=r,this._hasPendingWrites=i}return t.prototype.data=function(t){return N("DocumentSnapshot.data",arguments,0,1),t=za("DocumentSnapshot.data",t),this._document?this.convertObject(this._document.data,Ot.fromSnapshotOptions(t,this._firestore._areTimestampsInSnapshotsEnabled())):void 0},t.prototype.get=function(t,e){if(N("DocumentSnapshot.get",arguments,1,2),e=za("DocumentSnapshot.get",e),this._document){var n=this._document.data.field(Ea("DocumentSnapshot.get",t));if(void 0!==n)return this.convertValue(n,Ot.fromSnapshotOptions(e,this._firestore._areTimestampsInSnapshotsEnabled()))}},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Ma(this._key,this._firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this._document},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new La(this._hasPendingWrites,this._fromCache)},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw Q("isEqual","DocumentSnapshot",1,e);return this._firestore===e._firestore&&this._fromCache===e._fromCache&&this._key.isEqual(e._key)&&(null===this._document?null===e._document:this._document.isEqual(e._document))},t.prototype.convertObject=function(t,e){var n=this,r={};return t.forEach(function(t,i){r[t]=n.convertValue(i,e)}),r},t.prototype.convertValue=function(t,e){if(t instanceof qt)return this.convertObject(t,e);if(t instanceof Wt)return this.convertArray(t,e);if(t instanceof Bt){var n=t.value(e),r=this._firestore.ensureClientConfigured().databaseId();return t.databaseId.isEqual(r)||p("Document "+this._key.path+" contains a document reference within a different database ("+t.databaseId.projectId+"/"+t.databaseId.database+") which is not supported. It will be treated as a reference in the current database ("+r.projectId+"/"+r.database+") instead."),new Ma(n,this._firestore)}return t.value(e)},t.prototype.convertArray=function(t,e){var n=this;return t.internalValue.map(function(t){return n.convertValue(t,e)})},t}(),Va=function(t){function e(e,n,r,i,o){return t.call(this,e,n,r,i,o)||this}return s.__extends(e,t),e.prototype.data=function(e){var n=t.prototype.data.call(this,e);return g("object"===typeof n,"Document in a QueryDocumentSnapshot should exist"),n},e}(Fa),Ba=function(){function t(t,e){this._query=t,this.firestore=e}return t.prototype.where=function(e,n,r){var i;x("Query.where",arguments,3),D("Query.where","non-empty string",2,n),z("Query.where",3,r);var o=Ea("Query.where",e),a=Zt.fromString(n);if(o.isKeyField()){if(a===Zt.ARRAY_CONTAINS)throw new _(w.INVALID_ARGUMENT,"Invalid Query. You can't perform array-contains queries on FieldPath.documentId() since document IDs are not arrays.");if("string"===typeof r){if(-1!==r.indexOf("/"))throw new _(w.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a valid document ID if the first parameter is FieldPath.documentId(), but it contains a slash.");if(""===r)throw new _(w.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a valid document ID if the first parameter is FieldPath.documentId(), but it was an empty string.");var s=this._query.path.child(new vt([r]));g(s.length%2===0,"Path should be a document key"),i=new Bt(this.firestore._databaseId,new mt(s))}else{if(!(r instanceof Ma))throw new _(w.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a string or a DocumentReference if the first parameter is FieldPath.documentId(), but it was: "+K(r)+".");var u=r;i=new Bt(this.firestore._databaseId,u._key)}}else i=this.firestore._dataConverter.parseQueryValue("Query.where",r);var c=$t.create(o,a,i);return this.validateNewFilter(c),new t(this._query.addFilter(c),this.firestore)},t.prototype.orderBy=function(e,n){var r;if(N("Query.orderBy",arguments,1,2),j("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)r=re.ASCENDING;else{if("desc"!==n)throw new _(w.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r=re.DESCENDING}if(null!==this._query.startAt)throw new _(w.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this._query.endAt)throw new _(w.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=Ea("Query.orderBy",e),o=new oe(i,r);return this.validateNewOrderBy(o),new t(this._query.addOrderBy(o),this.firestore)},t.prototype.limit=function(e){if(x("Query.limit",arguments,1),D("Query.limit","number",1,e),e<=0)throw new _(w.INVALID_ARGUMENT,"Invalid Query. Query limit ("+e+") is invalid. Limit must be positive.");return new t(this._query.withLimit(e),this.firestore)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];P("Query.startAt",arguments,1);var i=this.boundFromDocOrFields("Query.startAt",e,n,!0);return new t(this._query.withStartAt(i),this.firestore)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];P("Query.startAfter",arguments,1);var i=this.boundFromDocOrFields("Query.startAfter",e,n,!1);return new t(this._query.withStartAt(i),this.firestore)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];P("Query.endBefore",arguments,1);var i=this.boundFromDocOrFields("Query.endBefore",e,n,!0);return new t(this._query.withEndAt(i),this.firestore)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];P("Query.endAt",arguments,1);var i=this.boundFromDocOrFields("Query.endAt",e,n,!1);return new t(this._query.withEndAt(i),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw Q("isEqual","Query",1,e);return this.firestore===e.firestore&&this._query.isEqual(e._query)},t.prototype.boundFromDocOrFields=function(t,e,n,r){if(z(t,1,e),e instanceof Fa){if(n.length>0)throw new _(w.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new _(w.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.boundFromDocument(t,i._document,r)}var o=[e].concat(n);return this.boundFromFields(t,o,r)},t.prototype.boundFromDocument=function(t,e,n){for(var r=[],i=0,o=this._query.orderBy;i<o.length;i++){var a=o[i];if(a.field.isKeyField())r.push(new Bt(this.firestore._databaseId,e.key));else{var s=e.field(a.field);if(void 0===s){var u=a.field.canonicalString();throw new _(w.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}r.push(s)}}return new ie(r,n)},t.prototype.boundFromFields=function(t,e,n){var r=this._query.explicitOrderBy;if(e.length>r.length)throw new _(w.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var a=e[o],s=r[o];if(s.field.isKeyField()){if("string"!==typeof a)throw new _(w.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof a);if(-1!==a.indexOf("/"))throw new _(w.INVALID_ARGUMENT,"Invalid query. Document ID '"+a+"' contains a slash in "+t+"()");var u=new mt(this._query.path.child(a));i.push(new Bt(this.firestore._databaseId,u))}else{var c=this.firestore._dataConverter.parseQueryValue(t,a);i.push(c)}}return new ie(i,n)},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];N("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!==typeof t[i]||oa(t[i])||(r=t[i],G("Query.onSnapshot",r,["includeMetadataChanges"]),L("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),oa(t[i])?n=t[i]:(D("Query.onSnapshot","function",i,t[i]),j("Query.onSnapshot","function",i+1,t[i+1]),j("Query.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(r,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Yo({next:function(t){e.next&&e.next(new Ua(n.firestore,n._query,t))},error:r}),o=this.firestore.ensureClientConfigured(),a=o.listen(this._query,i,t);return function(){i.mute(),o.unlisten(a)}},t.prototype.get=function(t){var e=this;return N("Query.get",arguments,0,1),Ga("Query.get",t),new Promise(function(n,r){t&&"cache"===t.source?e.firestore.ensureClientConfigured().getDocumentsFromLocalCache(e._query).then(function(t){n(new Ua(e.firestore,e._query,t))},r):e.getViaSnapshotListener(n,r,t)})},t.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),i.metadata.fromCache&&n&&"server"===n.source?e(new _(w.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):t(i)},error:e})},t.prototype.validateNewFilter=function(t){if(t instanceof te)if(t.isInequality()){var e=this._query.getInequalityFilterField();if(null!==e&&!e.isEqual(t.field))throw new _(w.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+e.toString()+"' and '"+t.field.toString()+"'");var n=this._query.getFirstOrderByField();null!==n&&this.validateOrderByAndInequalityMatch(t.field,n)}else if(t.op===Zt.ARRAY_CONTAINS&&this._query.hasArrayContainsFilter())throw new _(w.INVALID_ARGUMENT,"Invalid query. Queries only support a single array-contains filter.")},t.prototype.validateNewOrderBy=function(t){if(null===this._query.getFirstOrderByField()){var e=this._query.getInequalityFilterField();null!==e&&this.validateOrderByAndInequalityMatch(e,t.field)}},t.prototype.validateOrderByAndInequalityMatch=function(t,e){if(!e.isEqual(t))throw new _(w.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},t}(),Ua=function(){function t(t,e,n){this._firestore=t,this._originalQuery=e,this._snapshot=n,this._cachedChanges=null,this._cachedChangesIncludeMetadataChanges=null,this.metadata=new La(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._snapshot.docs.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;N("QuerySnapshot.forEach",arguments,1,2),D("QuerySnapshot.forEach","function",1,t),this._snapshot.docs.forEach(function(r){t.call(e,n.convertToDocumentImpl(r))})},Object.defineProperty(t.prototype,"query",{get:function(){return new Ba(this._originalQuery,this._firestore)},enumerable:!0,configurable:!0}),t.prototype.docChanges=function(t){t&&(G("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),L("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this._snapshot.excludesMetadataChanges)throw new _(w.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=Ya(this._firestore,e,this._snapshot),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t.prototype.isEqual=function(e){if(!(e instanceof t))throw Q("isEqual","QuerySnapshot",1,e);return this._firestore===e._firestore&&this._originalQuery.isEqual(e._originalQuery)&&this._snapshot.isEqual(e._snapshot)},t.prototype.convertToDocumentImpl=function(t){return new Va(this._firestore,t.key,t,this.metadata.fromCache,this._snapshot.mutatedKeys.has(t.key))},t}();function qa(){throw new _(w.INVALID_ARGUMENT,'QuerySnapshot.docChanges has been changed from a property into a method, so usages like "querySnapshot.docChanges" should become "querySnapshot.docChanges()"')}var Wa=["length","forEach","map"].concat("undefined"!==typeof Symbol?[Symbol.iterator]:[]);Wa.forEach(function(t){try{Object.defineProperty(Ua.prototype.docChanges,t,{get:function(){return qa()}})}catch(e){}});var Ka=function(t){function e(e,n){var r=t.call(this,Jt.atPath(e),n)||this;if(e.length%2!==1)throw new _(w.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.canonicalString()+" has "+e.length);return r}return s.__extends(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._query.path.popLast();return t.isEmpty()?null:new Ma(new mt(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!0,configurable:!0}),e.prototype.doc=function(t){if(N("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=J.newId()),D("CollectionReference.doc","non-empty string",1,t),""===t)throw new _(w.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=vt.fromString(t);return Ma.forPath(this._query.path.child(e),this.firestore)},e.prototype.add=function(t){x("CollectionReference.add",arguments,1),D("CollectionReference.add","object",1,t);var e=this.doc();return e.set(t).then(function(){return e})},e}(Ba);function Ha(t,e){if(void 0===e)return{merge:!1};if(G(t,e,["merge","mergeFields"]),L(t,"boolean","merge",e.merge),V(t,"mergeFields","a string or a FieldPath",e.mergeFields,function(t){return"string"===typeof t||t instanceof Xo}),void 0!==e.mergeFields&&void 0!==e.merge)throw new _(w.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function za(t,e){return void 0===e?{}:(G(t,e,["serverTimestamps"]),U(t,"options","serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Ga(t,e){j(t,"object",1,e),e&&(G(t,e,["source"]),U(t,"options","source",e.source,["default","server","cache"]))}function Qa(t,e,n){if(e instanceof Ma){if(e.firestore!==n)throw new _(w.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Q(t,"DocumentReference",1,e)}function Ya(t,e,n){if(n.oldDocs.isEmpty()){var r,i=0;return n.docChanges.map(function(e){var o=new Va(t,e.doc.key,e.doc,n.fromCache,n.mutatedKeys.has(e.doc.key));return g(e.type===Ke.Added,"Invalid event type for first snapshot"),g(!r||n.query.docComparator(r,e.doc)<0,"Got added events in wrong order"),r=e.doc,{type:"added",doc:o,oldIndex:-1,newIndex:i++}})}var o=n.oldDocs;return n.docChanges.filter(function(t){return e||t.type!==Ke.Metadata}).map(function(e){var r=new Va(t,e.doc.key,e.doc,n.fromCache,n.mutatedKeys.has(e.doc.key)),i=-1,a=-1;return e.type!==Ke.Added&&(i=o.indexOf(e.doc.key),g(i>=0,"Index for document not found"),o=o.delete(e.doc.key)),e.type!==Ke.Removed&&(o=o.add(e.doc),a=o.indexOf(e.doc.key)),{type:Xa(e.type),doc:r,oldIndex:i,newIndex:a}})}function Xa(t){switch(t){case Ke.Added:return"added";case Ke.Modified:case Ke.Metadata:return"modified";case Ke.Removed:return"removed";default:return y("Unknown change type: "+t)}}var Ja=k(Ra,"Use firebase.firestore() instead."),$a=k(Da,"Use firebase.firestore().runTransaction() instead."),Za=k(ja,"Use firebase.firestore().batch() instead."),ts=k(Ma,"Use firebase.firestore().doc() instead."),es=k(Fa),ns=k(Va),rs=k(Ba),is=k(Ua),os=k(Ka,"Use firebase.firestore().collection() instead."),as={Firestore:Ja,GeoPoint:ut,Timestamp:ct,Blob:st,Transaction:$a,WriteBatch:Za,DocumentReference:ts,DocumentSnapshot:es,Query:rs,QueryDocumentSnapshot:ns,QuerySnapshot:is,CollectionReference:os,FieldPath:Xo,FieldValue:da,setLogLevel:Ra.setLogLevel,CACHE_SIZE_UNLIMITED:Ia};function ss(t){t.INTERNAL.registerService("firestore",function(t){return new Ra(t)},I(as))}function us(t){ss(t)}us(o),e.registerFirestore=us},e8dd:function(t,e,n){},ec30:function(t,e,n){"use strict";if(n("9e1e")){var r=n("2d00"),i=n("7726"),o=n("79e5"),a=n("5ca1"),s=n("0f88"),u=n("ed0b"),c=n("9b43"),l=n("f605"),h=n("4630"),f=n("32e9"),d=n("dcbc"),p=n("4588"),v=n("9def"),y=n("09fa"),g=n("77f1"),m=n("6a99"),b=n("69a8"),w=n("23c6"),_=n("d3f4"),k=n("4bf8"),E=n("33a4"),T=n("2aeb"),S=n("38fd"),C=n("9093").f,O=n("27ee"),A=n("ca5a"),I=n("2b4c"),x=n("0a49"),P=n("c366"),N=n("ebd6"),R=n("cadf"),D=n("84f2"),j=n("5cc5"),M=n("7a56"),L=n("36bd"),F=n("ba92"),V=n("86cc"),B=n("11e9"),U=V.f,q=B.f,W=i.RangeError,K=i.TypeError,H=i.Uint8Array,z="ArrayBuffer",G="Shared"+z,Q="BYTES_PER_ELEMENT",Y="prototype",X=Array[Y],J=u.ArrayBuffer,$=u.DataView,Z=x(0),tt=x(2),et=x(3),nt=x(4),rt=x(5),it=x(6),ot=P(!0),at=P(!1),st=R.values,ut=R.keys,ct=R.entries,lt=X.lastIndexOf,ht=X.reduce,ft=X.reduceRight,dt=X.join,pt=X.sort,vt=X.slice,yt=X.toString,gt=X.toLocaleString,mt=I("iterator"),bt=I("toStringTag"),wt=A("typed_constructor"),_t=A("def_constructor"),kt=s.CONSTR,Et=s.TYPED,Tt=s.VIEW,St="Wrong length!",Ct=x(1,function(t,e){return Pt(N(t,t[_t]),e)}),Ot=o(function(){return 1===new H(new Uint16Array([1]).buffer)[0]}),At=!!H&&!!H[Y].set&&o(function(){new H(1).set({})}),It=function(t,e){var n=p(t);if(n<0||n%e)throw W("Wrong offset!");return n},xt=function(t){if(_(t)&&Et in t)return t;throw K(t+" is not a typed array!")},Pt=function(t,e){if(!(_(t)&&wt in t))throw K("It is not a typed array constructor!");return new t(e)},Nt=function(t,e){return Rt(N(t,t[_t]),e)},Rt=function(t,e){var n=0,r=e.length,i=Pt(t,r);while(r>n)i[n]=e[n++];return i},Dt=function(t,e,n){U(t,e,{get:function(){return this._d[n]}})},jt=function(t){var e,n,r,i,o,a,s=k(t),u=arguments.length,l=u>1?arguments[1]:void 0,h=void 0!==l,f=O(s);if(void 0!=f&&!E(f)){for(a=f.call(s),r=[],e=0;!(o=a.next()).done;e++)r.push(o.value);s=r}for(h&&u>2&&(l=c(l,arguments[2],2)),e=0,n=v(s.length),i=Pt(this,n);n>e;e++)i[e]=h?l(s[e],e):s[e];return i},Mt=function(){var t=0,e=arguments.length,n=Pt(this,e);while(e>t)n[t]=arguments[t++];return n},Lt=!!H&&o(function(){gt.call(new H(1))}),Ft=function(){return gt.apply(Lt?vt.call(xt(this)):xt(this),arguments)},Vt={copyWithin:function(t,e){return F.call(xt(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return nt(xt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return L.apply(xt(this),arguments)},filter:function(t){return Nt(this,tt(xt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return rt(xt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return it(xt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){Z(xt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return at(xt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return ot(xt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return dt.apply(xt(this),arguments)},lastIndexOf:function(t){return lt.apply(xt(this),arguments)},map:function(t){return Ct(xt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return ht.apply(xt(this),arguments)},reduceRight:function(t){return ft.apply(xt(this),arguments)},reverse:function(){var t,e=this,n=xt(e).length,r=Math.floor(n/2),i=0;while(i<r)t=e[i],e[i++]=e[--n],e[n]=t;return e},some:function(t){return et(xt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return pt.call(xt(this),t)},subarray:function(t,e){var n=xt(this),r=n.length,i=g(t,r);return new(N(n,n[_t]))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,v((void 0===e?r:g(e,r))-i))}},Bt=function(t,e){return Nt(this,vt.call(xt(this),t,e))},Ut=function(t){xt(this);var e=It(arguments[1],1),n=this.length,r=k(t),i=v(r.length),o=0;if(i+e>n)throw W(St);while(o<i)this[e+o]=r[o++]},qt={entries:function(){return ct.call(xt(this))},keys:function(){return ut.call(xt(this))},values:function(){return st.call(xt(this))}},Wt=function(t,e){return _(t)&&t[Et]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},Kt=function(t,e){return Wt(t,e=m(e,!0))?h(2,t[e]):q(t,e)},Ht=function(t,e,n){return!(Wt(t,e=m(e,!0))&&_(n)&&b(n,"value"))||b(n,"get")||b(n,"set")||n.configurable||b(n,"writable")&&!n.writable||b(n,"enumerable")&&!n.enumerable?U(t,e,n):(t[e]=n.value,t)};kt||(B.f=Kt,V.f=Ht),a(a.S+a.F*!kt,"Object",{getOwnPropertyDescriptor:Kt,defineProperty:Ht}),o(function(){yt.call({})})&&(yt=gt=function(){return dt.call(this)});var zt=d({},Vt);d(zt,qt),f(zt,mt,qt.values),d(zt,{slice:Bt,set:Ut,constructor:function(){},toString:yt,toLocaleString:Ft}),Dt(zt,"buffer","b"),Dt(zt,"byteOffset","o"),Dt(zt,"byteLength","l"),Dt(zt,"length","e"),U(zt,bt,{get:function(){return this[Et]}}),t.exports=function(t,e,n,u){u=!!u;var c=t+(u?"Clamped":"")+"Array",h="get"+t,d="set"+t,p=i[c],g=p||{},m=p&&S(p),b=!p||!s.ABV,k={},E=p&&p[Y],O=function(t,n){var r=t._d;return r.v[h](n*e+r.o,Ot)},A=function(t,n,r){var i=t._d;u&&(r=(r=Math.round(r))<0?0:r>255?255:255&r),i.v[d](n*e+i.o,r,Ot)},I=function(t,e){U(t,e,{get:function(){return O(this,e)},set:function(t){return A(this,e,t)},enumerable:!0})};b?(p=n(function(t,n,r,i){l(t,p,c,"_d");var o,a,s,u,h=0,d=0;if(_(n)){if(!(n instanceof J||(u=w(n))==z||u==G))return Et in n?Rt(p,n):jt.call(p,n);o=n,d=It(r,e);var g=n.byteLength;if(void 0===i){if(g%e)throw W(St);if(a=g-d,a<0)throw W(St)}else if(a=v(i)*e,a+d>g)throw W(St);s=a/e}else s=y(n),a=s*e,o=new J(a);f(t,"_d",{b:o,o:d,l:a,e:s,v:new $(o)});while(h<s)I(t,h++)}),E=p[Y]=T(zt),f(E,"constructor",p)):o(function(){p(1)})&&o(function(){new p(-1)})&&j(function(t){new p,new p(null),new p(1.5),new p(t)},!0)||(p=n(function(t,n,r,i){var o;return l(t,p,c),_(n)?n instanceof J||(o=w(n))==z||o==G?void 0!==i?new g(n,It(r,e),i):void 0!==r?new g(n,It(r,e)):new g(n):Et in n?Rt(p,n):jt.call(p,n):new g(y(n))}),Z(m!==Function.prototype?C(g).concat(C(m)):C(g),function(t){t in p||f(p,t,g[t])}),p[Y]=E,r||(E.constructor=p));var x=E[mt],P=!!x&&("values"==x.name||void 0==x.name),N=qt.values;f(p,wt,!0),f(E,Et,c),f(E,Tt,!0),f(E,_t,p),(u?new p(1)[bt]==c:bt in E)||U(E,bt,{get:function(){return c}}),k[c]=p,a(a.G+a.W+a.F*(p!=g),k),a(a.S,c,{BYTES_PER_ELEMENT:e}),a(a.S+a.F*o(function(){g.of.call(p,1)}),c,{from:jt,of:Mt}),Q in E||f(E,Q,e),a(a.P,c,Vt),M(c),a(a.P+a.F*At,c,{set:Ut}),a(a.P+a.F*!P,c,qt),r||E.toString==yt||(E.toString=yt),a(a.P+a.F*o(function(){new p(1).slice()}),c,{slice:Bt}),a(a.P+a.F*(o(function(){return[1,2].toLocaleString()!=new p([1,2]).toLocaleString()})||!o(function(){E.toLocaleString.call([1,2])})),c,{toLocaleString:Ft}),D[c]=P?x:N,r||P||f(E,mt,N)}}else t.exports=function(){}},ed0b:function(t,e,n){"use strict";var r=n("7726"),i=n("9e1e"),o=n("2d00"),a=n("0f88"),s=n("32e9"),u=n("dcbc"),c=n("79e5"),l=n("f605"),h=n("4588"),f=n("9def"),d=n("09fa"),p=n("9093").f,v=n("86cc").f,y=n("36bd"),g=n("7f20"),m="ArrayBuffer",b="DataView",w="prototype",_="Wrong length!",k="Wrong index!",E=r[m],T=r[b],S=r.Math,C=r.RangeError,O=r.Infinity,A=E,I=S.abs,x=S.pow,P=S.floor,N=S.log,R=S.LN2,D="buffer",j="byteLength",M="byteOffset",L=i?"_b":D,F=i?"_l":j,V=i?"_o":M;function B(t,e,n){var r,i,o,a=new Array(n),s=8*n-e-1,u=(1<<s)-1,c=u>>1,l=23===e?x(2,-24)-x(2,-77):0,h=0,f=t<0||0===t&&1/t<0?1:0;for(t=I(t),t!=t||t===O?(i=t!=t?1:0,r=u):(r=P(N(t)/R),t*(o=x(2,-r))<1&&(r--,o*=2),t+=r+c>=1?l/o:l*x(2,1-c),t*o>=2&&(r++,o/=2),r+c>=u?(i=0,r=u):r+c>=1?(i=(t*o-1)*x(2,e),r+=c):(i=t*x(2,c-1)*x(2,e),r=0));e>=8;a[h++]=255&i,i/=256,e-=8);for(r=r<<e|i,s+=e;s>0;a[h++]=255&r,r/=256,s-=8);return a[--h]|=128*f,a}function U(t,e,n){var r,i=8*n-e-1,o=(1<<i)-1,a=o>>1,s=i-7,u=n-1,c=t[u--],l=127&c;for(c>>=7;s>0;l=256*l+t[u],u--,s-=8);for(r=l&(1<<-s)-1,l>>=-s,s+=e;s>0;r=256*r+t[u],u--,s-=8);if(0===l)l=1-a;else{if(l===o)return r?NaN:c?-O:O;r+=x(2,e),l-=a}return(c?-1:1)*r*x(2,l-e)}function q(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function W(t){return[255&t]}function K(t){return[255&t,t>>8&255]}function H(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function z(t){return B(t,52,8)}function G(t){return B(t,23,4)}function Q(t,e,n){v(t[w],e,{get:function(){return this[n]}})}function Y(t,e,n,r){var i=+n,o=d(i);if(o+e>t[F])throw C(k);var a=t[L]._b,s=o+t[V],u=a.slice(s,s+e);return r?u:u.reverse()}function X(t,e,n,r,i,o){var a=+n,s=d(a);if(s+e>t[F])throw C(k);for(var u=t[L]._b,c=s+t[V],l=r(+i),h=0;h<e;h++)u[c+h]=l[o?h:e-h-1]}if(a.ABV){if(!c(function(){E(1)})||!c(function(){new E(-1)})||c(function(){return new E,new E(1.5),new E(NaN),E.name!=m})){E=function(t){return l(this,E),new A(d(t))};for(var J,$=E[w]=A[w],Z=p(A),tt=0;Z.length>tt;)(J=Z[tt++])in E||s(E,J,A[J]);o||($.constructor=E)}var et=new T(new E(2)),nt=T[w].setInt8;et.setInt8(0,2147483648),et.setInt8(1,2147483649),!et.getInt8(0)&&et.getInt8(1)||u(T[w],{setInt8:function(t,e){nt.call(this,t,e<<24>>24)},setUint8:function(t,e){nt.call(this,t,e<<24>>24)}},!0)}else E=function(t){l(this,E,m);var e=d(t);this._b=y.call(new Array(e),0),this[F]=e},T=function(t,e,n){l(this,T,b),l(t,E,b);var r=t[F],i=h(e);if(i<0||i>r)throw C("Wrong offset!");if(n=void 0===n?r-i:f(n),i+n>r)throw C(_);this[L]=t,this[V]=i,this[F]=n},i&&(Q(E,j,"_l"),Q(T,D,"_b"),Q(T,j,"_l"),Q(T,M,"_o")),u(T[w],{getInt8:function(t){return Y(this,1,t)[0]<<24>>24},getUint8:function(t){return Y(this,1,t)[0]},getInt16:function(t){var e=Y(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=Y(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return q(Y(this,4,t,arguments[1]))},getUint32:function(t){return q(Y(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return U(Y(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return U(Y(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){X(this,1,t,W,e)},setUint8:function(t,e){X(this,1,t,W,e)},setInt16:function(t,e){X(this,2,t,K,e,arguments[2])},setUint16:function(t,e){X(this,2,t,K,e,arguments[2])},setInt32:function(t,e){X(this,4,t,H,e,arguments[2])},setUint32:function(t,e){X(this,4,t,H,e,arguments[2])},setFloat32:function(t,e){X(this,4,t,G,e,arguments[2])},setFloat64:function(t,e){X(this,8,t,z,e,arguments[2])}});g(E,m),g(T,b),s(T[w],a.VIEW,!0),e[m]=E,e[b]=T},ed33:function(t,e,n){n("014b"),t.exports=n("584a").Object.getOwnPropertySymbols},f201:function(t,e,n){var r=n("e4ae"),i=n("79aa"),o=n("5168")("species");t.exports=function(t,e){var n,a=r(t).constructor;return void 0===a||void 0==(n=r(a)[o])?e:i(n)}},f228:function(t,e,n){var r=n("40c3"),i=n("4517");t.exports=function(t){return function(){if(r(this)!=t)throw TypeError(t+"#toJSON isn't generic");return i(this)}}},f2ea:function(t,e,n){"use strict";n("4917");var r=n("f499"),i=n.n(r),o=n("d225"),a=n("b0b4"),s=n("308d"),u=n("6bb5"),c=n("4e2b"),l=n("4aa6"),h=n.n(l),f=n("2d7d"),d=n.n(f),p=n("54b6");function v(t){return-1!==Function.toString.call(t).indexOf("[native code]")}var y=n("9a04");function g(t){var e="function"===typeof d.a?new d.a:void 0;return g=function(t){if(null===t||!v(t))return t;if("function"!==typeof t)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return Object(y["a"])(t,arguments,Object(u["a"])(this).constructor)}return n.prototype=h()(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Object(p["a"])(n,t)},g(t)}n.d(e,"b",function(){return b}),n.d(e,"a",function(){return w});
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
var m="https://ckeditor.com/docs/ckeditor5/latest/framework/guides/support/error-codes.html",b=function(t){function e(t,n){var r;return Object(o["a"])(this,e),t=w(t),n&&(t+=" "+i()(n)),r=Object(s["a"])(this,Object(u["a"])(e).call(this,t)),r.name="CKEditorError",r.data=n,r}return Object(c["a"])(e,t),Object(a["a"])(e,null,[{key:"isCKEditorError",value:function(t){return t instanceof e}}]),e}(g(Error));function w(t){var e=t.match(/^([^:]+):/);return e?t+" Read more: ".concat(m,"#error-").concat(e[1],"\n"):t}},f410:function(t,e,n){n("1af6"),t.exports=n("584a").Array.isArray},f499:function(t,e,n){t.exports=n("a21f")},f559:function(t,e,n){"use strict";var r=n("5ca1"),i=n("9def"),o=n("d2c8"),a="startsWith",s=""[a];r(r.P+r.F*n("5147")(a),"String",{startsWith:function(t){var e=o(this,t,a),n=i(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),r=String(t);return s?s.call(e,r,n):e.slice(n,n+r.length)===r}})},f5e9:function(t,e,n){},f820:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("ckeditor",{attrs:{editor:t.editor,config:t.editorConfig},model:{value:t.editorData,callback:function(e){t.editorData=e},expression:"editorData"}}),n("button",{attrs:{type:"button"},on:{click:t.show}},[t._v("click")])],1)},i=[],o=(n("7f7f"),n("795b")),a=n.n(o);n("96cf");function s(t,e,n,r,i,o,s){try{var u=t[o](s),c=u.value}catch(l){return void n(l)}u.done?e(c):a.a.resolve(c).then(r,i)}function u(t){return function(){var e=this,n=arguments;return new a.a(function(r,i){var o=t.apply(e,n);function a(t){s(o,r,i,a,u,"next",t)}function u(t){s(o,r,i,a,u,"throw",t)}a(void 0)})}}var c=n("d225"),l=n("b0b4"),h=n("8aa5"),f=n.n(h),d={apiKey:"AIzaSyBg5_ZISebZkorGZA3NT2ZO7LuTHDNNUWQ",authDomain:"gaesory-ec24c.firebaseapp.com",databaseURL:"https://gaesory-ec24c.firebaseio.com",projectId:"gaesory-ec24c",storageBucket:"gaesory-ec24c.appspot.com",messagingSenderId:"752962651932"};f.a.initializeApp(d);var p=f.a.storage(),v=function(){function t(e,n){Object(c["a"])(this,t),this.loader=e,this.url=n}return Object(l["a"])(t,[{key:"upload",value:function(){var t=u(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new a.a(function(t,e){t({default:"https://www.naver.com"})}));case 1:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},{key:"abort",value:function(){this.xhr&&this.xhr.abort()}},{key:"_initRequest",value:function(){var t=this.xhr=new XMLHttpRequest;t.open("POST",this.url,!0),t.responseType="json"}},{key:"_initListeners",value:function(t,e){var n=this.xhr,r=this.loader,i="Couldn't upload file:"+" ".concat(r.file.name,".");n.addEventListener("error",function(){return e(i)}),n.addEventListener("abort",function(){return e()}),n.addEventListener("load",function(){var r=n.response;if(!r||r.error)return e(r&&r.error?r.error.message:i);t({default:r.url})}),n.upload&&n.upload.addEventListener("progress",function(t){t.lengthComputable&&(r.uploadTotal=t.total,r.uploaded=t.loaded)})}},{key:"_sendRequest",value:function(){var t=u(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=new FormData,e.append("upload",this.loader.file),t.next=4,p.ref().child("ssasdf").put(this.loader.file);case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()}]),t}();function y(t){t.plugins.get("FileRepository").createUploadAdapter=function(t){return new v(t,"gs://gaesory-ec24c.appspot.com/jaejong")}}var g=y,m=(n("a481"),n("308d")),b=n("6bb5"),w=n("268f"),_=n.n(w),k=n("8feb"),E=n.n(k);function T(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=Object(b["a"])(t),null===t)break;return t}function S(t,e,n){return S="undefined"!==typeof Reflect&&E.a?E.a:function(t,e,n){var r=T(t,e);if(r){var i=_()(r,e);return i.get?i.get.call(n):i.value}},S(t,e,n||t)}var C=n("4e2b"),O=n("013f"),A=n("a4bb"),I=n.n(A),x=(n("ac6a"),n("5d73")),P=n.n(x),N=(n("28a5"),n("26ee")),R=N["a"].Symbol,D=R,j=Object.prototype,M=j.hasOwnProperty,L=j.toString,F=D?D.toStringTag:void 0;function V(t){var e=M.call(t,F),n=t[F];try{t[F]=void 0;var r=!0}catch(o){}var i=L.call(t);return r&&(e?t[F]=n:delete t[F]),i}var B=V,U=Object.prototype,q=U.toString;function W(t){return q.call(t)}var K=W,H="[object Null]",z="[object Undefined]",G=D?D.toStringTag:void 0;function Q(t){return null==t?void 0===t?z:H:G&&G in Object(t)?B(t):K(t)}var Y=Q;function X(t,e){return function(n){return t(e(n))}}var J=X,$=J(Object.getPrototypeOf,Object),Z=$;function tt(t){return null!=t&&"object"==typeof t}var et=tt,nt="[object Object]",rt=Function.prototype,it=Object.prototype,ot=rt.toString,at=it.hasOwnProperty,st=ot.call(Object);function ut(t){if(!et(t)||Y(t)!=nt)return!1;var e=Z(t);if(null===e)return!0;var n=at.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&ot.call(n)==st}var ct=ut,lt=function(){function t(e,n){Object(c["a"])(this,t),this._config={},n&&this.define(n),e&&this._setObjectToTarget(this._config,e)}return Object(l["a"])(t,[{key:"set",value:function(t,e){this._setToTarget(this._config,t,e)}},{key:"define",value:function(t,e){var n=!0;this._setToTarget(this._config,t,e,n)}},{key:"get",value:function(t){return this._getFromSource(this._config,t)}},{key:"_setToTarget",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(ct(e))this._setObjectToTarget(t,e,r);else{var i=e.split(".");e=i.pop();var o=!0,a=!1,s=void 0;try{for(var u,c=P()(i);!(o=(u=c.next()).done);o=!0){var l=u.value;ct(t[l])||(t[l]={}),t=t[l]}}catch(h){a=!0,s=h}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}if(ct(n))return ct(t[e])||(t[e]={}),t=t[e],void this._setObjectToTarget(t,n,r);r&&"undefined"!=typeof t[e]||(t[e]=n)}}},{key:"_getFromSource",value:function(t,e){var n=e.split(".");e=n.pop();var r=!0,i=!1,o=void 0;try{for(var a,s=P()(n);!(r=(a=s.next()).done);r=!0){var u=a.value;if(!ct(t[u])){t=null;break}t=t[u]}}catch(c){i=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return t?t[e]:void 0}},{key:"_setObjectToTarget",value:function(t,e,n){var r=this;I()(e).forEach(function(i){r._setToTarget(t,i,e[i],n)})}}]),t}(),ht=n("67bb"),ft=n.n(ht),dt=n("a745"),pt=n.n(dt);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function vt(t){if(pt()(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}var yt=n("774e"),gt=n.n(yt),mt=n("c8bb"),bt=n.n(mt);function wt(t){if(bt()(Object(t))||"[object Arguments]"===Object.prototype.toString.call(t))return gt()(t)}function _t(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function kt(t){return vt(t)||wt(t)||_t()}n("55dd"),n("4917");var Et=n("9a04");function Tt(t){if(pt()(t))return t}function St(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=P()(t);!(r=(a=s.next()).done);r=!0)if(n.push(a.value),e&&n.length===e)break}catch(u){i=!0,o=u}finally{try{r||null==s["return"]||s["return"]()}finally{if(i)throw o}}return n}function Ct(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function Ot(t,e){return Tt(t)||St(t,e)||Ct()}var At=n("2d7d"),It=n.n(At),xt=n("b6d0"),Pt=n.n(xt),Nt=n("f2ea");
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
function Rt(){return function t(){t.called=!0}}var Dt=Rt,jt=function t(e,n){Object(c["a"])(this,t),this.source=e,this.name=n,this.path=[],this.stop=Dt(),this.off=Dt()};
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */n("6b54");
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
function Mt(){for(var t="e",e=0;e<8;e++)t+=Math.floor(65536*(1+Math.random())).toString(16).substring(1);return t}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Lt={get:function(t){return"number"!=typeof t?this[t]||this.normal:t},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5},Ft=Lt,Vt=ft()("listeningTo"),Bt=ft()("emitterId"),Ut={on:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.listenTo(this,t,e,n)},once:function(t,e,n){var r=function(t){t.off();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e.call.apply(e,[this,t].concat(r))};this.listenTo(this,t,r,n)},off:function(t,e){this.stopListening(this,t,e)},listenTo:function(t,e,n){var r,i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this[Vt]||(this[Vt]={});var a=this[Vt];Ht(t)||Kt(t);var s=Ht(t);(r=a[s])||(r=a[s]={emitter:t,callbacks:{}}),(i=r.callbacks[e])||(i=r.callbacks[e]=[]),i.push(n),Qt(t,e);var u=Yt(t,e),c=Ft.get(o.priority),l={callback:n,priority:c},h=!0,f=!1,d=void 0;try{for(var p,v=P()(u);!(h=(p=v.next()).done);h=!0){for(var y=p.value,g=!1,m=0;m<y.length;m++)if(y[m].priority<c){y.splice(m,0,l),g=!0;break}g||y.push(l)}}catch(b){f=!0,d=b}finally{try{h||null==v.return||v.return()}finally{if(f)throw d}}},stopListening:function(t,e,n){var r=this[Vt],i=t&&Ht(t),o=r&&i&&r[i],a=o&&e&&o.callbacks[e];if(!(!r||t&&!o||e&&!a))if(n)$t(t,e,n);else if(a){while(n=a.pop())$t(t,e,n);delete o.callbacks[e]}else if(o){for(e in o.callbacks)this.stopListening(t,e);delete r[i]}else{for(i in r)this.stopListening(r[i].emitter);delete this[Vt]}},fire:function(t){var e=t instanceof jt?t:new jt(this,t),n=e.name,r=Xt(this,n);e.path.push(this);for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];if(r){var s=[e].concat(o);r=gt()(r);for(var u=0;u<r.length;u++)if(r[u].callback.apply(this,s),e.off.called&&(delete e.off.called,$t(this,n,r[u].callback)),e.stop.called)break}if(this._delegations){var c=this._delegations.get(n),l=this._delegations.get("*");c&&Jt(c,e,o),l&&Jt(l,e,o)}return e.return},delegate:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return{to:function(e,r){t._delegations||(t._delegations=new It.a);for(var i=0;i<n.length;i++){var o=n[i],a=t._delegations.get(o);a?a.set(e,r):t._delegations.set(o,new It.a([[e,r]]))}}}},stopDelegating:function(t,e){if(this._delegations)if(t)if(e){var n=this._delegations.get(t);n&&n.delete(e)}else this._delegations.delete(t);else this._delegations.clear()}},qt=Ut;function Wt(t,e){return t[Vt]&&t[Vt][e]?t[Vt][e].emitter:null}function Kt(t,e){t[Bt]||(t[Bt]=e||Mt())}function Ht(t){return t[Bt]}function zt(t){return t._events||Object.defineProperty(t,"_events",{value:{}}),t._events}function Gt(){return{callbacks:[],childEvents:[]}}function Qt(t,e){var n=zt(t);if(!n[e]){var r=e,i=null,o=[];while(""!==r){if(n[r])break;n[r]=Gt(),o.push(n[r]),i&&n[r].childEvents.push(i),i=r,r=r.substr(0,r.lastIndexOf(":"))}if(""!==r){for(var a=0;a<o.length;a++){var s=o[a];s.callbacks=n[r].callbacks.slice()}n[r].childEvents.push(i)}}}function Yt(t,e){var n=zt(t)[e];if(!n)return[];for(var r=[n.callbacks],i=0;i<n.childEvents.length;i++){var o=Yt(t,n.childEvents[i]);r=r.concat(o)}return r}function Xt(t,e){var n;return t._events&&(n=t._events[e])&&n.callbacks.length?n.callbacks:e.indexOf(":")>-1?Xt(t,e.substr(0,e.lastIndexOf(":"))):null}function Jt(t,e,n){var r=!0,i=!1,o=void 0;try{for(var a,s=P()(t);!(r=(a=s.next()).done);r=!0){var u=Ot(a.value,2),c=u[0],l=u[1];l?"function"==typeof l&&(l=l(e.name)):l=e.name;var h=new jt(e.source,l);h.path=kt(e.path),c.fire.apply(c,[h].concat(kt(n)))}}catch(f){i=!0,o=f}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}function $t(t,e,n){var r=Yt(t,e),i=!0,o=!1,a=void 0;try{for(var s,u=P()(r);!(i=(s=u.next()).done);i=!0)for(var c=s.value,l=0;l<c.length;l++)c[l].callback==n&&(c.splice(l,1),l--)}catch(h){o=!0,a=h}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}}var Zt=n("85f2"),te=n.n(Zt),ee=n("e265"),ne=n.n(ee),re=n("03cc"),ie=n.n(re);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
function oe(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];n.forEach(function(e){ie()(e).concat(ne()(e)).forEach(function(n){if(!(n in t.prototype)){var r=_()(e,n);r.enumerable=!1,te()(t.prototype,n,r)}})})}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function ae(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++)if(t[r]!=e[r])return r;return t.length==e.length?"same":t.length<e.length?"prefix":"extension"}function se(){this.__data__=[],this.size=0}var ue=se;function ce(t,e){return t===e||t!==t&&e!==e}var le=ce;function he(t,e){var n=t.length;while(n--)if(le(t[n][0],e))return n;return-1}var fe=he,de=Array.prototype,pe=de.splice;function ve(t){var e=this.__data__,n=fe(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():pe.call(e,n,1),--this.size,!0}var ye=ve;function ge(t){var e=this.__data__,n=fe(e,t);return n<0?void 0:e[n][1]}var me=ge;function be(t){return fe(this.__data__,t)>-1}var we=be;function _e(t,e){var n=this.__data__,r=fe(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}var ke=_e;function Ee(t){var e=-1,n=null==t?0:t.length;this.clear();while(++e<n){var r=t[e];this.set(r[0],r[1])}}Ee.prototype.clear=ue,Ee.prototype["delete"]=ye,Ee.prototype.get=me,Ee.prototype.has=we,Ee.prototype.set=ke;var Te=Ee;function Se(){this.__data__=new Te,this.size=0}var Ce=Se;function Oe(t){var e=this.__data__,n=e["delete"](t);return this.size=e.size,n}var Ae=Oe;function Ie(t){return this.__data__.get(t)}var xe=Ie;function Pe(t){return this.__data__.has(t)}var Ne=Pe;function Re(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var De=Re,je="[object AsyncFunction]",Me="[object Function]",Le="[object GeneratorFunction]",Fe="[object Proxy]";function Ve(t){if(!De(t))return!1;var e=Y(t);return e==Me||e==Le||e==je||e==Fe}var Be=Ve,Ue=N["a"]["__core-js_shared__"],qe=Ue,We=function(){var t=/[^.]+$/.exec(qe&&qe.keys&&qe.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Ke(t){return!!We&&We in t}var He=Ke,ze=Function.prototype,Ge=ze.toString;function Qe(t){if(null!=t){try{return Ge.call(t)}catch(e){}try{return t+""}catch(e){}}return""}var Ye=Qe,Xe=/[\\^$.*+?()[\]{}|]/g,Je=/^\[object .+?Constructor\]$/,$e=Function.prototype,Ze=Object.prototype,tn=$e.toString,en=Ze.hasOwnProperty,nn=RegExp("^"+tn.call(en).replace(Xe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function rn(t){if(!De(t)||He(t))return!1;var e=Be(t)?nn:Je;return e.test(Ye(t))}var on=rn;function an(t,e){return null==t?void 0:t[e]}var sn=an;function un(t,e){var n=sn(t,e);return on(n)?n:void 0}var cn=un,ln=cn(N["a"],"Map"),hn=ln,fn=cn(Object,"create"),dn=fn;function pn(){this.__data__=dn?dn(null):{},this.size=0}var vn=pn;function yn(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var gn=yn,mn="__lodash_hash_undefined__",bn=Object.prototype,wn=bn.hasOwnProperty;function _n(t){var e=this.__data__;if(dn){var n=e[t];return n===mn?void 0:n}return wn.call(e,t)?e[t]:void 0}var kn=_n,En=Object.prototype,Tn=En.hasOwnProperty;function Sn(t){var e=this.__data__;return dn?void 0!==e[t]:Tn.call(e,t)}var Cn=Sn,On="__lodash_hash_undefined__";function An(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=dn&&void 0===e?On:e,this}var In=An;function xn(t){var e=-1,n=null==t?0:t.length;this.clear();while(++e<n){var r=t[e];this.set(r[0],r[1])}}xn.prototype.clear=vn,xn.prototype["delete"]=gn,xn.prototype.get=kn,xn.prototype.has=Cn,xn.prototype.set=In;var Pn=xn;function Nn(){this.size=0,this.__data__={hash:new Pn,map:new(hn||Te),string:new Pn}}var Rn=Nn;function Dn(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}var jn=Dn;function Mn(t,e){var n=t.__data__;return jn(e)?n["string"==typeof e?"string":"hash"]:n.map}var Ln=Mn;function Fn(t){var e=Ln(this,t)["delete"](t);return this.size-=e?1:0,e}var Vn=Fn;function Bn(t){return Ln(this,t).get(t)}var Un=Bn;function qn(t){return Ln(this,t).has(t)}var Wn=qn;function Kn(t,e){var n=Ln(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}var Hn=Kn;function zn(t){var e=-1,n=null==t?0:t.length;this.clear();while(++e<n){var r=t[e];this.set(r[0],r[1])}}zn.prototype.clear=Rn,zn.prototype["delete"]=Vn,zn.prototype.get=Un,zn.prototype.has=Wn,zn.prototype.set=Hn;var Gn=zn,Qn=200;function Yn(t,e){var n=this.__data__;if(n instanceof Te){var r=n.__data__;if(!hn||r.length<Qn-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Gn(r)}return n.set(t,e),this.size=n.size,this}var Xn=Yn;function Jn(t){var e=this.__data__=new Te(t);this.size=e.size}Jn.prototype.clear=Ce,Jn.prototype["delete"]=Ae,Jn.prototype.get=xe,Jn.prototype.has=Ne,Jn.prototype.set=Xn;var $n=Jn;function Zn(t,e){var n=-1,r=null==t?0:t.length;while(++n<r)if(!1===e(t[n],n,t))break;return t}var tr=Zn,er=function(){try{var t=cn(Object,"defineProperty");return t({},"",{}),t}catch(e){}}(),nr=er;function rr(t,e,n){"__proto__"==e&&nr?nr(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}var ir=rr,or=Object.prototype,ar=or.hasOwnProperty;function sr(t,e,n){var r=t[e];ar.call(t,e)&&le(r,n)&&(void 0!==n||e in t)||ir(t,e,n)}var ur=sr;function cr(t,e,n,r){var i=!n;n||(n={});var o=-1,a=e.length;while(++o<a){var s=e[o],u=r?r(n[s],t[s],s,n,t):void 0;void 0===u&&(u=t[s]),i?ir(n,s,u):ur(n,s,u)}return n}var lr=cr;function hr(t,e){var n=-1,r=Array(t);while(++n<t)r[n]=e(n);return r}var fr=hr,dr="[object Arguments]";function pr(t){return et(t)&&Y(t)==dr}var vr=pr,yr=Object.prototype,gr=yr.hasOwnProperty,mr=yr.propertyIsEnumerable,br=vr(function(){return arguments}())?vr:function(t){return et(t)&&gr.call(t,"callee")&&!mr.call(t,"callee")},wr=br,_r=Array.isArray,kr=_r,Er=n("58e0"),Tr=9007199254740991,Sr=/^(?:0|[1-9]\d*)$/;function Cr(t,e){var n=typeof t;return e=null==e?Tr:e,!!e&&("number"==n||"symbol"!=n&&Sr.test(t))&&t>-1&&t%1==0&&t<e}var Or=Cr,Ar=9007199254740991;function Ir(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Ar}var xr=Ir,Pr="[object Arguments]",Nr="[object Array]",Rr="[object Boolean]",Dr="[object Date]",jr="[object Error]",Mr="[object Function]",Lr="[object Map]",Fr="[object Number]",Vr="[object Object]",Br="[object RegExp]",Ur="[object Set]",qr="[object String]",Wr="[object WeakMap]",Kr="[object ArrayBuffer]",Hr="[object DataView]",zr="[object Float32Array]",Gr="[object Float64Array]",Qr="[object Int8Array]",Yr="[object Int16Array]",Xr="[object Int32Array]",Jr="[object Uint8Array]",$r="[object Uint8ClampedArray]",Zr="[object Uint16Array]",ti="[object Uint32Array]",ei={};function ni(t){return et(t)&&xr(t.length)&&!!ei[Y(t)]}ei[zr]=ei[Gr]=ei[Qr]=ei[Yr]=ei[Xr]=ei[Jr]=ei[$r]=ei[Zr]=ei[ti]=!0,ei[Pr]=ei[Nr]=ei[Kr]=ei[Rr]=ei[Hr]=ei[Dr]=ei[jr]=ei[Mr]=ei[Lr]=ei[Fr]=ei[Vr]=ei[Br]=ei[Ur]=ei[qr]=ei[Wr]=!1;var ri=ni;function ii(t){return function(e){return t(e)}}var oi=ii,ai=n("c6eb"),si=ai["a"]&&ai["a"].isTypedArray,ui=si?oi(si):ri,ci=ui,li=Object.prototype,hi=li.hasOwnProperty;function fi(t,e){var n=kr(t),r=!n&&wr(t),i=!n&&!r&&Object(Er["a"])(t),o=!n&&!r&&!i&&ci(t),a=n||r||i||o,s=a?fr(t.length,String):[],u=s.length;for(var c in t)!e&&!hi.call(t,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Or(c,u))||s.push(c);return s}var di=fi,pi=Object.prototype;function vi(t){var e=t&&t.constructor,n="function"==typeof e&&e.prototype||pi;return t===n}var yi=vi,gi=J(Object.keys,Object),mi=gi,bi=Object.prototype,wi=bi.hasOwnProperty;function _i(t){if(!yi(t))return mi(t);var e=[];for(var n in Object(t))wi.call(t,n)&&"constructor"!=n&&e.push(n);return e}var ki=_i;function Ei(t){return null!=t&&xr(t.length)&&!Be(t)}var Ti=Ei;function Si(t){return Ti(t)?di(t):ki(t)}var Ci=Si;function Oi(t,e){return t&&lr(e,Ci(e),t)}var Ai=Oi;function Ii(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}var xi=Ii,Pi=Object.prototype,Ni=Pi.hasOwnProperty;function Ri(t){if(!De(t))return xi(t);var e=yi(t),n=[];for(var r in t)("constructor"!=r||!e&&Ni.call(t,r))&&n.push(r);return n}var Di=Ri;function ji(t){return Ti(t)?di(t,!0):Di(t)}var Mi=ji;function Li(t,e){return t&&lr(e,Mi(e),t)}var Fi=Li,Vi=n("dff1");function Bi(t,e){var n=-1,r=t.length;e||(e=Array(r));while(++n<r)e[n]=t[n];return e}var Ui=Bi;function qi(t,e){var n=-1,r=null==t?0:t.length,i=0,o=[];while(++n<r){var a=t[n];e(a,n,t)&&(o[i++]=a)}return o}var Wi=qi;function Ki(){return[]}var Hi=Ki,zi=Object.prototype,Gi=zi.propertyIsEnumerable,Qi=Object.getOwnPropertySymbols,Yi=Qi?function(t){return null==t?[]:(t=Object(t),Wi(Qi(t),function(e){return Gi.call(t,e)}))}:Hi,Xi=Yi;function Ji(t,e){return lr(t,Xi(t),e)}var $i=Ji;function Zi(t,e){var n=-1,r=e.length,i=t.length;while(++n<r)t[i+n]=e[n];return t}var to=Zi,eo=Object.getOwnPropertySymbols,no=eo?function(t){var e=[];while(t)to(e,Xi(t)),t=Z(t);return e}:Hi,ro=no;function io(t,e){return lr(t,ro(t),e)}var oo=io;function ao(t,e,n){var r=e(t);return kr(t)?r:to(r,n(t))}var so=ao;function uo(t){return so(t,Ci,Xi)}var co=uo;function lo(t){return so(t,Mi,ro)}var ho=lo,fo=cn(N["a"],"DataView"),po=fo,vo=cn(N["a"],"Promise"),yo=vo,go=cn(N["a"],"Set"),mo=go,bo=cn(N["a"],"WeakMap"),wo=bo,_o="[object Map]",ko="[object Object]",Eo="[object Promise]",To="[object Set]",So="[object WeakMap]",Co="[object DataView]",Oo=Ye(po),Ao=Ye(hn),Io=Ye(yo),xo=Ye(mo),Po=Ye(wo),No=Y;(po&&No(new po(new ArrayBuffer(1)))!=Co||hn&&No(new hn)!=_o||yo&&No(yo.resolve())!=Eo||mo&&No(new mo)!=To||wo&&No(new wo)!=So)&&(No=function(t){var e=Y(t),n=e==ko?t.constructor:void 0,r=n?Ye(n):"";if(r)switch(r){case Oo:return Co;case Ao:return _o;case Io:return Eo;case xo:return To;case Po:return So}return e});var Ro=No,Do=Object.prototype,jo=Do.hasOwnProperty;function Mo(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&jo.call(t,"index")&&(n.index=t.index,n.input=t.input),n}var Lo=Mo,Fo=N["a"].Uint8Array,Vo=Fo;function Bo(t){var e=new t.constructor(t.byteLength);return new Vo(e).set(new Vo(t)),e}var Uo=Bo;function qo(t,e){var n=e?Uo(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}var Wo=qo,Ko=/\w*$/;function Ho(t){var e=new t.constructor(t.source,Ko.exec(t));return e.lastIndex=t.lastIndex,e}var zo=Ho,Go=D?D.prototype:void 0,Qo=Go?Go.valueOf:void 0;function Yo(t){return Qo?Object(Qo.call(t)):{}}var Xo=Yo;function Jo(t,e){var n=e?Uo(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}var $o=Jo,Zo="[object Boolean]",ta="[object Date]",ea="[object Map]",na="[object Number]",ra="[object RegExp]",ia="[object Set]",oa="[object String]",aa="[object Symbol]",sa="[object ArrayBuffer]",ua="[object DataView]",ca="[object Float32Array]",la="[object Float64Array]",ha="[object Int8Array]",fa="[object Int16Array]",da="[object Int32Array]",pa="[object Uint8Array]",va="[object Uint8ClampedArray]",ya="[object Uint16Array]",ga="[object Uint32Array]";function ma(t,e,n){var r=t.constructor;switch(e){case sa:return Uo(t);case Zo:case ta:return new r(+t);case ua:return Wo(t,n);case ca:case la:case ha:case fa:case da:case pa:case va:case ya:case ga:return $o(t,n);case ea:return new r;case na:case oa:return new r(t);case ra:return zo(t);case ia:return new r;case aa:return Xo(t)}}var ba=ma,wa=Object.create,_a=function(){function t(){}return function(e){if(!De(e))return{};if(wa)return wa(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}(),ka=_a;function Ea(t){return"function"!=typeof t.constructor||yi(t)?{}:ka(Z(t))}var Ta=Ea,Sa="[object Map]";function Ca(t){return et(t)&&Ro(t)==Sa}var Oa=Ca,Aa=ai["a"]&&ai["a"].isMap,Ia=Aa?oi(Aa):Oa,xa=Ia,Pa="[object Set]";function Na(t){return et(t)&&Ro(t)==Pa}var Ra=Na,Da=ai["a"]&&ai["a"].isSet,ja=Da?oi(Da):Ra,Ma=ja,La=1,Fa=2,Va=4,Ba="[object Arguments]",Ua="[object Array]",qa="[object Boolean]",Wa="[object Date]",Ka="[object Error]",Ha="[object Function]",za="[object GeneratorFunction]",Ga="[object Map]",Qa="[object Number]",Ya="[object Object]",Xa="[object RegExp]",Ja="[object Set]",$a="[object String]",Za="[object Symbol]",ts="[object WeakMap]",es="[object ArrayBuffer]",ns="[object DataView]",rs="[object Float32Array]",is="[object Float64Array]",os="[object Int8Array]",as="[object Int16Array]",ss="[object Int32Array]",us="[object Uint8Array]",cs="[object Uint8ClampedArray]",ls="[object Uint16Array]",hs="[object Uint32Array]",fs={};function ds(t,e,n,r,i,o){var a,s=e&La,u=e&Fa,c=e&Va;if(n&&(a=i?n(t,r,i,o):n(t)),void 0!==a)return a;if(!De(t))return t;var l=kr(t);if(l){if(a=Lo(t),!s)return Ui(t,a)}else{var h=Ro(t),f=h==Ha||h==za;if(Object(Er["a"])(t))return Object(Vi["a"])(t,s);if(h==Ya||h==Ba||f&&!i){if(a=u||f?{}:Ta(t),!s)return u?oo(t,Fi(a,t)):$i(t,Ai(a,t))}else{if(!fs[h])return i?t:{};a=ba(t,h,s)}}o||(o=new $n);var d=o.get(t);if(d)return d;if(o.set(t,a),Ma(t))return t.forEach(function(r){a.add(ds(r,e,n,r,t,o))}),a;if(xa(t))return t.forEach(function(r,i){a.set(i,ds(r,e,n,i,t,o))}),a;var p=c?u?ho:co:u?keysIn:Ci,v=l?void 0:p(t);return tr(v||t,function(r,i){v&&(i=r,r=t[i]),ur(a,i,ds(r,e,n,i,t,o))}),a}fs[Ba]=fs[Ua]=fs[es]=fs[ns]=fs[qa]=fs[Wa]=fs[rs]=fs[is]=fs[os]=fs[as]=fs[ss]=fs[Ga]=fs[Qa]=fs[Ya]=fs[Xa]=fs[Ja]=fs[$a]=fs[Za]=fs[us]=fs[cs]=fs[ls]=fs[hs]=!0,fs[Ka]=fs[Ha]=fs[ts]=!1;var ps=ds,vs=4;function ys(t){return ps(t,vs)}var gs=ys,ms=function(){function t(){Object(c["a"])(this,t),this.parent=null}return Object(l["a"])(t,[{key:"getPath",value:function(){var t=[],e=this;while(e.parent)t.unshift(e.index),e=e.parent;return t}},{key:"getAncestors",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{includeSelf:!1,parentFirst:!1},e=[],n=t.includeSelf?this:this.parent;while(n)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}},{key:"getCommonAncestor",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getAncestors(e),r=t.getAncestors(e),i=0;while(n[i]==r[i]&&n[i])i++;return 0===i?null:n[i-1]}},{key:"isBefore",value:function(t){if(this==t)return!1;if(this.root!==t.root)return!1;var e=this.getPath(),n=t.getPath(),r=ae(e,n);switch(r){case"prefix":return!0;case"extension":return!1;default:return e[r]<n[r]}}},{key:"isAfter",value:function(t){return this!=t&&(this.root===t.root&&!this.isBefore(t))}},{key:"_remove",value:function(){this.parent._removeChildren(this.index)}},{key:"_fireChange",value:function(t,e){this.fire("change:"+t,e),this.parent&&this.parent._fireChange(t,e)}},{key:"toJSON",value:function(){var t=gs(this);return delete t.parent,t}},{key:"is",value:function(t){return"node"==t}},{key:"index",get:function(){var t;if(!this.parent)return null;if(-1==(t=this.parent.getChildIndex(this)))throw new Nt["b"]("view-node-not-found-in-parent: The node's parent does not contain this node.");return t}},{key:"nextSibling",get:function(){var t=this.index;return null!==t&&this.parent.getChild(t+1)||null}},{key:"previousSibling",get:function(){var t=this.index;return null!==t&&this.parent.getChild(t-1)||null}},{key:"root",get:function(){var t=this;while(t.parent)t=t.parent;return t}},{key:"document",get:function(){return this.parent instanceof t?this.parent.document:null}}]),t}();
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */oe(ms,qt);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
var bs=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this)),n._textData=t,n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"is",value:function(t){return"text"==t||S(Object(b["a"])(e.prototype),"is",this).call(this,t)}},{key:"isSimilar",value:function(t){return t instanceof e&&(this===t||this.data===t.data)}},{key:"_clone",value:function(){return new e(this.data)}},{key:"data",get:function(){return this._textData}},{key:"_data",get:function(){return this.data},set:function(t){this._fireChange("text",this),this._textData=t}}]),e}(ms),ws=function(){function t(e,n,r){if(Object(c["a"])(this,t),this.textNode=e,n<0||n>e.data.length)throw new Nt["b"]("view-textproxy-wrong-offsetintext: Given offsetInText value is incorrect.");if(r<0||n+r>e.data.length)throw new Nt["b"]("view-textproxy-wrong-length: Given length value is incorrect.");this.data=e.data.substring(n,n+r),this.offsetInText=n}return Object(l["a"])(t,[{key:"is",value:function(t){return"textProxy"==t}},{key:"getAncestors",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{includeSelf:!1,parentFirst:!1},e=[],n=t.includeSelf?this.textNode:this.parent;while(null!==n)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}},{key:"offsetSize",get:function(){return this.data.length}},{key:"isPartial",get:function(){return this.data.length!==this.textNode.data.length}},{key:"parent",get:function(){return this.textNode.parent}},{key:"root",get:function(){return this.textNode.root}},{key:"document",get:function(){return this.textNode.document}}]),t}();
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
function _s(t){var e=new It.a;for(var n in t)e.set(n,t[n]);return e}var ks=n("5d58"),Es=n.n(ks);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
function Ts(t){return!(!t||!t[Es.a])}n("3b2b");
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Ss=function(){function t(){Object(c["a"])(this,t),this._patterns=[],this.add.apply(this,arguments)}return Object(l["a"])(t,[{key:"add",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++){var i=e[r];("string"==typeof i||i instanceof RegExp)&&(i={name:i}),i.classes&&("string"==typeof i.classes||i.classes instanceof RegExp)&&(i.classes=[i.classes]),this._patterns.push(i)}}},{key:"match",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++){var i=e[r],o=!0,a=!1,s=void 0;try{for(var u,c=P()(this._patterns);!(o=(u=c.next()).done);o=!0){var l=u.value,h=Cs(i,l);if(h)return{element:i,pattern:l,match:h}}}catch(f){a=!0,s=f}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}}return null}},{key:"matchAll",value:function(){for(var t=[],e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(var i=0;i<n.length;i++){var o=n[i],a=!0,s=!1,u=void 0;try{for(var c,l=P()(this._patterns);!(a=(c=l.next()).done);a=!0){var h=c.value,f=Cs(o,h);f&&t.push({element:o,pattern:h,match:f})}}catch(d){s=!0,u=d}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}}return t.length>0?t:null}},{key:"getElementName",value:function(){if(1!==this._patterns.length)return null;var t=this._patterns[0],e=t.name;return"function"==typeof t||!e||e instanceof RegExp?null:e}}]),t}();function Cs(t,e){if("function"==typeof e)return e(t);var n={};return e.name&&(n.name=Os(e.name,t.name),!n.name)?null:e.attributes&&(n.attributes=As(e.attributes,t),!n.attributes)?null:!(e.classes&&(n.classes=Is(e.classes,t),!n.classes))&&(!(e.styles&&(n.styles=xs(e.styles,t),!n.styles))&&n)}function Os(t,e){return t instanceof RegExp?t.test(e):t===e}function As(t,e){var n=[];for(var r in t){var i=t[r];if(!e.hasAttribute(r))return null;var o=e.getAttribute(r);if(!0===i)n.push(r);else if(i instanceof RegExp){if(!i.test(o))return null;n.push(r)}else{if(o!==i)return null;n.push(r)}}return n}function Is(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=P()(t);!(r=(a=s.next()).done);r=!0){var u=a.value;if(u instanceof RegExp){var c=e.getClassNames(),l=!0,h=!1,f=void 0;try{for(var d,p=P()(c);!(l=(d=p.next()).done);l=!0){var v=d.value;u.test(v)&&n.push(v)}}catch(y){h=!0,f=y}finally{try{l||null==p.return||p.return()}finally{if(h)throw f}}if(0===n.length)return null}else{if(!e.hasClass(u))return null;n.push(u)}}}catch(y){i=!0,o=y}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}function xs(t,e){var n=[];for(var r in t){var i=t[r];if(!e.hasStyle(r))return null;var o=e.getStyle(r);if(i instanceof RegExp){if(!i.test(o))return null;n.push(r)}else{if(o!==i)return null;n.push(r)}}return n}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Ps=function(t){function e(t,n,r){var i;if(Object(c["a"])(this,e),i=Object(m["a"])(this,Object(b["a"])(e).call(this)),i.name=t,i._attrs=Ns(n),i._children=[],r&&i._insertChild(0,r),i._classes=new Pt.a,i._attrs.has("class")){var o=i._attrs.get("class");Ds(i._classes,o),i._attrs.delete("class")}return i._styles=new It.a,i._attrs.has("style")&&(Rs(i._styles,i._attrs.get("style")),i._attrs.delete("style")),i._customProperties=new It.a,i}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"is",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return n?"element"==t&&n==this.name:"element"==t||t==this.name||S(Object(b["a"])(e.prototype),"is",this).call(this,t)}},{key:"getChild",value:function(t){return this._children[t]}},{key:"getChildIndex",value:function(t){return this._children.indexOf(t)}},{key:"getChildren",value:function(){return P()(this._children)}},{key:"getAttributeKeys",value:regeneratorRuntime.mark(function t(){var e,n,r,i,o,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!(this._classes.size>0)){t.next=3;break}return t.next=3,"class";case 3:if(!(this._styles.size>0)){t.next=6;break}return t.next=6,"style";case 6:e=!0,n=!1,r=void 0,t.prev=9,i=P()(this._attrs.keys());case 11:if(e=(o=i.next()).done){t.next=18;break}return a=o.value,t.next=15,a;case 15:e=!0,t.next=11;break;case 18:t.next=24;break;case 20:t.prev=20,t.t0=t["catch"](9),n=!0,r=t.t0;case 24:t.prev=24,t.prev=25,e||null==i.return||i.return();case 27:if(t.prev=27,!n){t.next=30;break}throw r;case 30:return t.finish(27);case 31:return t.finish(24);case 32:case"end":return t.stop()}},t,this,[[9,20,24,32],[25,,27,31]])})},{key:"getAttributes",value:regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.delegateYield(this._attrs.entries(),"t0",1);case 1:if(!(this._classes.size>0)){t.next=4;break}return t.next=4,["class",this.getAttribute("class")];case 4:if(!(this._styles.size>0)){t.next=7;break}return t.next=7,["style",this.getAttribute("style")];case 7:case"end":return t.stop()}},t,this)})},{key:"getAttribute",value:function(t){if("class"==t)return this._classes.size>0?kt(this._classes).join(" "):void 0;if("style"!=t)return this._attrs.get(t);if(this._styles.size>0){var e="",n=!0,r=!1,i=void 0;try{for(var o,a=P()(this._styles);!(n=(o=a.next()).done);n=!0){var s=Ot(o.value,2),u=s[0],c=s[1];e+="".concat(u,":").concat(c,";")}}catch(l){r=!0,i=l}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}}},{key:"hasAttribute",value:function(t){return"class"==t?this._classes.size>0:"style"==t?this._styles.size>0:this._attrs.has(t)}},{key:"isSimilar",value:function(t){if(!(t instanceof e))return!1;if(this===t)return!0;if(this.name!=t.name)return!1;if(this._attrs.size!==t._attrs.size||this._classes.size!==t._classes.size||this._styles.size!==t._styles.size)return!1;var n=!0,r=!1,i=void 0;try{for(var o,a=P()(this._attrs);!(n=(o=a.next()).done);n=!0){var s=Ot(o.value,2),u=s[0],c=s[1];if(!t._attrs.has(u)||t._attrs.get(u)!==c)return!1}}catch(E){r=!0,i=E}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}var l=!0,h=!1,f=void 0;try{for(var d,p=P()(this._classes);!(l=(d=p.next()).done);l=!0){var v=d.value;if(!t._classes.has(v))return!1}}catch(E){h=!0,f=E}finally{try{l||null==p.return||p.return()}finally{if(h)throw f}}var y=!0,g=!1,m=void 0;try{for(var b,w=P()(this._styles);!(y=(b=w.next()).done);y=!0){var _=Ot(b.value,2),k=_[0];c=_[1];if(!t._styles.has(k)||t._styles.get(k)!==c)return!1}}catch(E){g=!0,m=E}finally{try{y||null==w.return||w.return()}finally{if(g)throw m}}return!0}},{key:"hasClass",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++){var i=e[r];if(!this._classes.has(i))return!1}return!0}},{key:"getClassNames",value:function(){return this._classes.keys()}},{key:"getStyle",value:function(t){return this._styles.get(t)}},{key:"getStyleNames",value:function(){return this._styles.keys()}},{key:"hasStyle",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++){var i=e[r];if(!this._styles.has(i))return!1}return!0}},{key:"findAncestor",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=Object(Et["a"])(Ss,e),i=this.parent;while(i){if(r.match(i))return i;i=i.parent}return null}},{key:"getCustomProperty",value:function(t){return this._customProperties.get(t)}},{key:"getCustomProperties",value:regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.delegateYield(this._customProperties.entries(),"t0",1);case 1:case"end":return t.stop()}},t,this)})},{key:"getIdentity",value:function(){var t=gt()(this._classes).sort().join(","),e=gt()(this._styles).map(function(t){return"".concat(t[0],":").concat(t[1])}).sort().join(";"),n=gt()(this._attrs).map(function(t){return"".concat(t[0],'="').concat(t[1],'"')}).sort().join(" ");return this.name+(""==t?"":' class="'.concat(t,'"'))+(""==e?"":' style="'.concat(e,'"'))+(""==n?"":" ".concat(n))}},{key:"_clone",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=[];if(t){var n=!0,r=!1,i=void 0;try{for(var o,a=P()(this.getChildren());!(n=(o=a.next()).done);n=!0){var s=o.value;e.push(s._clone(t))}}catch(c){r=!0,i=c}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}var u=new this.constructor(this.name,this._attrs,e);return u._classes=new Pt.a(this._classes),u._styles=new It.a(this._styles),u._customProperties=new It.a(this._customProperties),u.getFillerOffset=this.getFillerOffset,u}},{key:"_appendChild",value:function(t){return this._insertChild(this.childCount,t)}},{key:"_insertChild",value:function(t,e){this._fireChange("children",this);var n=0,r=js(e),i=!0,o=!1,a=void 0;try{for(var s,u=P()(r);!(i=(s=u.next()).done);i=!0){var c=s.value;null!==c.parent&&c._remove(),c.parent=this,this._children.splice(t,0,c),t++,n++}}catch(l){o=!0,a=l}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}return n}},{key:"_removeChildren",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this._fireChange("children",this);for(var n=t;n<t+e;n++)this._children[n].parent=null;return this._children.splice(t,e)}},{key:"_setAttribute",value:function(t,e){e=String(e),this._fireChange("attributes",this),"class"==t?Ds(this._classes,e):"style"==t?Rs(this._styles,e):this._attrs.set(t,e)}},{key:"_removeAttribute",value:function(t){return this._fireChange("attributes",this),"class"==t?this._classes.size>0&&(this._classes.clear(),!0):"style"==t?this._styles.size>0&&(this._styles.clear(),!0):this._attrs.delete(t)}},{key:"_addClass",value:function(t){var e=this;this._fireChange("attributes",this),t=pt()(t)?t:[t],t.forEach(function(t){return e._classes.add(t)})}},{key:"_removeClass",value:function(t){var e=this;this._fireChange("attributes",this),t=pt()(t)?t:[t],t.forEach(function(t){return e._classes.delete(t)})}},{key:"_setStyle",value:function(t,e){if(this._fireChange("attributes",this),ct(t)){var n=I()(t),r=!0,i=!1,o=void 0;try{for(var a,s=P()(n);!(r=(a=s.next()).done);r=!0){var u=a.value;this._styles.set(u,t[u])}}catch(c){i=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}else this._styles.set(t,e)}},{key:"_removeStyle",value:function(t){var e=this;this._fireChange("attributes",this),t=pt()(t)?t:[t],t.forEach(function(t){return e._styles.delete(t)})}},{key:"_setCustomProperty",value:function(t,e){this._customProperties.set(t,e)}},{key:"_removeCustomProperty",value:function(t){return this._customProperties.delete(t)}},{key:"childCount",get:function(){return this._children.length}},{key:"isEmpty",get:function(){return 0===this._children.length}}]),e}(ms);function Ns(t){t=ct(t)?_s(t):new It.a(t);var e=!0,n=!1,r=void 0;try{for(var i,o=P()(t);!(e=(i=o.next()).done);e=!0){var a=Ot(i.value,2),s=a[0],u=a[1];null===u?t.delete(s):"string"!=typeof u&&t.set(s,String(u))}}catch(c){n=!0,r=c}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return t}function Rs(t,e){var n=null,r=0,i=0,o=null;if(t.clear(),""!==e){";"!=e.charAt(e.length-1)&&(e+=";");for(var a=0;a<e.length;a++){var s=e.charAt(a);if(null===n)switch(s){case":":o||(o=e.substr(r,a-r),i=a+1);break;case'"':case"'":n=s;break;case";":var u=e.substr(i,a-i);o&&t.set(o.trim(),u.trim()),o=null,r=a+1;break}else s===n&&(n=null)}}}function Ds(t,e){var n=e.split(/\s+/);t.clear(),n.forEach(function(e){return t.add(e)})}function js(t){return"string"==typeof t?[new bs(t)]:(Ts(t)||(t=[t]),gt()(t).map(function(t){return"string"==typeof t?new bs(t):t instanceof ws?new bs(t.data):t}))}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Ms=function(t){function e(t,n,r){var i;return Object(c["a"])(this,e),i=Object(m["a"])(this,Object(b["a"])(e).call(this,t,n,r)),i.getFillerOffset=Ls,i}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"is",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return n?"containerElement"==t&&n==this.name||S(Object(b["a"])(e.prototype),"is",this).call(this,t,n):"containerElement"==t||S(Object(b["a"])(e.prototype),"is",this).call(this,t)}}]),e}(Ps);function Ls(){var t=kt(this.getChildren()),e=t[this.childCount-1];if(e&&e.is("element","br"))return this.childCount;var n=!0,r=!1,i=void 0;try{for(var o,a=P()(t);!(n=(o=a.next()).done);n=!0){var s=o.value;if(!s.is("uiElement"))return null}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return this.childCount}var Fs=n("7618");function Vs(t){return t}var Bs=Vs;function Us(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}var qs=Us,Ws=Math.max;function Ks(t,e,n){return e=Ws(void 0===e?t.length-1:e,0),function(){var r=arguments,i=-1,o=Ws(r.length-e,0),a=Array(o);while(++i<o)a[i]=r[e+i];i=-1;var s=Array(e+1);while(++i<e)s[i]=r[i];return s[e]=n(a),qs(t,this,s)}}var Hs=Ks;function zs(t){return function(){return t}}var Gs=zs,Qs=nr?function(t,e){return nr(t,"toString",{configurable:!0,enumerable:!1,value:Gs(e),writable:!0})}:Bs,Ys=Qs,Xs=800,Js=16,$s=Date.now;function Zs(t){var e=0,n=0;return function(){var r=$s(),i=Js-(r-n);if(n=r,i>0){if(++e>=Xs)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var tu=Zs,eu=tu(Ys),nu=eu;function ru(t,e){return nu(Hs(t,e,Bs),t+"")}var iu=ru;function ou(t,e,n){if(!De(n))return!1;var r=typeof e;return!!("number"==r?Ti(n)&&Or(e,n.length):"string"==r&&e in n)&&le(n[e],t)}var au=ou;function su(t){return iu(function(e,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;o=t.length>3&&"function"==typeof o?(i--,o):void 0,a&&au(n[0],n[1],a)&&(o=i<3?void 0:o,i=1),e=Object(e);while(++r<i){var s=n[r];s&&t(e,s,r,o)}return e})}var uu=su,cu=uu(function(t,e){lr(e,Mi(e),t)}),lu=cu,hu=ft()("observableProperties"),fu=ft()("boundObservables"),du=ft()("boundProperties"),pu={set:function(t,e){var n=this;if(De(t))I()(t).forEach(function(e){n.set(e,t[e])},this);else{yu(this);var r=this[hu];if(t in this&&!r.has(t))throw new Nt["b"]("observable-set-cannot-override: Cannot override an existing property.");te()(this,t,{enumerable:!0,configurable:!0,get:function(){return r.get(t)},set:function(e){var n=r.get(t),i=this.fire("set:"+t,t,e,n);void 0===i&&(i=e),n===i&&r.has(t)||(r.set(t,i),this.fire("change:"+t,t,i,n))}}),this[t]=e}},bind:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if(!e.length||!wu(e))throw new Nt["b"]("observable-bind-wrong-properties: All properties must be strings.");if(new Pt.a(e).size!==e.length)throw new Nt["b"]("observable-bind-duplicate-properties: Properties must be unique.");yu(this);var r=this[du];e.forEach(function(t){if(r.has(t))throw new Nt["b"]("observable-bind-rebind: Cannot bind the same property more that once.")});var i=new It.a;return e.forEach(function(t){var e={property:t,to:[]};r.set(t,e),i.set(t,e)}),{to:gu,toMany:mu,_observable:this,_bindProperties:e,_to:[],_bindings:i}},unbind:function(){var t=this;if(hu in this){for(var e=this[du],n=this[fu],r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];if(i.length){if(!wu(i))throw new Nt["b"]("observable-unbind-wrong-properties: Properties must be strings.");i.forEach(function(r){var i,o,a,s,u=e.get(r);u&&(u.to.forEach(function(e){i=e[0],o=e[1],a=n.get(i),s=a[o],s.delete(u),s.size||delete a[o],I()(a).length||(n.delete(i),t.stopListening(i,"change"))}),e.delete(r))})}else n.forEach(function(e,n){t.stopListening(n,"change")}),n.clear(),e.clear()}},decorate:function(t){var e=this,n=this[t];if(!n)throw new Nt["b"]("observablemixin-cannot-decorate-undefined: Cannot decorate an undefined method.",{object:this,methodName:t});this.on(t,function(t,r){t.return=n.apply(e,r)}),this[t]=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.fire(t,n)}}};lu(pu,qt);var vu=pu;function yu(t){hu in t||(te()(t,hu,{value:new It.a}),te()(t,fu,{value:new It.a}),te()(t,du,{value:new It.a}))}function gu(){var t=this,e=_u.apply(void 0,arguments),n=gt()(this._bindings.keys()),r=n.length;if(!e.callback&&e.to.length>1)throw new Nt["b"]("observable-bind-to-no-callback: Binding multiple observables only possible with callback.");if(r>1&&e.callback)throw new Nt["b"]("observable-bind-to-extra-callback: Cannot bind multiple properties and use a callback in one binding.");e.to.forEach(function(e){if(e.properties.length&&e.properties.length!==r)throw new Nt["b"]("observable-bind-to-properties-length: The number of properties must match.");e.properties.length||(e.properties=t._bindProperties)}),this._to=e.to,e.callback&&(this._bindings.get(n[0]).callback=e.callback),Su(this._observable,this._to),Eu(this),this._bindProperties.forEach(function(e){Tu(t._observable,e)})}function mu(t,e,n){if(this._bindings.size>1)throw new Nt["b"]("observable-bind-to-many-not-one-binding: Cannot bind multiple properties with toMany().");this.to.apply(this,kt(bu(t,e)).concat([n]))}function bu(t,e){var n=t.map(function(t){return[t,e]});return Array.prototype.concat.apply([],n)}function wu(t){return t.every(function(t){return"string"==typeof t})}function _u(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if(!e.length)throw new Nt["b"]("observable-bind-to-parse-error: Invalid argument syntax in `to()`.");var r,i={to:[]};return"function"==typeof e[e.length-1]&&(i.callback=e.pop()),e.forEach(function(t){if("string"==typeof t)r.properties.push(t);else{if("object"!=Object(Fs["a"])(t))throw new Nt["b"]("observable-bind-to-parse-error: Invalid argument syntax in `to()`.");r={observable:t,properties:[]},i.to.push(r)}}),i}function ku(t,e,n,r){var i=t[fu],o=i.get(n),a=o||{};a[r]||(a[r]=new Pt.a),a[r].add(e),o||i.set(n,a)}function Eu(t){var e;t._bindings.forEach(function(n,r){t._to.forEach(function(i){e=i.properties[n.callback?0:t._bindProperties.indexOf(r)],n.to.push([i.observable,e]),ku(t._observable,n,i.observable,e)})})}function Tu(t,e){var n,r=t[du],i=r.get(e);i.callback?n=i.callback.apply(t,i.to.map(function(t){return t[0][t[1]]})):(n=i.to[0],n=n[0][n[1]]),t.hasOwnProperty(e)?t[e]=n:t.set(e,n)}function Su(t,e){e.forEach(function(e){var n,r=t[fu];r.get(e.observable)||t.listenTo(e.observable,"change",function(i,o){n=r.get(e.observable)[o],n&&n.forEach(function(e){Tu(t,e.property)})})})}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Cu=ft()("document"),Ou=function(t){function e(t,n,r){var i;return Object(c["a"])(this,e),i=Object(m["a"])(this,Object(b["a"])(e).call(this,t,n,r)),i.set("isReadOnly",!1),i.set("isFocused",!1),i}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"is",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return n?"editableElement"==t&&n==this.name||S(Object(b["a"])(e.prototype),"is",this).call(this,t,n):"editableElement"==t||S(Object(b["a"])(e.prototype),"is",this).call(this,t)}},{key:"document",get:function(){return this.getCustomProperty(Cu)}},{key:"_document",set:function(t){var e=this;if(this.getCustomProperty(Cu))throw new Nt["b"]("view-editableelement-document-already-set: View document is already set.");this._setCustomProperty(Cu,t),this.bind("isReadOnly").to(t),this.bind("isFocused").to(t,"isFocused",function(n){return n&&t.selection.editableElement==e}),this.listenTo(t.selection,"change",function(){e.isFocused=t.isFocused&&t.selection.editableElement==e})}}]),e}(Ms);oe(Ou,vu);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
var Au=ft()("rootName"),Iu=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),n.rootName="main",n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"is",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return n?"rootElement"==t&&n==this.name||S(Object(b["a"])(e.prototype),"is",this).call(this,t,n):"rootElement"==t||S(Object(b["a"])(e.prototype),"is",this).call(this,t)}},{key:"rootName",get:function(){return this.getCustomProperty(Au)},set:function(t){this._setCustomProperty(Au,t)}},{key:"_name",set:function(t){this.name=t}}]),e}(Ou),xu=(n("8449"),function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object(c["a"])(this,t),!e.boundaries&&!e.startPosition)throw new Nt["b"]("view-tree-walker-no-start-position: Neither boundaries nor starting position have been defined.");if(e.direction&&"forward"!=e.direction&&"backward"!=e.direction)throw new Nt["b"]("view-tree-walker-unknown-direction: Only `backward` and `forward` direction allowed.",{direction:e.direction});this.boundaries=e.boundaries||null,e.startPosition?this.position=Pu._createAt(e.startPosition):this.position=Pu._createAt(e.boundaries["backward"==e.direction?"end":"start"]),this.direction=e.direction||"forward",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null}return Object(l["a"])(t,[{key:Es.a,value:function(){return this}},{key:"skip",value:function(t){var e,n,r;do{r=this.position;var i=this.next();e=i.done,n=i.value}while(!e&&t(n));e||(this.position=r)}},{key:"next",value:function(){return"forward"==this.direction?this._next():this._previous()}},{key:"_next",value:function(){var t,e=this.position.clone(),n=this.position,r=e.parent;if(null===r.parent&&e.offset===r.childCount)return{done:!0};if(r===this._boundaryEndParent&&e.offset==this.boundaries.end.offset)return{done:!0};if(r instanceof bs){if(e.isAtEnd)return this.position=Pu._createAfter(r),this._next();t=r.data[e.offset]}else t=r.getChild(e.offset);if(t instanceof Ps)return this.shallow?e.offset++:e=new Pu(t,0),this.position=e,this._formatReturnValue("elementStart",t,n,e,1);if(t instanceof bs){if(this.singleCharacters)return e=new Pu(t,0),this.position=e,this._next();var i,o=t.data.length;return t==this._boundaryEndParent?(o=this.boundaries.end.offset,i=new ws(t,0,o),e=Pu._createAfter(i)):(i=new ws(t,0,t.data.length),e.offset++),this.position=e,this._formatReturnValue("text",i,n,e,o)}if("string"==typeof t){var a;if(this.singleCharacters)a=1;else{var s=r===this._boundaryEndParent?this.boundaries.end.offset:r.data.length;a=s-e.offset}var u=new ws(r,e.offset,a);return e.offset+=a,this.position=e,this._formatReturnValue("text",u,n,e,a)}return e=Pu._createAfter(r),this.position=e,this.ignoreElementEnd?this._next():this._formatReturnValue("elementEnd",r,n,e)}},{key:"_previous",value:function(){var t,e=this.position.clone(),n=this.position,r=e.parent;if(null===r.parent&&0===e.offset)return{done:!0};if(r==this._boundaryStartParent&&e.offset==this.boundaries.start.offset)return{done:!0};if(r instanceof bs){if(e.isAtStart)return this.position=Pu._createBefore(r),this._previous();t=r.data[e.offset-1]}else t=r.getChild(e.offset-1);if(t instanceof Ps)return this.shallow?(e.offset--,this.position=e,this._formatReturnValue("elementStart",t,n,e,1)):(e=new Pu(t,t.childCount),this.position=e,this.ignoreElementEnd?this._previous():this._formatReturnValue("elementEnd",t,n,e));if(t instanceof bs){if(this.singleCharacters)return e=new Pu(t,t.data.length),this.position=e,this._previous();var i,o=t.data.length;if(t==this._boundaryStartParent){var a=this.boundaries.start.offset;i=new ws(t,a,t.data.length-a),o=i.data.length,e=Pu._createBefore(i)}else i=new ws(t,0,t.data.length),e.offset--;return this.position=e,this._formatReturnValue("text",i,n,e,o)}if("string"==typeof t){var s;if(this.singleCharacters)s=1;else{var u=r===this._boundaryStartParent?this.boundaries.start.offset:0;s=e.offset-u}e.offset-=s;var c=new ws(r,e.offset,s);return this.position=e,this._formatReturnValue("text",c,n,e,s)}return e=Pu._createBefore(r),this.position=e,this._formatReturnValue("elementStart",r,n,e,1)}},{key:"_formatReturnValue",value:function(t,e,n,r,i){return e instanceof ws&&(e.offsetInText+e.data.length==e.textNode.data.length&&("forward"!=this.direction||this.boundaries&&this.boundaries.end.isEqual(this.position)?n=Pu._createAfter(e.textNode):(r=Pu._createAfter(e.textNode),this.position=r)),0===e.offsetInText&&("backward"!=this.direction||this.boundaries&&this.boundaries.start.isEqual(this.position)?n=Pu._createBefore(e.textNode):(r=Pu._createBefore(e.textNode),this.position=r))),{done:!1,value:{type:t,item:e,previousPosition:n,nextPosition:r,length:i}}}}]),t}()),Pu=function(){function t(e,n){Object(c["a"])(this,t),this.parent=e,this.offset=n}return Object(l["a"])(t,[{key:"getShiftedBy",value:function(e){var n=t._createAt(this),r=n.offset+e;return n.offset=r<0?0:r,n}},{key:"getLastMatchingPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.startPosition=this;var n=new xu(e);return n.skip(t),n.position}},{key:"getAncestors",value:function(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}},{key:"getCommonAncestor",value:function(t){var e=this.getAncestors(),n=t.getAncestors(),r=0;while(e[r]==n[r]&&e[r])r++;return 0===r?null:e[r-1]}},{key:"isEqual",value:function(t){return this.parent==t.parent&&this.offset==t.offset}},{key:"isBefore",value:function(t){return"before"==this.compareWith(t)}},{key:"isAfter",value:function(t){return"after"==this.compareWith(t)}},{key:"compareWith",value:function(t){if(this.root!==t.root)return"different";if(this.isEqual(t))return"same";var e=this.parent.is("node")?this.parent.getPath():[],n=t.parent.is("node")?t.parent.getPath():[];e.push(this.offset),n.push(t.offset);var r=ae(e,n);switch(r){case"prefix":return"before";case"extension":return"after";default:return e[r]<n[r]?"before":"after"}}},{key:"getWalker",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.startPosition=this,new xu(t)}},{key:"clone",value:function(){return new t(this.parent,this.offset)}},{key:"nodeAfter",get:function(){return this.parent.is("text")?null:this.parent.getChild(this.offset)||null}},{key:"nodeBefore",get:function(){return this.parent.is("text")?null:this.parent.getChild(this.offset-1)||null}},{key:"isAtStart",get:function(){return 0===this.offset}},{key:"isAtEnd",get:function(){var t=this.parent.is("text")?this.parent.data.length:this.parent.childCount;return this.offset===t}},{key:"root",get:function(){return this.parent.root}},{key:"editableElement",get:function(){var t=this.parent;while(!(t instanceof Ou)){if(!t.parent)return null;t=t.parent}return t}}],[{key:"_createAt",value:function(e,n){if(e instanceof t)return new this(e.parent,e.offset);var r=e;if("end"==n)n=r.is("text")?r.data.length:r.childCount;else{if("before"==n)return this._createBefore(r);if("after"==n)return this._createAfter(r);if(0!==n&&!n)throw new Nt["b"]("view-createPositionAt-offset-required: View#createPositionAt() requires the offset when the first parameter is a view item.")}return new t(r,n)}},{key:"_createAfter",value:function(e){if(e.is("textProxy"))return new t(e.textNode,e.offsetInText+e.data.length);if(!e.parent)throw new Nt["b"]("view-position-after-root: You can not make position after root.",{root:e});return new t(e.parent,e.index+1)}},{key:"_createBefore",value:function(e){if(e.is("textProxy"))return new t(e.textNode,e.offsetInText);if(!e.parent)throw new Nt["b"]("view-position-before-root: You can not make position before root.",{root:e});return new t(e.parent,e.index)}}]),t}(),Nu=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(c["a"])(this,t),this.start=e.clone(),this.end=n?n.clone():e.clone()}return Object(l["a"])(t,[{key:Es.a,value:regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.delegateYield(new xu({boundaries:this,ignoreElementEnd:!0}),"t0",1);case 1:case"end":return t.stop()}},t,this)})},{key:"getEnlarged",value:function(){var e=this.start.getLastMatchingPosition(Ru,{direction:"backward"}),n=this.end.getLastMatchingPosition(Ru);return e.parent.is("text")&&e.isAtStart&&(e=Pu._createBefore(e.parent)),n.parent.is("text")&&n.isAtEnd&&(n=Pu._createAfter(n.parent)),new t(e,n)}},{key:"getTrimmed",value:function(){var e=this.start.getLastMatchingPosition(Ru);if(e.isAfter(this.end)||e.isEqual(this.end))return new t(e,e);var n=this.end.getLastMatchingPosition(Ru,{direction:"backward"}),r=e.nodeAfter,i=n.nodeBefore;return r&&r.is("text")&&(e=new Pu(r,0)),i&&i.is("text")&&(n=new Pu(i,i.data.length)),new t(e,n)}},{key:"isEqual",value:function(t){return this==t||this.start.isEqual(t.start)&&this.end.isEqual(t.end)}},{key:"containsPosition",value:function(t){return t.isAfter(this.start)&&t.isBefore(this.end)}},{key:"containsRange",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.isCollapsed&&(e=!1);var n=this.containsPosition(t.start)||e&&this.start.isEqual(t.start),r=this.containsPosition(t.end)||e&&this.end.isEqual(t.end);return n&&r}},{key:"getDifference",value:function(e){var n=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&n.push(new t(this.start,e.start)),this.containsPosition(e.end)&&n.push(new t(e.end,this.end))):n.push(this.clone()),n}},{key:"getIntersection",value:function(e){if(this.isIntersecting(e)){var n=this.start,r=this.end;return this.containsPosition(e.start)&&(n=e.start),this.containsPosition(e.end)&&(r=e.end),new t(n,r)}return null}},{key:"getWalker",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.boundaries=this,new xu(t)}},{key:"getCommonAncestor",value:function(){return this.start.getCommonAncestor(this.end)}},{key:"clone",value:function(){return new t(this.start,this.end)}},{key:"getItems",value:regeneratorRuntime.mark(function t(){var e,n,r,i,o,a,s,u,c=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e=c.length>0&&void 0!==c[0]?c[0]:{},e.boundaries=this,e.ignoreElementEnd=!0,n=new xu(e),r=!0,i=!1,o=void 0,t.prev=7,a=P()(n);case 9:if(r=(s=a.next()).done){t.next=16;break}return u=s.value,t.next=13,u.item;case 13:r=!0,t.next=9;break;case 16:t.next=22;break;case 18:t.prev=18,t.t0=t["catch"](7),i=!0,o=t.t0;case 22:t.prev=22,t.prev=23,r||null==a.return||a.return();case 25:if(t.prev=25,!i){t.next=28;break}throw o;case 28:return t.finish(25);case 29:return t.finish(22);case 30:case"end":return t.stop()}},t,this,[[7,18,22,30],[23,,25,29]])})},{key:"getPositions",value:regeneratorRuntime.mark(function t(){var e,n,r,i,o,a,s,u,c=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=c.length>0&&void 0!==c[0]?c[0]:{},e.boundaries=this,n=new xu(e),t.next=5,n.position;case 5:r=!0,i=!1,o=void 0,t.prev=8,a=P()(n);case 10:if(r=(s=a.next()).done){t.next=17;break}return u=s.value,t.next=14,u.nextPosition;case 14:r=!0,t.next=10;break;case 17:t.next=23;break;case 19:t.prev=19,t.t0=t["catch"](8),i=!0,o=t.t0;case 23:t.prev=23,t.prev=24,r||null==a.return||a.return();case 26:if(t.prev=26,!i){t.next=29;break}throw o;case 29:return t.finish(26);case 30:return t.finish(23);case 31:case"end":return t.stop()}},t,this,[[8,19,23,31],[24,,26,30]])})},{key:"isIntersecting",value:function(t){return this.start.isBefore(t.end)&&this.end.isAfter(t.start)}},{key:"isCollapsed",get:function(){return this.start.isEqual(this.end)}},{key:"isFlat",get:function(){return this.start.parent===this.end.parent}},{key:"root",get:function(){return this.start.root}}],[{key:"_createFromParentsAndOffsets",value:function(t,e,n,r){return new this(new Pu(t,e),new Pu(n,r))}},{key:"_createFromPositionAndShift",value:function(t,e){var n=t,r=t.getShiftedBy(e);return e>0?new this(n,r):new this(r,n)}},{key:"_createIn",value:function(t){return this._createFromParentsAndOffsets(t,0,t,t.childCount)}},{key:"_createOn",value:function(t){var e=t.is("textProxy")?t.offsetSize:1;return this._createFromPositionAndShift(Pu._createBefore(t),e)}}]),t}();function Ru(t){return!(!t.item.is("attributeElement")&&!t.item.is("uiElement"))}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function Du(t){var e=0,n=!0,r=!1,i=void 0;try{for(var o,a=P()(t);!(n=(o=a.next()).done);n=!0){o.value;e++}}catch(s){r=!0,i=s}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var ju=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;Object(c["a"])(this,t),this._ranges=[],this._lastRangeBackward=!1,this._isFake=!1,this._fakeSelectionLabel="",this.setTo(e,n,r)}return Object(l["a"])(t,[{key:"getRanges",value:regeneratorRuntime.mark(function t(){var e,n,r,i,o,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e=!0,n=!1,r=void 0,t.prev=3,i=P()(this._ranges);case 5:if(e=(o=i.next()).done){t.next=12;break}return a=o.value,t.next=9,a.clone();case 9:e=!0,t.next=5;break;case 12:t.next=18;break;case 14:t.prev=14,t.t0=t["catch"](3),n=!0,r=t.t0;case 18:t.prev=18,t.prev=19,e||null==i.return||i.return();case 21:if(t.prev=21,!n){t.next=24;break}throw r;case 24:return t.finish(21);case 25:return t.finish(18);case 26:case"end":return t.stop()}},t,this,[[3,14,18,26],[19,,21,25]])})},{key:"getFirstRange",value:function(){var t=null,e=!0,n=!1,r=void 0;try{for(var i,o=P()(this._ranges);!(e=(i=o.next()).done);e=!0){var a=i.value;t&&!a.start.isBefore(t.start)||(t=a)}}catch(s){n=!0,r=s}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return t?t.clone():null}},{key:"getLastRange",value:function(){var t=null,e=!0,n=!1,r=void 0;try{for(var i,o=P()(this._ranges);!(e=(i=o.next()).done);e=!0){var a=i.value;t&&!a.end.isAfter(t.end)||(t=a)}}catch(s){n=!0,r=s}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return t?t.clone():null}},{key:"getFirstPosition",value:function(){var t=this.getFirstRange();return t?t.start.clone():null}},{key:"getLastPosition",value:function(){var t=this.getLastRange();return t?t.end.clone():null}},{key:"isEqual",value:function(t){if(this.isFake!=t.isFake)return!1;if(this.isFake&&this.fakeSelectionLabel!=t.fakeSelectionLabel)return!1;if(this.rangeCount!=t.rangeCount)return!1;if(0===this.rangeCount)return!0;if(!this.anchor.isEqual(t.anchor)||!this.focus.isEqual(t.focus))return!1;var e=!0,n=!1,r=void 0;try{for(var i,o=P()(this._ranges);!(e=(i=o.next()).done);e=!0){var a=i.value,s=!1,u=!0,c=!1,l=void 0;try{for(var h,f=P()(t._ranges);!(u=(h=f.next()).done);u=!0){var d=h.value;if(a.isEqual(d)){s=!0;break}}}catch(p){c=!0,l=p}finally{try{u||null==f.return||f.return()}finally{if(c)throw l}}if(!s)return!1}}catch(p){n=!0,r=p}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return!0}},{key:"isSimilar",value:function(t){if(this.isBackward!=t.isBackward)return!1;var e=Du(this.getRanges()),n=Du(t.getRanges());if(e!=n)return!1;if(0==e)return!0;var r=!0,i=!1,o=void 0;try{for(var a,s=P()(this.getRanges());!(r=(a=s.next()).done);r=!0){var u=a.value;u=u.getTrimmed();var c=!1,l=!0,h=!1,f=void 0;try{for(var d,p=P()(t.getRanges());!(l=(d=p.next()).done);l=!0){var v=d.value;if(v=v.getTrimmed(),u.start.isEqual(v.start)&&u.end.isEqual(v.end)){c=!0;break}}}catch(y){h=!0,f=y}finally{try{l||null==p.return||p.return()}finally{if(h)throw f}}if(!c)return!1}}catch(y){i=!0,o=y}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return!0}},{key:"getSelectedElement",value:function(){if(1!==this.rangeCount)return null;var t=this.getFirstRange(),e=t.start.nodeAfter,n=t.end.nodeBefore;return e instanceof Ps&&e==n?e:null}},{key:"setTo",value:function(e,n,r){if(null===e)this._setRanges([]),this._setFakeOptions(n);else if(e instanceof t||e instanceof Mu)this._setRanges(e.getRanges(),e.isBackward),this._setFakeOptions({fake:e.isFake,label:e.fakeSelectionLabel});else if(e instanceof Nu)this._setRanges([e],n&&n.backward),this._setFakeOptions(n);else if(e instanceof Pu)this._setRanges([new Nu(e)]),this._setFakeOptions(n);else if(e instanceof ms){var i,o=!!r&&!!r.backward;if(void 0===n)throw new Nt["b"]("view-selection-setTo-required-second-parameter: selection.setTo requires the second parameter when the first parameter is a node.");i="in"==n?Nu._createIn(e):"on"==n?Nu._createOn(e):new Nu(Pu._createAt(e,n)),this._setRanges([i],o),this._setFakeOptions(r)}else{if(!Ts(e))throw new Nt["b"]("view-selection-setTo-not-selectable: Cannot set selection to given place.");this._setRanges(e,n&&n.backward),this._setFakeOptions(n)}this.fire("change")}},{key:"setFocus",value:function(t,e){if(null===this.anchor)throw new Nt["b"]("view-selection-setFocus-no-ranges: Cannot set selection focus if there are no ranges in selection.");var n=Pu._createAt(t,e);if("same"!=n.compareWith(this.focus)){var r=this.anchor;this._ranges.pop(),"before"==n.compareWith(r)?this._addRange(new Nu(n,r),!0):this._addRange(new Nu(r,n)),this.fire("change")}}},{key:"_setRanges",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t=gt()(t),this._ranges=[];var n=!0,r=!1,i=void 0;try{for(var o,a=P()(t);!(n=(o=a.next()).done);n=!0){var s=o.value;this._addRange(s)}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}this._lastRangeBackward=!!e}},{key:"_setFakeOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._isFake=!!t.fake,this._fakeSelectionLabel=t.fake&&t.label||""}},{key:"_addRange",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(t instanceof Nu))throw new Nt["b"]("view-selection-add-range-not-range: Selection range set to an object that is not an instance of view.Range");this._pushRange(t),this._lastRangeBackward=!!e}},{key:"_pushRange",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=P()(this._ranges);!(e=(i=o.next()).done);e=!0){var a=i.value;if(t.isIntersecting(a))throw new Nt["b"]("view-selection-range-intersects: Trying to add a range that intersects with another range from selection.",{addedRange:t,intersectingRange:a})}}catch(s){n=!0,r=s}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}this._ranges.push(new Nu(t.start,t.end))}},{key:"isFake",get:function(){return this._isFake}},{key:"fakeSelectionLabel",get:function(){return this._fakeSelectionLabel}},{key:"anchor",get:function(){if(!this._ranges.length)return null;var t=this._ranges[this._ranges.length-1],e=this._lastRangeBackward?t.end:t.start;return e.clone()}},{key:"focus",get:function(){if(!this._ranges.length)return null;var t=this._ranges[this._ranges.length-1],e=this._lastRangeBackward?t.start:t.end;return e.clone()}},{key:"isCollapsed",get:function(){return 1===this.rangeCount&&this._ranges[0].isCollapsed}},{key:"rangeCount",get:function(){return this._ranges.length}},{key:"isBackward",get:function(){return!this.isCollapsed&&this._lastRangeBackward}},{key:"editableElement",get:function(){return this.anchor?this.anchor.editableElement:null}}]),t}();oe(ju,qt);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
var Mu=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;Object(c["a"])(this,t),this._selection=new ju,this._selection.delegate("change").to(this),this._selection.setTo(e,n,r)}return Object(l["a"])(t,[{key:"getRanges",value:regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.delegateYield(this._selection.getRanges(),"t0",1);case 1:case"end":return t.stop()}},t,this)})},{key:"getFirstRange",value:function(){return this._selection.getFirstRange()}},{key:"getLastRange",value:function(){return this._selection.getLastRange()}},{key:"getFirstPosition",value:function(){return this._selection.getFirstPosition()}},{key:"getLastPosition",value:function(){return this._selection.getLastPosition()}},{key:"getSelectedElement",value:function(){return this._selection.getSelectedElement()}},{key:"isEqual",value:function(t){return this._selection.isEqual(t)}},{key:"isSimilar",value:function(t){return this._selection.isSimilar(t)}},{key:"_setTo",value:function(t,e,n){this._selection.setTo(t,e,n)}},{key:"_setFocus",value:function(t,e){this._selection.setFocus(t,e)}},{key:"isFake",get:function(){return this._selection.isFake}},{key:"fakeSelectionLabel",get:function(){return this._selection.fakeSelectionLabel}},{key:"anchor",get:function(){return this._selection.anchor}},{key:"focus",get:function(){return this._selection.focus}},{key:"isCollapsed",get:function(){return this._selection.isCollapsed}},{key:"rangeCount",get:function(){return this._selection.rangeCount}},{key:"isBackward",get:function(){return this._selection.isBackward}},{key:"editableElement",get:function(){return this._selection.editableElement}},{key:"_ranges",get:function(){return this._selection._ranges}}]),t}();oe(Mu,qt);n("7514");var Lu=n("1b81"),Fu=n.n(Lu),Vu=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(c["a"])(this,t),this._items=[],this._itemMap=new It.a,this._idProperty=e.idProperty||"id",this._bindToExternalToInternalMap=new Fu.a,this._bindToInternalToExternalMap=new Fu.a,this._skippedIndexesFromExternal=[]}return Object(l["a"])(t,[{key:"add",value:function(t,e){var n,r=this._idProperty;if(r in t){if(n=t[r],"string"!=typeof n)throw new Nt["b"]("collection-add-invalid-id");if(this.get(n))throw new Nt["b"]("collection-add-item-already-exists")}else t[r]=n=Mt();if(void 0===e)e=this._items.length;else if(e>this._items.length||e<0)throw new Nt["b"]("collection-add-item-invalid-index");return this._items.splice(e,0,t),this._itemMap.set(n,t),this.fire("add",t,e),this}},{key:"get",value:function(t){var e;if("string"==typeof t)e=this._itemMap.get(t);else{if("number"!=typeof t)throw new Nt["b"]("collection-get-invalid-arg: Index or id must be given.");e=this._items[t]}return e||null}},{key:"getIndex",value:function(t){var e;return e="string"==typeof t?this._itemMap.get(t):t,this._items.indexOf(e)}},{key:"remove",value:function(t){var e,n,r,i=!1,o=this._idProperty;if("string"==typeof t?(n=t,r=this._itemMap.get(n),i=!r,r&&(e=this._items.indexOf(r))):"number"==typeof t?(e=t,r=this._items[e],i=!r,r&&(n=r[o])):(r=t,n=r[o],e=this._items.indexOf(r),i=-1==e||!this._itemMap.get(n)),i)throw new Nt["b"]("collection-remove-404: Item not found.");this._items.splice(e,1),this._itemMap.delete(n);var a=this._bindToInternalToExternalMap.get(r);return this._bindToInternalToExternalMap.delete(r),this._bindToExternalToInternalMap.delete(a),this.fire("remove",r,e),r}},{key:"map",value:function(t,e){return this._items.map(t,e)}},{key:"find",value:function(t,e){return this._items.find(t,e)}},{key:"filter",value:function(t,e){return this._items.filter(t,e)}},{key:"clear",value:function(){this._bindToCollection&&(this.stopListening(this._bindToCollection),this._bindToCollection=null);while(this.length)this.remove(0)}},{key:"bindTo",value:function(t){var e=this;if(this._bindToCollection)throw new Nt["b"]("collection-bind-to-rebind: The collection cannot be bound more than once.");return this._bindToCollection=t,{as:function(t){e._setUpBindToBinding(function(e){return new t(e)})},using:function(t){"function"==typeof t?e._setUpBindToBinding(function(e){return t(e)}):e._setUpBindToBinding(function(e){return e[t]})}}}},{key:"_setUpBindToBinding",value:function(t){var e=this,n=this._bindToCollection,r=function(r,i,o){var a=n._bindToCollection==e,s=n._bindToInternalToExternalMap.get(i);if(a&&s)e._bindToExternalToInternalMap.set(i,s),e._bindToInternalToExternalMap.set(s,i);else{var u=t(i);if(!u)return void e._skippedIndexesFromExternal.push(o);var c=o,l=!0,h=!1,f=void 0;try{for(var d,p=P()(e._skippedIndexesFromExternal);!(l=(d=p.next()).done);l=!0){var v=d.value;o>v&&c--}}catch(E){h=!0,f=E}finally{try{l||null==p.return||p.return()}finally{if(h)throw f}}var y=!0,g=!1,m=void 0;try{for(var b,w=P()(n._skippedIndexesFromExternal);!(y=(b=w.next()).done);y=!0){var _=b.value;c>=_&&c++}}catch(E){g=!0,m=E}finally{try{y||null==w.return||w.return()}finally{if(g)throw m}}e._bindToExternalToInternalMap.set(i,u),e._bindToInternalToExternalMap.set(u,i),e.add(u,c);for(var k=0;k<n._skippedIndexesFromExternal.length;k++)c<=n._skippedIndexesFromExternal[k]&&n._skippedIndexesFromExternal[k]++}},i=!0,o=!1,a=void 0;try{for(var s,u=P()(n);!(i=(s=u.next()).done);i=!0){var c=s.value;r(null,c,n.getIndex(c))}}catch(l){o=!0,a=l}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}this.listenTo(n,"add",r),this.listenTo(n,"remove",function(t,n,r){var i=e._bindToExternalToInternalMap.get(n);i&&e.remove(i),e._skippedIndexesFromExternal=e._skippedIndexesFromExternal.reduce(function(t,e){return r<e&&t.push(e-1),r>e&&t.push(e),t},[])})}},{key:Es.a,value:function(){return P()(this._items)}},{key:"length",get:function(){return this._items.length}},{key:"first",get:function(){return this._items[0]||null}},{key:"last",get:function(){return this._items[this.length-1]||null}}]),t}();oe(Vu,qt);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
var Bu=function(){function t(){Object(c["a"])(this,t),this.selection=new Mu,this.roots=new Vu({idProperty:"rootName"}),this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("isComposing",!1),this._postFixers=new Pt.a}return Object(l["a"])(t,[{key:"getRoot",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main";return this.roots.get(t)}},{key:"registerPostFixer",value:function(t){this._postFixers.add(t)}},{key:"_callPostFixers",value:function(t){var e=!1;do{var n=!0,r=!1,i=void 0;try{for(var o,a=P()(this._postFixers);!(n=(o=a.next()).done);n=!0){var s=o.value;if(e=s(t),e)break}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}while(e)}}]),t}();oe(Bu,vu);n("c5f6");
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Uu=10,qu=function(t){function e(t,n,r){var i;return Object(c["a"])(this,e),i=Object(m["a"])(this,Object(b["a"])(e).call(this,t,n,r)),i.getFillerOffset=Wu,i._priority=Uu,i._id=null,i._clonesGroup=null,i}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"getElementsWithSameId",value:function(){if(null===this.id)throw new Nt["b"]("attribute-element-get-elements-with-same-id-no-id: Cannot get elements with the same id for an attribute element without id.");return new Pt.a(this._clonesGroup)}},{key:"is",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return n?"attributeElement"==t&&n==this.name||S(Object(b["a"])(e.prototype),"is",this).call(this,t,n):"attributeElement"==t||S(Object(b["a"])(e.prototype),"is",this).call(this,t)}},{key:"isSimilar",value:function(t){return null!==this.id||null!==t.id?this.id===t.id:S(Object(b["a"])(e.prototype),"isSimilar",this).call(this,t)&&this.priority==t.priority}},{key:"_clone",value:function(t){var n=S(Object(b["a"])(e.prototype),"_clone",this).call(this,t);return n._priority=this._priority,n._id=this._id,n}},{key:"priority",get:function(){return this._priority}},{key:"id",get:function(){return this._id}}]),e}(Ps);function Wu(){if(Ku(this))return null;var t=this.parent;while(t&&t.is("attributeElement")){if(Ku(t)>1)return null;t=t.parent}return!t||Ku(t)>1?null:this.childCount}function Ku(t){return gt()(t.getChildren()).filter(function(t){return!t.is("uiElement")}).length}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */qu.DEFAULT_PRIORITY=Uu;var Hu=function(t){function e(t,n,r){var i;return Object(c["a"])(this,e),i=Object(m["a"])(this,Object(b["a"])(e).call(this,t,n,r)),i.getFillerOffset=zu,i}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"is",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return n?"emptyElement"==t&&n==this.name||S(Object(b["a"])(e.prototype),"is",this).call(this,t,n):"emptyElement"==t||S(Object(b["a"])(e.prototype),"is",this).call(this,t)}},{key:"_insertChild",value:function(t,e){if(e&&(e instanceof ms||gt()(e).length>0))throw new Nt["b"]("view-emptyelement-cannot-add: Cannot add child nodes to EmptyElement instance.")}}]),e}(Ps);function zu(){return null}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Gu=navigator.userAgent.toLowerCase(),Qu={isMac:Xu(Gu),isEdge:Ju(Gu),isGecko:$u(Gu)},Yu=Qu;function Xu(t){return t.indexOf("macintosh")>-1}function Ju(t){return!!t.match(/edge\/(\d+.?\d*)/)}function $u(t){return!!t.match(/gecko\/\d+/)}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Zu={"":"ctrl","":"shift","":"alt"},tc={ctrl:"",shift:"",alt:""},ec=oc();function nc(t){var e;if("string"==typeof t){if(e=ec[t.toLowerCase()],!e)throw new Nt["b"]("keyboard-unknown-key: Unknown key name.",{key:t})}else e=t.keyCode+(t.altKey?ec.alt:0)+(t.ctrlKey?ec.ctrl:0)+(t.shiftKey?ec.shift:0);return e}function rc(t){return"string"==typeof t&&(t=ac(t)),t.map(function(t){return"string"==typeof t?nc(t):t}).reduce(function(t,e){return e+t},0)}function ic(t){return Yu.isMac?ac(t).map(function(t){return tc[t.toLowerCase()]||t}).reduce(function(t,e){return t.slice(-1)in Zu?t+e:t+"+"+e}):t}function oc(){for(var t={arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,cmd:1114112,shift:2228224,alt:4456448},e=65;e<=90;e++){var n=String.fromCharCode(e);t[n.toLowerCase()]=e}for(var r=48;r<=57;r++)t[r-48]=r;for(var i=112;i<=123;i++)t["f"+(i-111)]=i;return t}function ac(t){return t.split(/\s*\+\s*/)}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var sc=function(t){function e(t,n,r){var i;return Object(c["a"])(this,e),i=Object(m["a"])(this,Object(b["a"])(e).call(this,t,n,r)),i.getFillerOffset=cc,i}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"is",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return n?"uiElement"==t&&n==this.name||S(Object(b["a"])(e.prototype),"is",this).call(this,t,n):"uiElement"==t||S(Object(b["a"])(e.prototype),"is",this).call(this,t)}},{key:"_insertChild",value:function(t,e){if(e&&(e instanceof ms||gt()(e).length>0))throw new Nt["b"]("view-uielement-cannot-add: Cannot add child nodes to UIElement instance.")}},{key:"render",value:function(t){return this.toDomElement(t)}},{key:"toDomElement",value:function(t){var e=t.createElement(this.name),n=!0,r=!1,i=void 0;try{for(var o,a=P()(this.getAttributeKeys());!(n=(o=a.next()).done);n=!0){var s=o.value;e.setAttribute(s,this.getAttribute(s))}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}}]),e}(Ps);function uc(t){t.document.on("keydown",function(e,n){return lc(e,n,t.domConverter)})}function cc(){return null}function lc(t,e,n){if(e.keyCode==ec.arrowright){var r=e.domTarget.ownerDocument.defaultView.getSelection(),i=1==r.rangeCount&&r.getRangeAt(0).collapsed;if(i||e.shiftKey){var o=r.focusNode,a=r.focusOffset,s=n.domPositionToView(o,a);if(null===s)return;var u=!1,c=s.getLastMatchingPosition(function(t){return t.item.is("uiElement")&&(u=!0),!(!t.item.is("uiElement")&&!t.item.is("attributeElement"))});if(u){var l=n.viewPositionToDom(c);i?r.collapse(l.parent,l.offset):r.extend(l.parent,l.offset)}}}}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var hc=function(){function t(e){Object(c["a"])(this,t),this._children=[],e&&this._insertChild(0,e)}return Object(l["a"])(t,[{key:Es.a,value:function(){return P()(this._children)}},{key:"is",value:function(t){return"documentFragment"==t}},{key:"_appendChild",value:function(t){return this._insertChild(this.childCount,t)}},{key:"getChild",value:function(t){return this._children[t]}},{key:"getChildIndex",value:function(t){return this._children.indexOf(t)}},{key:"getChildren",value:function(){return P()(this._children)}},{key:"_insertChild",value:function(t,e){this._fireChange("children",this);var n=0,r=fc(e),i=!0,o=!1,a=void 0;try{for(var s,u=P()(r);!(i=(s=u.next()).done);i=!0){var c=s.value;null!==c.parent&&c._remove(),c.parent=this,this._children.splice(t,0,c),t++,n++}}catch(l){o=!0,a=l}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}return n}},{key:"_removeChildren",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this._fireChange("children",this);for(var n=t;n<t+e;n++)this._children[n].parent=null;return this._children.splice(t,e)}},{key:"_fireChange",value:function(t,e){this.fire("change:"+t,e)}},{key:"childCount",get:function(){return this._children.length}},{key:"isEmpty",get:function(){return 0===this.childCount}},{key:"root",get:function(){return this}},{key:"parent",get:function(){return null}}]),t}();function fc(t){return"string"==typeof t?[new bs(t)]:(Ts(t)||(t=[t]),gt()(t).map(function(t){return"string"==typeof t?new bs(t):t instanceof ws?new bs(t.data):t}))}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */oe(hc,qt);var dc=function(){function t(e){Object(c["a"])(this,t),this.document=e,this._cloneGroups=new It.a}return Object(l["a"])(t,[{key:"setSelection",value:function(t,e,n){this.document.selection._setTo(t,e,n)}},{key:"setSelectionFocus",value:function(t,e){this.document.selection._setFocus(t,e)}},{key:"createText",value:function(t){return new bs(t)}},{key:"createAttributeElement",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new qu(t,e);return n.priority&&(r._priority=n.priority),n.id&&(r._id=n.id),r}},{key:"createContainerElement",value:function(t,e){return new Ms(t,e)}},{key:"createEditableElement",value:function(t,e){var n=new Ou(t,e);return n._document=this.document,n}},{key:"createEmptyElement",value:function(t,e){return new Hu(t,e)}},{key:"createUIElement",value:function(t,e,n){var r=new sc(t,e);return n&&(r.render=n),r}},{key:"setAttribute",value:function(t,e,n){n._setAttribute(t,e)}},{key:"removeAttribute",value:function(t,e){e._removeAttribute(t)}},{key:"addClass",value:function(t,e){e._addClass(t)}},{key:"removeClass",value:function(t,e){e._removeClass(t)}},{key:"setStyle",value:function(t,e,n){ct(t)&&void 0===n&&(n=e),n._setStyle(t,e)}},{key:"removeStyle",value:function(t,e){e._removeStyle(t)}},{key:"setCustomProperty",value:function(t,e,n){n._setCustomProperty(t,e)}},{key:"removeCustomProperty",value:function(t,e){return e._removeCustomProperty(t)}},{key:"breakAttributes",value:function(t){return t instanceof Pu?this._breakAttributes(t):this._breakAttributesRange(t)}},{key:"breakContainer",value:function(t){var e=t.parent;if(!e.is("containerElement"))throw new Nt["b"]("view-writer-break-non-container-element: Trying to break an element which is not a container element.");if(!e.parent)throw new Nt["b"]("view-writer-break-root: Trying to break root element.");if(t.isAtStart)return Pu._createBefore(e);if(!t.isAtEnd){var n=e._clone(!1);this.insert(Pu._createAfter(e),n);var r=new Nu(t,Pu._createAt(e,"end")),i=new Pu(n,0);this.move(r,i)}return Pu._createAfter(e)}},{key:"mergeAttributes",value:function(t){var e=t.offset,n=t.parent;if(n.is("text"))return t;if(n.is("attributeElement")&&0===n.childCount){var r=n.parent,i=n.index;return n._remove(),this._removeFromClonedElementsGroup(n),this.mergeAttributes(new Pu(r,i))}var o=n.getChild(e-1),a=n.getChild(e);if(!o||!a)return t;if(o.is("text")&&a.is("text"))return bc(o,a);if(o.is("attributeElement")&&a.is("attributeElement")&&o.isSimilar(a)){var s=o.childCount;return o._appendChild(a.getChildren()),a._remove(),this._removeFromClonedElementsGroup(a),this.mergeAttributes(new Pu(o,s))}return t}},{key:"mergeContainers",value:function(t){var e=t.nodeBefore,n=t.nodeAfter;if(!e||!n||!e.is("containerElement")||!n.is("containerElement"))throw new Nt["b"]("view-writer-merge-containers-invalid-position: Element before and after given position cannot be merged.");var r=e.getChild(e.childCount-1),i=r instanceof bs?Pu._createAt(r,"end"):Pu._createAt(e,"end");return this.move(Nu._createIn(n),Pu._createAt(e,"end")),this.remove(Nu._createOn(n)),i}},{key:"insert",value:function(t,e){e=Ts(e)?kt(e):[e],_c(e);var n=vc(t);if(!n)throw new Nt["b"]("view-writer-invalid-position-container");var r=this._breakAttributes(t,!0),i=n._insertChild(r.offset,e),o=!0,a=!1,s=void 0;try{for(var u,c=P()(e);!(o=(u=c.next()).done);o=!0){var l=u.value;this._addToClonedElementsGroup(l)}}catch(p){a=!0,s=p}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}var h=r.getShiftedBy(i),f=this.mergeAttributes(r);if(0===i)return new Nu(f,f);f.isEqual(r)||h.offset--;var d=this.mergeAttributes(h);return new Nu(f,d)}},{key:"remove",value:function(t){var e=t instanceof Nu?t:Nu._createOn(t);if(Tc(e),e.isCollapsed)return new hc;var n=this._breakAttributesRange(e,!0),r=n.start,i=n.end,o=r.parent,a=i.offset-r.offset,s=o._removeChildren(r.offset,a),u=!0,c=!1,l=void 0;try{for(var h,f=P()(s);!(u=(h=f.next()).done);u=!0){var d=h.value;this._removeFromClonedElementsGroup(d)}}catch(v){c=!0,l=v}finally{try{u||null==f.return||f.return()}finally{if(c)throw l}}var p=this.mergeAttributes(r);return e.start=p,e.end=p.clone(),new hc(s)}},{key:"clear",value:function(t,e){Tc(t);var n=t.getWalker({direction:"backward",ignoreElementEnd:!0}),r=!0,i=!1,o=void 0;try{for(var a,s=P()(n);!(r=(a=s.next()).done);r=!0){var u=a.value,c=u.item,l=void 0;if(c.is("element")&&e.isSimilar(c))l=Nu._createOn(c);else if(!u.nextPosition.isAfter(t.start)&&c.is("textProxy")){var h=c.getAncestors().find(function(t){return t.is("element")&&e.isSimilar(t)});h&&(l=Nu._createIn(h))}l&&(l.end.isAfter(t.end)&&(l.end=t.end),l.start.isBefore(t.start)&&(l.start=t.start),this.remove(l))}}catch(f){i=!0,o=f}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}},{key:"move",value:function(t,e){var n;if(e.isAfter(t.end)){e=this._breakAttributes(e,!0);var r=e.parent,i=r.childCount;t=this._breakAttributesRange(t,!0),n=this.remove(t),e.offset+=r.childCount-i}else n=this.remove(t);return this.insert(e,n)}},{key:"wrap",value:function(t,e){if(!(e instanceof qu))throw new Nt["b"]("view-writer-wrap-invalid-attribute");if(Tc(t),t.isCollapsed){var n=t.start;n.parent.is("element")&&!pc(n.parent)&&(n=n.getLastMatchingPosition(function(t){return t.item.is("uiElement")})),n=this._wrapPosition(n,e);var r=this.document.selection;return r.isCollapsed&&r.getFirstPosition().isEqual(t.start)&&this.setSelection(n),new Nu(n)}return this._wrapRange(t,e)}},{key:"unwrap",value:function(t,e){if(!(e instanceof qu))throw new Nt["b"]("view-writer-unwrap-invalid-attribute");if(Tc(t),t.isCollapsed)return t;var n=this._breakAttributesRange(t,!0),r=n.start,i=n.end;if(i.isEqual(r.getShiftedBy(1))){var o=r.nodeAfter;if(!e.isSimilar(o)&&o instanceof qu&&this._unwrapAttributeElement(e,o)){var a=this.mergeAttributes(r);a.isEqual(r)||i.offset--;var s=this.mergeAttributes(i);return new Nu(a,s)}}var u=r.parent,c=this._unwrapChildren(u,r.offset,i.offset,e),l=this.mergeAttributes(c.start);l.isEqual(c.start)||c.end.offset--;var h=this.mergeAttributes(c.end);return new Nu(l,h)}},{key:"rename",value:function(t,e){var n=new Ms(t,e.getAttributes());return this.insert(Pu._createAfter(e),n),this.move(Nu._createIn(e),Pu._createAt(n,0)),this.remove(Nu._createOn(e)),n}},{key:"clearClonedElementsGroup",value:function(t){this._cloneGroups.delete(t)}},{key:"createPositionAt",value:function(t,e){return Pu._createAt(t,e)}},{key:"createPositionAfter",value:function(t){return Pu._createAfter(t)}},{key:"createPositionBefore",value:function(t){return Pu._createBefore(t)}},{key:"createRange",value:function(t,e){return new Nu(t,e)}},{key:"createRangeOn",value:function(t){return Nu._createOn(t)}},{key:"createRangeIn",value:function(t){return Nu._createIn(t)}},{key:"createSelection",value:function(t,e,n){return new ju(t,e,n)}},{key:"_wrapChildren",value:function(t,e,n,r){var i=e,o=[];while(i<n){var a=t.getChild(i),s=a.is("text"),u=a.is("attributeElement"),c=a.is("emptyElement"),l=a.is("uiElement");if(s||c||l||u&&yc(r,a)){var h=r._clone();a._remove(),h._appendChild(a),t._insertChild(i,h),this._addToClonedElementsGroup(h),o.push(new Pu(t,i))}else u&&this._wrapChildren(a,0,a.childCount,r);i++}for(var f=0,d=0;d<o.length;d++){var p=o[d];if(p.offset-=f,p.offset!=e){var v=this.mergeAttributes(p);v.isEqual(p)||(f++,n--)}}return Nu._createFromParentsAndOffsets(t,e,t,n)}},{key:"_unwrapChildren",value:function(t,e,n,r){var i=e,o=[];while(i<n){var a=t.getChild(i);if(a.isSimilar(r)){var s=a.getChildren(),u=a.childCount;a._remove(),t._insertChild(i,s),this._removeFromClonedElementsGroup(a),o.push(new Pu(t,i),new Pu(t,i+u)),i+=u,n+=u-1}else a.is("attributeElement")&&this._unwrapChildren(a,0,a.childCount,r),i++}for(var c=0,l=0;l<o.length;l++){var h=o[l];if(h.offset-=c,h.offset!=e&&h.offset!=n){var f=this.mergeAttributes(h);f.isEqual(h)||(c++,n--)}}return Nu._createFromParentsAndOffsets(t,e,t,n)}},{key:"_wrapRange",value:function(t,e){if(wc(t)&&this._wrapAttributeElement(e,t.start.parent)){var n=t.start.parent,r=this.mergeAttributes(Pu._createAfter(n)),i=this.mergeAttributes(Pu._createBefore(n));return new Nu(i,r)}var o=this._breakAttributesRange(t,!0),a=o.start,s=o.end;if(s.isEqual(a.getShiftedBy(1))){var u=a.nodeAfter;if(u instanceof qu&&this._wrapAttributeElement(e,u)){var c=this.mergeAttributes(a);c.isEqual(a)||s.offset--;var l=this.mergeAttributes(s);return new Nu(c,l)}}var h=a.parent,f=this._unwrapChildren(h,a.offset,s.offset,e),d=this._wrapChildren(h,f.start.offset,f.end.offset,e),p=this.mergeAttributes(d.start);p.isEqual(d.start)||d.end.offset--;var v=this.mergeAttributes(d.end);return new Nu(p,v)}},{key:"_wrapPosition",value:function(t,e){if(e.isSimilar(t.parent))return gc(t.clone());t.parent.is("text")&&(t=mc(t));var n=this.createAttributeElement();n._priority=Number.POSITIVE_INFINITY,n.isSimilar=function(){return!1},t.parent._insertChild(t.offset,n);var r=new Nu(t,t.getShiftedBy(1));this.wrap(r,e);var i=new Pu(n.parent,n.index);n._remove();var o=i.nodeBefore,a=i.nodeAfter;return o instanceof bs&&a instanceof bs?bc(o,a):gc(i)}},{key:"_wrapAttributeElement",value:function(t,e){if(!Sc(t,e))return!1;if(t.name!==e.name||t.priority!==e.priority)return!1;var n=!0,r=!1,i=void 0;try{for(var o,a=P()(t.getAttributeKeys());!(n=(o=a.next()).done);n=!0){var s=o.value;if("class"!==s&&"style"!==s&&(e.hasAttribute(s)&&e.getAttribute(s)!==t.getAttribute(s)))return!1}}catch(R){r=!0,i=R}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}var u=!0,c=!1,l=void 0;try{for(var h,f=P()(t.getStyleNames());!(u=(h=f.next()).done);u=!0){var d=h.value;if(e.hasStyle(d)&&e.getStyle(d)!==t.getStyle(d))return!1}}catch(R){c=!0,l=R}finally{try{u||null==f.return||f.return()}finally{if(c)throw l}}var p=!0,v=!1,y=void 0;try{for(var g,m=P()(t.getAttributeKeys());!(p=(g=m.next()).done);p=!0){var b=g.value;"class"!==b&&"style"!==b&&(e.hasAttribute(b)||this.setAttribute(b,t.getAttribute(b),e))}}catch(R){v=!0,y=R}finally{try{p||null==m.return||m.return()}finally{if(v)throw y}}var w=!0,_=!1,k=void 0;try{for(var E,T=P()(t.getStyleNames());!(w=(E=T.next()).done);w=!0){var S=E.value;e.hasStyle(S)||this.setStyle(S,t.getStyle(S),e)}}catch(R){_=!0,k=R}finally{try{w||null==T.return||T.return()}finally{if(_)throw k}}var C=!0,O=!1,A=void 0;try{for(var I,x=P()(t.getClassNames());!(C=(I=x.next()).done);C=!0){var N=I.value;e.hasClass(N)||this.addClass(N,e)}}catch(R){O=!0,A=R}finally{try{C||null==x.return||x.return()}finally{if(O)throw A}}return!0}},{key:"_unwrapAttributeElement",value:function(t,e){if(!Sc(t,e))return!1;if(t.name!==e.name||t.priority!==e.priority)return!1;var n=!0,r=!1,i=void 0;try{for(var o,a=P()(t.getAttributeKeys());!(n=(o=a.next()).done);n=!0){var s=o.value;if("class"!==s&&"style"!==s&&(!e.hasAttribute(s)||e.getAttribute(s)!==t.getAttribute(s)))return!1}}catch(w){r=!0,i=w}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}if(!e.hasClass.apply(e,kt(t.getClassNames())))return!1;var u=!0,c=!1,l=void 0;try{for(var h,f=P()(t.getStyleNames());!(u=(h=f.next()).done);u=!0){var d=h.value;if(!e.hasStyle(d)||e.getStyle(d)!==t.getStyle(d))return!1}}catch(w){c=!0,l=w}finally{try{u||null==f.return||f.return()}finally{if(c)throw l}}var p=!0,v=!1,y=void 0;try{for(var g,m=P()(t.getAttributeKeys());!(p=(g=m.next()).done);p=!0){var b=g.value;"class"!==b&&"style"!==b&&this.removeAttribute(b,e)}}catch(w){v=!0,y=w}finally{try{p||null==m.return||m.return()}finally{if(v)throw y}}return this.removeClass(gt()(t.getClassNames()),e),this.removeStyle(gt()(t.getStyleNames()),e),!0}},{key:"_breakAttributesRange",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.start,r=t.end;if(Tc(t),t.isCollapsed){var i=this._breakAttributes(t.start,e);return new Nu(i,i)}var o=this._breakAttributes(r,e),a=o.parent.childCount,s=this._breakAttributes(n,e);return o.offset+=o.parent.childCount-a,new Nu(s,o)}},{key:"_breakAttributes",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.offset,r=t.parent;if(t.parent.is("emptyElement"))throw new Nt["b"]("view-writer-cannot-break-empty-element");if(t.parent.is("uiElement"))throw new Nt["b"]("view-writer-cannot-break-ui-element");if(!e&&r.is("text")&&Ec(r.parent))return t.clone();if(Ec(r))return t.clone();if(r.is("text"))return this._breakAttributes(mc(t),e);var i=r.childCount;if(n==i){var o=new Pu(r.parent,r.index+1);return this._breakAttributes(o,e)}if(0===n){var a=new Pu(r.parent,r.index);return this._breakAttributes(a,e)}var s=r.index+1,u=r._clone();r.parent._insertChild(s,u),this._addToClonedElementsGroup(u);var c=r.childCount-n,l=r._removeChildren(n,c);u._appendChild(l);var h=new Pu(r.parent,s);return this._breakAttributes(h,e)}},{key:"_addToClonedElementsGroup",value:function(t){if(t.root.is("rootElement")){if(t.is("element")){var e=!0,n=!1,r=void 0;try{for(var i,o=P()(t.getChildren());!(e=(i=o.next()).done);e=!0){var a=i.value;this._addToClonedElementsGroup(a)}}catch(c){n=!0,r=c}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}var s=t.id;if(s){var u=this._cloneGroups.get(s);u||(u=new Pt.a,this._cloneGroups.set(s,u)),u.add(t),t._clonesGroup=u}}}},{key:"_removeFromClonedElementsGroup",value:function(t){if(t.is("element")){var e=!0,n=!1,r=void 0;try{for(var i,o=P()(t.getChildren());!(e=(i=o.next()).done);e=!0){var a=i.value;this._removeFromClonedElementsGroup(a)}}catch(c){n=!0,r=c}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}var s=t.id;if(s){var u=this._cloneGroups.get(s);u&&u.delete(t)}}}]),t}();function pc(t){return gt()(t.getChildren()).some(function(t){return!t.is("uiElement")})}function vc(t){var e=t.parent;while(!Ec(e)){if(!e)return;e=e.parent}return e}function yc(t,e){return t.priority<e.priority||!(t.priority>e.priority)&&t.getIdentity()<e.getIdentity()}function gc(t){var e=t.nodeBefore;if(e&&e.is("text"))return new Pu(e,e.data.length);var n=t.nodeAfter;return n&&n.is("text")?new Pu(n,0):t}function mc(t){if(t.offset==t.parent.data.length)return new Pu(t.parent.parent,t.parent.index+1);if(0===t.offset)return new Pu(t.parent.parent,t.parent.index);var e=t.parent.data.slice(t.offset);return t.parent._data=t.parent.data.slice(0,t.offset),t.parent.parent._insertChild(t.parent.index+1,new bs(e)),new Pu(t.parent.parent,t.parent.index+1)}function bc(t,e){var n=t.data.length;return t._data+=e.data,e._remove(),new Pu(t,n)}function wc(t){return t.start.parent==t.end.parent&&t.start.parent.is("attributeElement")&&0===t.start.offset&&t.end.offset===t.start.parent.childCount}function _c(t){var e=!0,n=!1,r=void 0;try{for(var i,o=function(){var t=i.value;if(!kc.some(function(e){return t instanceof e}))throw new Nt["b"]("view-writer-insert-invalid-node");t.is("text")||_c(t.getChildren())},a=P()(t);!(e=(i=a.next()).done);e=!0)o()}catch(s){n=!0,r=s}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}}var kc=[bs,qu,Ms,Hu,sc];function Ec(t){return t&&(t.is("containerElement")||t.is("documentFragment"))}function Tc(t){var e=vc(t.start),n=vc(t.end);if(!e||!n||e!==n)throw new Nt["b"]("view-writer-invalid-range-container")}function Sc(t,e){return null===t.id&&null===e.id}var Cc=n("5176"),Oc=n.n(Cc);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
function Ac(t){return"[object Text]"==Object.prototype.toString.call(t)}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */for(var Ic=function(t){var e=t.createElement("br");return e.dataset.ckeFiller=!0,e},xc=function(t){return t.createTextNode("")},Pc=7,Nc="",Rc=0;Rc<Pc;Rc++)Nc+="";function Dc(t){return Ac(t)&&t.data.substr(0,Pc)===Nc}function jc(t){return t.data.length==Pc&&Dc(t)}function Mc(t){return Dc(t)?t.data.slice(Pc):t.data}var Lc=new Fu.a;function Fc(t,e){var n=Lc.get(e);return n||(n=e(window.document),Lc.set(e,n)),t.isEqualNode(n)}function Vc(t){t.document.on("keydown",Bc)}function Bc(t,e){if(e.keyCode==ec.arrowleft){var n=e.domTarget.ownerDocument.defaultView.getSelection();if(1==n.rangeCount&&n.getRangeAt(0).collapsed){var r=n.getRangeAt(0).startContainer,i=n.getRangeAt(0).startOffset;Dc(r)&&i<=Pc&&n.collapse(r,0)}}}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function Uc(t,e,n){var r,i;if(n=n||function(t,e){return t===e},e.length<t.length){var o=t;t=e,e=o,r="delete",i="insert"}else r="insert",i="delete";var a=t.length,s=e.length,u=s-a,c={},l={};function h(o){var u=(void 0!==l[o-1]?l[o-1]:-1)+1,h=void 0!==l[o+1]?l[o+1]:-1,f=u>h?-1:1;c[o+f]&&(c[o]=c[o+f].slice(0)),c[o]||(c[o]=[]),c[o].push(u>h?r:i);var d=Math.max(u,h),p=d-o;while(p<a&&d<s&&n(t[p],e[d]))p++,d++,c[o].push("equal");return d}var f,d=0;do{for(f=-d;f<u;f++)l[f]=h(f);for(f=u+d;f>u;f--)l[f]=h(f);l[u]=h(u),d++}while(l[u]!==s);return c[u].slice(1)}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function qc(t,e,n){t.insertBefore(n,t.childNodes[e]||null)}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function Wc(t){var e=t.parentNode;e&&e.removeChild(t)}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function Kc(t){if(t){if(t.defaultView)return t instanceof t.defaultView.Document;if(t.ownerDocument&&t.ownerDocument.defaultView)return t instanceof t.ownerDocument.defaultView.Node}return!1}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function Hc(t,e){if(t===e)return[];var n=zc(t,e);return Yc(e,n)}function zc(t,e){var n=Gc(t,e),r=Qc(t,n),i=Qc(e,n),o=Gc(r,i),a=t.length-o,s=e.length-o;return{firstIndex:n,lastIndexOld:a,lastIndexNew:s}}function Gc(t,e){for(var n=0;n<Math.max(t.length,e.length);n++)if(t[n]!==e[n])return n}function Qc(t,e){return t.substring(e).split("").reverse().join("")}function Yc(t,e){var n=[],r=e.firstIndex,i=e.lastIndexOld,o=e.lastIndexNew;return o-r>0&&n.push({index:r,type:"insert",values:t.substring(r,o).split("")}),i-r>0&&n.push({index:r+(o-r),type:"delete",howMany:i-r}),n}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Xc=function(){function t(e,n){Object(c["a"])(this,t),this.domDocuments=new Pt.a,this.domConverter=e,this.markedAttributes=new Pt.a,this.markedChildren=new Pt.a,this.markedTexts=new Pt.a,this.selection=n,this.isFocused=!1,this._inlineFiller=null,this._fakeSelectionContainer=null}return Object(l["a"])(t,[{key:"markToSync",value:function(t,e){if("text"===t)this.domConverter.mapViewToDom(e.parent)&&this.markedTexts.add(e);else{if(!this.domConverter.mapViewToDom(e))return;if("attributes"===t)this.markedAttributes.add(e);else{if("children"!==t)throw new Nt["b"]("view-renderer-unknown-type: Unknown type passed to Renderer.markToSync.");this.markedChildren.add(e)}}}},{key:"render",value:function(){var t,e=!0,n=!1,r=void 0;try{for(var i,o=P()(this.markedChildren);!(e=(i=o.next()).done);e=!0){var a=i.value;this._updateChildrenMappings(a)}}catch(O){n=!0,r=O}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}this._inlineFiller&&!this._isSelectionInInlineFiller()&&this._removeInlineFiller(),this._inlineFiller?t=this._getInlineFillerPosition():this._needsInlineFillerAtSelection()&&(t=this.selection.getFirstPosition(),this.markedChildren.add(t.parent));var s=!0,u=!1,c=void 0;try{for(var l,h=P()(this.markedAttributes);!(s=(l=h.next()).done);s=!0){var f=l.value;this._updateAttrs(f)}}catch(O){u=!0,c=O}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}var d=!0,p=!1,v=void 0;try{for(var y,g=P()(this.markedChildren);!(d=(y=g.next()).done);d=!0){var m=y.value;this._updateChildren(m,{inlineFillerPosition:t})}}catch(O){p=!0,v=O}finally{try{d||null==g.return||g.return()}finally{if(p)throw v}}var b=!0,w=!1,_=void 0;try{for(var k,E=P()(this.markedTexts);!(b=(k=E.next()).done);b=!0){var T=k.value;!this.markedChildren.has(T.parent)&&this.domConverter.mapViewToDom(T.parent)&&this._updateText(T,{inlineFillerPosition:t})}}catch(O){w=!0,_=O}finally{try{b||null==E.return||E.return()}finally{if(w)throw _}}if(t){var S=this.domConverter.viewPositionToDom(t),C=S.parent.ownerDocument;Dc(S.parent)?this._inlineFiller=S.parent:this._inlineFiller=$c(C,S.parent,S.offset)}else this._inlineFiller=null;this._updateSelection(),this._updateFocus(),this.markedTexts.clear(),this.markedAttributes.clear(),this.markedChildren.clear()}},{key:"_updateChildrenMappings",value:function(t){var e=this.domConverter.mapViewToDom(t);if(e){var n=this.domConverter.mapViewToDom(t).childNodes,r=gt()(this.domConverter.viewChildrenToDom(t,e.ownerDocument,{withChildren:!1})),i=this._diffNodeLists(n,r),o=this._findReplaceActions(i,n,r);if(-1!==o.indexOf("replace")){var a={equal:0,insert:0,delete:0},s=!0,u=!1,c=void 0;try{for(var l,h=P()(o);!(s=(l=h.next()).done);s=!0){var f=l.value;if("replace"===f){var d=a.equal+a.insert,p=a.equal+a.delete,v=t.getChild(d);v&&!v.is("uiElement")&&this._updateElementMappings(v,n[p]),Wc(r[d]),a.equal++}else a[f]++}}catch(y){u=!0,c=y}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}}}}},{key:"_updateElementMappings",value:function(t,e){this.domConverter.unbindDomElement(e),this.domConverter.bindElements(e,t),this.markedChildren.add(t),this.markedAttributes.add(t)}},{key:"_getInlineFillerPosition",value:function(){var t=this.selection.getFirstPosition();return t.parent.is("text")?Pu._createBefore(this.selection.getFirstPosition().parent):t}},{key:"_isSelectionInInlineFiller",value:function(){if(1!=this.selection.rangeCount||!this.selection.isCollapsed)return!1;var t=this.selection.getFirstPosition(),e=this.domConverter.viewPositionToDom(t);return!!(e&&Ac(e.parent)&&Dc(e.parent))}},{key:"_removeInlineFiller",value:function(){var t=this._inlineFiller;if(!Dc(t))throw new Nt["b"]("view-renderer-filler-was-lost: The inline filler node was lost.");jc(t)?t.parentNode.removeChild(t):t.data=t.data.substr(Pc),this._inlineFiller=null}},{key:"_needsInlineFillerAtSelection",value:function(){if(1!=this.selection.rangeCount||!this.selection.isCollapsed)return!1;var t=this.selection.getFirstPosition(),e=t.parent,n=t.offset;if(!this.domConverter.mapViewToDom(e.root))return!1;if(!e.is("element"))return!1;if(!Jc(e))return!1;if(n===e.getFillerOffset())return!1;var r=t.nodeBefore,i=t.nodeAfter;return!(r instanceof bs||i instanceof bs)}},{key:"_updateText",value:function(t,e){var n=this.domConverter.findCorrespondingDomText(t),r=this.domConverter.viewToDom(t,n.ownerDocument),i=n.data,o=r.data,a=e.inlineFillerPosition;if(a&&a.parent==t.parent&&a.offset==t.index&&(o=Nc+o),i!=o){var s=Hc(i,o),u=!0,c=!1,l=void 0;try{for(var h,f=P()(s);!(u=(h=f.next()).done);u=!0){var d=h.value;"insert"===d.type?n.insertData(d.index,d.values.join("")):n.deleteData(d.index,d.howMany)}}catch(p){c=!0,l=p}finally{try{u||null==f.return||f.return()}finally{if(c)throw l}}}}},{key:"_updateAttrs",value:function(t){var e=this.domConverter.mapViewToDom(t);if(e){var n=gt()(e.attributes).map(function(t){return t.name}),r=t.getAttributeKeys(),i=!0,o=!1,a=void 0;try{for(var s,u=P()(r);!(i=(s=u.next()).done);i=!0){var c=s.value;e.setAttribute(c,t.getAttribute(c))}}catch(y){o=!0,a=y}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}var l=!0,h=!1,f=void 0;try{for(var d,p=P()(n);!(l=(d=p.next()).done);l=!0){var v=d.value;t.hasAttribute(v)||e.removeAttribute(v)}}catch(y){h=!0,f=y}finally{try{l||null==p.return||p.return()}finally{if(h)throw f}}}}},{key:"_updateChildren",value:function(t,e){var n=this.domConverter.mapViewToDom(t);if(n){var r=e.inlineFillerPosition,i=this.domConverter.mapViewToDom(t).childNodes,o=gt()(this.domConverter.viewChildrenToDom(t,n.ownerDocument,{bind:!0,inlineFillerPosition:r}));r&&r.parent===t&&$c(n.ownerDocument,o,r.offset);var a=this._diffNodeLists(i,o),s=0,u=new Pt.a,c=!0,l=!1,h=void 0;try{for(var f,d=P()(a);!(c=(f=d.next()).done);c=!0){var p=f.value;"insert"===p?(qc(n,s,o[s]),s++):"delete"===p?(u.add(i[s]),Wc(i[s])):(this._markDescendantTextToSync(this.domConverter.domToView(o[s])),s++)}}catch(_){l=!0,h=_}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}var v=!0,y=!1,g=void 0;try{for(var m,b=P()(u);!(v=(m=b.next()).done);v=!0){var w=m.value;w.parentNode||this.domConverter.unbindDomElement(w)}}catch(_){y=!0,g=_}finally{try{v||null==b.return||b.return()}finally{if(y)throw g}}}}},{key:"_diffNodeLists",value:function(t,e){return Uc(t,e,tl.bind(null,this.domConverter.blockFiller))}},{key:"_findReplaceActions",value:function(t,e,n){if(-1===t.indexOf("insert")||-1===t.indexOf("delete"))return t;var r=[],i=[],o=[],a={equal:0,insert:0,delete:0},s=!0,u=!1,c=void 0;try{for(var l,h=P()(t);!(s=(l=h.next()).done);s=!0){var f=l.value;"insert"===f?o.push(n[a.equal+a.insert]):"delete"===f?i.push(e[a.equal+a.delete]):(r=r.concat(Uc(i,o,Zc).map(function(t){return"equal"===t?"replace":t})),r.push("equal"),i=[],o=[]),a[f]++}}catch(d){u=!0,c=d}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}return r.concat(Uc(i,o,Zc).map(function(t){return"equal"===t?"replace":t}))}},{key:"_markDescendantTextToSync",value:function(t){if(t)if(t.is("text"))this.markedTexts.add(t);else if(t.is("element")){var e=!0,n=!1,r=void 0;try{for(var i,o=P()(t.getChildren());!(e=(i=o.next()).done);e=!0){var a=i.value;this._markDescendantTextToSync(a)}}catch(s){n=!0,r=s}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}}},{key:"_updateSelection",value:function(){if(0===this.selection.rangeCount)return this._removeDomSelection(),void this._removeFakeSelection();var t=this.domConverter.mapViewToDom(this.selection.editableElement);this.isFocused&&t&&(this.selection.isFake?this._updateFakeSelection(t):(this._removeFakeSelection(),this._updateDomSelection(t)))}},{key:"_updateFakeSelection",value:function(t){var e=t.ownerDocument,n=this._fakeSelectionContainer;n||(this._fakeSelectionContainer=n=e.createElement("div"),Oc()(n.style,{position:"fixed",top:0,left:"-9999px",width:"42px"}),n.appendChild(e.createTextNode(""))),n.parentElement||t.appendChild(n),n.firstChild.data=this.selection.fakeSelectionLabel||"";var r=e.getSelection(),i=e.createRange();r.removeAllRanges(),i.selectNodeContents(n),r.addRange(i),this.domConverter.bindFakeSelection(n,this.selection)}},{key:"_updateDomSelection",value:function(t){var e=t.ownerDocument.defaultView.getSelection();if(this._domSelectionNeedsUpdate(e)){var n=this.domConverter.viewPositionToDom(this.selection.anchor),r=this.domConverter.viewPositionToDom(this.selection.focus);t.focus(),e.collapse(n.parent,n.offset),e.extend(r.parent,r.offset),Yu.isGecko&&el(r,e)}}},{key:"_domSelectionNeedsUpdate",value:function(t){if(!this.domConverter.isDomSelectionCorrect(t))return!0;var e=t&&this.domConverter.domSelectionToView(t);return(!e||!this.selection.isEqual(e))&&!(!this.selection.isCollapsed&&this.selection.isSimilar(e))}},{key:"_removeDomSelection",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=P()(this.domDocuments);!(t=(r=i.next()).done);t=!0){var o=r.value,a=o.getSelection();if(a.rangeCount){var s=o.activeElement,u=this.domConverter.mapDomToView(s);s&&u&&o.getSelection().removeAllRanges()}}}catch(c){e=!0,n=c}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}},{key:"_removeFakeSelection",value:function(){var t=this._fakeSelectionContainer;t&&t.remove()}},{key:"_updateFocus",value:function(){if(this.isFocused){var t=this.selection.editableElement;t&&this.domConverter.focus(t)}}}]),t}();function Jc(t){if("false"==t.getAttribute("contenteditable"))return!1;var e=t.findAncestor(function(t){return t.hasAttribute("contenteditable")});return!e||"true"==e.getAttribute("contenteditable")}function $c(t,e,n){var r=e instanceof Array?e:e.childNodes,i=r[n];if(Ac(i))return i.data=Nc+i.data,i;var o=t.createTextNode(Nc);return pt()(e)?r.splice(n,0,o):qc(e,n,o),o}function Zc(t,e){return Kc(t)&&Kc(e)&&!Ac(t)&&!Ac(e)&&t.tagName.toLowerCase()===e.tagName.toLowerCase()}function tl(t,e,n){return e===n||(Ac(e)&&Ac(n)?e.data===n.data:!(!Fc(e,t)||!Fc(n,t)))}function el(t,e){var n=t.parent;if(n.nodeType==Node.ELEMENT_NODE&&t.offset==n.childNodes.length-1){var r=n.childNodes[t.offset];r&&"BR"==r.tagName&&e.addRange(e.getRangeAt(0))}}oe(Xc,vu);n("6762"),n("2fdb");var nl={window:window,document:document};
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
function rl(t){var e=0;while(t.previousSibling)t=t.previousSibling,e++;return e}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function il(t){var e=[];while(t&&t.nodeType!=Node.DOCUMENT_NODE)e.unshift(t),t=t.parentNode;return e}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function ol(t,e){var n=il(t),r=il(e),i=0;while(n[i]==r[i]&&n[i])i++;return 0===i?null:n[i-1]}function al(t){return et(t)&&1===t.nodeType&&!ct(t)}var sl=al,ul=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(c["a"])(this,t),this.blockFiller=e.blockFiller||Ic,this.preElements=["pre"],this.blockElements=["p","div","h1","h2","h3","h4","h5","h6"],this._domToViewMapping=new Fu.a,this._viewToDomMapping=new Fu.a,this._fakeSelectionMapping=new Fu.a}return Object(l["a"])(t,[{key:"bindFakeSelection",value:function(t,e){this._fakeSelectionMapping.set(t,new ju(e))}},{key:"fakeSelectionToView",value:function(t){return this._fakeSelectionMapping.get(t)}},{key:"bindElements",value:function(t,e){this._domToViewMapping.set(t,e),this._viewToDomMapping.set(e,t)}},{key:"unbindDomElement",value:function(t){var e=this._domToViewMapping.get(t);if(e){this._domToViewMapping.delete(t),this._viewToDomMapping.delete(e);for(var n=gt()(t.childNodes),r=0;r<n.length;r++){var i=n[r];this.unbindDomElement(i)}}}},{key:"bindDocumentFragments",value:function(t,e){this._domToViewMapping.set(t,e),this._viewToDomMapping.set(e,t)}},{key:"viewToDom",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t.is("text")){var i=this._processDataFromViewText(t);return e.createTextNode(i)}if(this.mapViewToDom(t))return this.mapViewToDom(t);if(t.is("documentFragment"))n=e.createDocumentFragment(),r.bind&&this.bindDocumentFragments(n,t);else{if(t.is("uiElement"))return n=t.render(e),r.bind&&this.bindElements(n,t),n;n=e.createElement(t.name),r.bind&&this.bindElements(n,t);var o=!0,a=!1,s=void 0;try{for(var u,c=P()(t.getAttributeKeys());!(o=(u=c.next()).done);o=!0){var l=u.value;n.setAttribute(l,t.getAttribute(l))}}catch(g){a=!0,s=g}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}}if(r.withChildren||void 0===r.withChildren){var h=!0,f=!1,d=void 0;try{for(var p,v=P()(this.viewChildrenToDom(t,e,r));!(h=(p=v.next()).done);h=!0){var y=p.value;n.appendChild(y)}}catch(g){f=!0,d=g}finally{try{h||null==v.return||v.return()}finally{if(f)throw d}}}return n}},{key:"viewChildrenToDom",value:regeneratorRuntime.mark(function t(e,n){var r,i,o,a,s,u,c,l,h,f=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:r=f.length>2&&void 0!==f[2]?f[2]:{},i=e.getFillerOffset&&e.getFillerOffset(),o=0,a=!0,s=!1,u=void 0,t.prev=6,c=P()(e.getChildren());case 8:if(a=(l=c.next()).done){t.next=19;break}if(h=l.value,i!==o){t.next=13;break}return t.next=13,this.blockFiller(n);case 13:return t.next=15,this.viewToDom(h,n,r);case 15:o++;case 16:a=!0,t.next=8;break;case 19:t.next=25;break;case 21:t.prev=21,t.t0=t["catch"](6),s=!0,u=t.t0;case 25:t.prev=25,t.prev=26,a||null==c.return||c.return();case 28:if(t.prev=28,!s){t.next=31;break}throw u;case 31:return t.finish(28);case 32:return t.finish(25);case 33:if(i!==o){t.next=36;break}return t.next=36,this.blockFiller(n);case 36:case"end":return t.stop()}},t,this,[[6,21,25,33],[26,,28,32]])})},{key:"viewRangeToDom",value:function(t){var e=this.viewPositionToDom(t.start),n=this.viewPositionToDom(t.end),r=document.createRange();return r.setStart(e.parent,e.offset),r.setEnd(n.parent,n.offset),r}},{key:"viewPositionToDom",value:function(t){var e,n,r,i=t.parent;if(i.is("text")){var o=this.findCorrespondingDomText(i);if(!o)return null;var a=t.offset;return Dc(o)&&(a+=Pc),{parent:o,offset:a}}if(0===t.offset){if(e=this.mapViewToDom(i),!e)return null;r=e.childNodes[0]}else{var s=t.nodeBefore;if(n=s.is("text")?this.findCorrespondingDomText(s):this.mapViewToDom(t.nodeBefore),!n)return null;e=n.parentNode,r=n.nextSibling}if(Ac(r)&&Dc(r))return{parent:r,offset:Pc};var u=n?rl(n)+1:0;return{parent:e,offset:u}}},{key:"domToView",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Fc(t,this.blockFiller))return null;var n,r=this.getParentUIElement(t,this._domToViewMapping);if(r)return r;if(Ac(t)){if(jc(t))return null;var i=this._processDataFromDomText(t);return""===i?null:new bs(i)}if(this.isComment(t))return null;if(this.mapDomToView(t))return this.mapDomToView(t);if(this.isDocumentFragment(t))n=new hc,e.bind&&this.bindDocumentFragments(t,n);else{var o=e.keepOriginalCase?t.tagName:t.tagName.toLowerCase();n=new Ps(o),e.bind&&this.bindElements(t,n);for(var a=t.attributes,s=a.length-1;s>=0;s--)n._setAttribute(a[s].name,a[s].value)}if(e.withChildren||void 0===e.withChildren){var u=!0,c=!1,l=void 0;try{for(var h,f=P()(this.domChildrenToView(t,e));!(u=(h=f.next()).done);u=!0){var d=h.value;n._appendChild(d)}}catch(p){c=!0,l=p}finally{try{u||null==f.return||f.return()}finally{if(c)throw l}}}return n}},{key:"domChildrenToView",value:regeneratorRuntime.mark(function t(e){var n,r,i,o,a=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:n=a.length>1&&void 0!==a[1]?a[1]:{},r=0;case 2:if(!(r<e.childNodes.length)){t.next=11;break}if(i=e.childNodes[r],o=this.domToView(i,n),null===o){t.next=8;break}return t.next=8,o;case 8:r++,t.next=2;break;case 11:case"end":return t.stop()}},t,this)})},{key:"domSelectionToView",value:function(t){if(1===t.rangeCount){var e=t.getRangeAt(0).startContainer;Ac(e)&&(e=e.parentNode);var n=this.fakeSelectionToView(e);if(n)return n}for(var r=this.isDomSelectionBackward(t),i=[],o=0;o<t.rangeCount;o++){var a=t.getRangeAt(o),s=this.domRangeToView(a);s&&i.push(s)}return new ju(i,{backward:r})}},{key:"domRangeToView",value:function(t){var e=this.domPositionToView(t.startContainer,t.startOffset),n=this.domPositionToView(t.endContainer,t.endOffset);return e&&n?new Nu(e,n):null}},{key:"domPositionToView",value:function(t,e){if(Fc(t,this.blockFiller))return this.domPositionToView(t.parentNode,rl(t));var n=this.mapDomToView(t);if(n&&n.is("uiElement"))return Pu._createBefore(n);if(Ac(t)){if(jc(t))return this.domPositionToView(t.parentNode,rl(t));var r=this.findCorrespondingViewText(t),i=e;return r?(Dc(t)&&(i-=Pc,i=i<0?0:i),new Pu(r,i)):null}if(0===e){var o=this.mapDomToView(t);if(o)return new Pu(o,0)}else{var a=t.childNodes[e-1],s=Ac(a)?this.findCorrespondingViewText(a):this.mapDomToView(a);if(s&&s.parent)return new Pu(s.parent,s.index+1)}return null}},{key:"mapDomToView",value:function(t){return this.getParentUIElement(t)||this._domToViewMapping.get(t)}},{key:"findCorrespondingViewText",value:function(t){if(jc(t))return null;var e=this.getParentUIElement(t);if(e)return e;var n=t.previousSibling;if(n){if(!this.isElement(n))return null;var r=this.mapDomToView(n);if(r){var i=r.nextSibling;return i instanceof bs?r.nextSibling:null}}else{var o=this.mapDomToView(t.parentNode);if(o){var a=o.getChild(0);return a instanceof bs?a:null}}return null}},{key:"mapViewToDom",value:function(t){return this._viewToDomMapping.get(t)}},{key:"findCorrespondingDomText",value:function(t){var e=t.previousSibling;return e&&this.mapViewToDom(e)?this.mapViewToDom(e).nextSibling:!e&&t.parent&&this.mapViewToDom(t.parent)?this.mapViewToDom(t.parent).childNodes[0]:null}},{key:"focus",value:function(t){var e=this.mapViewToDom(t);if(e&&e.ownerDocument.activeElement!==e){var n=nl.window,r=n.scrollX,i=n.scrollY,o=[];ll(e,function(t){var e=t.scrollLeft,n=t.scrollTop;o.push([e,n])}),e.focus(),ll(e,function(t){var e=o.shift(),n=Ot(e,2),r=n[0],i=n[1];t.scrollLeft=r,t.scrollTop=i}),nl.window.scrollTo(r,i)}}},{key:"isElement",value:function(t){return t&&t.nodeType==Node.ELEMENT_NODE}},{key:"isDocumentFragment",value:function(t){return t&&t.nodeType==Node.DOCUMENT_FRAGMENT_NODE}},{key:"isComment",value:function(t){return t&&t.nodeType==Node.COMMENT_NODE}},{key:"isDomSelectionBackward",value:function(t){if(t.isCollapsed)return!1;var e=document.createRange();e.setStart(t.anchorNode,t.anchorOffset),e.setEnd(t.focusNode,t.focusOffset);var n=e.collapsed;return e.detach(),n}},{key:"getParentUIElement",value:function(t){var e=il(t);e.pop();while(e.length){var n=e.pop(),r=this._domToViewMapping.get(n);if(r&&r.is("uiElement"))return r}return null}},{key:"isDomSelectionCorrect",value:function(t){return this._isDomSelectionPositionCorrect(t.anchorNode,t.anchorOffset)&&this._isDomSelectionPositionCorrect(t.focusNode,t.focusOffset)}},{key:"_isDomSelectionPositionCorrect",value:function(t,e){if(Ac(t)&&Dc(t)&&e<Pc)return!1;if(this.isElement(t)&&Dc(t.childNodes[e]))return!1;var n=this.mapDomToView(t);return!n||!n.is("uiElement")}},{key:"_processDataFromViewText",value:function(t){var e=this,n=t.data;if(t.getAncestors().some(function(t){return e.preElements.includes(t.name)}))return n;if(" "==n.charAt(0)){var r=this._getTouchingViewTextNode(t,!1),i=r&&this._nodeEndsWithSpace(r);!i&&r||(n=""+n.substr(1))}if(" "==n.charAt(n.length-1)){var o=this._getTouchingViewTextNode(t,!0);o||(n=n.substr(0,n.length-1)+"")}return n.replace(/ {2}/g," ")}},{key:"_nodeEndsWithSpace",value:function(t){var e=this;if(t.getAncestors().some(function(t){return e.preElements.includes(t.name)}))return!1;var n=this._processDataFromViewText(t);return" "==n.charAt(n.length-1)}},{key:"_processDataFromDomText",value:function(t){var e=t.data;if(cl(t,this.preElements))return Mc(t);e=e.replace(/[ \n\t\r]{1,}/g," ");var n=this._getTouchingInlineDomNode(t,!1),r=this._getTouchingInlineDomNode(t,!0),i=this._checkShouldLeftTrimDomText(n),o=this._checkShouldRightTrimDomText(t,r);return i&&(e=e.replace(/^ /,"")),o&&(e=e.replace(/ $/,"")),e=Mc(new Text(e)),e=e.replace(/ \u00A0/g,"  "),i&&(e=e.replace(/^\u00A0/," ")),Ac(r)&&""!=r.data.charAt(0)||(e=e.replace(/\u00A0( *)$/," $1")),e}},{key:"_checkShouldLeftTrimDomText",value:function(t){return!t||(!!sl(t)||/[^\S\u00A0]/.test(t.data.charAt(t.data.length-1)))}},{key:"_checkShouldRightTrimDomText",value:function(t,e){return!e&&!Dc(t)}},{key:"_getTouchingViewTextNode",value:function(t,e){var n=new xu({startPosition:e?Pu._createAfter(t):Pu._createBefore(t),direction:e?"forward":"backward"}),r=!0,i=!1,o=void 0;try{for(var a,s=P()(n);!(r=(a=s.next()).done);r=!0){var u=a.value;if(u.item.is("containerElement"))return null;if(u.item.is("br"))return null;if(u.item.is("textProxy"))return u.item}}catch(c){i=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return null}},{key:"_getTouchingInlineDomNode",value:function(t,e){if(!t.parentNode)return null;var n=e?"nextNode":"previousNode",r=t.ownerDocument,i=il(t)[0],o=r.createTreeWalker(i,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,{acceptNode:function(t){return Ac(t)?NodeFilter.FILTER_ACCEPT:"BR"==t.tagName?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});o.currentNode=t;var a=o[n]();if(null!==a){var s=ol(t,a);if(s&&!cl(t,this.blockElements,s)&&!cl(a,this.blockElements,s))return a}return null}}]),t}();
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function cl(t,e,n){var r=il(t);return n&&(r=r.slice(r.indexOf(n)+1)),r.some(function(t){return t.tagName&&e.includes(t.tagName.toLowerCase())})}function ll(t,e){while(t&&t!=nl.document)e(t),t=t.parentNode}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function hl(t){var e=Object.prototype.toString.apply(t);return"[object Window]"==e||"[object global]"==e}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var fl=lu({},qt,{listenTo:function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(Kc(t)||hl(t)){var o=this._getProxyEmitter(t)||new pl(t);o.attach.apply(o,r),t=o}(e=qt.listenTo).call.apply(e,[this,t].concat(r))},stopListening:function(t,e,n){if(Kc(t)||hl(t)){var r=this._getProxyEmitter(t);if(!r)return;t=r}qt.stopListening.call(this,t,e,n),t instanceof pl&&t.detach(e)},_getProxyEmitter:function(t){return Wt(this,vl(t))}}),dl=fl,pl=function t(e){Object(c["a"])(this,t),Kt(this,vl(e)),this._domNode=e};function vl(t){return t["data-ck-expando"]||(t["data-ck-expando"]=Mt())}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */lu(pl.prototype,qt,{attach:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this._domListeners||!this._domListeners[t]){var r=this._createDomListener(t,!!n.useCapture);this._domNode.addEventListener(t,r,!!n.useCapture),this._domListeners||(this._domListeners={}),this._domListeners[t]=r}},detach:function(t){var e;!this._domListeners[t]||(e=this._events[t])&&e.callbacks.length||this._domListeners[t].removeListener()},_createDomListener:function(t,e){var n=this,r=function(e){n.fire(t,e)};return r.removeListener=function(){n._domNode.removeEventListener(t,r,e),delete n._domListeners[t]},r}});var yl=function(){function t(e){Object(c["a"])(this,t),this.view=e,this.document=e.document,this.isEnabled=!1}return Object(l["a"])(t,[{key:"enable",value:function(){this.isEnabled=!0}},{key:"disable",value:function(){this.isEnabled=!1}},{key:"destroy",value:function(){this.disable(),this.stopListening()}}]),t}();oe(yl,dl);var gl="__lodash_hash_undefined__";function ml(t){return this.__data__.set(t,gl),this}var bl=ml;function wl(t){return this.__data__.has(t)}var _l=wl;function kl(t){var e=-1,n=null==t?0:t.length;this.__data__=new Gn;while(++e<n)this.add(t[e])}kl.prototype.add=kl.prototype.push=bl,kl.prototype.has=_l;var El=kl;function Tl(t,e){var n=-1,r=null==t?0:t.length;while(++n<r)if(e(t[n],n,t))return!0;return!1}var Sl=Tl;function Cl(t,e){return t.has(e)}var Ol=Cl,Al=1,Il=2;function xl(t,e,n,r,i,o){var a=n&Al,s=t.length,u=e.length;if(s!=u&&!(a&&u>s))return!1;var c=o.get(t);if(c&&o.get(e))return c==e;var l=-1,h=!0,f=n&Il?new El:void 0;o.set(t,e),o.set(e,t);while(++l<s){var d=t[l],p=e[l];if(r)var v=a?r(p,d,l,e,t,o):r(d,p,l,t,e,o);if(void 0!==v){if(v)continue;h=!1;break}if(f){if(!Sl(e,function(t,e){if(!Ol(f,e)&&(d===t||i(d,t,n,r,o)))return f.push(e)})){h=!1;break}}else if(d!==p&&!i(d,p,n,r,o)){h=!1;break}}return o["delete"](t),o["delete"](e),h}var Pl=xl;function Nl(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}var Rl=Nl;function Dl(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}var jl=Dl,Ml=1,Ll=2,Fl="[object Boolean]",Vl="[object Date]",Bl="[object Error]",Ul="[object Map]",ql="[object Number]",Wl="[object RegExp]",Kl="[object Set]",Hl="[object String]",zl="[object Symbol]",Gl="[object ArrayBuffer]",Ql="[object DataView]",Yl=D?D.prototype:void 0,Xl=Yl?Yl.valueOf:void 0;function Jl(t,e,n,r,i,o,a){switch(n){case Ql:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Gl:return!(t.byteLength!=e.byteLength||!o(new Vo(t),new Vo(e)));case Fl:case Vl:case ql:return le(+t,+e);case Bl:return t.name==e.name&&t.message==e.message;case Wl:case Hl:return t==e+"";case Ul:var s=Rl;case Kl:var u=r&Ml;if(s||(s=jl),t.size!=e.size&&!u)return!1;var c=a.get(t);if(c)return c==e;r|=Ll,a.set(t,e);var l=Pl(s(t),s(e),r,i,o,a);return a["delete"](t),l;case zl:if(Xl)return Xl.call(t)==Xl.call(e)}return!1}var $l=Jl,Zl=1,th=Object.prototype,eh=th.hasOwnProperty;function nh(t,e,n,r,i,o){var a=n&Zl,s=co(t),u=s.length,c=co(e),l=c.length;if(u!=l&&!a)return!1;var h=u;while(h--){var f=s[h];if(!(a?f in e:eh.call(e,f)))return!1}var d=o.get(t);if(d&&o.get(e))return d==e;var p=!0;o.set(t,e),o.set(e,t);var v=a;while(++h<u){f=s[h];var y=t[f],g=e[f];if(r)var m=a?r(g,y,f,e,t,o):r(y,g,f,t,e,o);if(!(void 0===m?y===g||i(y,g,n,r,o):m)){p=!1;break}v||(v="constructor"==f)}if(p&&!v){var b=t.constructor,w=e.constructor;b!=w&&"constructor"in t&&"constructor"in e&&!("function"==typeof b&&b instanceof b&&"function"==typeof w&&w instanceof w)&&(p=!1)}return o["delete"](t),o["delete"](e),p}var rh=nh,ih=1,oh="[object Arguments]",ah="[object Array]",sh="[object Object]",uh=Object.prototype,ch=uh.hasOwnProperty;function lh(t,e,n,r,i,o){var a=kr(t),s=kr(e),u=a?ah:Ro(t),c=s?ah:Ro(e);u=u==oh?sh:u,c=c==oh?sh:c;var l=u==sh,h=c==sh,f=u==c;if(f&&Object(Er["a"])(t)){if(!Object(Er["a"])(e))return!1;a=!0,l=!1}if(f&&!l)return o||(o=new $n),a||ci(t)?Pl(t,e,n,r,i,o):$l(t,e,u,n,r,i,o);if(!(n&ih)){var d=l&&ch.call(t,"__wrapped__"),p=h&&ch.call(e,"__wrapped__");if(d||p){var v=d?t.value():t,y=p?e.value():e;return o||(o=new $n),i(v,y,n,r,o)}}return!!f&&(o||(o=new $n),rh(t,e,n,r,i,o))}var hh=lh;function fh(t,e,n,r,i){return t===e||(null==t||null==e||!et(t)&&!et(e)?t!==t&&e!==e:hh(t,e,n,r,fh,i))}var dh=fh;function ph(t,e,n){n="function"==typeof n?n:void 0;var r=n?n(t,e):void 0;return void 0===r?dh(t,e,void 0,n):!!r}var vh=ph,yh=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),n._config={childList:!0,characterData:!0,characterDataOldValue:!0,subtree:!0},n.domConverter=t.domConverter,n.renderer=t._renderer,n._domElements=[],n._mutationObserver=new window.MutationObserver(n._onMutations.bind(Object(O["a"])(Object(O["a"])(n)))),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"flush",value:function(){this._onMutations(this._mutationObserver.takeRecords())}},{key:"observe",value:function(t){this._domElements.push(t),this.isEnabled&&this._mutationObserver.observe(t,this._config)}},{key:"enable",value:function(){S(Object(b["a"])(e.prototype),"enable",this).call(this);var t=!0,n=!1,r=void 0;try{for(var i,o=P()(this._domElements);!(t=(i=o.next()).done);t=!0){var a=i.value;this._mutationObserver.observe(a,this._config)}}catch(s){n=!0,r=s}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"disable",value:function(){S(Object(b["a"])(e.prototype),"disable",this).call(this),this._mutationObserver.disconnect()}},{key:"destroy",value:function(){S(Object(b["a"])(e.prototype),"destroy",this).call(this),this._mutationObserver.disconnect()}},{key:"_onMutations",value:function(t){if(0!==t.length){var e=this.domConverter,n=new It.a,r=new Pt.a,i=!0,o=!1,a=void 0;try{for(var s,u=P()(t);!(i=(s=u.next()).done);i=!0){var c=s.value;if("childList"===c.type){var l=e.mapDomToView(c.target);if(l&&l.is("uiElement"))continue;l&&!this._isBogusBrMutation(c)&&r.add(l)}}}catch(U){o=!0,a=U}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}var h=!0,f=!1,d=void 0;try{for(var p,v=P()(t);!(h=(p=v.next()).done);h=!0){var y=p.value,g=e.mapDomToView(y.target);if((!g||!g.is("uiElement"))&&"characterData"===y.type){var m=e.findCorrespondingViewText(y.target);m&&!r.has(m.parent)?n.set(m,{type:"text",oldText:m.data,newText:Mc(y.target),node:m}):!m&&Dc(y.target)&&r.add(e.mapDomToView(y.target.parentNode))}}}catch(U){f=!0,d=U}finally{try{h||null==v.return||v.return()}finally{if(f)throw d}}var b=[],w=!0,_=!1,k=void 0;try{for(var E,T=P()(n.values());!(w=(E=T.next()).done);w=!0){var S=E.value;this.renderer.markToSync("text",S.node),b.push(S)}}catch(U){_=!0,k=U}finally{try{w||null==T.return||T.return()}finally{if(_)throw k}}var C=!0,O=!1,A=void 0;try{for(var I,x=P()(r);!(C=(I=x.next()).done);C=!0){var N=I.value,R=e.mapViewToDom(N),D=gt()(N.getChildren()),j=gt()(e.domChildrenToView(R,{withChildren:!1}));vh(D,j,B)||(this.renderer.markToSync("children",N),b.push({type:"children",oldChildren:D,newChildren:j,node:N}))}}catch(U){O=!0,A=U}finally{try{C||null==x.return||x.return()}finally{if(O)throw A}}var M=t[0].target.ownerDocument.getSelection(),L=null;if(M&&M.anchorNode){var F=e.domPositionToView(M.anchorNode,M.anchorOffset),V=e.domPositionToView(M.focusNode,M.focusOffset);F&&V&&(L=new ju(F),L.setFocus(V))}this.document.fire("mutations",b,L),this.view.render()}function B(t,e){if(!pt()(t))return t===e||!(!t.is("text")||!e.is("text"))&&t.data===e.data}}},{key:"_isBogusBrMutation",value:function(t){var e=null;return null===t.nextSibling&&0===t.removedNodes.length&&1==t.addedNodes.length&&(e=this.domConverter.domToView(t.addedNodes[0],{withChildren:!1})),e&&e.is("element","br")}}]),e}(yl),gh=function(){function t(e,n,r){Object(c["a"])(this,t),this.view=e,this.document=e.document,this.domEvent=n,this.domTarget=n.target,lu(this,r)}return Object(l["a"])(t,[{key:"preventDefault",value:function(){this.domEvent.preventDefault()}},{key:"stopPropagation",value:function(){this.domEvent.stopPropagation()}},{key:"target",get:function(){return this.view.domConverter.mapDomToView(this.domTarget)}}]),t}(),mh=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),n.useCapture=!1,n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"observe",value:function(t){var e=this,n="string"==typeof this.domEventType?[this.domEventType]:this.domEventType;n.forEach(function(n){e.listenTo(t,n,function(t,n){e.isEnabled&&e.onDomEvent(n)},{useCapture:e.useCapture})})}},{key:"fire",value:function(t,e,n){this.isEnabled&&this.document.fire(t,new gh(this.view,e,n))}}]),e}(yl),bh=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),n.domEventType=["keydown","keyup"],n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"onDomEvent",value:function(t){this.fire(t.type,t,{keyCode:t.keyCode,altKey:t.altKey,ctrlKey:t.ctrlKey||t.metaKey,shiftKey:t.shiftKey,get keystroke(){return nc(this)}})}}]),e}(mh),wh=function(){return N["a"].Date.now()},_h=wh,kh="[object Symbol]";
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function Eh(t){return"symbol"==typeof t||et(t)&&Y(t)==kh}var Th=Eh,Sh=NaN,Ch=/^\s+|\s+$/g,Oh=/^[-+]0x[0-9a-f]+$/i,Ah=/^0b[01]+$/i,Ih=/^0o[0-7]+$/i,xh=parseInt;function Ph(t){if("number"==typeof t)return t;if(Th(t))return Sh;if(De(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=De(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(Ch,"");var n=Ah.test(t);return n||Ih.test(t)?xh(t.slice(2),n?2:8):Oh.test(t)?Sh:+t}var Nh=Ph,Rh="Expected a function",Dh=Math.max,jh=Math.min;function Mh(t,e,n){var r,i,o,a,s,u,c=0,l=!1,h=!1,f=!0;if("function"!=typeof t)throw new TypeError(Rh);function d(e){var n=r,o=i;return r=i=void 0,c=e,a=t.apply(o,n),a}function p(t){return c=t,s=setTimeout(g,e),l?d(t):a}function v(t){var n=t-u,r=t-c,i=e-n;return h?jh(i,o-r):i}function y(t){var n=t-u,r=t-c;return void 0===u||n>=e||n<0||h&&r>=o}function g(){var t=_h();if(y(t))return m(t);s=setTimeout(g,v(t))}function m(t){return s=void 0,f&&r?d(t):(r=i=void 0,a)}function b(){void 0!==s&&clearTimeout(s),c=0,r=u=i=s=void 0}function w(){return void 0===s?a:m(_h())}function _(){var t=_h(),n=y(t);if(r=arguments,i=this,u=t,n){if(void 0===s)return p(u);if(h)return s=setTimeout(g,e),d(u)}return void 0===s&&(s=setTimeout(g,e)),a}return e=Nh(e)||0,De(n)&&(l=!!n.leading,h="maxWait"in n,o=h?Dh(Nh(n.maxWait)||0,e):o,f="trailing"in n?!!n.trailing:f),_.cancel=b,_.flush=w,_}var Lh=Mh,Fh=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),n._fireSelectionChangeDoneDebounced=Lh(function(t){return n.document.fire("selectionChangeDone",t)},200),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"observe",value:function(){var t=this,e=this.document;e.on("keydown",function(n,r){var i=e.selection;i.isFake&&Vh(r.keyCode)&&t.isEnabled&&(r.preventDefault(),t._handleSelectionMove(r.keyCode))},{priority:"lowest"})}},{key:"destroy",value:function(){S(Object(b["a"])(e.prototype),"destroy",this).call(this),this._fireSelectionChangeDoneDebounced.cancel()}},{key:"_handleSelectionMove",value:function(t){var e=this.document.selection,n=new ju(e.getRanges(),{backward:e.isBackward,fake:!1});t!=ec.arrowleft&&t!=ec.arrowup||n.setTo(n.getFirstPosition()),t!=ec.arrowright&&t!=ec.arrowdown||n.setTo(n.getLastPosition());var r={oldSelection:e,newSelection:n,domSelection:null};this.document.fire("selectionChange",r),this._fireSelectionChangeDoneDebounced(r)}}]),e}(yl);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function Vh(t){return t==ec.arrowright||t==ec.arrowleft||t==ec.arrowup||t==ec.arrowdown}var Bh=n("a098"),Uh=n.n(Bh),qh=n("cd4b"),Wh=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),n.mutationObserver=t.getObserver(yh),n.selection=n.document.selection,n.domConverter=t.domConverter,n._documents=new Uh.a,n._fireSelectionChangeDoneDebounced=Lh(function(t){return n.document.fire("selectionChangeDone",t)},200),n._clearInfiniteLoopInterval=setInterval(function(){return n._clearInfiniteLoop()},1e3),n._loopbackCounter=0,n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"observe",value:function(t){var e=this,n=t.ownerDocument;this._documents.has(n)||(this.listenTo(n,"selectionchange",function(){e._handleSelectionChange(n)}),this._documents.add(n))}},{key:"destroy",value:function(){S(Object(b["a"])(e.prototype),"destroy",this).call(this),clearInterval(this._clearInfiniteLoopInterval),this._fireSelectionChangeDoneDebounced.cancel()}},{key:"_handleSelectionChange",value:function(t){if(this.isEnabled&&(this.document.isFocused||this.document.isReadOnly)){this.mutationObserver.flush();var e=t.defaultView.getSelection(),n=this.domConverter.domSelectionToView(e);if(!this.selection.isEqual(n)||!this.domConverter.isDomSelectionCorrect(e))if(++this._loopbackCounter>60)qh["a"].warn("selectionchange-infinite-loop: Selection change observer detected an infinite rendering loop.");else if(this.selection.isSimilar(n))this.view.render();else{var r={oldSelection:this.selection,newSelection:n,domSelection:e};this.document.fire("selectionChange",r),this._fireSelectionChangeDoneDebounced(r)}}}},{key:"_clearInfiniteLoop",value:function(){this._loopbackCounter=0}}]),e}(yl),Kh=function(t){function e(t){var n;Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),n.domEventType=["focus","blur"],n.useCapture=!0;var r=n.document;return r.on("focus",function(){r.isFocused=!0,n._renderTimeoutId=setTimeout(function(){return t.render()},50)}),r.on("blur",function(e,n){var i=r.selection.editableElement;null!==i&&i!==n.target||(r.isFocused=!1,t.render())}),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"onDomEvent",value:function(t){this.fire(t.type,t)}},{key:"destroy",value:function(){this._renderTimeoutId&&clearTimeout(this._renderTimeoutId),S(Object(b["a"])(e.prototype),"destroy",this).call(this)}}]),e}(mh),Hh=function(t){function e(t){var n;Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),n.domEventType=["compositionstart","compositionupdate","compositionend"];var r=n.document;return r.on("compositionstart",function(){r.isComposing=!0}),r.on("compositionend",function(){r.isComposing=!1}),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"onDomEvent",value:function(t){this.fire(t.type,t)}}]),e}(mh);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
function zh(t){return"[object Range]"==Object.prototype.toString.apply(t)}var Gh=n("e814"),Qh=n.n(Gh);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
function Yh(t){var e=t.ownerDocument.defaultView.getComputedStyle(t);return{top:Qh()(e.borderTopWidth,10),right:Qh()(e.borderRightWidth,10),bottom:Qh()(e.borderBottomWidth,10),left:Qh()(e.borderLeftWidth,10)}}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Xh=["top","right","bottom","left","width","height"],Jh=function(){function t(e){Object(c["a"])(this,t);var n=zh(e);if(Object.defineProperty(this,"_source",{value:e._source||e,writable:!0,enumerable:!1}),sl(e)||n){var r=n?e.startContainer:e;r.ownerDocument&&r.ownerDocument.body.contains(r)||qh["a"].warn("rect-source-not-in-dom: The source of this rect does not belong to any rendered DOM tree.",{source:e}),$h(this,n?t.getDomRangeRects(e)[0]:e.getBoundingClientRect())}else if(hl(e)){var i=e.innerWidth,o=e.innerHeight;$h(this,{top:0,right:i,bottom:o,left:0,width:i,height:o})}else $h(this,e)}return Object(l["a"])(t,[{key:"clone",value:function(){return new t(this)}},{key:"moveTo",value:function(t,e){return this.top=e,this.right=t+this.width,this.bottom=e+this.height,this.left=t,this}},{key:"moveBy",value:function(t,e){return this.top+=e,this.right+=t,this.left+=t,this.bottom+=e,this}},{key:"getIntersection",value:function(e){var n={top:Math.max(this.top,e.top),right:Math.min(this.right,e.right),bottom:Math.min(this.bottom,e.bottom),left:Math.max(this.left,e.left)};return n.width=n.right-n.left,n.height=n.bottom-n.top,n.width<0||n.height<0?null:new t(n)}},{key:"getIntersectionArea",value:function(t){var e=this.getIntersection(t);return e?e.getArea():0}},{key:"getArea",value:function(){return this.width*this.height}},{key:"getVisible",value:function(){var e=this._source,n=this.clone();if(!Zh(e)){var r=e.parentNode||e.commonAncestorContainer;while(r&&!Zh(r)){var i=new t(r),o=n.getIntersection(i);if(!o)return null;o.getArea()<n.getArea()&&(n=o),r=r.parentNode}}return n}},{key:"isEqual",value:function(t){for(var e=0;e<Xh.length;e++){var n=Xh[e];if(this[n]!==t[n])return!1}return!0}},{key:"contains",value:function(t){var e=this.getIntersection(t);return!(!e||!e.isEqual(t))}},{key:"excludeScrollbarsAndBorders",value:function(){var t,e,n=this._source;if(hl(n))t=n.innerWidth-n.document.documentElement.clientWidth,e=n.innerHeight-n.document.documentElement.clientHeight;else{var r=Yh(this._source);t=n.offsetWidth-n.clientWidth,e=n.offsetHeight-n.clientHeight,this.moveBy(r.left,r.top)}return this.width-=t,this.right-=t,this.height-=e,this.bottom-=e,this}}],[{key:"getDomRangeRects",value:function(e){var n=[],r=gt()(e.getClientRects());if(r.length){var i=!0,o=!1,a=void 0;try{for(var s,u=P()(r);!(i=(s=u.next()).done);i=!0){var c=s.value;n.push(new t(c))}}catch(f){o=!0,a=f}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}}else{var l=e.startContainer;Ac(l)&&(l=l.parentNode);var h=new t(l.getBoundingClientRect());h.right=h.left,h.width=0,n.push(h)}return n}}]),t}();function $h(t,e){for(var n=0;n<Xh.length;n++){var r=Xh[n];t[r]=e[r]}}function Zh(t){return!!sl(t)&&t===t.ownerDocument.body}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var tf={};function ef(t){var e=t.target,n=t.viewportOffset,r=void 0===n?0:n,i=lf(e),o=i,a=null;while(o){var s=void 0;s=hf(o==i?e:a),of(s,function(){return ff(e,o)});var u=ff(e,o);if(rf(o,u,r),o.parent!=o){if(a=o.frameElement,o=o.parent,!a)return}else o=null}}function nf(t){var e=hf(t);of(e,function(){return new Jh(t)})}function rf(t,e,n){var r=e.clone().moveBy(0,n),i=e.clone().moveBy(0,-n),o=new Jh(t).excludeScrollbarsAndBorders(),a=[i,r];if(!a.every(function(t){return o.contains(t)})){var s=t.scrollX,u=t.scrollY;sf(i,o)?u-=o.top-e.top+n:af(r,o)&&(u+=e.bottom-o.bottom+n),uf(e,o)?s-=o.left-e.left+n:cf(e,o)&&(s+=e.right-o.right+n),t.scrollTo(s,u)}}function of(t,e){var n,r,i=lf(t);while(t!=i.document.body)r=e(),n=new Jh(t).excludeScrollbarsAndBorders(),n.contains(r)||(sf(r,n)?t.scrollTop-=n.top-r.top:af(r,n)&&(t.scrollTop+=r.bottom-n.bottom),uf(r,n)?t.scrollLeft-=n.left-r.left:cf(r,n)&&(t.scrollLeft+=r.right-n.right)),t=t.parentNode}function af(t,e){return t.bottom>e.bottom}function sf(t,e){return t.top<e.top}function uf(t,e){return t.left<e.left}function cf(t,e){return t.right>e.right}function lf(t){return zh(t)?t.startContainer.ownerDocument.defaultView:t.ownerDocument.defaultView}function hf(t){if(zh(t)){var e=t.commonAncestorContainer;return Ac(e)&&(e=e.parentNode),e}return t.parentNode}function ff(t,e){var n=lf(t),r=new Jh(t);if(n===e)return r;var i=n;while(i!=e){var o=i.frameElement,a=new Jh(o).excludeScrollbarsAndBorders();r.moveBy(a.left,a.top),i=i.parent}return r}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */Oc()(tf,{scrollViewportToShowTarget:ef,scrollAncestorsToShowTarget:nf});var df=function(){function t(){var e=this;Object(c["a"])(this,t),this.document=new Bu,this.domConverter=new ul,this._renderer=new Xc(this.domConverter,this.document.selection),this._renderer.bind("isFocused").to(this.document),this.domRoots=new It.a,this._observers=new It.a,this._ongoingChange=!1,this._renderingInProgress=!1,this._postFixersInProgress=!1,this._renderingDisabled=!1,this._writer=new dc(this.document),this.addObserver(yh),this.addObserver(Wh),this.addObserver(Kh),this.addObserver(bh),this.addObserver(Fh),this.addObserver(Hh),Vc(this),uc(this),this.on("render",function(){e._render(),e.document.fire("layoutChanged")})}return Object(l["a"])(t,[{key:"attachDomRoot",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"main",r=this.document.getRoot(n);r._name=t.tagName.toLowerCase(),this.domRoots.set(n,t),this.domConverter.bindElements(t,r),this._renderer.markToSync("children",r),this._renderer.domDocuments.add(t.ownerDocument),r.on("change:children",function(t,n){return e._renderer.markToSync("children",n)}),r.on("change:attributes",function(t,n){return e._renderer.markToSync("attributes",n)}),r.on("change:text",function(t,n){return e._renderer.markToSync("text",n)});var i=!0,o=!1,a=void 0;try{for(var s,u=P()(this._observers.values());!(i=(s=u.next()).done);i=!0){var c=s.value;c.observe(t,n)}}catch(l){o=!0,a=l}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}}},{key:"getDomRoot",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main";return this.domRoots.get(t)}},{key:"addObserver",value:function(t){var e=this._observers.get(t);if(e)return e;e=new t(this),this._observers.set(t,e);var n=!0,r=!1,i=void 0;try{for(var o,a=P()(this.domRoots);!(n=(o=a.next()).done);n=!0){var s=Ot(o.value,2),u=s[0],c=s[1];e.observe(c,u)}}catch(l){r=!0,i=l}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e.enable(),e}},{key:"getObserver",value:function(t){return this._observers.get(t)}},{key:"disableObservers",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=P()(this._observers.values());!(t=(r=i.next()).done);t=!0){var o=r.value;o.disable()}}catch(a){e=!0,n=a}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}},{key:"enableObservers",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=P()(this._observers.values());!(t=(r=i.next()).done);t=!0){var o=r.value;o.enable()}}catch(a){e=!0,n=a}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}},{key:"scrollToTheSelection",value:function(){var t=this.document.selection.getFirstRange();t&&ef({target:this.domConverter.viewRangeToDom(t),viewportOffset:20})}},{key:"focus",value:function(){if(!this.document.isFocused){var t=this.document.selection.editableElement;t?(this.domConverter.focus(t),this.render()):qh["a"].warn("view-focus-no-selection: There is no selection in any editable to focus.")}}},{key:"change",value:function(t){if(this._renderingInProgress||this._postFixersInProgress)throw new Nt["b"]("cannot-change-view-tree: Attempting to make changes to the view when it is in an incorrect state: rendering or post-fixers are in progress. This may cause some unexpected behavior and inconsistency between the DOM and the view.");if(this._ongoingChange)return t(this._writer);this._ongoingChange=!0;var e=t(this._writer);return this._ongoingChange=!1,this._renderingDisabled||(this._postFixersInProgress=!0,this.document._callPostFixers(this._writer),this._postFixersInProgress=!1,this.fire("render")),e}},{key:"render",value:function(){this.change(function(){})}},{key:"destroy",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=P()(this._observers.values());!(t=(r=i.next()).done);t=!0){var o=r.value;o.destroy()}}catch(a){e=!0,n=a}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}this.stopListening()}},{key:"createPositionAt",value:function(t,e){return Pu._createAt(t,e)}},{key:"createPositionAfter",value:function(t){return Pu._createAfter(t)}},{key:"createPositionBefore",value:function(t){return Pu._createBefore(t)}},{key:"createRange",value:function(t,e){return new Nu(t,e)}},{key:"createRangeOn",value:function(t){return Nu._createOn(t)}},{key:"createRangeIn",value:function(t){return Nu._createIn(t)}},{key:"createSelection",value:function(t,e,n){return new ju(t,e,n)}},{key:"_render",value:function(){this._renderingInProgress=!0,this.disableObservers(),this._renderer.render(),this.enableObservers(),this._renderingInProgress=!1}}]),t}();
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
function pf(t){return ct(t)?_s(t):new It.a(t)}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */oe(df,vu);var vf=function(){function t(e){Object(c["a"])(this,t),this.parent=null,this._attrs=pf(e)}return Object(l["a"])(t,[{key:"getPath",value:function(){var t=[],e=this;while(e.parent)t.unshift(e.startOffset),e=e.parent;return t}},{key:"getAncestors",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{includeSelf:!1,parentFirst:!1},e=[],n=t.includeSelf?this:this.parent;while(n)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}},{key:"getCommonAncestor",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getAncestors(e),r=t.getAncestors(e),i=0;while(n[i]==r[i]&&n[i])i++;return 0===i?null:n[i-1]}},{key:"isBefore",value:function(t){if(this==t)return!1;if(this.root!==t.root)return!1;var e=this.getPath(),n=t.getPath(),r=ae(e,n);switch(r){case"prefix":return!0;case"extension":return!1;default:return e[r]<n[r]}}},{key:"isAfter",value:function(t){return this!=t&&(this.root===t.root&&!this.isBefore(t))}},{key:"hasAttribute",value:function(t){return this._attrs.has(t)}},{key:"getAttribute",value:function(t){return this._attrs.get(t)}},{key:"getAttributes",value:function(){return this._attrs.entries()}},{key:"getAttributeKeys",value:function(){return this._attrs.keys()}},{key:"toJSON",value:function(){var t={};return this._attrs.size&&(t.attributes=gt()(this._attrs).reduce(function(t,e){return t[e[0]]=e[1],t},{})),t}},{key:"_clone",value:function(){return new t(this._attrs)}},{key:"_remove",value:function(){this.parent._removeChildren(this.index)}},{key:"_setAttribute",value:function(t,e){this._attrs.set(t,e)}},{key:"_setAttributesTo",value:function(t){this._attrs=pf(t)}},{key:"_removeAttribute",value:function(t){return this._attrs.delete(t)}},{key:"_clearAttributes",value:function(){this._attrs.clear()}},{key:"is",value:function(t){return"node"==t}},{key:"index",get:function(){var t;if(!this.parent)return null;if(null===(t=this.parent.getChildIndex(this)))throw new Nt["b"]("model-node-not-found-in-parent: The node's parent does not contain this node.");return t}},{key:"startOffset",get:function(){var t;if(!this.parent)return null;if(null===(t=this.parent.getChildStartOffset(this)))throw new Nt["b"]("model-node-not-found-in-parent: The node's parent does not contain this node.");return t}},{key:"offsetSize",get:function(){return 1}},{key:"endOffset",get:function(){return this.parent?this.startOffset+this.offsetSize:null}},{key:"nextSibling",get:function(){var t=this.index;return null!==t&&this.parent.getChild(t+1)||null}},{key:"previousSibling",get:function(){var t=this.index;return null!==t&&this.parent.getChild(t-1)||null}},{key:"root",get:function(){var t=this;while(t.parent)t=t.parent;return t}},{key:"document",get:function(){return this.root==this?null:this.root.document||null}}]),t}(),yf=function(t){function e(t,n){var r;return Object(c["a"])(this,e),r=Object(m["a"])(this,Object(b["a"])(e).call(this,n)),r._data=t||"",r}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"is",value:function(t){return"text"==t||S(Object(b["a"])(e.prototype),"is",this).call(this,t)}},{key:"toJSON",value:function(){var t=S(Object(b["a"])(e.prototype),"toJSON",this).call(this);return t.data=this.data,t}},{key:"_clone",value:function(){return new e(this.data,this.getAttributes())}},{key:"offsetSize",get:function(){return this.data.length}},{key:"data",get:function(){return this._data}}],[{key:"fromJSON",value:function(t){return new e(t.data,t.attributes)}}]),e}(vf),gf=function(){function t(e,n,r){if(Object(c["a"])(this,t),this.textNode=e,n<0||n>e.offsetSize)throw new Nt["b"]("model-textproxy-wrong-offsetintext: Given offsetInText value is incorrect.");if(r<0||n+r>e.offsetSize)throw new Nt["b"]("model-textproxy-wrong-length: Given length value is incorrect.");this.data=e.data.substring(n,n+r),this.offsetInText=n}return Object(l["a"])(t,[{key:"is",value:function(t){return"textProxy"==t}},{key:"getPath",value:function(){var t=this.textNode.getPath();return t.length>0&&(t[t.length-1]+=this.offsetInText),t}},{key:"getAncestors",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{includeSelf:!1,parentFirst:!1},e=[],n=t.includeSelf?this:this.parent;while(n)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}},{key:"hasAttribute",value:function(t){return this.textNode.hasAttribute(t)}},{key:"getAttribute",value:function(t){return this.textNode.getAttribute(t)}},{key:"getAttributes",value:function(){return this.textNode.getAttributes()}},{key:"getAttributeKeys",value:function(){return this.textNode.getAttributeKeys()}},{key:"startOffset",get:function(){return null!==this.textNode.startOffset?this.textNode.startOffset+this.offsetInText:null}},{key:"offsetSize",get:function(){return this.data.length}},{key:"endOffset",get:function(){return null!==this.startOffset?this.startOffset+this.offsetSize:null}},{key:"isPartial",get:function(){return this.offsetSize!==this.textNode.offsetSize}},{key:"parent",get:function(){return this.textNode.parent}},{key:"root",get:function(){return this.textNode.root}},{key:"document",get:function(){return this.textNode.document}}]),t}(),mf=function(){function t(e){Object(c["a"])(this,t),this._nodes=[],e&&this._insertNodes(0,e)}return Object(l["a"])(t,[{key:Es.a,value:function(){return P()(this._nodes)}},{key:"getNode",value:function(t){return this._nodes[t]||null}},{key:"getNodeIndex",value:function(t){var e=this._nodes.indexOf(t);return-1==e?null:e}},{key:"getNodeStartOffset",value:function(t){var e=this.getNodeIndex(t);return null===e?null:this._nodes.slice(0,e).reduce(function(t,e){return t+e.offsetSize},0)}},{key:"indexToOffset",value:function(t){if(t==this._nodes.length)return this.maxOffset;var e=this._nodes[t];if(!e)throw new Nt["b"]("model-nodelist-index-out-of-bounds: Given index cannot be found in the node list.");return this.getNodeStartOffset(e)}},{key:"offsetToIndex",value:function(t){var e=0,n=!0,r=!1,i=void 0;try{for(var o,a=P()(this._nodes);!(n=(o=a.next()).done);n=!0){var s=o.value;if(t>=e&&t<e+s.offsetSize)return this.getNodeIndex(s);e+=s.offsetSize}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}if(e!=t)throw new Nt["b"]("model-nodelist-offset-out-of-bounds: Given offset cannot be found in the node list.",{offset:t,nodeList:this});return this.length}},{key:"_insertNodes",value:function(t,e){var n,r=!0,i=!1,o=void 0;try{for(var a,s=P()(e);!(r=(a=s.next()).done);r=!0){var u=a.value;if(!(u instanceof vf))throw new Nt["b"]("model-nodelist-insertNodes-not-node: Trying to insert an object which is not a Node instance.")}}catch(c){i=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}(n=this._nodes).splice.apply(n,[t,0].concat(kt(e)))}},{key:"_removeNodes",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._nodes.splice(t,e)}},{key:"toJSON",value:function(){return this._nodes.map(function(t){return t.toJSON()})}},{key:"length",get:function(){return this._nodes.length}},{key:"maxOffset",get:function(){return this._nodes.reduce(function(t,e){return t+e.offsetSize},0)}}]),t}(),bf=function(t){function e(t,n,r){var i;return Object(c["a"])(this,e),i=Object(m["a"])(this,Object(b["a"])(e).call(this,n)),i.name=t,i._children=new mf,r&&i._insertChild(0,r),i}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"is",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return n?"element"==t&&n==this.name:"element"==t||t==this.name||S(Object(b["a"])(e.prototype),"is",this).call(this,t)}},{key:"getChild",value:function(t){return this._children.getNode(t)}},{key:"getChildren",value:function(){return P()(this._children)}},{key:"getChildIndex",value:function(t){return this._children.getNodeIndex(t)}},{key:"getChildStartOffset",value:function(t){return this._children.getNodeStartOffset(t)}},{key:"offsetToIndex",value:function(t){return this._children.offsetToIndex(t)}},{key:"getNodeByPath",value:function(t){var e=this,n=!0,r=!1,i=void 0;try{for(var o,a=P()(t);!(n=(o=a.next()).done);n=!0){var s=o.value;e=e.getChild(e.offsetToIndex(s))}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}},{key:"toJSON",value:function(){var t=S(Object(b["a"])(e.prototype),"toJSON",this).call(this);if(t.name=this.name,this._children.length>0){t.children=[];var n=!0,r=!1,i=void 0;try{for(var o,a=P()(this._children);!(n=(o=a.next()).done);n=!0){var s=o.value;t.children.push(s.toJSON())}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}return t}},{key:"_clone",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=t?gt()(this._children).map(function(t){return t._clone(!0)}):null;return new e(this.name,this.getAttributes(),n)}},{key:"_appendChild",value:function(t){this._insertChild(this.childCount,t)}},{key:"_insertChild",value:function(t,e){var n=wf(e),r=!0,i=!1,o=void 0;try{for(var a,s=P()(n);!(r=(a=s.next()).done);r=!0){var u=a.value;null!==u.parent&&u._remove(),u.parent=this}}catch(c){i=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}this._children._insertNodes(t,n)}},{key:"_removeChildren",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this._children._removeNodes(t,e),r=!0,i=!1,o=void 0;try{for(var a,s=P()(n);!(r=(a=s.next()).done);r=!0){var u=a.value;u.parent=null}}catch(c){i=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}},{key:"childCount",get:function(){return this._children.length}},{key:"maxOffset",get:function(){return this._children.maxOffset}},{key:"isEmpty",get:function(){return 0===this.childCount}}],[{key:"fromJSON",value:function(t){var n=null;if(t.children){n=[];var r=!0,i=!1,o=void 0;try{for(var a,s=P()(t.children);!(r=(a=s.next()).done);r=!0){var u=a.value;u.name?n.push(e.fromJSON(u)):n.push(yf.fromJSON(u))}}catch(c){i=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}return new e(t.name,t.attributes,n)}}]),e}(vf);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function wf(t){return"string"==typeof t?[new yf(t)]:(Ts(t)||(t=[t]),gt()(t).map(function(t){return"string"==typeof t?new yf(t):t instanceof gf?new yf(t.data,t.getAttributes()):t}))}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var _f=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object(c["a"])(this,t),!e.boundaries&&!e.startPosition)throw new Nt["b"]("model-tree-walker-no-start-position: Neither boundaries nor starting position have been defined.");var n=e.direction||"forward";if("forward"!=n&&"backward"!=n)throw new Nt["b"]("model-tree-walker-unknown-direction: Only `backward` and `forward` direction allowed.",{direction:n});this.direction=n,this.boundaries=e.boundaries||null,e.startPosition?this.position=e.startPosition.clone():this.position=Sf._createAt(this.boundaries["backward"==this.direction?"end":"start"]),this.position.stickiness="toNone",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null,this._visitedParent=this.position.parent}return Object(l["a"])(t,[{key:Es.a,value:function(){return this}},{key:"skip",value:function(t){var e,n,r,i;do{r=this.position,i=this._visitedParent;var o=this.next();e=o.done,n=o.value}while(!e&&t(n));e||(this.position=r,this._visitedParent=i)}},{key:"next",value:function(){return"forward"==this.direction?this._next():this._previous()}},{key:"_next",value:function(){var t=this.position,e=this.position.clone(),n=this._visitedParent;if(null===n.parent&&e.offset===n.maxOffset)return{done:!0};if(n===this._boundaryEndParent&&e.offset==this.boundaries.end.offset)return{done:!0};var r=e.textNode?e.textNode:e.nodeAfter;if(r instanceof bf)return this.shallow?e.offset++:(e.path.push(0),this._visitedParent=r),this.position=e,kf("elementStart",r,t,e,1);if(r instanceof yf){var i;if(this.singleCharacters)i=1;else{var o=r.endOffset;this._boundaryEndParent==n&&this.boundaries.end.offset<o&&(o=this.boundaries.end.offset),i=o-e.offset}var a=e.offset-r.startOffset,s=new gf(r,a,i);return e.offset+=i,this.position=e,kf("text",s,t,e,i)}return e.path.pop(),e.offset++,this.position=e,this._visitedParent=n.parent,this.ignoreElementEnd?this._next():kf("elementEnd",n,t,e)}},{key:"_previous",value:function(){var t=this.position,e=this.position.clone(),n=this._visitedParent;if(null===n.parent&&0===e.offset)return{done:!0};if(n==this._boundaryStartParent&&e.offset==this.boundaries.start.offset)return{done:!0};var r=e.textNode?e.textNode:e.nodeBefore;if(r instanceof bf)return e.offset--,this.shallow?(this.position=e,kf("elementStart",r,t,e,1)):(e.path.push(r.maxOffset),this.position=e,this._visitedParent=r,this.ignoreElementEnd?this._previous():kf("elementEnd",r,t,e));if(r instanceof yf){var i;if(this.singleCharacters)i=1;else{var o=r.startOffset;this._boundaryStartParent==n&&this.boundaries.start.offset>o&&(o=this.boundaries.start.offset),i=e.offset-o}var a=e.offset-r.startOffset,s=new gf(r,a-i,i);return e.offset-=i,this.position=e,kf("text",s,t,e,i)}return e.path.pop(),this.position=e,this._visitedParent=n.parent,kf("elementStart",n,t,e,1)}}]),t}();function kf(t,e,n,r,i){return{done:!1,value:{type:t,item:e,previousPosition:n,nextPosition:r,length:i}}}function Ef(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}var Tf=Ef,Sf=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"toNone";if(Object(c["a"])(this,t),!e.is("element")&&!e.is("documentFragment"))throw new Nt["b"]("model-position-root-invalid: Position root invalid.");if(!(n instanceof Array)||0===n.length)throw new Nt["b"]("model-position-path-incorrect: Position path must be an array with at least one item.",{path:n});n=e.getPath().concat(n),e=e.root,this.root=e,this.path=n,this.stickiness=r}return Object(l["a"])(t,[{key:"compareWith",value:function(t){if(this.root!=t.root)return"different";var e=ae(this.path,t.path);switch(e){case"same":return"same";case"prefix":return"before";case"extension":return"after";default:return this.path[e]<t.path[e]?"before":"after"}}},{key:"getLastMatchingPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.startPosition=this;var n=new _f(e);return n.skip(t),n.position}},{key:"getParentPath",value:function(){return this.path.slice(0,-1)}},{key:"getAncestors",value:function(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}},{key:"getCommonPath",value:function(t){if(this.root!=t.root)return[];var e=ae(this.path,t.path),n="string"==typeof e?Math.min(this.path.length,t.path.length):e;return this.path.slice(0,n)}},{key:"getCommonAncestor",value:function(t){var e=this.getAncestors(),n=t.getAncestors(),r=0;while(e[r]==n[r]&&e[r])r++;return 0===r?null:e[r-1]}},{key:"getShiftedBy",value:function(t){var e=this.clone(),n=e.offset+t;return e.offset=n<0?0:n,e}},{key:"isAfter",value:function(t){return"after"==this.compareWith(t)}},{key:"isBefore",value:function(t){return"before"==this.compareWith(t)}},{key:"isEqual",value:function(t){return"same"==this.compareWith(t)}},{key:"isTouching",value:function(e){var n=null,r=null,i=this.compareWith(e);switch(i){case"same":return!0;case"before":n=t._createAt(this),r=t._createAt(e);break;case"after":n=t._createAt(e),r=t._createAt(this);break;default:return!1}var o=n.parent;while(n.path.length+r.path.length){if(n.isEqual(r))return!0;if(n.path.length>r.path.length){if(n.offset!==o.maxOffset)return!1;n.path=n.path.slice(0,-1),o=o.parent,n.offset++}else{if(0!==r.offset)return!1;r.path=r.path.slice(0,-1)}}}},{key:"hasSameParentAs",value:function(t){if(this.root!==t.root)return!1;var e=this.getParentPath(),n=t.getParentPath();return"same"==ae(e,n)}},{key:"getTransformedByOperation",value:function(e){var n;switch(e.type){case"insert":n=this._getTransformedByInsertOperation(e);break;case"move":case"remove":case"reinsert":n=this._getTransformedByMoveOperation(e);break;case"split":n=this._getTransformedBySplitOperation(e);break;case"merge":n=this._getTransformedByMergeOperation(e);break;default:n=t._createAt(this);break}return n}},{key:"_getTransformedByInsertOperation",value:function(t){return this._getTransformedByInsertion(t.position,t.howMany)}},{key:"_getTransformedByMoveOperation",value:function(t){return this._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany)}},{key:"_getTransformedBySplitOperation",value:function(t){var e=t.movedRange,n=e.containsPosition(this)||e.start.isEqual(this)&&"toNext"==this.stickiness;return n?this._getCombined(t.splitPosition,t.moveTargetPosition):t.graveyardPosition?this._getTransformedByMove(t.graveyardPosition,t.insertionPosition,1):this._getTransformedByInsertion(t.insertionPosition,1)}},{key:"_getTransformedByMergeOperation",value:function(e){var n,r=e.movedRange,i=r.containsPosition(this)||r.start.isEqual(this);return i?(n=this._getCombined(e.sourcePosition,e.targetPosition),e.sourcePosition.isBefore(e.targetPosition)&&(n=n._getTransformedByDeletion(e.deletionPosition,1))):n=this.isEqual(e.deletionPosition)?t._createAt(e.deletionPosition):this._getTransformedByMove(e.deletionPosition,e.graveyardPosition,1),n}},{key:"_getTransformedByDeletion",value:function(e,n){var r=t._createAt(this);if(this.root!=e.root)return r;if("same"==ae(e.getParentPath(),this.getParentPath())){if(e.offset<this.offset){if(e.offset+n>this.offset)return null;r.offset-=n}}else if("prefix"==ae(e.getParentPath(),this.getParentPath())){var i=e.path.length-1;if(e.offset<=this.path[i]){if(e.offset+n>this.path[i])return null;r.path[i]-=n}}return r}},{key:"_getTransformedByInsertion",value:function(e,n){var r=t._createAt(this);if(this.root!=e.root)return r;if("same"==ae(e.getParentPath(),this.getParentPath()))(e.offset<this.offset||e.offset==this.offset&&"toPrevious"!=this.stickiness)&&(r.offset+=n);else if("prefix"==ae(e.getParentPath(),this.getParentPath())){var i=e.path.length-1;e.offset<=this.path[i]&&(r.path[i]+=n)}return r}},{key:"_getTransformedByMove",value:function(e,n,r){if(n=n._getTransformedByDeletion(e,r),e.isEqual(n))return t._createAt(this);var i=this._getTransformedByDeletion(e,r),o=null===i||e.isEqual(this)&&"toNext"==this.stickiness||e.getShiftedBy(r).isEqual(this)&&"toPrevious"==this.stickiness;return o?this._getCombined(e,n):i._getTransformedByInsertion(n,r)}},{key:"_getCombined",value:function(e,n){var r=e.path.length-1,i=t._createAt(n);return i.stickiness=this.stickiness,i.offset=i.offset+this.path[r]-e.offset,i.path=i.path.concat(this.path.slice(r+1)),i}},{key:"toJSON",value:function(){return{root:this.root.toJSON(),path:gt()(this.path),stickiness:this.stickiness}}},{key:"clone",value:function(){return new this.constructor(this.root,this.path,this.stickiness)}},{key:"offset",get:function(){return Tf(this.path)},set:function(t){this.path[this.path.length-1]=t}},{key:"parent",get:function(){for(var t=this.root,e=0;e<this.path.length-1;e++)t=t.getChild(t.offsetToIndex(this.path[e]));return t}},{key:"index",get:function(){return this.parent.offsetToIndex(this.offset)}},{key:"textNode",get:function(){var t=this.parent.getChild(this.index);return t instanceof yf&&t.startOffset<this.offset?t:null}},{key:"nodeAfter",get:function(){return null===this.textNode?this.parent.getChild(this.index):null}},{key:"nodeBefore",get:function(){return null===this.textNode?this.parent.getChild(this.index-1):null}},{key:"isAtStart",get:function(){return 0===this.offset}},{key:"isAtEnd",get:function(){return this.offset==this.parent.maxOffset}}],[{key:"_createAt",value:function(e,n){if(e instanceof t)return new t(e.root,e.path,e.stickiness);var r=e;if("end"==n)n=r.maxOffset;else{if("before"==n)return this._createBefore(r);if("after"==n)return this._createAfter(r);if(0!==n&&!n)throw new Nt["b"]("model-createPositionAt-offset-required: Model#createPositionAt() requires the offset when the first parameter is a model item.")}if(!r.is("element")&&!r.is("documentFragment"))throw new Nt["b"]("model-position-parent-incorrect: Position parent have to be a element or document fragment.");var i=r.getPath();return i.push(n),new this(r.root,i)}},{key:"_createAfter",value:function(t){if(!t.parent)throw new Nt["b"]("model-position-after-root: You cannot make a position after root.",{root:t});return this._createAt(t.parent,t.endOffset)}},{key:"_createBefore",value:function(t){if(!t.parent)throw new Nt["b"]("model-position-before-root: You cannot make a position before root.",{root:t});return this._createAt(t.parent,t.startOffset)}},{key:"fromJSON",value:function(e,n){if("$graveyard"===e.root){var r=new t(n.graveyard,e.path);return r.stickiness=e.stickiness,r}if(!n.getRoot(e.root))throw new Nt["b"]("model-position-fromjson-no-root: Cannot create position for document. Root with specified name does not exist.",{rootName:e.root});var i=new t(n.getRoot(e.root),e.path);return i.stickiness=e.stickiness,i}}]),t}(),Cf=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(c["a"])(this,t),this.start=Sf._createAt(e),this.end=n?Sf._createAt(n):Sf._createAt(e),this.start.stickiness=this.isCollapsed?"toNone":"toNext",this.end.stickiness=this.isCollapsed?"toNone":"toPrevious"}return Object(l["a"])(t,[{key:Es.a,value:regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.delegateYield(new _f({boundaries:this,ignoreElementEnd:!0}),"t0",1);case 1:case"end":return t.stop()}},t,this)})},{key:"containsPosition",value:function(t){return t.isAfter(this.start)&&t.isBefore(this.end)}},{key:"containsRange",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.isCollapsed&&(e=!1);var n=this.containsPosition(t.start)||e&&this.start.isEqual(t.start),r=this.containsPosition(t.end)||e&&this.end.isEqual(t.end);return n&&r}},{key:"containsItem",value:function(t){var e=Sf._createBefore(t);return this.containsPosition(e)||this.start.isEqual(e)}},{key:"isEqual",value:function(t){return this.start.isEqual(t.start)&&this.end.isEqual(t.end)}},{key:"isIntersecting",value:function(t){return this.start.isBefore(t.end)&&this.end.isAfter(t.start)}},{key:"getDifference",value:function(e){var n=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&n.push(new t(this.start,e.start)),this.containsPosition(e.end)&&n.push(new t(e.end,this.end))):n.push(new t(this.start,this.end)),n}},{key:"getIntersection",value:function(e){if(this.isIntersecting(e)){var n=this.start,r=this.end;return this.containsPosition(e.start)&&(n=e.start),this.containsPosition(e.end)&&(r=e.end),new t(n,r)}return null}},{key:"getMinimalFlatRanges",value:function(){var e=[],n=this.start.getCommonPath(this.end).length,r=Sf._createAt(this.start),i=r.parent;while(r.path.length>n+1){var o=i.maxOffset-r.offset;0!==o&&e.push(new t(r,r.getShiftedBy(o))),r.path=r.path.slice(0,-1),r.offset++,i=i.parent}while(r.path.length<=this.end.path.length){var a=this.end.path[r.path.length-1],s=a-r.offset;0!==s&&e.push(new t(r,r.getShiftedBy(s))),r.offset=a,r.path.push(0)}return e}},{key:"getWalker",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.boundaries=this,new _f(t)}},{key:"getItems",value:regeneratorRuntime.mark(function t(){var e,n,r,i,o,a,s,u,c=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e=c.length>0&&void 0!==c[0]?c[0]:{},e.boundaries=this,e.ignoreElementEnd=!0,n=new _f(e),r=!0,i=!1,o=void 0,t.prev=7,a=P()(n);case 9:if(r=(s=a.next()).done){t.next=16;break}return u=s.value,t.next=13,u.item;case 13:r=!0,t.next=9;break;case 16:t.next=22;break;case 18:t.prev=18,t.t0=t["catch"](7),i=!0,o=t.t0;case 22:t.prev=22,t.prev=23,r||null==a.return||a.return();case 25:if(t.prev=25,!i){t.next=28;break}throw o;case 28:return t.finish(25);case 29:return t.finish(22);case 30:case"end":return t.stop()}},t,this,[[7,18,22,30],[23,,25,29]])})},{key:"getPositions",value:regeneratorRuntime.mark(function t(){var e,n,r,i,o,a,s,u,c=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=c.length>0&&void 0!==c[0]?c[0]:{},e.boundaries=this,n=new _f(e),t.next=5,n.position;case 5:r=!0,i=!1,o=void 0,t.prev=8,a=P()(n);case 10:if(r=(s=a.next()).done){t.next=17;break}return u=s.value,t.next=14,u.nextPosition;case 14:r=!0,t.next=10;break;case 17:t.next=23;break;case 19:t.prev=19,t.t0=t["catch"](8),i=!0,o=t.t0;case 23:t.prev=23,t.prev=24,r||null==a.return||a.return();case 26:if(t.prev=26,!i){t.next=29;break}throw o;case 29:return t.finish(26);case 30:return t.finish(23);case 31:case"end":return t.stop()}},t,this,[[8,19,23,31],[24,,26,30]])})},{key:"getTransformedByOperation",value:function(e){switch(e.type){case"insert":return this._getTransformedByInsertOperation(e);case"move":case"remove":case"reinsert":return this._getTransformedByMoveOperation(e);case"split":return[this._getTransformedBySplitOperation(e)];case"merge":return[this._getTransformedByMergeOperation(e)]}return[new t(this.start,this.end)]}},{key:"getTransformedByOperations",value:function(e){var n=[new t(this.start,this.end)],r=!0,i=!1,o=void 0;try{for(var a,s=P()(e);!(r=(a=s.next()).done);r=!0)for(var u=a.value,c=0;c<n.length;c++){var l=n[c].getTransformedByOperation(u);n.splice.apply(n,[c,1].concat(kt(l))),c+=l.length-1}}catch(v){i=!0,o=v}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}for(var h=0;h<n.length;h++)for(var f=n[h],d=h+1;d<n.length;d++){var p=n[d];(f.containsRange(p)||p.containsRange(f)||f.isEqual(p))&&n.splice(d,1)}return n}},{key:"getCommonAncestor",value:function(){return this.start.getCommonAncestor(this.end)}},{key:"toJSON",value:function(){return{start:this.start.toJSON(),end:this.end.toJSON()}}},{key:"clone",value:function(){return new this.constructor(this.start,this.end)}},{key:"_getTransformedByInsertOperation",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._getTransformedByInsertion(t.position,t.howMany,e)}},{key:"_getTransformedByMoveOperation",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.sourcePosition,r=t.howMany,i=t.targetPosition;return this._getTransformedByMove(n,i,r,e)}},{key:"_getTransformedBySplitOperation",value:function(e){var n=this.start._getTransformedBySplitOperation(e),r=this.end._getTransformedBySplitOperation(e);return this.end.isEqual(e.insertionPosition)&&(r=this.end.getShiftedBy(1)),n.root!=r.root&&(r=this.end.getShiftedBy(-1)),new t(n,r)}},{key:"_getTransformedByMergeOperation",value:function(e){var n=this.start._getTransformedByMergeOperation(e),r=this.end._getTransformedByMergeOperation(e);return n.root!=r.root&&(r=this.end.getShiftedBy(-1)),n.isAfter(r)?(e.sourcePosition.isBefore(e.targetPosition)?(n=Sf._createAt(r),n.offset=0):(e.deletionPosition.isEqual(n)||(r=e.deletionPosition),n=e.targetPosition),new t(n,r)):new t(n,r)}},{key:"_getTransformedByInsertion",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(r&&this.containsPosition(e))return[new t(this.start,e),new t(e.getShiftedBy(n),this.end._getTransformedByInsertion(e,n))];var i=new t(this.start,this.end);return i.start=i.start._getTransformedByInsertion(e,n),i.end=i.end._getTransformedByInsertion(e,n),[i]}},{key:"_getTransformedByMove",value:function(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.isCollapsed){var o=this.start._getTransformedByMove(e,n,r);return[new t(o)]}var a,s=t._createFromPositionAndShift(e,r),u=n._getTransformedByDeletion(e,r);if(this.containsPosition(n)&&!i&&(s.containsPosition(this.start)||s.containsPosition(this.end))){var c=this.start._getTransformedByMove(e,n,r),l=this.end._getTransformedByMove(e,n,r);return[new t(c,l)]}var h=this.getDifference(s),f=null,d=this.getIntersection(s);if(1==h.length?f=new t(h[0].start._getTransformedByDeletion(e,r),h[0].end._getTransformedByDeletion(e,r)):2==h.length&&(f=new t(this.start,this.end._getTransformedByDeletion(e,r))),a=f?f._getTransformedByInsertion(u,r,null!==d||i):[],d){var p=new t(d.start._getCombined(s.start,u),d.end._getCombined(s.start,u));2==a.length?a.splice(1,0,p):a.push(p)}return a}},{key:"_getTransformedByDeletion",value:function(e,n){var r=this.start._getTransformedByDeletion(e,n),i=this.end._getTransformedByDeletion(e,n);return null==r&&null==i?null:(null==r&&(r=e),null==i&&(i=e),new t(r,i))}},{key:"isCollapsed",get:function(){return this.start.isEqual(this.end)}},{key:"isFlat",get:function(){var t=this.start.getParentPath(),e=this.end.getParentPath();return"same"==ae(t,e)}},{key:"root",get:function(){return this.start.root}}],[{key:"_createFromPositionAndShift",value:function(t,e){var n=t,r=t.getShiftedBy(e);return e>0?new this(n,r):new this(r,n)}},{key:"_createIn",value:function(t){return new this(Sf._createAt(t,0),Sf._createAt(t,t.maxOffset))}},{key:"_createOn",value:function(t){return this._createFromPositionAndShift(Sf._createBefore(t),t.offsetSize)}},{key:"_createFromRanges",value:function(t){if(0===t.length)throw new Nt["b"]("range-create-from-ranges-empty-array: At least one range has to be passed.");if(1==t.length)return t[0].clone();var e=t[0];t.sort(function(t,e){return t.start.isAfter(e.start)?1:-1});var n=t.indexOf(e),r=new this(e.start,e.end);if(n>0)for(var i=n-1;1;i++){if(!t[i].end.isEqual(r.start))break;r.start=Sf._createAt(t[i].start)}for(var o=n+1;o<t.length;o++){if(!t[o].start.isEqual(r.end))break;r.end=Sf._createAt(t[o].end)}return r}},{key:"fromJSON",value:function(t,e){return new this(Sf.fromJSON(t.start,e),Sf.fromJSON(t.end,e))}}]),t}(),Of=function(){function t(){var e=this;Object(c["a"])(this,t),this._modelToViewMapping=new Fu.a,this._viewToModelMapping=new Fu.a,this._viewToModelLengthCallbacks=new It.a,this._markerNameToElements=new It.a,this.on("modelToViewPosition",function(t,n){if(!n.viewPosition){var r=e._modelToViewMapping.get(n.modelPosition.parent);n.viewPosition=e._findPositionIn(r,n.modelPosition.offset)}},{priority:"low"}),this.on("viewToModelPosition",function(t,n){if(!n.modelPosition){var r=n.viewPosition.parent,i=e._viewToModelMapping.get(r);while(!i)r=r.parent,i=e._viewToModelMapping.get(r);var o=e._toModelOffset(n.viewPosition.parent,n.viewPosition.offset,r);n.modelPosition=Sf._createAt(i,o)}},{priority:"low"})}return Object(l["a"])(t,[{key:"bindElements",value:function(t,e){this._modelToViewMapping.set(t,e),this._viewToModelMapping.set(e,t)}},{key:"unbindViewElement",value:function(t){var e=this.toModelElement(t);this._viewToModelMapping.delete(t),this._modelToViewMapping.get(e)==t&&this._modelToViewMapping.delete(e)}},{key:"unbindModelElement",value:function(t){var e=this.toViewElement(t);this._modelToViewMapping.delete(t),this._viewToModelMapping.get(e)==t&&this._viewToModelMapping.delete(e)}},{key:"bindElementToMarker",value:function(t,e){var n=this._markerNameToElements.get(e)||new Pt.a;n.add(t),this._markerNameToElements.set(e,n)}},{key:"unbindElementsFromMarkerName",value:function(t){this._markerNameToElements.delete(t)}},{key:"clearBindings",value:function(){this._modelToViewMapping=new Fu.a,this._viewToModelMapping=new Fu.a,this._markerNameToElements=new It.a}},{key:"toModelElement",value:function(t){return this._viewToModelMapping.get(t)}},{key:"toViewElement",value:function(t){return this._modelToViewMapping.get(t)}},{key:"toModelRange",value:function(t){return new Cf(this.toModelPosition(t.start),this.toModelPosition(t.end))}},{key:"toViewRange",value:function(t){return new Nu(this.toViewPosition(t.start),this.toViewPosition(t.end))}},{key:"toModelPosition",value:function(t){var e={viewPosition:t,mapper:this};return this.fire("viewToModelPosition",e),e.modelPosition}},{key:"toViewPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{isPhantom:!1},n={modelPosition:t,mapper:this,isPhantom:e.isPhantom};return this.fire("modelToViewPosition",n),n.viewPosition}},{key:"markerNameToElements",value:function(t){var e=this._markerNameToElements.get(t);if(!e)return null;var n=new Pt.a,r=!0,i=!1,o=void 0;try{for(var a,s=P()(e);!(r=(a=s.next()).done);r=!0){var u=a.value;if(u.is("attributeElement")){var c=!0,l=!1,h=void 0;try{for(var f,d=P()(u.getElementsWithSameId());!(c=(f=d.next()).done);c=!0){var p=f.value;n.add(p)}}catch(v){l=!0,h=v}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}}else n.add(u)}}catch(v){i=!0,o=v}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}},{key:"registerViewToModelLength",value:function(t,e){this._viewToModelLengthCallbacks.set(t,e)}},{key:"_toModelOffset",value:function(t,e,n){if(n!=t){var r=this._toModelOffset(t.parent,t.index,n),i=this._toModelOffset(t,e,t);return r+i}if(t.is("text"))return e;for(var o=0,a=0;a<e;a++)o+=this.getModelLength(t.getChild(a));return o}},{key:"getModelLength",value:function(t){if(this._viewToModelLengthCallbacks.get(t.name)){var e=this._viewToModelLengthCallbacks.get(t.name);return e(t)}if(this._viewToModelMapping.has(t))return 1;if(t.is("text"))return t.data.length;if(t.is("uiElement"))return 0;var n=0,r=!0,i=!1,o=void 0;try{for(var a,s=P()(t.getChildren());!(r=(a=s.next()).done);r=!0){var u=a.value;n+=this.getModelLength(u)}}catch(c){i=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}},{key:"_findPositionIn",value:function(t,e){var n,r=0,i=0,o=0;if(t.is("text"))return new Pu(t,e);while(i<e)n=t.getChild(o),r=this.getModelLength(n),i+=r,o++;return i==e?this._moveViewPositionToTextNode(new Pu(t,o)):this._findPositionIn(n,e-(i-r))}},{key:"_moveViewPositionToTextNode",value:function(t){var e=t.nodeBefore,n=t.nodeAfter;return e instanceof bs?new Pu(e,e.data.length):n instanceof bs?new Pu(n,0):t}}]),t}();
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */oe(Of,qt);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
var Af=function(){function t(){Object(c["a"])(this,t),this._consumable=new It.a,this._textProxyRegistry=new It.a}return Object(l["a"])(t,[{key:"add",value:function(t,e){e=If(e),t instanceof gf&&(t=this._getSymbolForTextProxy(t)),this._consumable.has(t)||this._consumable.set(t,new It.a),this._consumable.get(t).set(e,!0)}},{key:"consume",value:function(t,e){return e=If(e),t instanceof gf&&(t=this._getSymbolForTextProxy(t)),!!this.test(t,e)&&(this._consumable.get(t).set(e,!1),!0)}},{key:"test",value:function(t,e){e=If(e),t instanceof gf&&(t=this._getSymbolForTextProxy(t));var n=this._consumable.get(t);if(void 0===n)return null;var r=n.get(e);return void 0===r?null:r}},{key:"revert",value:function(t,e){e=If(e),t instanceof gf&&(t=this._getSymbolForTextProxy(t));var n=this.test(t,e);return!1===n?(this._consumable.get(t).set(e,!0),!0):!0!==n&&null}},{key:"_getSymbolForTextProxy",value:function(t){var e=null,n=this._textProxyRegistry.get(t.startOffset);if(n){var r=n.get(t.endOffset);r&&(e=r.get(t.parent))}return e||(e=this._addSymbolForTextProxy(t.startOffset,t.endOffset,t.parent)),e}},{key:"_addSymbolForTextProxy",value:function(t,e,n){var r,i,o=ft()("textProxySymbol");return r=this._textProxyRegistry.get(t),r||(r=new It.a,this._textProxyRegistry.set(t,r)),i=r.get(e),i||(i=new It.a,r.set(e,i)),i.set(n,o),o}}]),t}();function If(t){var e=t.split(":");return e.length>1?e[0]+":"+e[1]:e[0]}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var xf=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(c["a"])(this,t),this.conversionApi=lu({dispatcher:this},e)}return Object(l["a"])(t,[{key:"convertChanges",value:function(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=P()(t.getMarkersToRemove());!(n=(o=a.next()).done);n=!0){var s=o.value;this.convertMarkerRemove(s.name,s.range,e)}}catch(w){r=!0,i=w}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}var u=!0,c=!1,l=void 0;try{for(var h,f=P()(t.getChanges());!(u=(h=f.next()).done);u=!0){var d=h.value;"insert"==d.type?this.convertInsert(Cf._createFromPositionAndShift(d.position,d.length),e):"remove"==d.type?this.convertRemove(d.position,d.length,d.name,e):this.convertAttribute(d.range,d.attributeKey,d.attributeOldValue,d.attributeNewValue,e)}}catch(w){c=!0,l=w}finally{try{u||null==f.return||f.return()}finally{if(c)throw l}}var p=!0,v=!1,y=void 0;try{for(var g,m=P()(t.getMarkersToAdd());!(p=(g=m.next()).done);p=!0){var b=g.value;this.convertMarkerAdd(b.name,b.range,e)}}catch(w){v=!0,y=w}finally{try{p||null==m.return||m.return()}finally{if(v)throw y}}}},{key:"convertInsert",value:function(t,e){this.conversionApi.writer=e,this.conversionApi.consumable=this._createInsertConsumable(t);var n=!0,r=!1,i=void 0;try{for(var o,a=P()(t);!(n=(o=a.next()).done);n=!0){var s=o.value,u=s.item,c=Cf._createFromPositionAndShift(s.previousPosition,s.length),l={item:u,range:c};this._testAndFire("insert",l);var h=!0,f=!1,d=void 0;try{for(var p,v=P()(u.getAttributeKeys());!(h=(p=v.next()).done);h=!0){var y=p.value;l.attributeKey=y,l.attributeOldValue=null,l.attributeNewValue=u.getAttribute(y),this._testAndFire("attribute:".concat(y),l)}}catch(g){f=!0,d=g}finally{try{h||null==v.return||v.return()}finally{if(f)throw d}}}}catch(g){r=!0,i=g}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}this._clearConversionApi()}},{key:"convertRemove",value:function(t,e,n,r){this.conversionApi.writer=r,this.fire("remove:"+n,{position:t,length:e},this.conversionApi),this._clearConversionApi()}},{key:"convertAttribute",value:function(t,e,n,r,i){this.conversionApi.writer=i,this.conversionApi.consumable=this._createConsumableForRange(t,"attribute:".concat(e));var o=!0,a=!1,s=void 0;try{for(var u,c=P()(t);!(o=(u=c.next()).done);o=!0){var l=u.value,h=l.item,f=Cf._createFromPositionAndShift(l.previousPosition,l.length),d={item:h,range:f,attributeKey:e,attributeOldValue:n,attributeNewValue:r};this._testAndFire("attribute:".concat(e),d)}}catch(p){a=!0,s=p}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}this._clearConversionApi()}},{key:"convertSelection",value:function(t,e,n){var r=gt()(e.getMarkersAtPosition(t.getFirstPosition()));if(this.conversionApi.writer=n,this.conversionApi.consumable=this._createSelectionConsumable(t,r),this.fire("selection",{selection:t},this.conversionApi),t.isCollapsed){var i=!0,o=!1,a=void 0;try{for(var s,u=P()(r);!(i=(s=u.next()).done);i=!0){var c=s.value,l=c.getRange();if(Pf(t.getFirstPosition(),c,this.conversionApi.mapper)){var h={item:t,markerName:c.name,markerRange:l};this.conversionApi.consumable.test(t,"addMarker:"+c.name)&&this.fire("addMarker:"+c.name,h,this.conversionApi)}}}catch(b){o=!0,a=b}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}var f=!0,d=!1,p=void 0;try{for(var v,y=P()(t.getAttributeKeys());!(f=(v=y.next()).done);f=!0){var g=v.value,m={item:t,range:t.getFirstRange(),attributeKey:g,attributeOldValue:null,attributeNewValue:t.getAttribute(g)};this.conversionApi.consumable.test(t,"attribute:"+m.attributeKey)&&this.fire("attribute:"+m.attributeKey,m,this.conversionApi)}}catch(b){d=!0,p=b}finally{try{f||null==y.return||y.return()}finally{if(d)throw p}}this._clearConversionApi()}}},{key:"convertMarkerAdd",value:function(t,e,n){if(e.root.document&&"$graveyard"!=e.root.rootName){this.conversionApi.writer=n;var r="addMarker:"+t;if(e.isCollapsed){var i=new Af;return i.add(e,r),this.conversionApi.consumable=i,void this.fire(r,{markerName:t,markerRange:e},this.conversionApi)}this.conversionApi.consumable=this._createConsumableForRange(e,r);var o=!0,a=!1,s=void 0;try{for(var u,c=P()(e.getItems());!(o=(u=c.next()).done);o=!0){var l=u.value;if(this.conversionApi.consumable.test(l,r)){var h={item:l,range:Cf._createOn(l),markerName:t,markerRange:e};this.fire(r,h,this.conversionApi)}}}catch(f){a=!0,s=f}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}this._clearConversionApi()}}},{key:"convertMarkerRemove",value:function(t,e,n){e.root.document&&"$graveyard"!=e.root.rootName&&(this.conversionApi.writer=n,this.fire("removeMarker:"+t,{markerName:t,markerRange:e},this.conversionApi),this._clearConversionApi())}},{key:"_createInsertConsumable",value:function(t){var e=new Af,n=!0,r=!1,i=void 0;try{for(var o,a=P()(t);!(n=(o=a.next()).done);n=!0){var s=o.value,u=s.item;e.add(u,"insert");var c=!0,l=!1,h=void 0;try{for(var f,d=P()(u.getAttributeKeys());!(c=(f=d.next()).done);c=!0){var p=f.value;e.add(u,"attribute:"+p)}}catch(v){l=!0,h=v}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}}}catch(v){r=!0,i=v}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}},{key:"_createConsumableForRange",value:function(t,e){var n=new Af,r=!0,i=!1,o=void 0;try{for(var a,s=P()(t.getItems());!(r=(a=s.next()).done);r=!0){var u=a.value;n.add(u,e)}}catch(c){i=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}},{key:"_createSelectionConsumable",value:function(t,e){var n=new Af;n.add(t,"selection");var r=!0,i=!1,o=void 0;try{for(var a,s=P()(e);!(r=(a=s.next()).done);r=!0){var u=a.value;n.add(t,"addMarker:"+u.name)}}catch(v){i=!0,o=v}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}var c=!0,l=!1,h=void 0;try{for(var f,d=P()(t.getAttributeKeys());!(c=(f=d.next()).done);c=!0){var p=f.value;n.add(t,"attribute:"+p)}}catch(v){l=!0,h=v}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}return n}},{key:"_testAndFire",value:function(t,e){if(this.conversionApi.consumable.test(e.item,t)){var n=e.item.name||"$text";this.fire(t+":"+n,e,this.conversionApi)}}},{key:"_clearConversionApi",value:function(){delete this.conversionApi.writer,delete this.conversionApi.consumable}}]),t}();function Pf(t,e,n){var r=e.getRange(),i=gt()(t.getAncestors());i.shift(),i.reverse();var o=i.some(function(t){if(r.containsItem(t)){var e=n.toViewElement(t);return!!e.getCustomProperty("addHighlight")}});return!o}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */oe(xf,qt);var Nf=function(){function t(e,n,r){Object(c["a"])(this,t),this._lastRangeBackward=!1,this._ranges=[],this._attrs=new It.a,e&&this.setTo(e,n,r)}return Object(l["a"])(t,[{key:"isEqual",value:function(t){if(this.rangeCount!=t.rangeCount)return!1;if(0===this.rangeCount)return!0;if(!this.anchor.isEqual(t.anchor)||!this.focus.isEqual(t.focus))return!1;var e=!0,n=!1,r=void 0;try{for(var i,o=P()(this._ranges);!(e=(i=o.next()).done);e=!0){var a=i.value,s=!1,u=!0,c=!1,l=void 0;try{for(var h,f=P()(t._ranges);!(u=(h=f.next()).done);u=!0){var d=h.value;if(a.isEqual(d)){s=!0;break}}}catch(p){c=!0,l=p}finally{try{u||null==f.return||f.return()}finally{if(c)throw l}}if(!s)return!1}}catch(p){n=!0,r=p}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return!0}},{key:"getRanges",value:regeneratorRuntime.mark(function t(){var e,n,r,i,o,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e=!0,n=!1,r=void 0,t.prev=3,i=P()(this._ranges);case 5:if(e=(o=i.next()).done){t.next=12;break}return a=o.value,t.next=9,new Cf(a.start,a.end);case 9:e=!0,t.next=5;break;case 12:t.next=18;break;case 14:t.prev=14,t.t0=t["catch"](3),n=!0,r=t.t0;case 18:t.prev=18,t.prev=19,e||null==i.return||i.return();case 21:if(t.prev=21,!n){t.next=24;break}throw r;case 24:return t.finish(21);case 25:return t.finish(18);case 26:case"end":return t.stop()}},t,this,[[3,14,18,26],[19,,21,25]])})},{key:"getFirstRange",value:function(){var t=null,e=!0,n=!1,r=void 0;try{for(var i,o=P()(this._ranges);!(e=(i=o.next()).done);e=!0){var a=i.value;t&&!a.start.isBefore(t.start)||(t=a)}}catch(s){n=!0,r=s}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return t?new Cf(t.start,t.end):null}},{key:"getLastRange",value:function(){var t=null,e=!0,n=!1,r=void 0;try{for(var i,o=P()(this._ranges);!(e=(i=o.next()).done);e=!0){var a=i.value;t&&!a.end.isAfter(t.end)||(t=a)}}catch(s){n=!0,r=s}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return t?new Cf(t.start,t.end):null}},{key:"getFirstPosition",value:function(){var t=this.getFirstRange();return t?t.start.clone():null}},{key:"getLastPosition",value:function(){var t=this.getLastRange();return t?t.end.clone():null}},{key:"setTo",value:function(e,n,r){if(null===e)this._setRanges([]);else if(e instanceof t)this._setRanges(e.getRanges(),e.isBackward);else if(e&&"function"==typeof e.getRanges)this._setRanges(e.getRanges(),e.isBackward);else if(e instanceof Cf)this._setRanges([e],!!n&&!!n.backward);else if(e instanceof Sf)this._setRanges([new Cf(e)]);else if(e instanceof vf){var i,o=!!r&&!!r.backward;if("in"==n)i=Cf._createIn(e);else if("on"==n)i=Cf._createOn(e);else{if(void 0===n)throw new Nt["b"]("model-selection-setTo-required-second-parameter: selection.setTo requires the second parameter when the first parameter is a node.");i=new Cf(Sf._createAt(e,n))}this._setRanges([i],o)}else{if(!Ts(e))throw new Nt["b"]("model-selection-setTo-not-selectable: Cannot set selection to given place.");this._setRanges(e,n&&!!n.backward)}}},{key:"_setRanges",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t=gt()(t);var r=t.some(function(t){if(!(t instanceof Cf))throw new Nt["b"]("model-selection-set-ranges-not-range: Selection range set to an object that is not an instance of model.Range.");return e._ranges.every(function(e){return!e.isEqual(t)})});if(t.length!==this._ranges.length||r){this._removeAllRanges();var i=!0,o=!1,a=void 0;try{for(var s,u=P()(t);!(i=(s=u.next()).done);i=!0){var c=s.value;this._pushRange(c)}}catch(l){o=!0,a=l}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}this._lastRangeBackward=!!n,this.fire("change:range",{directChange:!0})}}},{key:"setFocus",value:function(t,e){if(null===this.anchor)throw new Nt["b"]("model-selection-setFocus-no-ranges: Cannot set selection focus if there are no ranges in selection.");var n=Sf._createAt(t,e);if("same"!=n.compareWith(this.focus)){var r=this.anchor;this._ranges.length&&this._popRange(),"before"==n.compareWith(r)?(this._pushRange(new Cf(n,r)),this._lastRangeBackward=!0):(this._pushRange(new Cf(r,n)),this._lastRangeBackward=!1),this.fire("change:range",{directChange:!0})}}},{key:"getAttribute",value:function(t){return this._attrs.get(t)}},{key:"getAttributes",value:function(){return this._attrs.entries()}},{key:"getAttributeKeys",value:function(){return this._attrs.keys()}},{key:"hasAttribute",value:function(t){return this._attrs.has(t)}},{key:"removeAttribute",value:function(t){this.hasAttribute(t)&&(this._attrs.delete(t),this.fire("change:attribute",{attributeKeys:[t],directChange:!0}))}},{key:"setAttribute",value:function(t,e){this.getAttribute(t)!==e&&(this._attrs.set(t,e),this.fire("change:attribute",{attributeKeys:[t],directChange:!0}))}},{key:"getSelectedElement",value:function(){if(1!==this.rangeCount)return null;var t=this.getFirstRange(),e=t.start.nodeAfter,n=t.end.nodeBefore;return e instanceof bf&&e==n?e:null}},{key:"getSelectedBlocks",value:regeneratorRuntime.mark(function t(){var e,n,r,i,o,a,s,u,c,l,h,f,d,p,v;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e=new Uh.a,n=!0,r=!1,i=void 0,t.prev=4,o=P()(this.getRanges());case 6:if(n=(a=o.next()).done){t.next=46;break}if(s=a.value,u=Df(s.start,e),!u){t.next=12;break}return t.next=12,u;case 12:c=!0,l=!1,h=void 0,t.prev=15,f=P()(s.getWalker());case 17:if(c=(d=f.next()).done){t.next=25;break}if(p=d.value,"elementEnd"!=p.type||!Rf(p.item,e)){t.next=22;break}return t.next=22,p.item;case 22:c=!0,t.next=17;break;case 25:t.next=31;break;case 27:t.prev=27,t.t0=t["catch"](15),l=!0,h=t.t0;case 31:t.prev=31,t.prev=32,c||null==f.return||f.return();case 34:if(t.prev=34,!l){t.next=37;break}throw h;case 37:return t.finish(34);case 38:return t.finish(31);case 39:if(v=Df(s.end,e),!v||s.end.isTouching(Sf._createAt(v,0))){t.next=43;break}return t.next=43,v;case 43:n=!0,t.next=6;break;case 46:t.next=52;break;case 48:t.prev=48,t.t1=t["catch"](4),r=!0,i=t.t1;case 52:t.prev=52,t.prev=53,n||null==o.return||o.return();case 55:if(t.prev=55,!r){t.next=58;break}throw i;case 58:return t.finish(55);case 59:return t.finish(52);case 60:case"end":return t.stop()}},t,this,[[4,48,52,60],[15,27,31,39],[32,,34,38],[53,,55,59]])})},{key:"containsEntireContent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.anchor.root,e=Sf._createAt(t,0),n=Sf._createAt(t,"end");return e.isTouching(this.getFirstPosition())&&n.isTouching(this.getLastPosition())}},{key:"_pushRange",value:function(t){this._checkRange(t),this._ranges.push(new Cf(t.start,t.end))}},{key:"_checkRange",value:function(t){for(var e=0;e<this._ranges.length;e++)if(t.isIntersecting(this._ranges[e]))throw new Nt["b"]("model-selection-range-intersects: Trying to add a range that intersects with another range in the selection.",{addedRange:t,intersectingRange:this._ranges[e]})}},{key:"_removeAllRanges",value:function(){while(this._ranges.length>0)this._popRange()}},{key:"_popRange",value:function(){this._ranges.pop()}},{key:"anchor",get:function(){if(this._ranges.length>0){var t=this._ranges[this._ranges.length-1];return this._lastRangeBackward?t.end:t.start}return null}},{key:"focus",get:function(){if(this._ranges.length>0){var t=this._ranges[this._ranges.length-1];return this._lastRangeBackward?t.start:t.end}return null}},{key:"isCollapsed",get:function(){var t=this._ranges.length;return 1===t&&this._ranges[0].isCollapsed}},{key:"rangeCount",get:function(){return this._ranges.length}},{key:"isBackward",get:function(){return!this.isCollapsed&&this._lastRangeBackward}}]),t}();function Rf(t,e){return!e.has(t)&&(e.add(t),t.document.model.schema.isBlock(t)&&t.parent)}function Df(t,e){var n=t.parent.getAncestors({parentFirst:!0,includeSelf:!0}),r=n.find(function(t){return Rf(t,e)});return n.forEach(function(t){return e.add(t)}),r}oe(Nf,qt);n("f559");
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var jf=function(t){function e(t,n){var r;return Object(c["a"])(this,e),r=Object(m["a"])(this,Object(b["a"])(e).call(this,t,n)),Mf.call(Object(O["a"])(Object(O["a"])(r))),r}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"detach",value:function(){this.stopListening()}},{key:"toRange",value:function(){return new Cf(this.start,this.end)}}],[{key:"fromRange",value:function(t){return new e(t.start,t.end)}}]),e}(Cf);function Mf(){var t=this;this.listenTo(this.root.document.model,"applyOperation",function(e,n){var r=n[0];r.isDocumentOperation&&Lf.call(t,r)},{priority:"low"})}function Lf(t){var e=this.getTransformedByOperation(t),n=Cf._createFromRanges(e),r=!n.isEqual(this),i=Ff(this,t),o=null;if(r){"$graveyard"==n.root.rootName&&(o="remove"==t.type?t.sourcePosition:t.deletionPosition);var a=this.toRange();this.start=n.start,this.end=n.end,this.fire("change:range",a,{deletionPosition:o})}else i&&this.fire("change:content",this.toRange(),{deletionPosition:o})}function Ff(t,e){switch(e.type){case"insert":return t.containsPosition(e.position);case"move":case"remove":case"reinsert":case"merge":return t.containsPosition(e.sourcePosition)||t.start.isEqual(e.sourcePosition)||t.containsPosition(e.targetPosition);case"split":return t.containsPosition(e.splitPosition)||t.containsPosition(e.insertionPosition)}return!1}oe(jf,qt);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
var Vf="selection:",Bf=function(){function t(e){Object(c["a"])(this,t),this._selection=new Uf(e),this._selection.delegate("change:range").to(this),this._selection.delegate("change:attribute").to(this)}return Object(l["a"])(t,[{key:"getRanges",value:function(){return this._selection.getRanges()}},{key:"getFirstPosition",value:function(){return this._selection.getFirstPosition()}},{key:"getLastPosition",value:function(){return this._selection.getLastPosition()}},{key:"getFirstRange",value:function(){return this._selection.getFirstRange()}},{key:"getLastRange",value:function(){return this._selection.getLastRange()}},{key:"getSelectedBlocks",value:function(){return this._selection.getSelectedBlocks()}},{key:"getSelectedElement",value:function(){return this._selection.getSelectedElement()}},{key:"containsEntireContent",value:function(t){return this._selection.containsEntireContent(t)}},{key:"destroy",value:function(){this._selection.destroy()}},{key:"getAttributeKeys",value:function(){return this._selection.getAttributeKeys()}},{key:"getAttributes",value:function(){return this._selection.getAttributes()}},{key:"getAttribute",value:function(t){return this._selection.getAttribute(t)}},{key:"hasAttribute",value:function(t){return this._selection.hasAttribute(t)}},{key:"_setFocus",value:function(t,e){this._selection.setFocus(t,e)}},{key:"_setTo",value:function(t,e,n){this._selection.setTo(t,e,n)}},{key:"_setAttribute",value:function(t,e){this._selection.setAttribute(t,e)}},{key:"_removeAttribute",value:function(t){this._selection.removeAttribute(t)}},{key:"_getStoredAttributes",value:function(){return this._selection._getStoredAttributes()}},{key:"_overrideGravity",value:function(){return this._selection.overrideGravity()}},{key:"_restoreGravity",value:function(t){this._selection.restoreGravity(t)}},{key:"isCollapsed",get:function(){return this._selection.isCollapsed}},{key:"anchor",get:function(){return this._selection.anchor}},{key:"focus",get:function(){return this._selection.focus}},{key:"rangeCount",get:function(){return this._selection.rangeCount}},{key:"hasOwnRange",get:function(){return this._selection.hasOwnRange}},{key:"isBackward",get:function(){return this._selection.isBackward}},{key:"isGravityOverridden",get:function(){return this._selection.isGravityOverridden}},{key:"_ranges",get:function(){return this._selection._ranges}}],[{key:"_getStoreAttributeKey",value:function(t){return Vf+t}},{key:"_isStoreAttributeKey",value:function(t){return t.startsWith(Vf)}}]),t}();oe(Bf,qt);var Uf=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this)),n._model=t.model,n._document=t,n._attributePriority=new It.a,n._fixGraveyardRangesData=[],n._hasChangedRange=!1,n._overriddenGravityRegister=new Pt.a,n.on("change:range",function(){var t=!0,e=!1,r=void 0;try{for(var i,o=P()(n.getRanges());!(t=(i=o.next()).done);t=!0){var a=i.value;if(!n._document._validateSelectionRange(a))throw new Nt["b"]("document-selection-wrong-position: Range from document selection starts or ends at incorrect position.",{range:a})}}catch(s){e=!0,r=s}finally{try{t||null==o.return||o.return()}finally{if(e)throw r}}}),n.listenTo(n._document,"change",function(t,e){n._updateAttributes(!1),Wf(n._model,e)}),n.listenTo(n._model,"applyOperation",function(){while(n._fixGraveyardRangesData.length){var t=n._fixGraveyardRangesData.shift(),e=t.liveRange,r=t.sourcePosition;n._fixGraveyardSelection(e,r)}n._hasChangedRange&&(n._hasChangedRange=!1,n.fire("change:range",{directChange:!1}))},{priority:"lowest"}),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"destroy",value:function(){for(var t=0;t<this._ranges.length;t++)this._ranges[t].detach();this.stopListening()}},{key:"getRanges",value:regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!this._ranges.length){t.next=4;break}return t.delegateYield(S(Object(b["a"])(e.prototype),"getRanges",this).call(this),"t0",2);case 2:t.next=6;break;case 4:return t.next=6,this._document._getDefaultRange();case 6:case"end":return t.stop()}},t,this)})},{key:"getFirstRange",value:function(){return S(Object(b["a"])(e.prototype),"getFirstRange",this).call(this)||this._document._getDefaultRange()}},{key:"getLastRange",value:function(){return S(Object(b["a"])(e.prototype),"getLastRange",this).call(this)||this._document._getDefaultRange()}},{key:"setTo",value:function(t,n,r){S(Object(b["a"])(e.prototype),"setTo",this).call(this,t,n,r),this._refreshAttributes()}},{key:"setFocus",value:function(t,n){S(Object(b["a"])(e.prototype),"setFocus",this).call(this,t,n),this._refreshAttributes()}},{key:"setAttribute",value:function(t,e){if(this._setAttribute(t,e)){var n=[t];this.fire("change:attribute",{attributeKeys:n,directChange:!0})}}},{key:"removeAttribute",value:function(t){if(this._removeAttribute(t)){var e=[t];this.fire("change:attribute",{attributeKeys:e,directChange:!0})}}},{key:"overrideGravity",value:function(){var t=Mt();return this._overriddenGravityRegister.add(t),1===this._overriddenGravityRegister.size&&this._refreshAttributes(),t}},{key:"restoreGravity",value:function(t){if(!this._overriddenGravityRegister.has(t))throw new Nt["b"]("document-selection-gravity-wrong-restore: Attempting to restore the selection gravity for an unknown UID.",{uid:t});this._overriddenGravityRegister.delete(t),this.isGravityOverridden||this._refreshAttributes()}},{key:"_refreshAttributes",value:function(){this._updateAttributes(!0)}},{key:"_popRange",value:function(){this._ranges.pop().detach()}},{key:"_pushRange",value:function(t){var e=this._prepareRange(t);e&&this._ranges.push(e)}},{key:"_prepareRange",value:function(t){var e=this;if(this._checkRange(t),t.root!=this._document.graveyard){var n=jf.fromRange(t);return n.on("change:range",function(t,r,i){e._hasChangedRange=!0,n.root==e._document.graveyard&&e._fixGraveyardRangesData.push({liveRange:n,sourcePosition:i.deletionPosition})}),n}qh["a"].warn("model-selection-range-in-graveyard: Trying to add a Range that is in the graveyard root. Range rejected.")}},{key:"_updateAttributes",value:function(t){var e=pf(this._getSurroundingAttributes()),n=pf(this.getAttributes());if(t)this._attributePriority=new It.a,this._attrs=new It.a;else{var r=!0,i=!1,o=void 0;try{for(var a,s=P()(this._attributePriority);!(r=(a=s.next()).done);r=!0){var u=Ot(a.value,2),c=u[0],l=u[1];"low"==l&&(this._attrs.delete(c),this._attributePriority.delete(c))}}catch(O){i=!0,o=O}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}this._setAttributesTo(e);var h=[],f=!0,d=!1,p=void 0;try{for(var v,y=P()(this.getAttributes());!(f=(v=y.next()).done);f=!0){var g=Ot(v.value,2),m=g[0],b=g[1];n.has(m)&&n.get(m)===b||h.push(m)}}catch(O){d=!0,p=O}finally{try{f||null==y.return||y.return()}finally{if(d)throw p}}var w=!0,_=!1,k=void 0;try{for(var E,T=P()(n);!(w=(E=T.next()).done);w=!0){var S=Ot(E.value,1),C=S[0];this.hasAttribute(C)||h.push(C)}}catch(O){_=!0,k=O}finally{try{w||null==T.return||T.return()}finally{if(_)throw k}}h.length>0&&this.fire("change:attribute",{attributeKeys:h,directChange:!1})}},{key:"_setAttribute",value:function(t,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=r?"normal":"low";if("low"==i&&"normal"==this._attributePriority.get(t))return!1;var o=S(Object(b["a"])(e.prototype),"getAttribute",this).call(this,t);return o!==n&&(this._attrs.set(t,n),this._attributePriority.set(t,i),!0)}},{key:"_removeAttribute",value:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=n?"normal":"low";return("low"!=r||"normal"!=this._attributePriority.get(t))&&(this._attributePriority.set(t,r),!!S(Object(b["a"])(e.prototype),"hasAttribute",this).call(this,t)&&(this._attrs.delete(t),!0))}},{key:"_setAttributesTo",value:function(t){var e=new Pt.a,n=!0,r=!1,i=void 0;try{for(var o,a=P()(this.getAttributes());!(n=(o=a.next()).done);n=!0){var s=Ot(o.value,2),u=s[0],c=s[1];t.get(u)!==c&&this._removeAttribute(u,!1)}}catch(b){r=!0,i=b}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}var l=!0,h=!1,f=void 0;try{for(var d,p=P()(t);!(l=(d=p.next()).done);l=!0){var v=Ot(d.value,2),y=v[0],g=v[1],m=this._setAttribute(y,g,!1);m&&e.add(y)}}catch(b){h=!0,f=b}finally{try{l||null==p.return||p.return()}finally{if(h)throw f}}return e}},{key:"_getStoredAttributes",value:regeneratorRuntime.mark(function t(){var e,n,r,i,o,a,s,u;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e=this.getFirstPosition().parent,!this.isCollapsed||!e.isEmpty){t.next=30;break}n=!0,r=!1,i=void 0,t.prev=5,o=P()(e.getAttributeKeys());case 7:if(n=(a=o.next()).done){t.next=16;break}if(s=a.value,!s.startsWith(Vf)){t.next=13;break}return u=s.substr(Vf.length),t.next=13,[u,e.getAttribute(s)];case 13:n=!0,t.next=7;break;case 16:t.next=22;break;case 18:t.prev=18,t.t0=t["catch"](5),r=!0,i=t.t0;case 22:t.prev=22,t.prev=23,n||null==o.return||o.return();case 25:if(t.prev=25,!r){t.next=28;break}throw i;case 28:return t.finish(25);case 29:return t.finish(22);case 30:case"end":return t.stop()}},t,this,[[5,18,22,30],[23,,25,29]])})},{key:"_getSurroundingAttributes",value:function(){var t=this.getFirstPosition(),e=this._model.schema,n=null;if(this.isCollapsed){var r=t.textNode?t.textNode:t.nodeBefore,i=t.textNode?t.textNode:t.nodeAfter;if(this.isGravityOverridden||(n=qf(r)),n||(n=qf(i)),!this.isGravityOverridden&&!n){var o=r;while(o&&!n)o=o.previousSibling,n=qf(o)}if(!n){var a=i;while(a&&!n)a=a.nextSibling,n=qf(a)}n||(n=this._getStoredAttributes())}else{var s=this.getFirstRange(),u=!0,c=!1,l=void 0;try{for(var h,f=P()(s);!(u=(h=f.next()).done);u=!0){var d=h.value;if(d.item.is("element")&&e.isObject(d.item))break;"text"==d.type&&null===n&&(n=d.item.getAttributes())}}catch(p){c=!0,l=p}finally{try{u||null==f.return||f.return()}finally{if(c)throw l}}}return n}},{key:"_fixGraveyardSelection",value:function(t,e){var n=e.clone(),r=this._model.schema.getNearestSelectionRange(n),i=this._ranges.indexOf(t);if(this._ranges.splice(i,1),t.detach(),r){var o=this._prepareRange(r);this._ranges.splice(i,0,o)}}},{key:"isCollapsed",get:function(){var t=this._ranges.length;return 0===t?this._document._getDefaultRange().isCollapsed:S(Object(b["a"])(e.prototype),"isCollapsed",this)}},{key:"anchor",get:function(){return S(Object(b["a"])(e.prototype),"anchor",this)||this._document._getDefaultRange().start}},{key:"focus",get:function(){return S(Object(b["a"])(e.prototype),"focus",this)||this._document._getDefaultRange().end}},{key:"rangeCount",get:function(){return this._ranges.length?this._ranges.length:1}},{key:"hasOwnRange",get:function(){return this._ranges.length>0}},{key:"isGravityOverridden",get:function(){return!!this._overriddenGravityRegister.size}}]),e}(Nf);function qf(t){return t instanceof gf||t instanceof yf?t.getAttributes():null}function Wf(t,e){var n=t.document.differ,r=!0,i=!1,o=void 0;try{for(var a,s=function(){var n=a.value;if("insert"!=n.type)return"continue";var r=n.position.parent,i=n.length===r.maxOffset;i&&t.enqueueChange(e,function(t){var e=gt()(r.getAttributeKeys()).filter(function(t){return t.startsWith(Vf)}),n=!0,i=!1,o=void 0;try{for(var a,s=P()(e);!(n=(a=s.next()).done);n=!0){var u=a.value;t.removeAttribute(u,r)}}catch(c){i=!0,o=c}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}})},u=P()(n.getChanges());!(r=(a=u.next()).done);r=!0)s()}catch(c){i=!0,o=c}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}}var Kf=1,Hf=4;function zf(t){return ps(t,Kf|Hf)}var Gf=zf;
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function Qf(t){return t=Gf(t),t.view=Jf(t.view,"container"),function(e){e.on("insert:"+t.model,ed(t.view),{priority:t.converterPriority||"normal"})}}function Yf(t){t=Gf(t);var e=t.model.key?t.model.key:t.model,n="attribute:"+e;if(t.model.name&&(n+=":"+t.model.name),t.model.values){var r=!0,i=!1,o=void 0;try{for(var a,s=P()(t.model.values);!(r=(a=s.next()).done);r=!0){var u=a.value;t.view[u]=Jf(t.view[u],"attribute")}}catch(l){i=!0,o=l}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}else t.view=Jf(t.view,"attribute");var c=Zf(t);return function(e){e.on(n,od(c),{priority:t.converterPriority||"normal"})}}function Xf(t){t=Gf(t);var e=t.model.key?t.model.key:t.model,n="attribute:"+e;if(t.model.name&&(n+=":"+t.model.name),t.model.values){var r=!0,i=!1,o=void 0;try{for(var a,s=P()(t.model.values);!(r=(a=s.next()).done);r=!0){var u=a.value;t.view[u]=td(t.view[u])}}catch(l){i=!0,o=l}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}else t.view=td(t.view);var c=Zf(t);return function(e){e.on(n,id(c),{priority:t.converterPriority||"normal"})}}function Jf(t,e){return"function"==typeof t?t:function(n,r){return $f(t,r,e)}}function $f(t,e,n){var r;"string"==typeof t&&(t={name:t});var i=Oc()({},t.attributes);if("container"==n)r=e.createContainerElement(t.name,i);else if("attribute"==n){var o={priority:t.priority||qu.DEFAULT_PRIORITY};r=e.createAttributeElement(t.name,i,o)}else r=e.createUIElement(t.name,i);if(t.styles){var a=I()(t.styles),s=!0,u=!1,c=void 0;try{for(var l,h=P()(a);!(s=(l=h.next()).done);s=!0){var f=l.value;e.setStyle(f,t.styles[f],r)}}catch(w){u=!0,c=w}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}}if(t.classes){var d=t.classes;if("string"==typeof d)e.addClass(d,r);else{var p=!0,v=!1,y=void 0;try{for(var g,m=P()(d);!(p=(g=m.next()).done);p=!0){var b=g.value;e.addClass(b,r)}}catch(w){v=!0,y=w}finally{try{p||null==m.return||m.return()}finally{if(v)throw y}}}}return r}function Zf(t){return t.model.values?function(e,n){var r=t.view[e];return r?r(e,n):null}:t.view}function td(t){return"string"==typeof t?function(e){return{key:t,value:e}}:"object"==Object(Fs["a"])(t)?t.value?function(){return t}:function(e){return{key:t.key,value:e}}:t}function ed(t){return function(e,n,r){var i=t(n.item,r.writer);if(i&&r.consumable.consume(n.item,"insert")){var o=r.mapper.toViewPosition(n.range.start);r.mapper.bindElements(n.item,i),r.writer.insert(o,i)}}}function nd(){return function(t,e,n){if(n.consumable.consume(e.item,"insert")){var r=n.writer,i=n.mapper.toViewPosition(e.range.start),o=r.createText(e.item.data);r.insert(i,o)}}}function rd(){return function(t,e,n){var r=n.mapper.toViewPosition(e.position),i=e.position.getShiftedBy(e.length),o=n.mapper.toViewPosition(i,{isPhantom:!0}),a=n.writer.createRange(r,o),s=n.writer.remove(a.getTrimmed()),u=!0,c=!1,l=void 0;try{for(var h,f=P()(n.writer.createRangeIn(s).getItems());!(u=(h=f.next()).done);u=!0){var d=h.value;n.mapper.unbindViewElement(d)}}catch(p){c=!0,l=p}finally{try{u||null==f.return||f.return()}finally{if(c)throw l}}}}function id(t){return t=t||function(t,e){return{value:t,key:e.attributeKey}},function(e,n,r){var i=t(n.attributeOldValue,n),o=t(n.attributeNewValue,n);if((i||o)&&r.consumable.consume(n.item,e.name)){var a=r.mapper.toViewElement(n.item),s=r.writer;if(a){if(null!==n.attributeOldValue&&i)if("class"==i.key){var u=pt()(i.value)?i.value:[i.value],c=!0,l=!1,h=void 0;try{for(var f,d=P()(u);!(c=(f=d.next()).done);c=!0){var p=f.value;s.removeClass(p,a)}}catch(F){l=!0,h=F}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}}else if("style"==i.key){var v=I()(i.value),y=!0,g=!1,m=void 0;try{for(var b,w=P()(v);!(y=(b=w.next()).done);y=!0){var _=b.value;s.removeStyle(_,a)}}catch(F){g=!0,m=F}finally{try{y||null==w.return||w.return()}finally{if(g)throw m}}}else s.removeAttribute(i.key,a);if(null!==n.attributeNewValue&&o)if("class"==o.key){var k=pt()(o.value)?o.value:[o.value],E=!0,T=!1,S=void 0;try{for(var C,O=P()(k);!(E=(C=O.next()).done);E=!0){var A=C.value;s.addClass(A,a)}}catch(F){T=!0,S=F}finally{try{E||null==O.return||O.return()}finally{if(T)throw S}}}else if("style"==o.key){var x=I()(o.value),N=!0,R=!1,D=void 0;try{for(var j,M=P()(x);!(N=(j=M.next()).done);N=!0){var L=j.value;s.setStyle(L,o.value[L],a)}}catch(F){R=!0,D=F}finally{try{N||null==M.return||M.return()}finally{if(R)throw D}}}else s.setAttribute(o.key,o.value,a)}else qh["a"].warn("conversion-attribute-to-attribute-on-text: Trying to convert text node's attribute with attribute-to-attribute converter.")}}}function od(t){return function(e,n,r){var i=t(n.attributeOldValue,r.writer),o=t(n.attributeNewValue,r.writer);if((i||o)&&r.consumable.consume(n.item,e.name)){var a=r.writer,s=a.document.selection;if(n.item instanceof Nf||n.item instanceof Bf)a.wrap(s.getFirstRange(),o);else{var u=r.mapper.toViewRange(n.range);null!==n.attributeOldValue&&i&&(u=a.unwrap(u,i)),null!==n.attributeNewValue&&o&&a.wrap(u,o)}}}}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
function ad(t,e){return function(n,r){var i=r.newSelection,o=new Nf,a=[],s=!0,u=!1,c=void 0;try{for(var l,h=P()(i.getRanges());!(s=(l=h.next()).done);s=!0){var f=l.value;a.push(e.toModelRange(f))}}catch(d){u=!0,c=d}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}o.setTo(a,{backward:i.isBackward}),o.isEqual(t.document.selection)||t.change(function(t){t.setSelection(o)})}}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function sd(){return function(t,e,n){var r=e.selection;if(!r.isCollapsed&&n.consumable.consume(r,"selection")){var i=[],o=!0,a=!1,s=void 0;try{for(var u,c=P()(r.getRanges());!(o=(u=c.next()).done);o=!0){var l=u.value,h=n.mapper.toViewRange(l);i.push(h)}}catch(f){a=!0,s=f}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}n.writer.setSelection(i,{backward:r.isBackward})}}}function ud(){return function(t,e,n){var r=e.selection;if(r.isCollapsed&&n.consumable.consume(r,"selection")){var i=n.writer,o=r.getFirstPosition(),a=n.mapper.toViewPosition(o),s=i.breakAttributes(a);i.setSelection(s)}}}function cd(){return function(t,e,n){var r=n.writer,i=r.document.selection,o=!0,a=!1,s=void 0;try{for(var u,c=P()(i.getRanges());!(o=(u=c.next()).done);o=!0){var l=u.value;l.isCollapsed&&l.end.parent.document&&n.writer.mergeAttributes(l.start)}}catch(h){a=!0,s=h}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}r.setSelection(null)}}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var ld=function(){function t(e){var n=this;Object(c["a"])(this,t),this.model=e,this.view=new df,this.mapper=new Of,this.downcastDispatcher=new xf({mapper:this.mapper});var r=this.model.document,i=r.selection,o=this.model.markers;this.listenTo(this.model,"_beforeChanges",function(){n.view._renderingDisabled=!0},{priority:"highest"}),this.listenTo(this.model,"_afterChanges",function(){n.view._renderingDisabled=!1,n.view.render()},{priority:"lowest"}),this.listenTo(r,"change",function(){n.view.change(function(t){n.downcastDispatcher.convertChanges(r.differ,t),n.downcastDispatcher.convertSelection(i,o,t)})},{priority:"low"}),this.listenTo(this.view.document,"selectionChange",ad(this.model,this.mapper)),this.downcastDispatcher.on("insert:$text",nd(),{priority:"lowest"}),this.downcastDispatcher.on("remove",rd(),{priority:"low"}),this.downcastDispatcher.on("selection",cd(),{priority:"low"}),this.downcastDispatcher.on("selection",sd(),{priority:"low"}),this.downcastDispatcher.on("selection",ud(),{priority:"low"}),this.view.document.roots.bindTo(this.model.document.roots).using(function(t){if("$graveyard"==t.rootName)return null;var e=new Iu(t.name);return e.rootName=t.rootName,e._document=n.view.document,n.mapper.bindElements(t,e),e})}return Object(l["a"])(t,[{key:"destroy",value:function(){this.view.destroy(),this.stopListening()}}]),t}();oe(ld,vu);n("5df3");
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var hd=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(c["a"])(this,t),this._editor=e,this._availablePlugins=new It.a,this._plugins=new It.a;var r=!0,i=!1,o=void 0;try{for(var a,s=P()(n);!(r=(a=s.next()).done);r=!0){var u=a.value;this._availablePlugins.set(u,u),u.pluginName&&this._availablePlugins.set(u.pluginName,u)}}catch(l){i=!0,o=l}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}return Object(l["a"])(t,[{key:Es.a,value:regeneratorRuntime.mark(function t(){var e,n,r,i,o,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e=!0,n=!1,r=void 0,t.prev=3,i=P()(this._plugins);case 5:if(e=(o=i.next()).done){t.next=13;break}if(a=o.value,"function"!=typeof a[0]){t.next=10;break}return t.next=10,a;case 10:e=!0,t.next=5;break;case 13:t.next=19;break;case 15:t.prev=15,t.t0=t["catch"](3),n=!0,r=t.t0;case 19:t.prev=19,t.prev=20,e||null==i.return||i.return();case 22:if(t.prev=22,!n){t.next=25;break}throw r;case 25:return t.finish(22);case 26:return t.finish(19);case 27:case"end":return t.stop()}},t,this,[[3,15,19,27],[20,,22,26]])})},{key:"get",value:function(t){return this._plugins.get(t)}},{key:"load",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this,r=this._editor,i=new Pt.a,o=[],s=v(t),u=v(e),c=p(t);if(c){var l="plugincollection-plugin-not-found: Some plugins are not available and could not be loaded.";return qh["a"].error(l,{plugins:c}),a.a.reject(new Nt["b"](l,{plugins:c}))}return a.a.all(s.map(h)).then(function(){return o});function h(t){if(!u.includes(t)&&!n.get(t)&&!i.has(t))return f(t).catch(function(e){throw qh["a"].error("plugincollection-load: It was not possible to load the plugin.",{plugin:t}),e})}function f(t){return new a.a(function(a){i.add(t),t.requires&&t.requires.forEach(function(n){var r=d(n);if(e.includes(r))throw new Nt["b"]("plugincollection-required: Cannot load a plugin because one of its dependencies is listed inthe `removePlugins` option.",{plugin:r,requiredBy:t});h(r)});var s=new t(r);n._add(t,s),o.push(s),a()})}function d(t){return"function"==typeof t?t:n._availablePlugins.get(t)}function p(t){var e=[],n=!0,r=!1,i=void 0;try{for(var o,a=P()(t);!(n=(o=a.next()).done);n=!0){var s=o.value;d(s)||e.push(s)}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e.length?e:null}function v(t){return t.map(function(t){return d(t)}).filter(function(t){return!!t})}}},{key:"destroy",value:function(){var t=gt()(this).map(function(t){var e=Ot(t,2),n=e[1];return n}).filter(function(t){return"function"==typeof t.destroy}).map(function(t){return t.destroy()});return a.a.all(t)}},{key:"_add",value:function(t,e){this._plugins.set(t,e);var n=t.pluginName;n&&(this._plugins.has(n)?qh["a"].warn("plugincollection-plugin-name-conflict: Two plugins with the same name were loaded.",{pluginName:n,plugin1:this._plugins.get(n).constructor,plugin2:t}):this._plugins.set(n,e))}}]),t}(),fd=function(){function t(){Object(c["a"])(this,t),this._commands=new It.a}return Object(l["a"])(t,[{key:"add",value:function(t,e){this._commands.set(t,e)}},{key:"get",value:function(t){return this._commands.get(t)}},{key:"execute",value:function(t){var e=this.get(t);if(!e)throw new Nt["b"]("commandcollection-command-not-found: Command does not exist.",{commandName:t});for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e.execute.apply(e,r)}},{key:"names",value:regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.delegateYield(this._commands.keys(),"t0",1);case 1:case"end":return t.stop()}},t,this)})},{key:"commands",value:regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.delegateYield(this._commands.values(),"t0",1);case 1:case"end":return t.stop()}},t,this)})},{key:Es.a,value:function(){return P()(this._commands)}},{key:"destroy",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=P()(this.commands());!(t=(r=i.next()).done);t=!0){var o=r.value;o.destroy()}}catch(a){e=!0,n=a}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}}]),t}();function dd(t,e){var n=vd();if(1===n&&(t=I()(window.CKEDITOR_TRANSLATIONS)[0]),0===n||!pd(t,e))return e.replace(/ \[context: [^\]]+\]$/,"");var r=window.CKEDITOR_TRANSLATIONS[t];return r[e].replace(/ \[context: [^\]]+\]$/,"")}function pd(t,e){return t in window.CKEDITOR_TRANSLATIONS&&e in window.CKEDITOR_TRANSLATIONS[t]}function vd(){return I()(window.CKEDITOR_TRANSLATIONS).length}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
window.CKEDITOR_TRANSLATIONS||(window.CKEDITOR_TRANSLATIONS={});var yd=function(){function t(e){var n=this;Object(c["a"])(this,t),this.language=e||"en",this.t=function(){return n._t.apply(n,arguments)}}return Object(l["a"])(t,[{key:"_t",value:function(t,e){var n=dd(this.language,t);return e&&(n=n.replace(/%(\d+)/g,function(t,n){return n<e.length?e[n]:t})),n}}]),t}(),gd=function(){function t(){Object(c["a"])(this,t),this._consumables=new It.a}return Object(l["a"])(t,[{key:"add",value:function(t,e){var n;t.is("text")||t.is("documentFragment")?this._consumables.set(t,!0):(this._consumables.has(t)?n=this._consumables.get(t):(n=new md,this._consumables.set(t,n)),n.add(e))}},{key:"test",value:function(t,e){var n=this._consumables.get(t);return void 0===n?null:t.is("text")||t.is("documentFragment")?n:n.test(e)}},{key:"consume",value:function(t,e){return!!this.test(t,e)&&(t.is("text")||t.is("documentFragment")?this._consumables.set(t,!1):this._consumables.get(t).consume(e),!0)}},{key:"revert",value:function(t,e){var n=this._consumables.get(t);void 0!==n&&(t.is("text")||t.is("documentFragment")?this._consumables.set(t,!0):n.revert(e))}}],[{key:"consumablesFromElement",value:function(t){var e={name:!0,attributes:[],classes:[],styles:[]},n=t.getAttributeKeys(),r=!0,i=!1,o=void 0;try{for(var a,s=P()(n);!(r=(a=s.next()).done);r=!0){var u=a.value;"style"!=u&&"class"!=u&&e.attributes.push(u)}}catch(E){i=!0,o=E}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}var c=t.getClassNames(),l=!0,h=!1,f=void 0;try{for(var d,p=P()(c);!(l=(d=p.next()).done);l=!0){var v=d.value;e.classes.push(v)}}catch(E){h=!0,f=E}finally{try{l||null==p.return||p.return()}finally{if(h)throw f}}var y=t.getStyleNames(),g=!0,m=!1,b=void 0;try{for(var w,_=P()(y);!(g=(w=_.next()).done);g=!0){var k=w.value;e.styles.push(k)}}catch(E){m=!0,b=E}finally{try{g||null==_.return||_.return()}finally{if(m)throw b}}return e}},{key:"createFrom",value:function(e,n){if(n||(n=new t),e.is("text"))return n.add(e),n;e.is("element")&&n.add(e,t.consumablesFromElement(e)),e.is("documentFragment")&&n.add(e);var r=!0,i=!1,o=void 0;try{for(var a,s=P()(e.getChildren());!(r=(a=s.next()).done);r=!0){var u=a.value;n=t.createFrom(u,n)}}catch(c){i=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}]),t}(),md=function(){function t(){Object(c["a"])(this,t),this._canConsumeName=null,this._consumables={attributes:new It.a,styles:new It.a,classes:new It.a}}return Object(l["a"])(t,[{key:"add",value:function(t){for(var e in t.name&&(this._canConsumeName=!0),this._consumables)e in t&&this._add(e,t[e])}},{key:"test",value:function(t){if(t.name&&!this._canConsumeName)return this._canConsumeName;for(var e in this._consumables)if(e in t){var n=this._test(e,t[e]);if(!0!==n)return n}return!0}},{key:"consume",value:function(t){for(var e in t.name&&(this._canConsumeName=!1),this._consumables)e in t&&this._consume(e,t[e])}},{key:"revert",value:function(t){for(var e in t.name&&(this._canConsumeName=!0),this._consumables)e in t&&this._revert(e,t[e])}},{key:"_add",value:function(t,e){var n=kr(e)?e:[e],r=this._consumables[t],i=!0,o=!1,a=void 0;try{for(var s,u=P()(n);!(i=(s=u.next()).done);i=!0){var c=s.value;if("attributes"===t&&("class"===c||"style"===c))throw new Nt["b"]("viewconsumable-invalid-attribute: Classes and styles should be handled separately.");r.set(c,!0)}}catch(l){o=!0,a=l}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}}},{key:"_test",value:function(t,e){var n=kr(e)?e:[e],r=this._consumables[t],i=!0,o=!1,a=void 0;try{for(var s,u=P()(n);!(i=(s=u.next()).done);i=!0){var c=s.value;if("attributes"!==t||"class"!==c&&"style"!==c){var l=r.get(c);if(void 0===l)return null;if(!l)return!1}else{var h="class"==c?"classes":"styles",f=this._test(h,kt(this._consumables[h].keys()));if(!0!==f)return f}}}catch(d){o=!0,a=d}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}return!0}},{key:"_consume",value:function(t,e){var n=kr(e)?e:[e],r=this._consumables[t],i=!0,o=!1,a=void 0;try{for(var s,u=P()(n);!(i=(s=u.next()).done);i=!0){var c=s.value;if("attributes"!==t||"class"!==c&&"style"!==c)r.set(c,!1);else{var l="class"==c?"classes":"styles";this._consume(l,kt(this._consumables[l].keys()))}}}catch(h){o=!0,a=h}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}}},{key:"_revert",value:function(t,e){var n=kr(e)?e:[e],r=this._consumables[t],i=!0,o=!1,a=void 0;try{for(var s,u=P()(n);!(i=(s=u.next()).done);i=!0){var c=s.value;if("attributes"!==t||"class"!==c&&"style"!==c){var l=r.get(c);!1===l&&r.set(c,!0)}else{var h="class"==c?"classes":"styles";this._revert(h,kt(this._consumables[h].keys()))}}}catch(f){o=!0,a=f}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}}}]),t}(),bd=(n("aef6"),regeneratorRuntime.mark(Md)),wd=regeneratorRuntime.mark(Ld),_d=function(){function t(){var e=this;Object(c["a"])(this,t),this._sourceDefinitions={},this.decorate("checkChild"),this.decorate("checkAttribute"),this.on("checkAttribute",function(t,e){e[0]=new kd(e[0])},{priority:"highest"}),this.on("checkChild",function(t,n){n[0]=new kd(n[0]),n[1]=e.getDefinition(n[1])},{priority:"highest"})}return Object(l["a"])(t,[{key:"register",value:function(t,e){if(this._sourceDefinitions[t])throw new Nt["b"]("schema-cannot-register-item-twice: A single item cannot be registered twice in the schema.",{itemName:t});this._sourceDefinitions[t]=[Oc()({},e)],this._clearCache()}},{key:"extend",value:function(t,e){if(!this._sourceDefinitions[t])throw new Nt["b"]("schema-cannot-extend-missing-item: Cannot extend an item which was not registered yet.",{itemName:t});this._sourceDefinitions[t].push(Oc()({},e)),this._clearCache()}},{key:"getDefinitions",value:function(){return this._compiledDefinitions||this._compile(),this._compiledDefinitions}},{key:"getDefinition",value:function(t){var e;return e="string"==typeof t?t:t.is&&(t.is("text")||t.is("textProxy"))?"$text":t.name,this.getDefinitions()[e]}},{key:"isRegistered",value:function(t){return!!this.getDefinition(t)}},{key:"isBlock",value:function(t){var e=this.getDefinition(t);return!(!e||!e.isBlock)}},{key:"isLimit",value:function(t){var e=this.getDefinition(t);return!!e&&!(!e.isLimit&&!e.isObject)}},{key:"isObject",value:function(t){var e=this.getDefinition(t);return!(!e||!e.isObject)}},{key:"checkChild",value:function(t,e){return!!e&&this._checkContextMatch(e,t)}},{key:"checkAttribute",value:function(t,e){var n=this.getDefinition(t.last);return!!n&&n.allowAttributes.includes(e)}},{key:"checkMerge",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t instanceof Sf){var n=t.nodeBefore,r=t.nodeAfter;if(!(n instanceof bf))throw new Nt["b"]("schema-check-merge-no-element-before: The node before the merge position must be an element.");if(!(r instanceof bf))throw new Nt["b"]("schema-check-merge-no-element-after: The node after the merge position must be an element.");return this.checkMerge(n,r)}var i=!0,o=!1,a=void 0;try{for(var s,u=P()(e.getChildren());!(i=(s=u.next()).done);i=!0){var c=s.value;if(!this.checkChild(t,c))return!1}}catch(l){o=!0,a=l}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}return!0}},{key:"addChildCheck",value:function(t){this.on("checkChild",function(e,n){var r=Ot(n,2),i=r[0],o=r[1];if(o){var a=t(i,o);"boolean"==typeof a&&(e.stop(),e.return=a)}},{priority:"high"})}},{key:"addAttributeCheck",value:function(t){this.on("checkAttribute",function(e,n){var r=Ot(n,2),i=r[0],o=r[1],a=t(i,o);"boolean"==typeof a&&(e.stop(),e.return=a)},{priority:"high"})}},{key:"getLimitElement",value:function(t){var e;if(t instanceof Sf)e=t.parent;else{var n=t instanceof Cf?[t]:gt()(t.getRanges());e=n.reduce(function(t,e){var n=e.getCommonAncestor();return t?t.getCommonAncestor(n,{includeSelf:!0}):n},null)}while(!this.isLimit(e)){if(!e.parent)break;e=e.parent}return e}},{key:"checkAttributeInSelection",value:function(t,e){if(t.isCollapsed){var n=t.getFirstPosition(),r=[].concat(kt(n.getAncestors()),[new yf("",t.getAttributes())]);return this.checkAttribute(r,e)}var i=t.getRanges(),o=!0,a=!1,s=void 0;try{for(var u,c=P()(i);!(o=(u=c.next()).done);o=!0){var l=u.value,h=!0,f=!1,d=void 0;try{for(var p,v=P()(l);!(h=(p=v.next()).done);h=!0){var y=p.value;if(this.checkAttribute(y.item,e))return!0}}catch(g){f=!0,d=g}finally{try{h||null==v.return||v.return()}finally{if(f)throw d}}}}catch(g){a=!0,s=g}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}return!1}},{key:"getValidRanges",value:regeneratorRuntime.mark(function t(e,n){var r,i,o,a,s,u;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e=Ld(e),r=!0,i=!1,o=void 0,t.prev=4,a=P()(e);case 6:if(r=(s=a.next()).done){t.next=12;break}return u=s.value,t.delegateYield(this._getValidRangesForRange(u,n),"t0",9);case 9:r=!0,t.next=6;break;case 12:t.next=18;break;case 14:t.prev=14,t.t1=t["catch"](4),i=!0,o=t.t1;case 18:t.prev=18,t.prev=19,r||null==a.return||a.return();case 21:if(t.prev=21,!i){t.next=24;break}throw o;case 24:return t.finish(21);case 25:return t.finish(18);case 26:case"end":return t.stop()}},t,this,[[4,14,18,26],[19,,21,25]])})},{key:"_getValidRangesForRange",value:regeneratorRuntime.mark(function t(e,n){var r,i,o,a,s,u,c,l;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:r=e.start,i=e.start,o=!0,a=!1,s=void 0,t.prev=5,u=P()(e.getItems({shallow:!0}));case 7:if(o=(c=u.next()).done){t.next=20;break}if(l=c.value,!l.is("element")){t.next=11;break}return t.delegateYield(this._getValidRangesForRange(Cf._createIn(l),n),"t0",11);case 11:if(this.checkAttribute(l,n)){t.next=16;break}if(r.isEqual(i)){t.next=15;break}return t.next=15,new Cf(r,i);case 15:r=Sf._createAfter(l);case 16:i=Sf._createAfter(l);case 17:o=!0,t.next=7;break;case 20:t.next=26;break;case 22:t.prev=22,t.t1=t["catch"](5),a=!0,s=t.t1;case 26:t.prev=26,t.prev=27,o||null==u.return||u.return();case 29:if(t.prev=29,!a){t.next=32;break}throw s;case 32:return t.finish(29);case 33:return t.finish(26);case 34:if(r.isEqual(i)){t.next=37;break}return t.next=37,new Cf(r,i);case 37:case"end":return t.stop()}},t,this,[[5,22,26,34],[27,,29,33]])})},{key:"getNearestSelectionRange",value:function(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"both";if(this.checkChild(t,"$text"))return new Cf(t);"both"!=r&&"backward"!=r||(e=new _f({startPosition:t,direction:"backward"})),"both"!=r&&"forward"!=r||(n=new _f({startPosition:t}));var i=!0,o=!1,a=void 0;try{for(var s,u=P()(Md(e,n));!(i=(s=u.next()).done);i=!0){var c=s.value,l=c.walker==e?"elementEnd":"elementStart",h=c.value;if(h.type==l&&this.isObject(h.item))return Cf._createOn(h.item);if(this.checkChild(h.nextPosition,"$text"))return new Cf(h.nextPosition)}}catch(f){o=!0,a=f}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}return null}},{key:"findAllowedParent",value:function(t,e){var n=e.parent;while(n){if(this.checkChild(n,t))return n;if(this.isLimit(n))return null;n=n.parent}return null}},{key:"removeDisallowedAttributes",value:function(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=P()(t);!(n=(o=a.next()).done);n=!0){var s=o.value,u=!0,c=!1,l=void 0;try{for(var h,f=P()(s.getAttributeKeys());!(u=(h=f.next()).done);u=!0){var d=h.value;this.checkAttribute(s,d)||e.removeAttribute(d,s)}}catch(p){c=!0,l=p}finally{try{u||null==f.return||f.return()}finally{if(c)throw l}}s.is("element")&&this.removeDisallowedAttributes(s.getChildren(),e)}}catch(p){r=!0,i=p}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}},{key:"createContext",value:function(t){return new kd(t)}},{key:"_clearCache",value:function(){this._compiledDefinitions=null}},{key:"_compile",value:function(){var t={},e=this._sourceDefinitions,n=I()(e),r=!0,i=!1,o=void 0;try{for(var a,s=P()(n);!(r=(a=s.next()).done);r=!0){var u=a.value;t[u]=Ed(e[u],u)}}catch(j){i=!0,o=j}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}var c=!0,l=!1,h=void 0;try{for(var f,d=P()(n);!(c=(f=d.next()).done);c=!0){var p=f.value;Td(t,p)}}catch(j){l=!0,h=j}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}var v=!0,y=!1,g=void 0;try{for(var m,b=P()(n);!(v=(m=b.next()).done);v=!0){var w=m.value;Sd(t,w)}}catch(j){y=!0,g=j}finally{try{v||null==b.return||b.return()}finally{if(y)throw g}}var _=!0,k=!1,E=void 0;try{for(var T,S=P()(n);!(_=(T=S.next()).done);_=!0){var C=T.value;Cd(t,C),Od(t,C)}}catch(j){k=!0,E=j}finally{try{_||null==S.return||S.return()}finally{if(k)throw E}}var O=!0,A=!1,x=void 0;try{for(var N,R=P()(n);!(O=(N=R.next()).done);O=!0){var D=N.value;Ad(t,D),Id(t,D)}}catch(j){A=!0,x=j}finally{try{O||null==R.return||R.return()}finally{if(A)throw x}}this._compiledDefinitions=t}},{key:"_checkContextMatch",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length-1,r=e.getItem(n);if(t.allowIn.includes(r.name)){if(0==n)return!0;var i=this.getDefinition(r);return this._checkContextMatch(i,e,n-1)}return!1}}]),t}();
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */oe(_d,vu);var kd=function(){function t(e){if(Object(c["a"])(this,t),e instanceof t)return e;"string"==typeof e?e=[e]:pt()(e)||(e=e.getAncestors({includeSelf:!0})),e[0]&&"string"!=typeof e[0]&&e[0].is("documentFragment")&&e.shift(),this._items=e.map(jd)}return Object(l["a"])(t,[{key:Es.a,value:function(){return P()(this._items)}},{key:"push",value:function(e){var n=new t([e]);return n._items=[].concat(kt(this._items),kt(n._items)),n}},{key:"getItem",value:function(t){return this._items[t]}},{key:"getNames",value:regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.delegateYield(this._items.map(function(t){return t.name}),"t0",1);case 1:case"end":return t.stop()}},t,this)})},{key:"endsWith",value:function(t){return gt()(this.getNames()).join(" ").endsWith(t)}},{key:"length",get:function(){return this._items.length}},{key:"last",get:function(){return this._items[this._items.length-1]}}]),t}();function Ed(t,e){var n={name:e,allowIn:[],allowContentOf:[],allowWhere:[],allowAttributes:[],allowAttributesOf:[],inheritTypesFrom:[]};return xd(t,n),Pd(t,n,"allowIn"),Pd(t,n,"allowContentOf"),Pd(t,n,"allowWhere"),Pd(t,n,"allowAttributes"),Pd(t,n,"allowAttributesOf"),Pd(t,n,"inheritTypesFrom"),Nd(t,n),n}function Td(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=P()(t[e].allowContentOf);!(n=(o=a.next()).done);n=!0){var s=o.value;if(t[s]){var u=Rd(t,s);u.forEach(function(t){t.allowIn.push(e)})}}}catch(c){r=!0,i=c}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}delete t[e].allowContentOf}function Sd(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=P()(t[e].allowWhere);!(n=(o=a.next()).done);n=!0){var s=o.value,u=t[s];if(u){var c,l=u.allowIn;(c=t[e].allowIn).push.apply(c,kt(l))}}}catch(h){r=!0,i=h}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}delete t[e].allowWhere}function Cd(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=P()(t[e].allowAttributesOf);!(n=(o=a.next()).done);n=!0){var s=o.value,u=t[s];if(u){var c,l=u.allowAttributes;(c=t[e].allowAttributes).push.apply(c,kt(l))}}}catch(h){r=!0,i=h}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}delete t[e].allowAttributesOf}function Od(t,e){var n=t[e],r=!0,i=!1,o=void 0;try{for(var a,s=P()(n.inheritTypesFrom);!(r=(a=s.next()).done);r=!0){var u=a.value,c=t[u];if(c){var l=I()(c).filter(function(t){return t.startsWith("is")}),h=!0,f=!1,d=void 0;try{for(var p,v=P()(l);!(h=(p=v.next()).done);h=!0){var y=p.value;y in n||(n[y]=c[y])}}catch(g){f=!0,d=g}finally{try{h||null==v.return||v.return()}finally{if(f)throw d}}}}}catch(g){i=!0,o=g}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}delete n.inheritTypesFrom}function Ad(t,e){var n=t[e],r=n.allowIn.filter(function(e){return t[e]});n.allowIn=gt()(new Pt.a(r))}function Id(t,e){var n=t[e];n.allowAttributes=gt()(new Pt.a(n.allowAttributes))}function xd(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=P()(t);!(n=(o=a.next()).done);n=!0){var s=o.value,u=I()(s).filter(function(t){return t.startsWith("is")}),c=!0,l=!1,h=void 0;try{for(var f,d=P()(u);!(c=(f=d.next()).done);c=!0){var p=f.value;e[p]=s[p]}}catch(v){l=!0,h=v}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}}}catch(v){r=!0,i=v}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}function Pd(t,e,n){var r=!0,i=!1,o=void 0;try{for(var a,s=P()(t);!(r=(a=s.next()).done);r=!0){var u=a.value;if("string"==typeof u[n])e[n].push(u[n]);else if(pt()(u[n])){var c;(c=e[n]).push.apply(c,kt(u[n]))}}}catch(l){i=!0,o=l}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}function Nd(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=P()(t);!(n=(o=a.next()).done);n=!0){var s=o.value,u=s.inheritAllFrom;u&&(e.allowContentOf.push(u),e.allowWhere.push(u),e.allowAttributesOf.push(u),e.inheritTypesFrom.push(u))}}catch(c){r=!0,i=c}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}function Rd(t,e){var n=t[e];return Dd(t).filter(function(t){return t.allowIn.includes(n.name)})}function Dd(t){return I()(t).map(function(e){return t[e]})}function jd(t){return"string"==typeof t?{name:t,getAttributeKeys:regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}},t,this)}),getAttribute:function(){}}:{name:t.is("element")?t.name:"$text",getAttributeKeys:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.delegateYield(t.getAttributeKeys(),"t0",1);case 1:case"end":return e.stop()}},e,this)}),getAttribute:function(e){return t.getAttribute(e)}}}function Md(t,e){var n,r,i;return regeneratorRuntime.wrap(function(o){while(1)switch(o.prev=o.next){case 0:n=!1;case 1:if(n){o.next=17;break}if(n=!0,!t){o.next=9;break}if(r=t.next(),r.done){o.next=9;break}return n=!1,o.next=9,{walker:t,value:r.value};case 9:if(!e){o.next=15;break}if(i=e.next(),i.done){o.next=15;break}return n=!1,o.next=15,{walker:e,value:i.value};case 15:o.next=1;break;case 17:case"end":return o.stop()}},bd,this)}function Ld(t){var e,n,r,i,o,a;return regeneratorRuntime.wrap(function(s){while(1)switch(s.prev=s.next){case 0:e=!0,n=!1,r=void 0,s.prev=3,i=P()(t);case 5:if(e=(o=i.next()).done){s.next=11;break}return a=o.value,s.delegateYield(a.getMinimalFlatRanges(),"t0",8);case 8:e=!0,s.next=5;break;case 11:s.next=17;break;case 13:s.prev=13,s.t1=s["catch"](3),n=!0,r=s.t1;case 17:s.prev=17,s.prev=18,e||null==i.return||i.return();case 20:if(s.prev=20,!n){s.next=23;break}throw r;case 23:return s.finish(20);case 24:return s.finish(17);case 25:case"end":return s.stop()}},wd,this,[[3,13,17,25],[18,,20,24]])}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Fd=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(c["a"])(this,t),this._removeIfEmpty=new Pt.a,this._modelCursor=null,this.conversionApi=Oc()({},e),this.conversionApi.convertItem=this._convertItem.bind(this),this.conversionApi.convertChildren=this._convertChildren.bind(this),this.conversionApi.splitToAllowedParent=this._splitToAllowedParent.bind(this)}return Object(l["a"])(t,[{key:"convert",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:["$root"];this.fire("viewCleanup",t),this._modelCursor=Bd(n,e),this.conversionApi.writer=e,this.conversionApi.consumable=gd.createFrom(t),this.conversionApi.store={};var r=this._convertItem(t,this._modelCursor),i=r.modelRange,o=e.createDocumentFragment();if(i){this._removeEmptyElements();for(var a=gt()(this._modelCursor.parent.getChildren()),s=0;s<a.length;s++){var u=a[s];e.append(u,o)}o.markers=Vd(o,e)}return this._modelCursor=null,this._removeIfEmpty.clear(),this.conversionApi.writer=null,this.conversionApi.store=null,o}},{key:"_convertItem",value:function(t,e){var n=Oc()({viewItem:t,modelCursor:e,modelRange:null});if(t.is("element")?this.fire("element:"+t.name,n,this.conversionApi):t.is("text")?this.fire("text",n,this.conversionApi):this.fire("documentFragment",n,this.conversionApi),n.modelRange&&!(n.modelRange instanceof Cf))throw new Nt["b"]("view-conversion-dispatcher-incorrect-result: Incorrect conversion result was dropped.");return{modelRange:n.modelRange,modelCursor:n.modelCursor}}},{key:"_convertChildren",value:function(t,e){for(var n=new Cf(e),r=e,i=gt()(t.getChildren()),o=0;o<i.length;o++){var a=i[o],s=this._convertItem(a,r);s.modelRange instanceof Cf&&(n.end=s.modelRange.end,r=s.modelCursor)}return{modelRange:n,modelCursor:r}}},{key:"_splitToAllowedParent",value:function(t,e){var n=this.conversionApi.schema.findAllowedParent(t,e);if(!n)return null;if(n===e.parent)return{position:e};if(this._modelCursor.parent.getAncestors().includes(n))return null;var r=this.conversionApi.writer.split(e,n),i=!0,o=!1,a=void 0;try{for(var s,u=P()(r.range.getPositions());!(i=(s=u.next()).done);i=!0){var c=s.value;c.isEqual(r.position)||this._removeIfEmpty.add(c.parent)}}catch(l){o=!0,a=l}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}return{position:r.position,cursorParent:r.range.end.parent}}},{key:"_removeEmptyElements",value:function(){var t=!1,e=!0,n=!1,r=void 0;try{for(var i,o=P()(this._removeIfEmpty);!(e=(i=o.next()).done);e=!0){var a=i.value;a.isEmpty&&(this.conversionApi.writer.remove(a),this._removeIfEmpty.delete(a),t=!0)}}catch(s){n=!0,r=s}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}t&&this._removeEmptyElements()}}]),t}();function Vd(t,e){var n=new Pt.a,r=new It.a,i=Cf._createIn(t).getItems(),o=!0,a=!1,s=void 0;try{for(var u,c=P()(i);!(o=(u=c.next()).done);o=!0){var l=u.value;"$marker"==l.name&&n.add(l)}}catch(b){a=!0,s=b}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}var h=!0,f=!1,d=void 0;try{for(var p,v=P()(n);!(h=(p=v.next()).done);h=!0){var y=p.value,g=y.getAttribute("data-name"),m=e.createPositionBefore(y);r.has(g)?r.get(g).end=m.clone():r.set(g,new Cf(m.clone())),e.remove(y)}}catch(b){f=!0,d=b}finally{try{h||null==v.return||v.return()}finally{if(f)throw d}}return r}function Bd(t,e){var n,r=!0,i=!1,o=void 0;try{for(var a,s=P()(new kd(t));!(r=(a=s.next()).done);r=!0){var u=a.value,c={},l=!0,h=!1,f=void 0;try{for(var d,p=P()(u.getAttributeKeys());!(l=(d=p.next()).done);l=!0){var v=d.value;c[v]=u.getAttribute(v)}}catch(g){h=!0,f=g}finally{try{l||null==p.return||p.return()}finally{if(h)throw f}}var y=e.createElement(u.name,c);n&&e.append(y,n),n=Sf._createAt(y,0)}}catch(g){i=!0,o=g}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}function Ud(t,e,n){return e in t?te()(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function qd(t){t=Gf(t);var e=zd(t),n=Hd(t),r=n?"element:"+n:"element";return function(n){n.on(r,e,{priority:t.converterPriority||"normal"})}}function Wd(t){t=Gf(t),Yd(t);var e=Xd(t,!1),n=Hd(t),r=n?"element:"+n:"element";return function(n){n.on(r,e,{priority:t.converterPriority||"normal"})}}function Kd(t){t=Gf(t);var e=null;("string"==typeof t.view||t.view.key)&&(e=Qd(t)),Yd(t,e);var n=Xd(t,!0);return function(e){e.on("element",n,{priority:t.converterPriority||"low"})}}function Hd(t){return"string"==typeof t.view?t.view:"object"==Object(Fs["a"])(t.view)&&"string"==typeof t.view.name?t.view.name:null}function zd(t){var e=new Ss(t.view);return function(n,r,i){var o=e.match(r.viewItem);if(o){o.match.name=!0;var a=Gd(t.model,r.viewItem,i.writer);if(a&&i.consumable.test(r.viewItem,o.match)){var s=i.splitToAllowedParent(a,r.modelCursor);if(s){i.writer.insert(a,s.position);var u=i.convertChildren(r.viewItem,i.writer.createPositionAt(a,0));i.consumable.consume(r.viewItem,o.match),r.modelRange=new Cf(i.writer.createPositionBefore(a),i.writer.createPositionAfter(u.modelCursor.parent)),s.cursorParent?r.modelCursor=i.writer.createPositionAt(s.cursorParent,0):r.modelCursor=r.modelRange.end}}}}}function Gd(t,e,n){return t instanceof Function?t(e,n):n.createElement(t)}function Qd(t){"string"==typeof t.view&&(t.view={key:t.view});var e,n=t.view.key;if("class"==n||"style"==n){var r="class"==n?"classes":"styles";e=Ud({},r,t.view.value)}else{var i="undefined"==typeof t.view.value?/[\s\S]*/:t.view.value;e={attributes:Ud({},n,i)}}return t.view.name&&(e.name=t.view.name),t.view=e,n}function Yd(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=null===e||function(t){return t.getAttribute(e)},r="object"!=Object(Fs["a"])(t.model)?t.model:t.model.key,i="object"!=Object(Fs["a"])(t.model)||"undefined"==typeof t.model.value?n:t.model.value;t.model={key:r,value:i}}function Xd(t,e){var n=new Ss(t.view);return function(r,i,o){var a=n.match(i.viewItem);if(a){var s=t.model.key,u="function"==typeof t.model.value?t.model.value(i.viewItem):t.model.value;if(null!==u&&(Jd(t)?a.match.name=!0:delete a.match.name,o.consumable.test(i.viewItem,a.match))){i.modelRange||(i=Oc()(i,o.convertChildren(i.viewItem,i.modelCursor)));var c=$d(i.modelRange,{key:s,value:u},e,o);c&&o.consumable.consume(i.viewItem,a.match)}}}}function Jd(t){return!("object"==Object(Fs["a"])(t.view)&&!Hd(t))&&(!t.view.classes&&!t.view.attributes&&!t.view.styles)}function $d(t,e,n,r){for(var i=!1,o=gt()(t.getItems({shallow:n})),a=0;a<o.length;a++){var s=o[a];r.schema.checkAttribute(s,e.key)&&(r.writer.setAttribute(e.key,e.value,s),i=!0)}return i}function Zd(){return function(t,e,n){if(!e.modelRange&&n.consumable.consume(e.viewItem,{name:!0})){var r=n.convertChildren(e.viewItem,e.modelCursor),i=r.modelRange,o=r.modelCursor;e.modelRange=i,e.modelCursor=o}}}function tp(){return function(t,e,n){if(n.schema.checkChild(e.modelCursor,"$text")&&n.consumable.consume(e.viewItem)){var r=n.writer.createText(e.viewItem.data);n.writer.insert(r,e.modelCursor),e.modelRange=Cf._createFromPositionAndShift(e.modelCursor,r.offsetSize),e.modelCursor=e.modelRange.end}}}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */oe(Fd,qt);var ep=function(){function t(e,n){Object(c["a"])(this,t),this.model=e,this.processor=n,this.mapper=new Of,this.downcastDispatcher=new xf({mapper:this.mapper}),this.downcastDispatcher.on("insert:$text",nd(),{priority:"lowest"}),this.upcastDispatcher=new Fd({schema:e.schema}),this.upcastDispatcher.on("text",tp(),{priority:"lowest"}),this.upcastDispatcher.on("element",Zd(),{priority:"lowest"}),this.upcastDispatcher.on("documentFragment",Zd(),{priority:"lowest"}),this.decorate("init")}return Object(l["a"])(t,[{key:"get",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main";return this.stringify(this.model.document.getRoot(t))}},{key:"stringify",value:function(t){var e=this.toView(t);return this.processor.toData(e)}},{key:"toView",value:function(t){this.mapper.clearBindings();var e=Cf._createIn(t),n=new hc,r=new dc(new Bu);if(this.mapper.bindElements(t,n),this.downcastDispatcher.convertInsert(e,r),!t.is("documentFragment")){var i=np(t),o=!0,a=!1,s=void 0;try{for(var u,c=P()(i);!(o=(u=c.next()).done);o=!0){var l=Ot(u.value,2),h=l[0],f=l[1];this.downcastDispatcher.convertMarkerAdd(h,f,r)}}catch(d){a=!0,s=d}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}}return n}},{key:"init",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"main";if(this.model.document.version)throw new Nt["b"]("datacontroller-init-document-not-empty: Trying to set initial data to not empty document.");var r=this.model.document.getRoot(n);return this.model.enqueueChange("transparent",function(n){n.insert(e.parse(t,r),r,0)}),a.a.resolve()}},{key:"set",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"main",r=this.model.document.getRoot(n);this.model.enqueueChange("transparent",function(n){n.setSelection(null),n.removeSelectionAttribute(e.model.document.selection.getAttributeKeys()),n.remove(n.createRangeIn(r)),n.insert(e.parse(t,r),r,0)})}},{key:"parse",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"$root",n=this.processor.toView(t);return this.toModel(n,e)}},{key:"toModel",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"$root";return this.model.change(function(r){return e.upcastDispatcher.convert(t,r,n)})}},{key:"destroy",value:function(){}}]),t}();function np(t){var e=[],n=t.root.document;if(!n)return[];var r=Cf._createIn(t),i=!0,o=!1,a=void 0;try{for(var s,u=P()(n.model.markers);!(i=(s=u.next()).done);i=!0){var c=s.value,l=r.getIntersection(c.getRange());l&&e.push([c.name,l])}}catch(h){o=!0,a=h}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}return e}oe(ep,vu);var rp=regeneratorRuntime.mark(sp),ip=regeneratorRuntime.mark(up),op=function(){function t(){Object(c["a"])(this,t),this._dispatchersGroups=new It.a}return Object(l["a"])(t,[{key:"register",value:function(t,e){if(this._dispatchersGroups.has(t))throw new Nt["b"]("conversion-register-group-exists: Trying to register a group name that was already registered.");this._dispatchersGroups.set(t,e)}},{key:"for",value:function(t){var e=this._getDispatchers(t);return{add:function(t){return ap(e,t),this}}}},{key:"elementToElement",value:function(t){this.for("downcast").add(Qf(t));var e=!0,n=!1,r=void 0;try{for(var i,o=P()(sp(t));!(e=(i=o.next()).done);e=!0){var a=i.value,s=a.model,u=a.view;this.for("upcast").add(qd({model:s,view:u,converterPriority:t.converterPriority}))}}catch(c){n=!0,r=c}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"attributeToElement",value:function(t){this.for("downcast").add(Yf(t));var e=!0,n=!1,r=void 0;try{for(var i,o=P()(sp(t));!(e=(i=o.next()).done);e=!0){var a=i.value,s=a.model,u=a.view;this.for("upcast").add(Wd({view:u,model:s,priority:t.priority}))}}catch(c){n=!0,r=c}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"attributeToAttribute",value:function(t){this.for("downcast").add(Xf(t));var e=!0,n=!1,r=void 0;try{for(var i,o=P()(sp(t));!(e=(i=o.next()).done);e=!0){var a=i.value,s=a.model,u=a.view;this.for("upcast").add(Kd({view:u,model:s}))}}catch(c){n=!0,r=c}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"_getDispatchers",value:function(t){var e=this._dispatchersGroups.get(t);if(!e)throw new Nt["b"]("conversion-for-unknown-group: Trying to add a converter to an unknown dispatchers group.");return e}}]),t}();
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function ap(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=P()(t);!(n=(o=a.next()).done);n=!0){var s=o.value;e(s)}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}function sp(t){var e,n,r,i,o,a,s,u,c;return regeneratorRuntime.wrap(function(l){while(1)switch(l.prev=l.next){case 0:if(!t.model.values){l.next=31;break}e=!0,n=!1,r=void 0,l.prev=4,i=P()(t.model.values);case 6:if(e=(o=i.next()).done){l.next=15;break}return a=o.value,s={key:t.model.key,value:a},u=t.view[a],c=t.upcastAlso?t.upcastAlso[a]:void 0,l.delegateYield(up(s,u,c),"t0",12);case 12:e=!0,l.next=6;break;case 15:l.next=21;break;case 17:l.prev=17,l.t1=l["catch"](4),n=!0,r=l.t1;case 21:l.prev=21,l.prev=22,e||null==i.return||i.return();case 24:if(l.prev=24,!n){l.next=27;break}throw r;case 27:return l.finish(24);case 28:return l.finish(21);case 29:l.next=32;break;case 31:return l.delegateYield(up(t.model,t.view,t.upcastAlso),"t2",32);case 32:case"end":return l.stop()}},rp,this,[[4,17,21,29],[22,,24,28]])}function up(t,e,n){var r,i,o,a,s,u;return regeneratorRuntime.wrap(function(c){while(1)switch(c.prev=c.next){case 0:return c.next=2,{model:t,view:e};case 2:if(!n){c.next=30;break}n=pt()(n)?n:[n],r=!0,i=!1,o=void 0,c.prev=7,a=P()(n);case 9:if(r=(s=a.next()).done){c.next=16;break}return u=s.value,c.next=13,{model:t,view:u};case 13:r=!0,c.next=9;break;case 16:c.next=22;break;case 18:c.prev=18,c.t0=c["catch"](7),i=!0,o=c.t0;case 22:c.prev=22,c.prev=23,r||null==a.return||a.return();case 25:if(c.prev=25,!i){c.next=28;break}throw o;case 28:return c.finish(25);case 29:return c.finish(22);case 30:case"end":return c.stop()}},ip,this,[[7,18,22,30],[23,,25,29]])}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var cp=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";Object(c["a"])(this,t),this.operations=[],this.type=e}return Object(l["a"])(t,[{key:"addOperation",value:function(t){return t.batch=this,this.operations.push(t),t}},{key:"baseVersion",get:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=P()(this.operations);!(t=(r=i.next()).done);t=!0){var o=r.value;if(null!==o.baseVersion)return o.baseVersion}}catch(a){e=!0,n=a}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}return null}}]),t}(),lp=function(){function t(e){Object(c["a"])(this,t),this.baseVersion=e,this.isDocumentOperation=null!==this.baseVersion,this.batch=null}return Object(l["a"])(t,[{key:"_validate",value:function(){}},{key:"toJSON",value:function(){var t=Oc()({},this);return t.__className=this.constructor.className,delete t.batch,delete t.isDocumentOperation,t}}],[{key:"fromJSON",value:function(t){return new this(t.baseVersion)}},{key:"className",get:function(){return"Operation"}}]),t}(),hp=function(){function t(e){Object(c["a"])(this,t),this.markers=new It.a,this._children=new mf,e&&this._insertChild(0,e)}return Object(l["a"])(t,[{key:Es.a,value:function(){return this.getChildren()}},{key:"is",value:function(t){return"documentFragment"==t}},{key:"getChild",value:function(t){return this._children.getNode(t)}},{key:"getChildren",value:function(){return P()(this._children)}},{key:"getChildIndex",value:function(t){return this._children.getNodeIndex(t)}},{key:"getChildStartOffset",value:function(t){return this._children.getNodeStartOffset(t)}},{key:"getPath",value:function(){return[]}},{key:"getNodeByPath",value:function(t){var e=this,n=!0,r=!1,i=void 0;try{for(var o,a=P()(t);!(n=(o=a.next()).done);n=!0){var s=o.value;e=e.getChild(e.offsetToIndex(s))}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}},{key:"offsetToIndex",value:function(t){return this._children.offsetToIndex(t)}},{key:"toJSON",value:function(){var t=[],e=!0,n=!1,r=void 0;try{for(var i,o=P()(this._children);!(e=(i=o.next()).done);e=!0){var a=i.value;t.push(a.toJSON())}}catch(s){n=!0,r=s}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return t}},{key:"_appendChild",value:function(t){this._insertChild(this.childCount,t)}},{key:"_insertChild",value:function(t,e){var n=fp(e),r=!0,i=!1,o=void 0;try{for(var a,s=P()(n);!(r=(a=s.next()).done);r=!0){var u=a.value;null!==u.parent&&u._remove(),u.parent=this}}catch(c){i=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}this._children._insertNodes(t,n)}},{key:"_removeChildren",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this._children._removeNodes(t,e),r=!0,i=!1,o=void 0;try{for(var a,s=P()(n);!(r=(a=s.next()).done);r=!0){var u=a.value;u.parent=null}}catch(c){i=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}},{key:"childCount",get:function(){return this._children.length}},{key:"maxOffset",get:function(){return this._children.maxOffset}},{key:"isEmpty",get:function(){return 0===this.childCount}},{key:"root",get:function(){return this}},{key:"parent",get:function(){return null}}],[{key:"fromJSON",value:function(e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=P()(e);!(r=(a=s.next()).done);r=!0){var u=a.value;u.name?n.push(bf.fromJSON(u)):n.push(yf.fromJSON(u))}}catch(c){i=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return new t(n)}}]),t}();
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function fp(t){return"string"==typeof t?[new yf(t)]:(Ts(t)||(t=[t]),gt()(t).map(function(t){return"string"==typeof t?new yf(t):t instanceof gf?new yf(t.data,t.getAttributes()):t}))}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function dp(t,e){e=gp(e);var n=e.reduce(function(t,e){return t+e.offsetSize},0),r=t.parent;bp(t);var i=t.index;return r._insertChild(i,e),mp(r,i+e.length),mp(r,i),new Cf(t,t.getShiftedBy(n))}function pp(t){if(!t.isFlat)throw new Nt["b"]("operation-utils-remove-range-not-flat: Trying to remove a range which starts and ends in different element.");var e=t.start.parent;bp(t.start),bp(t.end);var n=e._removeChildren(t.start.index,t.end.index-t.start.index);return mp(e,t.start.index),n}function vp(t,e){if(!t.isFlat)throw new Nt["b"]("operation-utils-move-range-not-flat: Trying to move a range which starts and ends in different element.");var n=pp(t);return e=e._getTransformedByDeletion(t.start,t.end.offset-t.start.offset),dp(e,n)}function yp(t,e,n){bp(t.start),bp(t.end);var r=!0,i=!1,o=void 0;try{for(var a,s=P()(t.getItems({shallow:!0}));!(r=(a=s.next()).done);r=!0){var u=a.value,c=u.is("textProxy")?u.textNode:u;null!==n?c._setAttribute(e,n):c._removeAttribute(e),mp(c.parent,c.index)}}catch(l){i=!0,o=l}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}mp(t.end.parent,t.end.index)}function gp(t){var e=[];t instanceof Array||(t=[t]);for(var n=0;n<t.length;n++)if("string"==typeof t[n])e.push(new yf(t[n]));else if(t[n]instanceof gf)e.push(new yf(t[n].data,t[n].getAttributes()));else if(t[n]instanceof hp||t[n]instanceof mf){var r=!0,i=!1,o=void 0;try{for(var a,s=P()(t[n]);!(r=(a=s.next()).done);r=!0){var u=a.value;e.push(u)}}catch(f){i=!0,o=f}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}else t[n]instanceof vf&&e.push(t[n]);for(var c=1;c<e.length;c++){var l=e[c],h=e[c-1];l instanceof yf&&h instanceof yf&&wp(l,h)&&(e.splice(c-1,2,new yf(h.data+l.data,h.getAttributes())),c--)}return e}function mp(t,e){var n=t.getChild(e-1),r=t.getChild(e);if(n&&r&&n.is("text")&&r.is("text")&&wp(n,r)){var i=new yf(n.data+r.data,n.getAttributes());t._removeChildren(e-1,2),t._insertChild(e-1,i)}}function bp(t){var e=t.textNode,n=t.parent;if(e){var r=t.offset-e.startOffset,i=e.index;n._removeChildren(i,1);var o=new yf(e.data.substr(0,r),e.getAttributes()),a=new yf(e.data.substr(r),e.getAttributes());n._insertChild(i,[o,a])}}function wp(t,e){var n=t.getAttributes(),r=e.getAttributes(),i=!0,o=!1,a=void 0;try{for(var s,u=P()(n);!(i=(s=u.next()).done);i=!0){var c=s.value;if(c[1]!==e.getAttribute(c[0]))return!1;r.next()}}catch(l){o=!0,a=l}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}return r.next().done}function _p(t,e){return dh(t,e)}var kp=_p,Ep=function(t){function e(t,n,r,i,o){var a;return Object(c["a"])(this,e),a=Object(m["a"])(this,Object(b["a"])(e).call(this,o)),a.range=t.clone(),a.key=n,a.oldValue=void 0===r?null:r,a.newValue=void 0===i?null:i,a}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"clone",value:function(){return new e(this.range,this.key,this.oldValue,this.newValue,this.baseVersion)}},{key:"getReversed",value:function(){return new e(this.range,this.key,this.newValue,this.oldValue,this.baseVersion+1)}},{key:"toJSON",value:function(){var t=S(Object(b["a"])(e.prototype),"toJSON",this).call(this);return t.range=this.range.toJSON(),t}},{key:"_validate",value:function(){if(!this.range.isFlat)throw new Nt["b"]("attribute-operation-range-not-flat: The range to change is not flat.");var t=!0,e=!1,n=void 0;try{for(var r,i=P()(this.range.getItems({shallow:!0}));!(t=(r=i.next()).done);t=!0){var o=r.value;if(null!==this.oldValue&&!kp(o.getAttribute(this.key),this.oldValue))throw new Nt["b"]("attribute-operation-wrong-old-value: Changed node has different attribute value than operation's old attribute value.",{item:o,key:this.key,value:this.oldValue});if(null===this.oldValue&&null!==this.newValue&&o.hasAttribute(this.key))throw new Nt["b"]("attribute-operation-attribute-exists: The attribute with given key already exists.",{node:o,key:this.key})}}catch(a){e=!0,n=a}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}},{key:"_execute",value:function(){kp(this.oldValue,this.newValue)||yp(this.range,this.key,this.newValue)}},{key:"type",get:function(){return null===this.oldValue?"addAttribute":null===this.newValue?"removeAttribute":"changeAttribute"}}],[{key:"fromJSON",value:function(t,n){return new e(Cf.fromJSON(t.range,n),t.key,t.oldValue,t.newValue,t.baseVersion)}},{key:"className",get:function(){return"AttributeOperation"}}]),e}(lp),Tp=function(t){function e(t,n){var r;return Object(c["a"])(this,e),r=Object(m["a"])(this,Object(b["a"])(e).call(this,null)),r.sourcePosition=t.clone(),r.howMany=n,r}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"toJSON",value:function(){var t=S(Object(b["a"])(e.prototype),"toJSON",this).call(this);return t.sourcePosition=this.sourcePosition.toJSON(),t}},{key:"_validate",value:function(){if(this.sourcePosition.root.document)throw new Nt["b"]("detach-operation-on-document-node: Cannot detach document node.")}},{key:"_execute",value:function(){pp(Cf._createFromPositionAndShift(this.sourcePosition,this.howMany))}},{key:"type",get:function(){return"detach"}}],[{key:"className",get:function(){return"DetachOperation"}}]),e}(lp),Sp=function(t){function e(t,n,r,i){var o;return Object(c["a"])(this,e),o=Object(m["a"])(this,Object(b["a"])(e).call(this,i)),o.sourcePosition=t.clone(),o.sourcePosition.stickiness="toNext",o.howMany=n,o.targetPosition=r.clone(),o.targetPosition.stickiness="toNone",o}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"clone",value:function(){return new this.constructor(this.sourcePosition,this.howMany,this.targetPosition,this.baseVersion)}},{key:"getMovedRangeStart",value:function(){return this.targetPosition._getTransformedByDeletion(this.sourcePosition,this.howMany)}},{key:"getReversed",value:function(){var t=this.sourcePosition._getTransformedByInsertion(this.targetPosition,this.howMany);return new this.constructor(this.getMovedRangeStart(),this.howMany,t,this.baseVersion+1)}},{key:"_validate",value:function(){var t=this.sourcePosition.parent,e=this.targetPosition.parent,n=this.sourcePosition.offset,r=this.targetPosition.offset;if(!t||!e)throw new Nt["b"]("move-operation-position-invalid: Source position or target position is invalid.");if(n+this.howMany>t.maxOffset)throw new Nt["b"]("move-operation-nodes-do-not-exist: The nodes which should be moved do not exist.");if(t===e&&n<r&&r<n+this.howMany)throw new Nt["b"]("move-operation-range-into-itself: Trying to move a range of nodes to the inside of that range.");if(this.sourcePosition.root==this.targetPosition.root&&"prefix"==ae(this.sourcePosition.getParentPath(),this.targetPosition.getParentPath())){var i=this.sourcePosition.path.length-1;if(this.targetPosition.path[i]>=n&&this.targetPosition.path[i]<n+this.howMany)throw new Nt["b"]("move-operation-node-into-itself: Trying to move a range of nodes into one of nodes from that range.")}}},{key:"_execute",value:function(){vp(Cf._createFromPositionAndShift(this.sourcePosition,this.howMany),this.targetPosition)}},{key:"toJSON",value:function(){var t=S(Object(b["a"])(e.prototype),"toJSON",this).call(this);return t.sourcePosition=this.sourcePosition.toJSON(),t.targetPosition=this.targetPosition.toJSON(),t}},{key:"type",get:function(){return"$graveyard"==this.targetPosition.root.rootName?"remove":"$graveyard"==this.sourcePosition.root.rootName?"reinsert":"move"}}],[{key:"fromJSON",value:function(t,e){var n=Sf.fromJSON(t.sourcePosition,e),r=Sf.fromJSON(t.targetPosition,e);return new this(n,t.howMany,r,t.baseVersion)}},{key:"className",get:function(){return"MoveOperation"}}]),e}(lp),Cp=function(t){function e(t,n,r){var i;return Object(c["a"])(this,e),i=Object(m["a"])(this,Object(b["a"])(e).call(this,r)),i.position=t.clone(),i.position.stickiness="toNone",i.nodes=new mf(gp(n)),i.shouldReceiveAttributes=!1,i}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"clone",value:function(){var t=new mf(kt(this.nodes).map(function(t){return t._clone(!0)})),n=new e(this.position,t,this.baseVersion);return n.shouldReceiveAttributes=this.shouldReceiveAttributes,n}},{key:"getReversed",value:function(){var t=this.position.root.document.graveyard,e=new Sf(t,[0]);return new Sp(this.position,this.nodes.maxOffset,e,this.baseVersion+1)}},{key:"_validate",value:function(){var t=this.position.parent;if(!t||t.maxOffset<this.position.offset)throw new Nt["b"]("insert-operation-position-invalid: Insertion position is invalid.")}},{key:"_execute",value:function(){var t=this.nodes;this.nodes=new mf(kt(t).map(function(t){return t._clone(!0)})),dp(this.position,t)}},{key:"toJSON",value:function(){var t=S(Object(b["a"])(e.prototype),"toJSON",this).call(this);return t.position=this.position.toJSON(),t.nodes=this.nodes.toJSON(),t}},{key:"type",get:function(){return"insert"}},{key:"howMany",get:function(){return this.nodes.maxOffset}}],[{key:"fromJSON",value:function(t,n){var r=[],i=!0,o=!1,a=void 0;try{for(var s,u=P()(t.nodes);!(i=(s=u.next()).done);i=!0){var c=s.value;c.name?r.push(bf.fromJSON(c)):r.push(yf.fromJSON(c))}}catch(h){o=!0,a=h}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}var l=new e(Sf.fromJSON(t.position,n),r,t.baseVersion);return l.shouldReceiveAttributes=t.shouldReceiveAttributes,l}},{key:"className",get:function(){return"InsertOperation"}}]),e}(lp),Op=function(t){function e(t,n,r,i,o,a){var s;return Object(c["a"])(this,e),s=Object(m["a"])(this,Object(b["a"])(e).call(this,a)),s.name=t,s.oldRange=n?n.clone():null,s.newRange=r?r.clone():null,s.affectsData=o,s._markers=i,s}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"clone",value:function(){return new e(this.name,this.oldRange,this.newRange,this._markers,this.affectsData,this.baseVersion)}},{key:"getReversed",value:function(){return new e(this.name,this.newRange,this.oldRange,this._markers,this.affectsData,this.baseVersion+1)}},{key:"_execute",value:function(){var t=this.newRange?"_set":"_remove";this._markers[t](this.name,this.newRange,!0,this.affectsData)}},{key:"toJSON",value:function(){var t=S(Object(b["a"])(e.prototype),"toJSON",this).call(this);return this.oldRange&&(t.oldRange=this.oldRange.toJSON()),this.newRange&&(t.newRange=this.newRange.toJSON()),delete t._markers,t}},{key:"type",get:function(){return"marker"}}],[{key:"fromJSON",value:function(t,n){return new e(t.name,t.oldRange?Cf.fromJSON(t.oldRange,n):null,t.newRange?Cf.fromJSON(t.newRange,n):null,n.model.markers,t.affectsData,t.baseVersion)}},{key:"className",get:function(){return"MarkerOperation"}}]),e}(lp),Ap=function(t){function e(t,n,r,i){var o;return Object(c["a"])(this,e),o=Object(m["a"])(this,Object(b["a"])(e).call(this,i)),o.position=t,o.position.stickiness="toNext",o.oldName=n,o.newName=r,o}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"clone",value:function(){return new e(this.position.clone(),this.oldName,this.newName,this.baseVersion)}},{key:"getReversed",value:function(){return new e(this.position.clone(),this.newName,this.oldName,this.baseVersion+1)}},{key:"_validate",value:function(){var t=this.position.nodeAfter;if(!(t instanceof bf))throw new Nt["b"]("rename-operation-wrong-position: Given position is invalid or node after it is not an instance of Element.");if(t.name!==this.oldName)throw new Nt["b"]("rename-operation-wrong-name: Element to change has different name than operation's old name.")}},{key:"_execute",value:function(){var t=this.position.nodeAfter;t.name=this.newName}},{key:"toJSON",value:function(){var t=S(Object(b["a"])(e.prototype),"toJSON",this).call(this);return t.position=this.position.toJSON(),t}},{key:"type",get:function(){return"rename"}}],[{key:"fromJSON",value:function(t,n){return new e(Sf.fromJSON(t.position,n),t.oldName,t.newName,t.baseVersion)}},{key:"className",get:function(){return"RenameOperation"}}]),e}(lp),Ip=function(t){function e(t,n,r,i,o){var a;return Object(c["a"])(this,e),a=Object(m["a"])(this,Object(b["a"])(e).call(this,o)),a.root=t,a.key=n,a.oldValue=r,a.newValue=i,a}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"clone",value:function(){return new e(this.root,this.key,this.oldValue,this.newValue,this.baseVersion)}},{key:"getReversed",value:function(){return new e(this.root,this.key,this.newValue,this.oldValue,this.baseVersion+1)}},{key:"_validate",value:function(){if(this.root!=this.root.root||this.root.is("documentFragment"))throw new Nt["b"]("rootattribute-operation-not-a-root: The element to change is not a root element.",{root:this.root,key:this.key});if(null!==this.oldValue&&this.root.getAttribute(this.key)!==this.oldValue)throw new Nt["b"]("rootattribute-operation-wrong-old-value: Changed node has different attribute value than operation's old attribute value.",{root:this.root,key:this.key});if(null===this.oldValue&&null!==this.newValue&&this.root.hasAttribute(this.key))throw new Nt["b"]("rootattribute-operation-attribute-exists: The attribute with given key already exists.",{root:this.root,key:this.key})}},{key:"_execute",value:function(){null!==this.newValue?this.root._setAttribute(this.key,this.newValue):this.root._removeAttribute(this.key)}},{key:"toJSON",value:function(){var t=S(Object(b["a"])(e.prototype),"toJSON",this).call(this);return t.root=this.root.toJSON(),t}},{key:"type",get:function(){return null===this.oldValue?"addRootAttribute":null===this.newValue?"removeRootAttribute":"changeRootAttribute"}}],[{key:"fromJSON",value:function(t,n){if(!n.getRoot(t.root))throw new Nt["b"]("rootattribute-operation-fromjson-no-root: Cannot create RootAttributeOperation. Root with specified name does not exist.",{rootName:t.root});return new e(n.getRoot(t.root),t.key,t.oldValue,t.newValue,t.baseVersion)}},{key:"className",get:function(){return"RootAttributeOperation"}}]),e}(lp),xp=function(t){function e(t,n,r,i,o){var a;return Object(c["a"])(this,e),a=Object(m["a"])(this,Object(b["a"])(e).call(this,o)),a.sourcePosition=t.clone(),a.sourcePosition.stickiness="toPrevious",a.howMany=n,a.targetPosition=r.clone(),a.targetPosition.stickiness="toNext",a.graveyardPosition=i.clone(),a}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"clone",value:function(){return new this.constructor(this.sourcePosition,this.howMany,this.targetPosition,this.graveyardPosition,this.baseVersion)}},{key:"getReversed",value:function(){var t=this.targetPosition._getTransformedByMergeOperation(this),e=this.sourcePosition.path.slice(0,-1),n=new Sf(this.sourcePosition.root,e)._getTransformedByMergeOperation(this),r=new Pp(t,this.howMany,this.graveyardPosition,this.baseVersion+1);return r.insertionPosition=n,r}},{key:"_validate",value:function(){var t=this.sourcePosition.parent,e=this.targetPosition.parent;if(!(t&&t.is("element")&&t.parent))throw new Nt["b"]("merge-operation-source-position-invalid: Merge source position is invalid.");if(!(e&&e.is("element")&&e.parent))throw new Nt["b"]("merge-operation-target-position-invalid: Merge target position is invalid.");if(this.howMany!=t.maxOffset)throw new Nt["b"]("merge-operation-how-many-invalid: Merge operation specifies wrong number of nodes to move.")}},{key:"_execute",value:function(){var t=this.sourcePosition.parent,e=Cf._createIn(t);vp(e,this.targetPosition),vp(Cf._createOn(t),this.graveyardPosition)}},{key:"toJSON",value:function(){var t=S(Object(b["a"])(e.prototype),"toJSON",this).call(this);return t.sourcePosition=t.sourcePosition.toJSON(),t.targetPosition=t.targetPosition.toJSON(),t.graveyardPosition=t.graveyardPosition.toJSON(),t}},{key:"type",get:function(){return"merge"}},{key:"deletionPosition",get:function(){return new Sf(this.sourcePosition.root,this.sourcePosition.path.slice(0,-1))}},{key:"movedRange",get:function(){var t=this.sourcePosition.getShiftedBy(Number.POSITIVE_INFINITY);return new Cf(this.sourcePosition,t)}}],[{key:"fromJSON",value:function(t,e){var n=Sf.fromJSON(t.sourcePosition,e),r=Sf.fromJSON(t.targetPosition,e),i=Sf.fromJSON(t.graveyardPosition,e);return new this(n,t.howMany,r,i,t.baseVersion)}},{key:"className",get:function(){return"MergeOperation"}}]),e}(lp),Pp=function(t){function e(t,n,r,i){var o;return Object(c["a"])(this,e),o=Object(m["a"])(this,Object(b["a"])(e).call(this,i)),o.splitPosition=t.clone(),o.splitPosition.stickiness="toNext",o.howMany=n,o.insertionPosition=e.getInsertionPosition(t),o.insertionPosition.stickiness="toNone",o.graveyardPosition=r?r.clone():null,o.graveyardPosition&&(o.graveyardPosition.stickiness="toNext"),o}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"clone",value:function(){var t=new this.constructor(this.splitPosition,this.howMany,this.graveyardPosition,this.baseVersion);return t.insertionPosition=this.insertionPosition,t}},{key:"getReversed",value:function(){var t=this.splitPosition.root.document.graveyard,e=new Sf(t,[0]);return new xp(this.moveTargetPosition,this.howMany,this.splitPosition,e,this.baseVersion+1)}},{key:"_validate",value:function(){var t=this.splitPosition.parent,e=this.splitPosition.offset;if(!t||t.maxOffset<e)throw new Nt["b"]("split-operation-position-invalid: Split position is invalid.");if(!t.parent)throw new Nt["b"]("split-operation-split-in-root: Cannot split root element.");if(this.howMany!=t.maxOffset-this.splitPosition.offset)throw new Nt["b"]("split-operation-how-many-invalid: Split operation specifies wrong number of nodes to move.");if(this.graveyardPosition&&!this.graveyardPosition.nodeAfter)throw new Nt["b"]("split-operation-graveyard-position-invalid: Graveyard position invalid.")}},{key:"_execute",value:function(){var t=this.splitPosition.parent;if(this.graveyardPosition)vp(Cf._createFromPositionAndShift(this.graveyardPosition,1),this.insertionPosition);else{var e=t._clone();dp(this.insertionPosition,e)}var n=new Cf(Sf._createAt(t,this.splitPosition.offset),Sf._createAt(t,t.maxOffset));vp(n,this.moveTargetPosition)}},{key:"toJSON",value:function(){var t=S(Object(b["a"])(e.prototype),"toJSON",this).call(this);return t.splitPosition=this.splitPosition.toJSON(),t.insertionPosition=this.insertionPosition.toJSON(),this.graveyardPosition&&(t.graveyardPosition=this.graveyardPosition.toJSON()),t}},{key:"type",get:function(){return"split"}},{key:"moveTargetPosition",get:function(){var t=this.insertionPosition.path.slice();return t.push(0),new Sf(this.insertionPosition.root,t)}},{key:"movedRange",get:function(){var t=this.splitPosition.getShiftedBy(Number.POSITIVE_INFINITY);return new Cf(this.splitPosition,t)}}],[{key:"getInsertionPosition",value:function(t){var e=t.path.slice(0,-1);return e[e.length-1]++,new Sf(t.root,e)}},{key:"fromJSON",value:function(t,e){var n=Sf.fromJSON(t.splitPosition,e),r=Sf.fromJSON(t.insertionPosition,e),i=t.graveyardPosition?Sf.fromJSON(t.graveyardPosition,e):null,o=new this(n,t.howMany,i,t.baseVersion);return o.insertionPosition=r,o}},{key:"className",get:function(){return"SplitOperation"}}]),e}(lp),Np=function(t){function e(t,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"main";return Object(c["a"])(this,e),r=Object(m["a"])(this,Object(b["a"])(e).call(this,n)),r._doc=t,r.rootName=i,r}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"is",value:function(t,n){return n?"rootElement"==t&&n==this.name||S(Object(b["a"])(e.prototype),"is",this).call(this,t,n):"rootElement"==t||S(Object(b["a"])(e.prototype),"is",this).call(this,t)}},{key:"toJSON",value:function(){return this.rootName}},{key:"document",get:function(){return this._doc}}]),e}(bf),Rp=function(){function t(e,n){Object(c["a"])(this,t),this.model=e,this.batch=n}return Object(l["a"])(t,[{key:"createText",value:function(t,e){return new yf(t,e)}},{key:"createElement",value:function(t,e){return new bf(t,e)}},{key:"createDocumentFragment",value:function(){return new hp}},{key:"insert",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._assertWriterUsedCorrectly();var r=Sf._createAt(e,n);if(t.parent){if(Fp(t.root,r.root))return void this.move(Cf._createOn(t),r);if(t.root.document)throw new Error("model-writer-insert-forbidden-move: Cannot move a node from a document to a different tree.");this.remove(t)}var i=r.root.document?r.root.document.version:null,o=new Cp(r,t,i);if(t instanceof yf&&(o.shouldReceiveAttributes=!0),this.batch.addOperation(o),this.model.applyOperation(o),t instanceof hp){var a=!0,s=!1,u=void 0;try{for(var c,l=P()(t.markers);!(a=(c=l.next()).done);a=!0){var h=Ot(c.value,2),f=h[0],d=h[1],p=Sf._createAt(d.root,0),v=new Cf(d.start._getCombined(p,r),d.end._getCombined(p,r));this.addMarker(f,{range:v,usingOperation:!0,affectsData:!0})}}catch(y){s=!0,u=y}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}}}},{key:"insertText",value:function(t,e,n,r){e instanceof hp||e instanceof bf||e instanceof Sf?this.insert(this.createText(t),e,n):this.insert(this.createText(t,e),n,r)}},{key:"insertElement",value:function(t,e,n,r){e instanceof hp||e instanceof bf||e instanceof Sf?this.insert(this.createElement(t),e,n):this.insert(this.createElement(t,e),n,r)}},{key:"append",value:function(t,e){this.insert(t,e,"end")}},{key:"appendText",value:function(t,e,n){e instanceof hp||e instanceof bf?this.insert(this.createText(t),e,"end"):this.insert(this.createText(t,e),n,"end")}},{key:"appendElement",value:function(t,e,n){e instanceof hp||e instanceof bf?this.insert(this.createElement(t),e,"end"):this.insert(this.createElement(t,e),n,"end")}},{key:"setAttribute",value:function(t,e,n){if(this._assertWriterUsedCorrectly(),n instanceof Cf){var r=n.getMinimalFlatRanges(),i=!0,o=!1,a=void 0;try{for(var s,u=P()(r);!(i=(s=u.next()).done);i=!0){var c=s.value;Dp(this,t,e,c)}}catch(l){o=!0,a=l}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}}else jp(this,t,e,n)}},{key:"setAttributes",value:function(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=P()(pf(t));!(n=(o=a.next()).done);n=!0){var s=Ot(o.value,2),u=s[0],c=s[1];this.setAttribute(u,c,e)}}catch(l){r=!0,i=l}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}},{key:"removeAttribute",value:function(t,e){if(this._assertWriterUsedCorrectly(),e instanceof Cf){var n=e.getMinimalFlatRanges(),r=!0,i=!1,o=void 0;try{for(var a,s=P()(n);!(r=(a=s.next()).done);r=!0){var u=a.value;Dp(this,t,null,u)}}catch(c){i=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}else jp(this,t,null,e)}},{key:"clearAttributes",value:function(t){var e=this;this._assertWriterUsedCorrectly();var n=function(t){var n=!0,r=!1,i=void 0;try{for(var o,a=P()(t.getAttributeKeys());!(n=(o=a.next()).done);n=!0){var s=o.value;e.removeAttribute(s,t)}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}};if(t instanceof Cf){var r=!0,i=!1,o=void 0;try{for(var a,s=P()(t.getItems());!(r=(a=s.next()).done);r=!0){var u=a.value;n(u)}}catch(c){i=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}else n(t)}},{key:"move",value:function(t,e,n){if(this._assertWriterUsedCorrectly(),!(t instanceof Cf))throw new Nt["b"]("writer-move-invalid-range: Invalid range to move.");if(!t.isFlat)throw new Nt["b"]("writer-move-range-not-flat: Range to move is not flat.");var r=Sf._createAt(e,n);if(!Fp(t.root,r.root))throw new Nt["b"]("writer-move-different-document: Range is going to be moved between different documents.");var i=t.root.document?t.root.document.version:null,o=new Sp(t.start,t.end.offset-t.start.offset,r,i);this.batch.addOperation(o),this.model.applyOperation(o)}},{key:"remove",value:function(t){if(this._assertWriterUsedCorrectly(),t instanceof Cf){var e=t.getMinimalFlatRanges().reverse(),n=!0,r=!1,i=void 0;try{for(var o,a=P()(e);!(n=(o=a.next()).done);n=!0){var s=o.value;Lp(s.start,s.end.offset-s.start.offset,this.batch,this.model)}}catch(c){r=!0,i=c}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}else{var u=t.is("text")?t.offsetSize:1;Lp(Sf._createBefore(t),u,this.batch,this.model)}}},{key:"merge",value:function(t){this._assertWriterUsedCorrectly();var e=t.nodeBefore,n=t.nodeAfter;if(!(e instanceof bf))throw new Nt["b"]("writer-merge-no-element-before: Node before merge position must be an element.");if(!(n instanceof bf))throw new Nt["b"]("writer-merge-no-element-after: Node after merge position must be an element.");t.root.document?this._merge(t):this._mergeDetached(t)}},{key:"createPositionFromPath",value:function(t,e,n){return this.model.createPositionFromPath(t,e,n)}},{key:"createPositionAt",value:function(t,e){return this.model.createPositionAt(t,e)}},{key:"createPositionAfter",value:function(t){return this.model.createPositionAfter(t)}},{key:"createPositionBefore",value:function(t){return this.model.createPositionBefore(t)}},{key:"createRange",value:function(t,e){return this.model.createRange(t,e)}},{key:"createRangeIn",value:function(t){return this.model.createRangeIn(t)}},{key:"createRangeOn",value:function(t){return this.model.createRangeOn(t)}},{key:"createSelection",value:function(t,e,n){return this.model.createSelection(t,e,n)}},{key:"_mergeDetached",value:function(t){var e=t.nodeBefore,n=t.nodeAfter;this.move(Cf._createIn(n),Sf._createAt(e,"end")),this.remove(n)}},{key:"_merge",value:function(t){var e=Sf._createAt(t.nodeBefore,"end"),n=Sf._createAt(t.nodeAfter,0),r=t.root.document.graveyard,i=new Sf(r,[0]),o=t.root.document.version,a=new xp(n,t.nodeAfter.maxOffset,e,i,o);this.batch.addOperation(a),this.model.applyOperation(a)}},{key:"rename",value:function(t,e){if(this._assertWriterUsedCorrectly(),!(t instanceof bf))throw new Nt["b"]("writer-rename-not-element-instance: Trying to rename an object which is not an instance of Element.");var n=t.root.document?t.root.document.version:null,r=new Ap(Sf._createBefore(t),t.name,e,n);this.batch.addOperation(r),this.model.applyOperation(r)}},{key:"split",value:function(t,e){this._assertWriterUsedCorrectly();var n,r,i=t.parent;if(!i.parent)throw new Nt["b"]("writer-split-element-no-parent: Element with no parent can not be split.");if(e||(e=i.parent),!t.parent.getAncestors({includeSelf:!0}).includes(e))throw new Nt["b"]("writer-split-invalid-limit-element: Limit element is not a position ancestor.");do{var o=i.root.document?i.root.document.version:null,a=i.maxOffset-t.offset,s=new Pp(t,a,null,o);this.batch.addOperation(s),this.model.applyOperation(s),n||r||(n=i,r=t.parent.nextSibling),t=this.createPositionAfter(t.parent),i=t.parent}while(i!==e);return{position:t,range:new Cf(Sf._createAt(n,"end"),Sf._createAt(r,0))}}},{key:"wrap",value:function(t,e){if(this._assertWriterUsedCorrectly(),!t.isFlat)throw new Nt["b"]("writer-wrap-range-not-flat: Range to wrap is not flat.");var n=e instanceof bf?e:new bf(e);if(n.childCount>0)throw new Nt["b"]("writer-wrap-element-not-empty: Element to wrap with is not empty.");if(null!==n.parent)throw new Nt["b"]("writer-wrap-element-attached: Element to wrap with is already attached to tree model.");var r=t.root.document?t.root.document.version:null,i=new Cp(t.start,n,r);this.batch.addOperation(i),this.model.applyOperation(i);var o=new Sp(t.start.getShiftedBy(1),t.end.offset-t.start.offset,Sf._createAt(n,0),null===r?null:r+1);this.batch.addOperation(o),this.model.applyOperation(o)}},{key:"unwrap",value:function(t){if(this._assertWriterUsedCorrectly(),null===t.parent)throw new Nt["b"]("writer-unwrap-element-no-parent: Trying to unwrap an element which has no parent.");this.move(Cf._createIn(t),this.createPositionAfter(t)),this.remove(t)}},{key:"addMarker",value:function(t,e){if(this._assertWriterUsedCorrectly(),!e||"boolean"!=typeof e.usingOperation)throw new Nt["b"]("writer-addMarker-no-usingOperations: The options.usingOperations parameter is required when adding a new marker.");var n=e.usingOperation,r=e.range,i=void 0!==e.affectsData&&e.affectsData;if(this.model.markers.has(t))throw new Nt["b"]("writer-addMarker-marker-exists: Marker with provided name already exists.");if(!r)throw new Nt["b"]("writer-addMarker-no-range: Range parameter is required when adding a new marker.");return n?(Mp(this,t,null,r,i),this.model.markers.get(t)):this.model.markers._set(t,r,n,i)}},{key:"updateMarker",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._assertWriterUsedCorrectly();var n="string"==typeof t?t:t.name,r=this.model.markers.get(n);if(!r)throw new Nt["b"]("writer-updateMarker-marker-not-exists: Marker with provided name does not exists.");var i="boolean"==typeof e.usingOperation,o="boolean"==typeof e.affectsData,a=o?e.affectsData:r.affectsData;if(!i&&!e.range&&!o)throw new Nt["b"]("writer-updateMarker-wrong-options: One of the options is required - provide range, usingOperations or affectsData.");var s=r.getRange(),u=e.range?e.range:s;i&&e.usingOperation!==r.managedUsingOperations?e.usingOperation?Mp(this,n,null,u,a):(Mp(this,n,s,null,a),this.model.markers._set(n,u,void 0,a)):r.managedUsingOperations?Mp(this,n,s,u,a):this.model.markers._set(n,u,void 0,a)}},{key:"removeMarker",value:function(t){this._assertWriterUsedCorrectly();var e="string"==typeof t?t:t.name;if(!this.model.markers.has(e))throw new Nt["b"]("writer-removeMarker-no-marker: Trying to remove marker which does not exist.");var n=this.model.markers.get(e);if(n.managedUsingOperations){var r=n.getRange();Mp(this,e,r,null,n.affectsData)}else this.model.markers._remove(e)}},{key:"setSelection",value:function(t,e,n){this._assertWriterUsedCorrectly(),this.model.document.selection._setTo(t,e,n)}},{key:"setSelectionFocus",value:function(t,e){this._assertWriterUsedCorrectly(),this.model.document.selection._setFocus(t,e)}},{key:"setSelectionAttribute",value:function(t,e){if(this._assertWriterUsedCorrectly(),"string"===typeof t)this._setSelectionAttribute(t,e);else{var n=!0,r=!1,i=void 0;try{for(var o,a=P()(pf(t));!(n=(o=a.next()).done);n=!0){var s=Ot(o.value,2),u=s[0],c=s[1];this._setSelectionAttribute(u,c)}}catch(l){r=!0,i=l}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}}},{key:"removeSelectionAttribute",value:function(t){if(this._assertWriterUsedCorrectly(),"string"===typeof t)this._removeSelectionAttribute(t);else{var e=!0,n=!1,r=void 0;try{for(var i,o=P()(t);!(e=(i=o.next()).done);e=!0){var a=i.value;this._removeSelectionAttribute(a)}}catch(s){n=!0,r=s}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}}},{key:"overrideSelectionGravity",value:function(){return this.model.document.selection._overrideGravity()}},{key:"restoreSelectionGravity",value:function(t){this.model.document.selection._restoreGravity(t)}},{key:"_setSelectionAttribute",value:function(t,e){var n=this.model.document.selection;if(n.isCollapsed&&n.anchor.parent.isEmpty){var r=Bf._getStoreAttributeKey(t);this.setAttribute(r,e,n.anchor.parent)}n._setAttribute(t,e)}},{key:"_removeSelectionAttribute",value:function(t){var e=this.model.document.selection;if(e.isCollapsed&&e.anchor.parent.isEmpty){var n=Bf._getStoreAttributeKey(t);this.removeAttribute(n,e.anchor.parent)}e._removeAttribute(t)}},{key:"_assertWriterUsedCorrectly",value:function(){if(this.model._currentWriter!==this)throw new Nt["b"]("writer-incorrect-use: Trying to use a writer outside the change() block.")}}]),t}();
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function Dp(t,e,n,r){var i,o,a,s=t.model,u=s.document,c=r.start,l=!0,h=!1,f=void 0;try{for(var d,p=P()(r.getWalker({shallow:!0}));!(l=(d=p.next()).done);l=!0){var v=d.value;a=v.item.getAttribute(e),i&&o!=a&&(o!=n&&y(),c=i),i=v.nextPosition,o=a}}catch(g){h=!0,f=g}finally{try{l||null==p.return||p.return()}finally{if(h)throw f}}function y(){var r=new Cf(c,i),a=r.root.document?u.version:null,l=new Ep(r,e,o,n,a);t.batch.addOperation(l),s.applyOperation(l)}i instanceof Sf&&i!=c&&o!=n&&y()}function jp(t,e,n,r){var i,o,a=t.model,s=a.document,u=r.getAttribute(e);if(u!=n){var c=r.root===r;if(c){var l=r.document?s.version:null;o=new Ip(r,e,u,n,l)}else{i=new Cf(Sf._createBefore(r),t.createPositionAfter(r));var h=i.root.document?s.version:null;o=new Ep(i,e,u,n,h)}t.batch.addOperation(o),a.applyOperation(o)}}function Mp(t,e,n,r,i){var o=t.model,a=o.document,s=new Op(e,n,r,o.markers,i,a.version);t.batch.addOperation(s),o.applyOperation(s)}function Lp(t,e,n,r){var i;if(t.root.document){var o=r.document,a=new Sf(o.graveyard,[0]);i=new Sp(t,e,a,o.version)}else i=new Tp(t,e);n.addOperation(i),r.applyOperation(i)}function Fp(t,e){return t===e||t instanceof Np&&e instanceof Np}n("14b9");
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Vp=function(){function t(e){Object(c["a"])(this,t),this._markerCollection=e,this._changesInElement=new It.a,this._elementSnapshots=new It.a,this._changedMarkers=new It.a,this._changeCount=0,this._cachedChanges=null,this._cachedChangesWithGraveyard=null}return Object(l["a"])(t,[{key:"bufferOperation",value:function(t){switch(t.type){case"insert":if(this._isInInsertedElement(t.position.parent))return;this._markInsert(t.position.parent,t.position.offset,t.nodes.maxOffset);break;case"addAttribute":case"removeAttribute":case"changeAttribute":var e=!0,n=!1,r=void 0;try{for(var i,o=P()(t.range.getItems());!(e=(i=o.next()).done);e=!0){var a=i.value;this._isInInsertedElement(a.parent)||this._markAttribute(a)}}catch(_){n=!0,r=_}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}break;case"remove":case"move":case"reinsert":var s=this._isInInsertedElement(t.sourcePosition.parent),u=this._isInInsertedElement(t.targetPosition.parent);s||this._markRemove(t.sourcePosition.parent,t.sourcePosition.offset,t.howMany),u||this._markInsert(t.targetPosition.parent,t.getMovedRangeStart().offset,t.howMany);break;case"rename":if(this._isInInsertedElement(t.position.parent))return;this._markRemove(t.position.parent,t.position.offset,1),this._markInsert(t.position.parent,t.position.offset,1);var c=Cf._createFromPositionAndShift(t.position,1),l=!0,h=!1,f=void 0;try{for(var d,p=P()(this._markerCollection.getMarkersIntersectingRange(c));!(l=(d=p.next()).done);l=!0){var v=d.value,y=v.getRange();this.bufferMarkerChange(v.name,y,y,v.affectsData)}}catch(_){h=!0,f=_}finally{try{l||null==p.return||p.return()}finally{if(h)throw f}}break;case"split":var g=t.splitPosition.parent;this._isInInsertedElement(g)||this._markRemove(g,t.splitPosition.offset,t.howMany),this._isInInsertedElement(t.insertionPosition.parent)||this._markInsert(t.insertionPosition.parent,t.insertionPosition.offset,1),t.graveyardPosition&&this._markRemove(t.graveyardPosition.parent,t.graveyardPosition.offset,1);break;case"merge":var m=t.sourcePosition.parent;this._isInInsertedElement(m.parent)||this._markRemove(m.parent,m.startOffset,1);var b=t.graveyardPosition.parent;this._markInsert(b,t.graveyardPosition.offset,1);var w=t.targetPosition.parent;this._isInInsertedElement(w)||this._markInsert(w,t.targetPosition.offset,m.maxOffset);break}this._cachedChanges=null}},{key:"bufferMarkerChange",value:function(t,e,n,r){var i=this._changedMarkers.get(t);i?(i.newRange=n,i.affectsData=r,null==i.oldRange&&null==i.newRange&&this._changedMarkers.delete(t)):this._changedMarkers.set(t,{oldRange:e,newRange:n,affectsData:r})}},{key:"getMarkersToRemove",value:function(){var t=[],e=!0,n=!1,r=void 0;try{for(var i,o=P()(this._changedMarkers);!(e=(i=o.next()).done);e=!0){var a=Ot(i.value,2),s=a[0],u=a[1];null!=u.oldRange&&t.push({name:s,range:u.oldRange})}}catch(c){n=!0,r=c}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return t}},{key:"getMarkersToAdd",value:function(){var t=[],e=!0,n=!1,r=void 0;try{for(var i,o=P()(this._changedMarkers);!(e=(i=o.next()).done);e=!0){var a=Ot(i.value,2),s=a[0],u=a[1];null!=u.newRange&&t.push({name:s,range:u.newRange})}}catch(c){n=!0,r=c}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return t}},{key:"hasDataChanges",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=P()(this._changedMarkers);!(t=(r=i.next()).done);t=!0){var o=Ot(r.value,2),a=o[1];if(a.affectsData)return!0}}catch(s){e=!0,n=s}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}return this._changesInElement.size>0}},{key:"getChanges",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{includeChangesInGraveyard:!1};if(this._cachedChanges)return t.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice();var e=[],n=!0,r=!1,i=void 0;try{for(var o,a=P()(this._changesInElement.keys());!(n=(o=a.next()).done);n=!0){var s=o.value,u=this._changesInElement.get(s).sort(function(t,e){return t.offset===e.offset?t.type!=e.type?"remove"==t.type?-1:1:0:t.offset<e.offset?-1:1}),c=this._elementSnapshots.get(s),l=Bp(s.getChildren()),h=Up(c.length,u),f=0,d=0,p=!0,v=!1,y=void 0;try{for(var g,m=P()(h);!(p=(g=m.next()).done);p=!0){var b=g.value;if("i"===b)e.push(this._getInsertDiff(s,f,l[f].name)),f++;else if("r"===b)e.push(this._getRemoveDiff(s,f,c[d].name)),d++;else if("a"===b){var w=l[f].attributes,_=c[d].attributes,k=void 0;if("$text"==l[f].name)k=new Cf(Sf._createAt(s,f),Sf._createAt(s,f+1));else{var E=s.offsetToIndex(f);k=new Cf(Sf._createAt(s,f),Sf._createAt(s.getChild(E),0))}e.push.apply(e,kt(this._getAttributesDiff(k,_,w))),f++,d++}else f++,d++}}catch(R){v=!0,y=R}finally{try{p||null==m.return||m.return()}finally{if(v)throw y}}}}catch(R){r=!0,i=R}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}e.sort(function(t,e){return t.position.root!=e.position.root?t.position.root.rootName<e.position.root.rootName?-1:1:t.position.isEqual(e.position)?t.changeCount-e.changeCount:t.position.isBefore(e.position)?-1:1});for(var T=1;T<e.length;T++){var S=e[T-1],C=e[T],O="remove"==S.type&&"remove"==C.type&&"$text"==S.name&&"$text"==C.name&&S.position.isEqual(C.position),A="insert"==S.type&&"insert"==C.type&&"$text"==S.name&&"$text"==C.name&&S.position.parent==C.position.parent&&S.position.offset+S.length==C.position.offset,I="attribute"==S.type&&"attribute"==C.type&&S.position.parent==C.position.parent&&S.range.isFlat&&C.range.isFlat&&S.position.offset+S.length==C.position.offset&&S.attributeKey==C.attributeKey&&S.attributeOldValue==C.attributeOldValue&&S.attributeNewValue==C.attributeNewValue;(O||A||I)&&(e[T-1].length++,I&&(e[T-1].range.end=e[T-1].range.end.getShiftedBy(1)),e.splice(T,1),T--)}for(var x=0;x<e.length;x++){var N=e[x];delete N.changeCount,"attribute"==N.type&&(delete N.position,delete N.length)}return this._changeCount=0,this._cachedChangesWithGraveyard=e.slice(),this._cachedChanges=e.slice().filter(qp),t.includeChangesInGraveyard?this._cachedChangesWithGraveyard:this._cachedChanges}},{key:"reset",value:function(){this._changesInElement.clear(),this._elementSnapshots.clear(),this._changedMarkers.clear(),this._cachedChanges=null}},{key:"_markInsert",value:function(t,e,n){var r={type:"insert",offset:e,howMany:n,count:this._changeCount++};this._markChange(t,r)}},{key:"_markRemove",value:function(t,e,n){var r={type:"remove",offset:e,howMany:n,count:this._changeCount++};this._markChange(t,r),this._removeAllNestedChanges(t,e,n)}},{key:"_markAttribute",value:function(t){var e={type:"attribute",offset:t.startOffset,howMany:t.offsetSize,count:this._changeCount++};this._markChange(t.parent,e)}},{key:"_markChange",value:function(t,e){this._makeSnapshot(t);var n=this._getChangesForElement(t);this._handleChange(e,n),n.push(e);for(var r=0;r<n.length;r++)n[r].howMany<1&&(n.splice(r,1),r--)}},{key:"_getChangesForElement",value:function(t){var e;return this._changesInElement.has(t)?e=this._changesInElement.get(t):(e=[],this._changesInElement.set(t,e)),e}},{key:"_makeSnapshot",value:function(t){this._elementSnapshots.has(t)||this._elementSnapshots.set(t,Bp(t.getChildren()))}},{key:"_handleChange",value:function(t,e){t.nodesToHandle=t.howMany;var n=!0,r=!1,i=void 0;try{for(var o,a=P()(e);!(n=(o=a.next()).done);n=!0){var s=o.value,u=t.offset+t.howMany,c=s.offset+s.howMany;if("insert"==t.type&&("insert"==s.type&&(t.offset<=s.offset?s.offset+=t.howMany:t.offset<c&&(s.howMany+=t.nodesToHandle,t.nodesToHandle=0)),"remove"==s.type&&t.offset<s.offset&&(s.offset+=t.howMany),"attribute"==s.type))if(t.offset<=s.offset)s.offset+=t.howMany;else if(t.offset<c){var l=s.howMany;s.howMany=t.offset-s.offset,e.unshift({type:"attribute",offset:u,howMany:l-s.howMany,count:this._changeCount++})}if("remove"==t.type){if("insert"==s.type)if(u<=s.offset)s.offset-=t.howMany;else if(u<=c)if(t.offset<s.offset){var h=u-s.offset;s.offset=t.offset,s.howMany-=h,t.nodesToHandle-=h}else s.howMany-=t.nodesToHandle,t.nodesToHandle=0;else if(t.offset<=s.offset)t.nodesToHandle-=s.howMany,s.howMany=0;else if(t.offset<c){var f=c-t.offset;s.howMany-=f,t.nodesToHandle-=f}if("remove"==s.type&&(u<=s.offset?s.offset-=t.howMany:t.offset<s.offset&&(t.nodesToHandle+=s.howMany,s.howMany=0)),"attribute"==s.type)if(u<=s.offset)s.offset-=t.howMany;else if(t.offset<s.offset){var d=u-s.offset;s.offset=t.offset,s.howMany-=d}else if(t.offset<c)if(u<=c){var p=s.howMany;s.howMany=t.offset-s.offset;var v=p-s.howMany-t.nodesToHandle;e.unshift({type:"attribute",offset:t.offset,howMany:v,count:this._changeCount++})}else s.howMany-=c-t.offset}if("attribute"==t.type){if("insert"==s.type)if(t.offset<s.offset&&u>s.offset){if(u>c){var y={type:"attribute",offset:c,howMany:u-c,count:this._changeCount++};this._handleChange(y,e),e.push(y)}t.nodesToHandle=s.offset-t.offset,t.howMany=t.nodesToHandle}else t.offset>=s.offset&&t.offset<c&&(u>c?(t.nodesToHandle=u-c,t.offset=c):t.nodesToHandle=0);"attribute"==s.type&&(t.offset>=s.offset&&u<=c?(t.nodesToHandle=0,t.howMany=0,t.offset=0):t.offset<=s.offset&&u>=c&&(s.howMany=0))}}}catch(g){r=!0,i=g}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}t.howMany=t.nodesToHandle,delete t.nodesToHandle}},{key:"_getInsertDiff",value:function(t,e,n){return{type:"insert",position:Sf._createAt(t,e),name:n,length:1,changeCount:this._changeCount++}}},{key:"_getRemoveDiff",value:function(t,e,n){return{type:"remove",position:Sf._createAt(t,e),name:n,length:1,changeCount:this._changeCount++}}},{key:"_getAttributesDiff",value:function(t,e,n){var r=[];n=new It.a(n);var i=!0,o=!1,a=void 0;try{for(var s,u=P()(e);!(i=(s=u.next()).done);i=!0){var c=Ot(s.value,2),l=c[0],h=c[1],f=n.has(l)?n.get(l):null;f!==h&&r.push({type:"attribute",position:t.start,range:t.clone(),length:1,attributeKey:l,attributeOldValue:h,attributeNewValue:f,changeCount:this._changeCount++}),n.delete(l)}}catch(w){o=!0,a=w}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}var d=!0,p=!1,v=void 0;try{for(var y,g=P()(n);!(d=(y=g.next()).done);d=!0){var m=Ot(y.value,2),b=(l=m[0],m[1]);r.push({type:"attribute",position:t.start,range:t.clone(),length:1,attributeKey:l,attributeOldValue:null,attributeNewValue:b,changeCount:this._changeCount++})}}catch(w){p=!0,v=w}finally{try{d||null==g.return||g.return()}finally{if(p)throw v}}return r}},{key:"_isInInsertedElement",value:function(t){var e=t.parent;if(!e)return!1;var n=this._changesInElement.get(e),r=t.startOffset;if(n){var i=!0,o=!1,a=void 0;try{for(var s,u=P()(n);!(i=(s=u.next()).done);i=!0){var c=s.value;if("insert"==c.type&&r>=c.offset&&r<c.offset+c.howMany)return!0}}catch(l){o=!0,a=l}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}}return this._isInInsertedElement(e)}},{key:"_removeAllNestedChanges",value:function(t,e,n){var r=new Cf(Sf._createAt(t,e),Sf._createAt(t,e+n)),i=!0,o=!1,a=void 0;try{for(var s,u=P()(r.getItems({shallow:!0}));!(i=(s=u.next()).done);i=!0){var c=s.value;c.is("element")&&(this._elementSnapshots.delete(c),this._changesInElement.delete(c),this._removeAllNestedChanges(c,0,c.maxOffset))}}catch(l){o=!0,a=l}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}}},{key:"isEmpty",get:function(){return 0==this._changesInElement.size&&0==this._changedMarkers.size}}]),t}();function Bp(t){var e=[],n=!0,r=!1,i=void 0;try{for(var o,a=P()(t);!(n=(o=a.next()).done);n=!0){var s=o.value;if(s.is("text"))for(var u=0;u<s.data.length;u++)e.push({name:"$text",attributes:new It.a(s.getAttributes())});else e.push({name:s.name,attributes:new It.a(s.getAttributes())})}}catch(c){r=!0,i=c}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}function Up(t,e){var n=[],r=0,i=0,o=!0,a=!1,s=void 0;try{for(var u,c=P()(e);!(o=(u=c.next()).done);o=!0){var l=u.value;l.offset>r&&(n.push.apply(n,kt("e".repeat(l.offset-r).split(""))),i+=l.offset-r),"insert"==l.type?(n.push.apply(n,kt("i".repeat(l.howMany).split(""))),r=l.offset+l.howMany):"remove"==l.type?(n.push.apply(n,kt("r".repeat(l.howMany).split(""))),r=l.offset,i+=l.howMany):(n.push.apply(n,kt("a".repeat(l.howMany).split(""))),r=l.offset+l.howMany,i+=l.howMany)}}catch(h){a=!0,s=h}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}return i<t&&n.push.apply(n,kt("e".repeat(t-i).split(""))),n}function qp(t){var e=t.position&&"$graveyard"==t.position.root.rootName,n=t.range&&"$graveyard"==t.range.root.rootName;return!e&&!n}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Wp=function(){function t(){Object(c["a"])(this,t),this._operations=[],this._undoPairs=new It.a,this._undoneOperations=new Pt.a}return Object(l["a"])(t,[{key:"addOperation",value:function(t){this._operations.includes(t)||this._operations.push(t)}},{key:"getOperations",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.POSITIVE_INFINITY;return t<0?[]:this._operations.slice(t,e)}},{key:"getOperation",value:function(t){return this._operations[t]}},{key:"setOperationAsUndone",value:function(t,e){this._undoPairs.set(e,t),this._undoneOperations.add(t)}},{key:"isUndoingOperation",value:function(t){return this._undoPairs.has(t)}},{key:"isUndoneOperation",value:function(t){return this._undoneOperations.has(t)}},{key:"getUndoneOperation",value:function(t){return this._undoPairs.get(t)}}]),t}();
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function Kp(t){return!!t&&1==t.length&&/[\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f]/.test(t)}function Hp(t){return!!t&&1==t.length&&/[\ud800-\udbff]/.test(t)}function zp(t){return!!t&&1==t.length&&/[\udc00-\udfff]/.test(t)}function Gp(t,e){return Hp(t.charAt(e-1))&&zp(t.charAt(e))}function Qp(t,e){return Kp(t.charAt(e))}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Yp="$graveyard",Xp=function(){function t(e){var n=this;Object(c["a"])(this,t),this.model=e,this.version=0,this.history=new Wp(this),this.selection=new Bf(this),this.roots=new Vu({idProperty:"rootName"}),this.differ=new Vp(e.markers),this._postFixers=new Pt.a,this.createRoot("$root",Yp),this.listenTo(e,"applyOperation",function(t,e){var r=e[0];if(r.isDocumentOperation&&r.baseVersion!==n.version)throw new Nt["b"]("model-document-applyOperation-wrong-version: Only operations with matching versions can be applied.",{operation:r})},{priority:"highest"}),this.listenTo(e,"applyOperation",function(t,e){var r=e[0];r.isDocumentOperation&&n.differ.bufferOperation(r)},{priority:"high"}),this.listenTo(e,"applyOperation",function(t,e){var r=e[0];r.isDocumentOperation&&(n.version++,n.history.addOperation(r))},{priority:"low"});var r=!1;this.listenTo(this.selection,"change",function(){r=!0}),this.listenTo(e,"_change",function(t,e){n.differ.isEmpty&&!r||(n._callPostFixers(e),n.differ.hasDataChanges()?n.fire("change:data",e.batch):n.fire("change",e.batch),n.differ.reset(),r=!1)}),this.listenTo(e.markers,"update",function(t,e,r,i){n.differ.bufferMarkerChange(e.name,r,i,e.affectsData),null===r&&e.on("change",function(t,r){n.differ.bufferMarkerChange(e.name,r,e.getRange(),e.affectsData)})})}return Object(l["a"])(t,[{key:"createRoot",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"$root",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"main";if(this.roots.get(e))throw new Nt["b"]("model-document-createRoot-name-exists: Root with specified name already exists.",{name:e});var n=new Np(this,t,e);return this.roots.add(n),n}},{key:"destroy",value:function(){this.selection.destroy(),this.stopListening()}},{key:"getRoot",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main";return this.roots.get(t)}},{key:"getRootNames",value:function(){return gt()(this.roots,function(t){return t.rootName}).filter(function(t){return t!=Yp})}},{key:"registerPostFixer",value:function(t){this._postFixers.add(t)}},{key:"toJSON",value:function(){var t=gs(this);return t.selection="[engine.model.DocumentSelection]",t.model="[engine.model.Model]",t}},{key:"_getDefaultRoot",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=P()(this.roots);!(t=(r=i.next()).done);t=!0){var o=r.value;if(o!==this.graveyard)return o}}catch(a){e=!0,n=a}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}return this.graveyard}},{key:"_getDefaultRange",value:function(){var t=this._getDefaultRoot(),e=this.model,n=e.schema,r=e.createPositionFromPath(t,[0]),i=n.getNearestSelectionRange(r);return i||e.createRange(r)}},{key:"_validateSelectionRange",value:function(t){return Jp(t.start)&&Jp(t.end)}},{key:"_callPostFixers",value:function(t){var e=!1;do{var n=!0,r=!1,i=void 0;try{for(var o,a=P()(this._postFixers);!(n=(o=a.next()).done);n=!0){var s=o.value;if(e=s(t),e)break}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}while(e)}},{key:"graveyard",get:function(){return this.getRoot(Yp)}}]),t}();function Jp(t){var e=t.textNode;if(e){var n=e.data,r=t.offset-e.startOffset;return!Gp(n,r)&&!Qp(n,r)}return!0}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */oe(Xp,qt);var $p=function(){function t(){Object(c["a"])(this,t),this._markers=new It.a}return Object(l["a"])(t,[{key:Es.a,value:function(){return this._markers.values()}},{key:"has",value:function(t){return this._markers.has(t)}},{key:"get",value:function(t){return this._markers.get(t)||null}},{key:"_set",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=t instanceof Zp?t.name:t,o=this._markers.get(i);if(o){var a=o.getRange(),s=!1;return a.isEqual(e)||(o._attachLiveRange(jf.fromRange(e)),s=!0),n!=o.managedUsingOperations&&(o._managedUsingOperations=n,s=!0),"boolean"===typeof r&&r!=o.affectsData&&(o._affectsData=r,s=!0),s&&this.fire("update:"+i,o,a,e),o}var u=jf.fromRange(e),c=new Zp(i,u,n,r);return this._markers.set(i,c),this.fire("update:"+i,c,null,e),c}},{key:"_remove",value:function(t){var e=t instanceof Zp?t.name:t,n=this._markers.get(e);return!!n&&(this._markers.delete(e),this.fire("update:"+e,n,n.getRange(),null),this._destroyMarker(n),!0)}},{key:"getMarkersAtPosition",value:regeneratorRuntime.mark(function t(e){var n,r,i,o,a,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:n=!0,r=!1,i=void 0,t.prev=3,o=P()(this);case 5:if(n=(a=o.next()).done){t.next=13;break}if(s=a.value,!s.getRange().containsPosition(e)){t.next=10;break}return t.next=10,s;case 10:n=!0,t.next=5;break;case 13:t.next=19;break;case 15:t.prev=15,t.t0=t["catch"](3),r=!0,i=t.t0;case 19:t.prev=19,t.prev=20,n||null==o.return||o.return();case 22:if(t.prev=22,!r){t.next=25;break}throw i;case 25:return t.finish(22);case 26:return t.finish(19);case 27:case"end":return t.stop()}},t,this,[[3,15,19,27],[20,,22,26]])})},{key:"getMarkersIntersectingRange",value:regeneratorRuntime.mark(function t(e){var n,r,i,o,a,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:n=!0,r=!1,i=void 0,t.prev=3,o=P()(this);case 5:if(n=(a=o.next()).done){t.next=13;break}if(s=a.value,null===s.getRange().getIntersection(e)){t.next=10;break}return t.next=10,s;case 10:n=!0,t.next=5;break;case 13:t.next=19;break;case 15:t.prev=15,t.t0=t["catch"](3),r=!0,i=t.t0;case 19:t.prev=19,t.prev=20,n||null==o.return||o.return();case 22:if(t.prev=22,!r){t.next=25;break}throw i;case 25:return t.finish(22);case 26:return t.finish(19);case 27:case"end":return t.stop()}},t,this,[[3,15,19,27],[20,,22,26]])})},{key:"destroy",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=P()(this._markers.values());!(t=(r=i.next()).done);t=!0){var o=r.value;this._destroyMarker(o)}}catch(a){e=!0,n=a}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}this._markers=null,this.stopListening()}},{key:"getMarkersGroup",value:regeneratorRuntime.mark(function t(e){var n,r,i,o,a,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:n=!0,r=!1,i=void 0,t.prev=3,o=P()(this._markers.values());case 5:if(n=(a=o.next()).done){t.next=13;break}if(s=a.value,!s.name.startsWith(e+":")){t.next=10;break}return t.next=10,s;case 10:n=!0,t.next=5;break;case 13:t.next=19;break;case 15:t.prev=15,t.t0=t["catch"](3),r=!0,i=t.t0;case 19:t.prev=19,t.prev=20,n||null==o.return||o.return();case 22:if(t.prev=22,!r){t.next=25;break}throw i;case 25:return t.finish(22);case 26:return t.finish(19);case 27:case"end":return t.stop()}},t,this,[[3,15,19,27],[20,,22,26]])})},{key:"_destroyMarker",value:function(t){t.stopListening(),t._detachLiveRange()}}]),t}();oe($p,qt);var Zp=function(){function t(e,n,r,i){Object(c["a"])(this,t),this.name=e,this._liveRange=this._attachLiveRange(n),this._managedUsingOperations=r,this._affectsData=i}return Object(l["a"])(t,[{key:"getStart",value:function(){if(!this._liveRange)throw new Nt["b"]("marker-destroyed: Cannot use a destroyed marker instance.");return this._liveRange.start.clone()}},{key:"getEnd",value:function(){if(!this._liveRange)throw new Nt["b"]("marker-destroyed: Cannot use a destroyed marker instance.");return this._liveRange.end.clone()}},{key:"getRange",value:function(){if(!this._liveRange)throw new Nt["b"]("marker-destroyed: Cannot use a destroyed marker instance.");return this._liveRange.toRange()}},{key:"_attachLiveRange",value:function(t){return this._liveRange&&this._detachLiveRange(),t.delegate("change:range").to(this),t.delegate("change:content").to(this),this._liveRange=t,t}},{key:"_detachLiveRange",value:function(){this._liveRange.stopDelegating("change:range",this),this._liveRange.stopDelegating("change:content",this),this._liveRange.detach(),this._liveRange=null}},{key:"managedUsingOperations",get:function(){if(!this._liveRange)throw new Nt["b"]("marker-destroyed: Cannot use a destroyed marker instance.");return this._managedUsingOperations}},{key:"affectsData",get:function(){if(!this._liveRange)throw new Nt["b"]("marker-destroyed: Cannot use a destroyed marker instance.");return this._affectsData}}]),t}();oe(Zp,qt);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
var tv=function(t){function e(t,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"toNone";if(Object(c["a"])(this,e),r=Object(m["a"])(this,Object(b["a"])(e).call(this,t,n,i)),!r.root.is("rootElement"))throw new Nt["b"]("model-liveposition-root-not-rootelement: LivePosition's root has to be an instance of RootElement.");return ev.call(Object(O["a"])(Object(O["a"])(r))),r}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"detach",value:function(){this.stopListening()}},{key:"toPosition",value:function(){return new Sf(this.root,this.path.slice(),this.stickiness)}}],[{key:"fromPosition",value:function(t,e){return new this(t.root,t.path.slice(),e||t.stickiness)}}]),e}(Sf);function ev(){var t=this;this.listenTo(this.root.document.model,"applyOperation",function(e,n){var r=n[0];r.isDocumentOperation&&nv.call(t,r)},{priority:"low"})}function nv(t){var e=this.getTransformedByOperation(t);if(!this.isEqual(e)){var n=this.toPosition();this.path=e.path,this.root=e.root,this.fire("change",n)}}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
function rv(t,e,n,r){t.change(function(i){var o;o=n?n instanceof Nf||n instanceof Bf?n:i.createSelection(n,r):t.document.selection,o.isCollapsed||t.deleteContent(o);var a,s=new iv(t,i,o.anchor);a=e.is("documentFragment")?e.getChildren():[e],s.handleNodes(a,{isFirst:!0,isLast:!0});var u=s.getSelectionRange();u?o instanceof Bf?i.setSelection(u):o.setTo(u):qh["a"].warn("insertcontent-no-range: Cannot determine a proper selection range after insertion.")})}oe(tv,qt);var iv=function(){function t(e,n,r){Object(c["a"])(this,t),this.model=e,this.writer=n,this.position=r,this.canMergeWith=new Pt.a([this.position.parent]),this.schema=e.schema,this._filterAttributesOf=[]}return Object(l["a"])(t,[{key:"handleNodes",value:function(t,e){t=gt()(t);for(var n=0;n<t.length;n++){var r=t[n];this._handleNode(r,{isFirst:0===n&&e.isFirst,isLast:n===t.length-1&&e.isLast})}this.schema.removeDisallowedAttributes(this._filterAttributesOf,this.writer),this._filterAttributesOf=[]}},{key:"getSelectionRange",value:function(){return this.nodeToSelect?Cf._createOn(this.nodeToSelect):this.model.schema.getNearestSelectionRange(this.position)}},{key:"_handleNode",value:function(t,e){if(this.schema.isObject(t))this._handleObject(t,e);else{var n=this._checkAndSplitToAllowedPosition(t,e);n?(this._insert(t),this._mergeSiblingsOf(t,e)):this._handleDisallowedNode(t,e)}}},{key:"_handleObject",value:function(t,e){this._checkAndSplitToAllowedPosition(t)?this._insert(t):this._tryAutoparagraphing(t,e)}},{key:"_handleDisallowedNode",value:function(t,e){t.is("element")?this.handleNodes(t.getChildren(),e):this._tryAutoparagraphing(t,e)}},{key:"_insert",value:function(t){if(this.schema.checkChild(this.position,t)){var e=tv.fromPosition(this.position,"toNext");this.writer.insert(t,this.position),this.position=e.toPosition(),e.detach(),this.schema.isObject(t)&&!this.schema.checkChild(this.position,"$text")?this.nodeToSelect=t:this.nodeToSelect=null,this._filterAttributesOf.push(t)}else qh["a"].error("insertcontent-wrong-position: The node cannot be inserted on the given position.",{node:t,position:this.position})}},{key:"_mergeSiblingsOf",value:function(t,e){if(t instanceof bf){var n=this._canMergeLeft(t,e),r=this._canMergeRight(t,e),i=tv._createBefore(t);i.stickiness="toNext";var o=tv._createAfter(t);if(o.stickiness="toNext",n){var a=tv.fromPosition(this.position);a.stickiness="toNext",this.writer.merge(i),this.position=a.toPosition(),a.detach()}if(r){this.position.isEqual(o)||qh["a"].error("insertcontent-wrong-position-on-merge: The insertion position should equal the merge position"),this.position=Sf._createAt(o.nodeBefore,"end");var s=new tv(this.position.root,this.position.path,"toPrevious");this.writer.merge(o),this.position=s.toPosition(),s.detach()}(n||r)&&this._filterAttributesOf.push(this.position.parent),i.detach(),o.detach()}}},{key:"_canMergeLeft",value:function(t,e){var n=t.previousSibling;return e.isFirst&&n instanceof bf&&this.canMergeWith.has(n)&&this.model.schema.checkMerge(n,t)}},{key:"_canMergeRight",value:function(t,e){var n=t.nextSibling;return e.isLast&&n instanceof bf&&this.canMergeWith.has(n)&&this.model.schema.checkMerge(t,n)}},{key:"_tryAutoparagraphing",value:function(t,e){var n=this.writer.createElement("paragraph");this._getAllowedIn(n,this.position.parent)&&this.schema.checkChild(n,t)&&(n._appendChild(t),this._handleNode(n,e))}},{key:"_checkAndSplitToAllowedPosition",value:function(t){var e=this._getAllowedIn(t,this.position.parent);if(!e)return!1;while(e!=this.position.parent){if(this.schema.isLimit(this.position.parent))return!1;if(this.position.isAtStart){var n=this.position.parent;this.position=this.writer.createPositionBefore(n),n.isEmpty&&this.writer.remove(n)}else if(this.position.isAtEnd)this.position=this.writer.createPositionAfter(this.position.parent);else{var r=this.writer.createPositionAfter(this.position.parent);this.writer.split(this.position),this.position=r,this.canMergeWith.add(this.position.nodeAfter)}}return!0}},{key:"_getAllowedIn",value:function(t,e){return this.schema.checkChild(e,t)?e:e.parent?this._getAllowedIn(t,e.parent):null}}]),t}();
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function ov(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.isCollapsed){var r=t.schema;t.change(function(t){if(n.doNotResetEntireContent||!hv(r,e)){var i=e.getFirstRange(),o=i.start,a=tv.fromPosition(i.end,"toNext");i.start.isTouching(i.end)||t.remove(i),n.leaveUnmerged||(av(t,o,a),r.removeDisallowedAttributes(o.parent.getChildren(),t)),e instanceof Bf?t.setSelection(o):e.setTo(o),sv(r,o)&&cv(t,o,e),a.detach()}else lv(t,e,r)})}}function av(t,e,n){var r=e.parent,i=n.parent;if(r!=i&&!t.model.schema.isLimit(r)&&!t.model.schema.isLimit(i)&&uv(e,n,t.model.schema)){e=t.createPositionAfter(r),n=t.createPositionBefore(i),n.isEqual(e)||t.insert(i,e),t.merge(e);while(n.parent.isEmpty){var o=n.parent;n=t.createPositionBefore(o),t.remove(o)}av(t,e,n)}}function sv(t,e){var n=t.checkChild(e,"$text"),r=t.checkChild(e,"paragraph");return!n&&r}function uv(t,e,n){var r=new Cf(t,e),i=!0,o=!1,a=void 0;try{for(var s,u=P()(r.getWalker());!(i=(s=u.next()).done);i=!0){var c=s.value;if(n.isLimit(c.item))return!1}}catch(l){o=!0,a=l}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}return!0}function cv(t,e,n){var r=t.createElement("paragraph");t.insert(r,e),n instanceof Bf?t.setSelection(r,0):n.setTo(r,0)}function lv(t,e){var n=t.model.schema.getLimitElement(e);t.remove(t.createRangeIn(n)),cv(t,t.createPositionAt(n,0),e)}function hv(t,e){var n=t.getLimitElement(e);if(!e.containsEntireContent(n))return!1;var r=e.getFirstRange();return r.start.parent!=r.end.parent&&t.checkChild(n,"paragraph")}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var fv=' ,.?!:;"-()';function dv(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=t.schema,o="backward"!=r.direction,a=r.unit?r.unit:"character",s=e.focus,u=new _f({boundaries:gv(s,o),singleCharacters:!0,direction:o?"forward":"backward"}),c={walker:u,schema:i,isForward:o,unit:a},l=function(){if(n.done)return{v:void 0};var r=pv(c,n.value);return r?(e instanceof Bf?t.change(function(t){t.setSelectionFocus(r)}):e.setFocus(r),{v:void 0}):void 0};while(n=u.next()){var h=l();if("object"===Object(Fs["a"])(h))return h.v}}function pv(t,e){if("text"==e.type)return"word"===t.unit?yv(t.walker,t.isForward):vv(t.walker,t.unit,t.isForward);if(e.type==(t.isForward?"elementStart":"elementEnd")){if(t.schema.isObject(e.item))return Sf._createAt(e.item,t.isForward?"after":"before");if(t.schema.checkChild(e.nextPosition,"$text"))return e.nextPosition}else{if(t.schema.isLimit(e.item))return void t.walker.skip(function(){return!0});if(t.schema.checkChild(e.nextPosition,"$text"))return e.nextPosition}}function vv(t,e){var n=t.position.textNode;if(n){var r=n.data,i=t.position.offset-n.startOffset;while(Gp(r,i)||"character"==e&&Qp(r,i))t.next(),i=t.position.offset-n.startOffset}return t.position}function yv(t,e){var n=t.position.textNode;if(n){var r=t.position.offset-n.startOffset;while(!mv(n.data,r,e)&&!bv(n,r,e)){t.next();var i=e?t.position.nodeAfter:t.position.nodeBefore;if(i&&i.is("text")){var o=i.data.charAt(e?0:i.data.length-1);fv.includes(o)||(t.next(),n=t.position.textNode)}r=t.position.offset-n.startOffset}}return t.position}function gv(t,e){var n=t.root,r=Sf._createAt(n,e?"end":0);return e?new Cf(t,r):new Cf(r,t)}function mv(t,e,n){var r=e+(n?0:-1);return fv.includes(t.charAt(r))}function bv(t,e,n){return e===(n?t.endOffset:0)}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function wv(t,e){return t.change(function(t){var n=t.createDocumentFragment(),r=e.getFirstRange();if(!r||r.isCollapsed)return n;var i,o=r.start.root,a=r.start.getCommonPath(r.end),s=o.getNodeByPath(a);i=r.start.parent==r.end.parent?r:t.createRange(t.createPositionAt(s,r.start.path[a.length]),t.createPositionAt(s,r.end.path[a.length]+1));var u=i.end.offset-i.start.offset,c=!0,l=!1,h=void 0;try{for(var f,d=P()(i.getItems({shallow:!0}));!(c=(f=d.next()).done);c=!0){var p=f.value;p.is("textProxy")?t.appendText(p.data,p.getAttributes(),n):t.append(p._clone(!0),n)}}catch(m){l=!0,h=m}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}if(i!=r){var v=r._getTransformedByMove(i.start,t.createPositionAt(n,0),u)[0],y=t.createRange(t.createPositionAt(n,0),v.start),g=t.createRange(v.end,t.createPositionAt(n,"end"));_v(g,t),_v(y,t)}return n})}function _v(t,e){var n=[];gt()(t.getItems({direction:"backward"})).map(function(t){return e.createRangeOn(t)}).filter(function(e){var n=(e.start.isAfter(t.start)||e.start.isEqual(t.start))&&(e.end.isBefore(t.end)||e.end.isEqual(t.end));return n}).forEach(function(t){n.push(t.start.parent),e.remove(t)}),n.forEach(function(t){var n=t;while(n.parent&&n.isEmpty){var r=e.createRangeOn(n);n=n.parent,e.remove(r)}})}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function kv(t){t.document.registerPostFixer(function(e){return Ev(e,t)})}function Ev(t,e){var n=e.document.selection,r=e.schema,i=[],o=!1,a=!0,s=!1,u=void 0;try{for(var c,l=P()(n.getRanges());!(a=(c=l.next()).done);a=!0){var h=c.value,f=Tv(h,r);f?(i.push(f),o=!0):i.push(h)}}catch(y){s=!0,u=y}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}if(o){var d=i;if(i.length>1){var p=i[0].start,v=i[i.length-1].end;d=[new Cf(p,v)]}t.setSelection(d,{backward:n.isBackward})}}function Tv(t,e){return t.isCollapsed?Sv(t,e):Cv(t,e)}function Sv(t,e){var n=t.start,r=e.getNearestSelectionRange(n);if(!r)return null;var i=r.start;return n.isEqual(i)?null:i.nodeAfter&&e.isLimit(i.nodeAfter)?new Cf(i,Sf._createAfter(i.nodeAfter)):new Cf(i)}function Cv(t,e){var n=t.start,r=t.end,i=e.checkChild(n,"$text"),o=e.checkChild(r,"$text"),a=e.getLimitElement(n),s=e.getLimitElement(r);if(a===s){if(i&&o)return null;if(Av(n,r,e)){var u=e.getNearestSelectionRange(n,"forward"),c=e.getNearestSelectionRange(r,"backward");return new Cf(u?u.start:n,c?c.start:r)}}var l=a&&!a.is("rootElement"),h=s&&!s.is("rootElement");if(l||h){var f=Sf._createAt(a,0),d=Sf._createAt(s,0),p=l?Ov(f,e,"start"):n,v=h?Ov(d,e,"end"):r;return new Cf(p,v)}return null}function Ov(t,e,n){var r=t.parent,i=r;while(e.isLimit(i)&&i.parent)r=i,i=i.parent;return"start"===n?Sf._createBefore(r):Sf._createAfter(r)}function Av(t,e,n){var r=t.nodeAfter&&!n.isLimit(t.nodeAfter)||n.checkChild(t,"$text"),i=e.nodeBefore&&!n.isLimit(e.nodeBefore)||n.checkChild(e,"$text");return r&&i}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Iv=function(){function t(){var e=this;Object(c["a"])(this,t),this.markers=new $p,this.document=new Xp(this),this.schema=new _d,this._pendingChanges=[],this._currentWriter=null,["insertContent","deleteContent","modifySelection","getSelectedContent","applyOperation"].forEach(function(t){return e.decorate(t)}),this.on("applyOperation",function(t,e){var n=e[0];n._validate()},{priority:"highest"}),this.schema.register("$root",{isLimit:!0}),this.schema.register("$block",{allowIn:"$root",isBlock:!0}),this.schema.register("$text",{allowIn:"$block"}),this.schema.register("$clipboardHolder",{allowContentOf:"$root",isLimit:!0}),this.schema.extend("$text",{allowIn:"$clipboardHolder"}),this.schema.register("$marker",{allowIn:["$root","$block"]}),kv(this)}return Object(l["a"])(t,[{key:"change",value:function(t){return 0===this._pendingChanges.length?(this._pendingChanges.push({batch:new cp,callback:t}),this._runPendingChanges()[0]):t(this._currentWriter)}},{key:"enqueueChange",value:function(t,e){"string"===typeof t?t=new cp(t):"function"==typeof t&&(e=t,t=new cp),this._pendingChanges.push({batch:t,callback:e}),1==this._pendingChanges.length&&this._runPendingChanges()}},{key:"applyOperation",value:function(t){t._execute()}},{key:"insertContent",value:function(t,e,n){rv(this,t,e,n)}},{key:"deleteContent",value:function(t,e){ov(this,t,e)}},{key:"modifySelection",value:function(t,e){dv(this,t,e)}},{key:"getSelectedContent",value:function(t){return wv(this,t)}},{key:"hasContent",value:function(t){if(t instanceof bf&&(t=Cf._createIn(t)),t.isCollapsed)return!1;var e=!0,n=!1,r=void 0;try{for(var i,o=P()(t.getItems());!(e=(i=o.next()).done);e=!0){var a=i.value;if(a.is("textProxy")||this.schema.isObject(a))return!0}}catch(s){n=!0,r=s}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return!1}},{key:"createPositionFromPath",value:function(t,e,n){return new Sf(t,e,n)}},{key:"createPositionAt",value:function(t,e){return Sf._createAt(t,e)}},{key:"createPositionAfter",value:function(t){return Sf._createAfter(t)}},{key:"createPositionBefore",value:function(t){return Sf._createBefore(t)}},{key:"createRange",value:function(t,e){return new Cf(t,e)}},{key:"createRangeIn",value:function(t){return Cf._createIn(t)}},{key:"createRangeOn",value:function(t){return Cf._createOn(t)}},{key:"createSelection",value:function(t,e,n){return new Nf(t,e,n)}},{key:"createBatch",value:function(){return new cp}},{key:"destroy",value:function(){this.document.destroy(),this.stopListening()}},{key:"_runPendingChanges",value:function(){var t=[];this.fire("_beforeChanges");while(this._pendingChanges.length){var e=this._pendingChanges[0].batch;this._currentWriter=new Rp(this,e);var n=this._pendingChanges[0].callback(this._currentWriter);t.push(n),this.fire("_change",this._currentWriter),this._pendingChanges.shift(),this._currentWriter=null}return this.fire("_afterChanges"),t}}]),t}();oe(Iv,vu);var xv=n("4aa6"),Pv=n.n(xv),Nv=function(){function t(){Object(c["a"])(this,t),this._listener=Pv()(dl)}return Object(l["a"])(t,[{key:"listenTo",value:function(t){var e=this;this._listener.listenTo(t,"keydown",function(t,n){e._listener.fire("_keydown:"+nc(n),n)})}},{key:"set",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=rc(t),i=n.priority;this._listener.listenTo(this._listener,"_keydown:"+r,function(t,n){e(n,function(){n.preventDefault(),n.stopPropagation(),t.stop()}),t.return=!0},{priority:i})}},{key:"press",value:function(t){return!!this._listener.fire("_keydown:"+nc(t),t)}},{key:"destroy",value:function(){this._listener.stopListening()}}]),t}(),Rv=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this)),n.editor=t,n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"set",value:function(t,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("string"==typeof n){var o=n;n=function(t,e){r.editor.execute(o),e()}}S(Object(b["a"])(e.prototype),"set",this).call(this,t,n,i)}}]),e}(Nv),Dv=(n("e800"),function(){function t(e){var n=this;Object(c["a"])(this,t);var r=this.constructor.builtinPlugins;this.config=new lt(e,this.constructor.defaultConfig),this.config.define("plugins",r),this.plugins=new hd(this,r),this.commands=new fd,this.locale=new yd(this.config.get("language")),this.t=this.locale.t,this.set("state","initializing"),this.once("ready",function(){return n.state="ready"},{priority:"high"}),this.once("destroy",function(){return n.state="destroyed"},{priority:"high"}),this.set("isReadOnly",!1),this.model=new Iv,this.data=new ep(this.model),this.editing=new ld(this.model),this.editing.view.document.bind("isReadOnly").to(this),this.conversion=new op,this.conversion.register("downcast",[this.editing.downcastDispatcher,this.data.downcastDispatcher]),this.conversion.register("editingDowncast",[this.editing.downcastDispatcher]),this.conversion.register("dataDowncast",[this.data.downcastDispatcher]),this.conversion.register("upcast",[this.data.upcastDispatcher]),this.keystrokes=new Rv(this),this.keystrokes.listenTo(this.editing.view.document)}return Object(l["a"])(t,[{key:"initPlugins",value:function(){var t=this,e=this,n=this.config;return r().then(function(t){return i(t,"init").then(function(){return i(t,"afterInit")})}).then(function(){return t.fire("pluginsReady")});function r(){var t=n.get("plugins")||[],r=n.get("removePlugins")||[],i=n.get("extraPlugins")||[];return e.plugins.load(t.concat(i),r)}function i(t,e){return t.reduce(function(t,n){return n[e]?t.then(n[e].bind(n)):t},a.a.resolve())}}},{key:"destroy",value:function(){var t=this,e=a.a.resolve();return"initializing"==this.state&&(e=new a.a(function(e){return t.once("ready",e)})),e.then(function(){t.fire("destroy"),t.stopListening(),t.commands.destroy()}).then(function(){return t.plugins.destroy()}).then(function(){t.model.destroy(),t.data.destroy(),t.editing.destroy(),t.keystrokes.destroy()})}},{key:"execute",value:function(){var t;(t=this.commands).execute.apply(t,arguments)}}],[{key:"create",value:function(t){var e=this;return new a.a(function(n){var r=new e(t);n(r.initPlugins().then(function(){r.fire("dataReady"),r.fire("ready")}).then(function(){return r}))})}}]),t}());oe(Dv,vu);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
var jv={setData:function(t){this.data.set(t)},getData:function(){return this.data.get()}},Mv=jv;
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
function Lv(t,e){t instanceof HTMLTextAreaElement&&(t.value=e),t.innerHTML=e}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Fv={updateSourceElement:function(){if(!this.sourceElement)throw new Nt["b"]("editor-missing-sourceelement: Cannot update the source element of a detached editor.");Lv(this.sourceElement,this.data.get())}},Vv=Fv;
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
function Bv(t){if(!Be(t.updateSourceElement))throw new Nt["b"]("attachtoform-missing-elementapi-interface: Editor passed to attachToForm() must implement ElementApi.");var e=t.sourceElement;if(e&&"textarea"===e.tagName.toLowerCase()&&e.form){var n,r=e.form,i=function(){return t.updateSourceElement()};Be(r.submit)&&(n=r.submit,r.submit=function(){i(),n.apply(r)}),r.addEventListener("submit",i),t.on("destroy",function(){r.removeEventListener("submit",i),n&&(r.submit=n)})}}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Uv=function(){function t(){Object(c["a"])(this,t)}return Object(l["a"])(t,[{key:"getHtml",value:function(t){var e=document.implementation.createHTMLDocument(""),n=e.createElement("div");return n.appendChild(t),n.innerHTML}}]),t}(),qv=function(){function t(){Object(c["a"])(this,t),this._domParser=new DOMParser,this._domConverter=new ul({blockFiller:xc}),this._htmlWriter=new Uv}return Object(l["a"])(t,[{key:"toData",value:function(t){var e=this._domConverter.viewToDom(t,document);return this._htmlWriter.getHtml(e)}},{key:"toView",value:function(t){var e=this._toDom(t);return this._domConverter.domToView(e)}},{key:"_toDom",value:function(t){var e=this._domParser.parseFromString(t,"text/html"),n=e.createDocumentFragment(),r=e.body.childNodes;while(r.length>0)n.appendChild(r[0]);return n}}]),t}(),Wv=function(){function t(e){Object(c["a"])(this,t),this.editor=e,this._components=new It.a}return Object(l["a"])(t,[{key:"names",value:regeneratorRuntime.mark(function t(){var e,n,r,i,o,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e=!0,n=!1,r=void 0,t.prev=3,i=P()(this._components.values());case 5:if(e=(o=i.next()).done){t.next=12;break}return a=o.value,t.next=9,a.originalName;case 9:e=!0,t.next=5;break;case 12:t.next=18;break;case 14:t.prev=14,t.t0=t["catch"](3),n=!0,r=t.t0;case 18:t.prev=18,t.prev=19,e||null==i.return||i.return();case 21:if(t.prev=21,!n){t.next=24;break}throw r;case 24:return t.finish(21);case 25:return t.finish(18);case 26:case"end":return t.stop()}},t,this,[[3,14,18,26],[19,,21,25]])})},{key:"add",value:function(t,e){if(this.has(t))throw new Nt["b"]("componentfactory-item-exists: The item already exists in the component factory.",{name:t});this._components.set(Kv(t),{callback:e,originalName:t})}},{key:"create",value:function(t){if(!this.has(t))throw new Nt["b"]("componentfactory-item-missing: The required component is not registered in the factory.",{name:t});return this._components.get(Kv(t)).callback(this.editor.locale)}},{key:"has",value:function(t){return this._components.has(Kv(t))}}]),t}();
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function Kv(t){return String(t).toLowerCase()}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Hv=function(){function t(){Object(c["a"])(this,t),this.set("isFocused",!1),this.focusedElement=null,this._elements=new Pt.a,this._nextEventLoopTimeout=null}return Object(l["a"])(t,[{key:"add",value:function(t){var e=this;if(this._elements.has(t))throw new Nt["b"]("focusTracker-add-element-already-exist");this.listenTo(t,"focus",function(){return e._focus(t)},{useCapture:!0}),this.listenTo(t,"blur",function(){return e._blur()},{useCapture:!0}),this._elements.add(t)}},{key:"remove",value:function(t){t===this.focusedElement&&this._blur(t),this._elements.has(t)&&(this.stopListening(t),this._elements.delete(t))}},{key:"_focus",value:function(t){clearTimeout(this._nextEventLoopTimeout),this.focusedElement=t,this.isFocused=!0}},{key:"_blur",value:function(){var t=this;clearTimeout(this._nextEventLoopTimeout),this._nextEventLoopTimeout=setTimeout(function(){t.focusedElement=null,t.isFocused=!1},0)}}]),t}();oe(Hv,dl),oe(Hv,vu);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
var zv=function(){function t(e,n){var r=this;Object(c["a"])(this,t),this.editor=e,this.view=n,this.componentFactory=new Wv(e),this.focusTracker=new Hv,this.listenTo(e.editing.view.document,"layoutChanged",function(){return r.update()})}return Object(l["a"])(t,[{key:"update",value:function(){this.fire("update")}},{key:"destroy",value:function(){this.stopListening(),this.view.destroy()}}]),t}();
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
function Gv(t){var e=t.origin,n=t.originKeystrokeHandler,r=t.originFocusTracker,i=t.toolbar,o=t.beforeFocus,a=t.afterBlur;r.add(i.element),n.set("Alt+F10",function(t,e){r.isFocused&&!i.focusTracker.isFocused&&(o&&o(),i.focus(),e())}),i.keystrokes.set("Esc",function(t,n){i.focusTracker.isFocused&&(e.focus(),a&&a(),n())})}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function Qv(t){return pt()(t)?{items:t}:t?Oc()({items:[]},t):{items:[]}}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */oe(zv,qt);var Yv=function(t){function e(t,n){var r;return Object(c["a"])(this,e),r=Object(m["a"])(this,Object(b["a"])(e).call(this,t,n)),r._toolbarConfig=Qv(t.config.get("toolbar")),r}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this.editor,e=this.view;e.render(),e.stickyPanel.bind("isActive").to(this.focusTracker,"isFocused"),e.stickyPanel.limiterElement=e.element,this._toolbarConfig.viewportTopOffset&&(e.stickyPanel.viewportTopOffset=this._toolbarConfig.viewportTopOffset);var n=t.editing.view.document.getRoot();e.editable.bind("isReadOnly").to(n),e.editable.bind("isFocused").to(t.editing.view.document),e.editable.name=n.rootName,this.focusTracker.add(this.view.editableElement),this.view.toolbar.fillFromConfig(this._toolbarConfig.items,this.componentFactory),Gv({origin:t.editing.view,originFocusTracker:this.focusTracker,originKeystrokeHandler:t.keystrokes,toolbar:this.view.toolbar})}}]),e}(zv),Xv=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,{idProperty:"viewUid"})),n.on("add",function(t,e,r){e.isRendered||e.render(),e.element&&n._parentElement&&n._parentElement.insertBefore(e.element,n._parentElement.children[r])}),n.on("remove",function(t,e){e.element&&n._parentElement&&e.element.remove()}),n.locale=t,n._parentElement=null,n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"destroy",value:function(){this.map(function(t){return t.destroy()})}},{key:"setParent",value:function(t){this._parentElement=t}},{key:"delegate",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(!n.length||!Jv(n))throw new Nt["b"]("ui-viewcollection-delegate-wrong-events: All event names must be strings.");return{to:function(e){var r=!0,i=!1,o=void 0;try{for(var a,s=P()(t);!(r=(a=s.next()).done);r=!0)for(var u=a.value,c=0;c<n.length;c++){var l=n[c];u.delegate(l).to(e)}}catch(h){i=!0,o=h}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}t.on("add",function(t,r){for(var i=0;i<n.length;i++){var o=n[i];r.delegate(o).to(e)}}),t.on("remove",function(t,r){for(var i=0;i<n.length;i++){var o=n[i];r.stopDelegating(o,e)}})}}}}]),e}(Vu);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function Jv(t){return t.every(function(t){return"string"==typeof t})}oe(Vu,vu);var $v=1,Zv=4;function ty(t,e){return e="function"==typeof e?e:void 0,ps(t,$v|Zv,e)}var ey=ty,ny="http://www.w3.org/1999/xhtml",ry=function(){function t(e){Object(c["a"])(this,t),Oc()(this,py(dy(e))),this._isRendered=!1,this._revertData=null}return Object(l["a"])(t,[{key:"render",value:function(){var t=this._renderNode({intoFragment:!0});return this._isRendered=!0,t}},{key:"apply",value:function(t){return this._revertData=Oy(),this._renderNode({node:t,isApplying:!0,revertData:this._revertData}),t}},{key:"revert",value:function(t){if(!this._revertData)throw new Nt["b"]("ui-template-revert-not-applied: Attempting to revert a template which has not been applied yet.");this._revertTemplateFromNode(t,this._revertData)}},{key:"getViews",value:regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n=function(t){var r,i,o,a,s,u;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!t.children){e.next=32;break}r=!0,i=!1,o=void 0,e.prev=4,a=P()(t.children);case 6:if(r=(s=a.next()).done){e.next=18;break}if(u=s.value,!Ty(u)){e.next=13;break}return e.next=11,u;case 11:e.next=15;break;case 13:if(!Sy(u)){e.next=15;break}return e.delegateYield(n(u),"t0",15);case 15:r=!0,e.next=6;break;case 18:e.next=24;break;case 20:e.prev=20,e.t1=e["catch"](4),i=!0,o=e.t1;case 24:e.prev=24,e.prev=25,r||null==a.return||a.return();case 27:if(e.prev=27,!i){e.next=30;break}throw o;case 30:return e.finish(27);case 31:return e.finish(24);case 32:case"end":return e.stop()}},e,this,[[4,20,24,32],[25,,27,31]])},e=regeneratorRuntime.mark(n),t.delegateYield(n(this),"t0",3);case 3:case"end":return t.stop()}},t,this)})},{key:"_renderNode",value:function(t){var e;if(e=t.node?this.tag&&this.text:this.tag?this.text:!this.text,e)throw new Nt["b"]('ui-template-wrong-syntax: Node definition must have either "tag" or "text" when rendering a new Node.');return this.text?this._renderText(t):this._renderElement(t)}},{key:"_renderElement",value:function(t){var e=t.node;return e||(e=t.node=document.createElementNS(this.ns||ny,this.tag)),this._renderAttributes(t),this._renderElementChildren(t),this._setUpListeners(t),e}},{key:"_renderText",value:function(t){var e=t.node;return e?t.revertData.text=e.textContent:e=t.node=document.createTextNode(""),sy(this.text)?this._bindToObservable({schema:this.text,updater:ly(e),data:t}):e.textContent=this.text.join(""),e}},{key:"_renderAttributes",value:function(t){var e,n,r,i;if(this.attributes){var o=t.node,a=t.revertData;for(e in this.attributes)if(r=o.getAttribute(e),n=this.attributes[e],a&&(a.attributes[e]=r),i=De(n[0])&&n[0].ns?n[0].ns:null,sy(n)){var s=i?n[0].value:n;a&&Ay(e)&&s.unshift(r),this._bindToObservable({schema:s,updater:hy(o,e,i),data:t})}else"style"==e&&"string"!==typeof n[0]?this._renderStyleAttribute(n[0],t):(a&&r&&Ay(e)&&n.unshift(r),n=n.map(function(t){return t&&t.value||t}).reduce(function(t,e){return t.concat(e)},[]).reduce(wy,""),Ey(n)||o.setAttributeNS(i,e,n))}}},{key:"_renderStyleAttribute",value:function(t,e){var n=e.node;for(var r in t){var i=t[r];sy(i)?this._bindToObservable({schema:[i],updater:fy(n,r),data:e}):n.style[r]=i}}},{key:"_renderElementChildren",value:function(t){var e=t.node,n=t.intoFragment?document.createDocumentFragment():e,r=t.isApplying,i=0,o=!0,a=!1,s=void 0;try{for(var u,c=P()(this.children);!(o=(u=c.next()).done);o=!0){var l=u.value;if(Cy(l)){if(!r){l.setParent(e);var h=!0,f=!1,d=void 0;try{for(var p,v=P()(l);!(h=(p=v.next()).done);h=!0){var y=p.value;n.appendChild(y.element)}}catch(b){f=!0,d=b}finally{try{h||null==v.return||v.return()}finally{if(f)throw d}}}}else if(Ty(l))r||(l.isRendered||l.render(),n.appendChild(l.element));else if(Kc(l))n.appendChild(l);else if(r){var g=t.revertData,m=Oy();g.children.push(m),l._renderNode({node:n.childNodes[i++],isApplying:!0,revertData:m})}else n.appendChild(l.render())}}catch(b){a=!0,s=b}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}t.intoFragment&&e.appendChild(n)}},{key:"_setUpListeners",value:function(t){var e=this;if(this.eventListeners){var n=function(n){var r=e.eventListeners[n].map(function(e){var r=n.split("@"),i=Ot(r,2),o=i[0],a=i[1];return e.activateDomEventListener(o,a,t)});t.revertData&&t.revertData.bindings.push(r)};for(var r in this.eventListeners)n(r)}}},{key:"_bindToObservable",value:function(t){var e=t.schema,n=t.updater,r=t.data,i=r.revertData;cy(e,n,r);var o=e.filter(function(t){return!Ey(t)}).filter(function(t){return t.observable}).map(function(t){return t.activateAttributeListener(e,n,r)});i&&i.bindings.push(o)}},{key:"_revertTemplateFromNode",value:function(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=P()(e.bindings);!(n=(o=a.next()).done);n=!0){var s=o.value,u=!0,c=!1,l=void 0;try{for(var h,f=P()(s);!(u=(h=f.next()).done);u=!0){var d=h.value;d()}}catch(g){c=!0,l=g}finally{try{u||null==f.return||f.return()}finally{if(c)throw l}}}}catch(g){r=!0,i=g}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}if(e.text)t.textContent=e.text;else{for(var p in e.attributes){var v=e.attributes[p];null===v?t.removeAttribute(p):t.setAttribute(p,v)}for(var y=0;y<e.children.length;++y)this._revertTemplateFromNode(t.childNodes[y],e.children[y])}}}],[{key:"bind",value:function(t,e){return{to:function(n,r){return new oy({eventNameOrFunction:n,attribute:n,observable:t,emitter:e,callback:r})},if:function(n,r,i){return new ay({observable:t,emitter:e,attribute:n,valueIfTrue:r,callback:i})}}}},{key:"extend",value:function(t,e){t._isRendered&&qh["a"].warn("template-extend-render: Attempting to extend a template which has already been rendered."),ky(t,py(dy(e)))}}]),t}();
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */oe(ry,qt);var iy=function(){function t(e){Object(c["a"])(this,t),Oc()(this,e)}return Object(l["a"])(t,[{key:"getValue",value:function(t){var e=this.observable[this.attribute];return this.callback?this.callback(e,t):e}},{key:"activateAttributeListener",value:function(t,e,n){var r=this,i=function(){return cy(t,e,n)};return this.emitter.listenTo(this.observable,"change:"+this.attribute,i),function(){r.emitter.stopListening(r.observable,"change:"+r.attribute,i)}}}]),t}(),oy=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"activateDomEventListener",value:function(t,e,n){var r=this,i=function(t,n){e&&!n.target.matches(e)||("function"==typeof r.eventNameOrFunction?r.eventNameOrFunction(n):r.observable.fire(r.eventNameOrFunction,n))};return this.emitter.listenTo(n.node,t,i),function(){r.emitter.stopListening(n.node,t,i)}}}]),e}(iy),ay=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"getValue",value:function(t){var n=S(Object(b["a"])(e.prototype),"getValue",this).call(this,t);return!Ey(n)&&(this.valueIfTrue||!0)}}]),e}(iy);function sy(t){return!!t&&(t.value&&(t=t.value),pt()(t)?t.some(sy):t instanceof iy)}function uy(t,e){return t.map(function(t){return t instanceof iy?t.getValue(e):t})}function cy(t,e,n){var r=n.node,i=uy(t,r);i=1==t.length&&t[0]instanceof ay?i[0]:i.reduce(wy,""),Ey(i)?e.remove():e.set(i)}function ly(t){return{set:function(e){t.textContent=e},remove:function(){t.textContent=""}}}function hy(t,e,n){return{set:function(r){t.setAttributeNS(n,e,r)},remove:function(){t.removeAttributeNS(n,e)}}}function fy(t,e){return{set:function(n){t.style[e]=n},remove:function(){t.style[e]=null}}}function dy(t){var e=ey(t,function(t){if(t&&(t instanceof iy||Sy(t)||Ty(t)||Cy(t)))return t});return e}function py(t){if("string"==typeof t?t=gy(t):t.text&&my(t),t.on&&(t.eventListeners=yy(t.on),delete t.on),!t.text){t.attributes&&vy(t.attributes);var e=[];if(t.children)if(Cy(t.children))e.push(t.children);else{var n=!0,r=!1,i=void 0;try{for(var o,a=P()(t.children);!(n=(o=a.next()).done);n=!0){var s=o.value;Sy(s)||Ty(s)||Kc(s)?e.push(s):e.push(new ry(s))}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}t.children=e}return t}function vy(t){for(var e in t)t[e].value&&(t[e].value=[].concat(t[e].value)),by(t,e)}function yy(t){for(var e in t)by(t,e);return t}function gy(t){return{text:[t]}}function my(t){pt()(t.text)||(t.text=[t.text])}function by(t,e){pt()(t[e])||(t[e]=[t[e]])}function wy(t,e){return Ey(e)?t:Ey(t)?e:"".concat(t," ").concat(e)}function _y(t,e){for(var n in e){var r;if(t[n])(r=t[n]).push.apply(r,kt(e[n]));else t[n]=e[n]}}function ky(t,e){var n;(e.attributes&&(t.attributes||(t.attributes={}),_y(t.attributes,e.attributes)),e.eventListeners&&(t.eventListeners||(t.eventListeners={}),_y(t.eventListeners,e.eventListeners)),e.text)&&(n=t.text).push.apply(n,kt(e.text));if(e.children&&e.children.length){if(t.children.length!=e.children.length)throw new Nt["b"]("ui-template-extend-children-mismatch: The number of children in extended definition does not match.");var r=0,i=!0,o=!1,a=void 0;try{for(var s,u=P()(e.children);!(i=(s=u.next()).done);i=!0){var c=s.value;ky(t.children[r++],c)}}catch(l){o=!0,a=l}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}}}function Ey(t){return!t&&0!==t}function Ty(t){return t instanceof Iy}function Sy(t){return t instanceof ry}function Cy(t){return t instanceof Xv}function Oy(){return{children:[],bindings:[],attributes:{}}}function Ay(t){return"class"==t||"style"==t}n("e281");
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Iy=function(){function t(e){Object(c["a"])(this,t),this.element=null,this.isRendered=!1,this.locale=e,this.t=e&&e.t,this._viewCollections=new Vu,this._unboundChildren=this.createCollection(),this._viewCollections.on("add",function(t,n){n.locale=e}),this.decorate("render")}return Object(l["a"])(t,[{key:"createCollection",value:function(){var t=new Xv;return this._viewCollections.add(t),t}},{key:"registerChild",value:function(t){Ts(t)||(t=[t]);var e=!0,n=!1,r=void 0;try{for(var i,o=P()(t);!(e=(i=o.next()).done);e=!0){var a=i.value;this._unboundChildren.add(a)}}catch(s){n=!0,r=s}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"deregisterChild",value:function(t){Ts(t)||(t=[t]);var e=!0,n=!1,r=void 0;try{for(var i,o=P()(t);!(e=(i=o.next()).done);e=!0){var a=i.value;this._unboundChildren.remove(a)}}catch(s){n=!0,r=s}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"setTemplate",value:function(t){this.template=new ry(t)}},{key:"extendTemplate",value:function(t){ry.extend(this.template,t)}},{key:"render",value:function(){if(this.isRendered)throw new Nt["b"]("ui-view-render-already-rendered: This View has already been rendered.");this.template&&(this.element=this.template.render(),this.registerChild(this.template.getViews())),this.isRendered=!0}},{key:"destroy",value:function(){this.stopListening(),this._viewCollections.map(function(t){return t.destroy()})}},{key:"bindTemplate",get:function(){return this._bindTemplate?this._bindTemplate:this._bindTemplate=ry.bind(this,this)}}]),t}();oe(Iy,dl),oe(Iy,vu);n("cf28");
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var xy=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),n.body=n.createCollection(),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"render",value:function(){S(Object(b["a"])(e.prototype),"render",this).call(this),this._renderBodyCollection()}},{key:"destroy",value:function(){return this._bodyCollectionContainer.remove(),S(Object(b["a"])(e.prototype),"destroy",this).call(this)}},{key:"_renderBodyCollection",value:function(){var t=this._bodyCollectionContainer=new ry({tag:"div",attributes:{class:["ck","ck-reset_all","ck-body","ck-rounded-corners"]},children:this.body}).render();document.body.appendChild(t)}}]),e}(Iy),Py=(n("e8dd"),function(t){function e(t){var n;Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),n.set("text"),n.set("for");var r=n.bindTemplate;return n.setTemplate({tag:"label",attributes:{class:["ck","ck-label"],for:r.to("for")},children:[{text:r.to("text")}]}),n}return Object(C["a"])(e,t),e}(Iy)),Ny=function(t){function e(t){var n;Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t));var r=Mt();return n.top=n.createCollection(),n.main=n.createCollection(),n._voiceLabelView=n._createVoiceLabel(r),n.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-editor","ck-rounded-corners"],role:"application",dir:"ltr",lang:t.language,"aria-labelledby":"ck-editor__aria-label_".concat(r)},children:[n._voiceLabelView,{tag:"div",attributes:{class:["ck","ck-editor__top","ck-reset_all"],role:"presentation"},children:n.top},{tag:"div",attributes:{class:["ck","ck-editor__main"],role:"presentation"},children:n.main}]}),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"_createVoiceLabel",value:function(t){var e=this.t,n=new Py;return n.text=e("Rich Text Editor"),n.extendTemplate({attributes:{id:"ck-editor__aria-label_".concat(t),class:"ck-voice-label"}}),n}}]),e}(xy),Ry=function(t){function e(t,n){var r;Object(c["a"])(this,e),r=Object(m["a"])(this,Object(b["a"])(e).call(this,t));var i=r.bindTemplate;return n&&(r.element=r.editableElement=n),r.setTemplate({tag:"div",attributes:{class:["ck","ck-content","ck-editor__editable","ck-rounded-corners",i.to("isFocused",function(t){return t?"ck-focused":"ck-blurred"}),i.if("isReadOnly","ck-read-only")],contenteditable:i.to("isReadOnly",function(t){return!t})}}),r.set("isReadOnly",!1),r.set("isFocused",!1),r.externalElement=n,r}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"render",value:function(){S(Object(b["a"])(e.prototype),"render",this).call(this),this.externalElement?this.template.apply(this.element=this.externalElement):this.editableElement=this.element}},{key:"destroy",value:function(){this.externalElement&&this.template.revert(this.externalElement),S(Object(b["a"])(e.prototype),"destroy",this).call(this)}}]),e}(Iy),Dy=function(t){function e(t,n){var r;Object(c["a"])(this,e),r=Object(m["a"])(this,Object(b["a"])(e).call(this,t,n));var i=r.bindTemplate,o=r.t;r.set("name",null);var a=function(t){return o("Rich Text Editor, %0",[t])};return r.extendTemplate({attributes:{role:"textbox","aria-label":i.to("name",a),class:"ck-editor__editable_inline"}}),r}return Object(C["a"])(e,t),e}(Ry);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
function jy(t){return function(e){return e+t}}n("da97");
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var My=jy("px"),Ly=function(t){function e(t){var n;Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t));var r=n.bindTemplate;return n.set("isActive",!1),n.set("isSticky",!1),n.set("limiterElement",null),n.set("limiterBottomOffset",50),n.set("viewportTopOffset",0),n.set("_marginLeft",null),n.set("_isStickyToTheLimiter",!1),n.set("_hasViewportTopOffset",!1),n.content=n.createCollection(),n._contentPanelPlaceholder=new ry({tag:"div",attributes:{class:["ck","ck-sticky-panel__placeholder"],style:{display:r.to("isSticky",function(t){return t?"block":"none"}),height:r.to("isSticky",function(t){return t?My(n._panelRect.height):null})}}}).render(),n._contentPanel=new ry({tag:"div",attributes:{class:["ck","ck-sticky-panel__content",r.if("isSticky","ck-sticky-panel__content_sticky"),r.if("_isStickyToTheLimiter","ck-sticky-panel__content_sticky_bottom-limit")],style:{width:r.to("isSticky",function(t){return t?My(n._contentPanelPlaceholder.getBoundingClientRect().width):null}),top:r.to("_hasViewportTopOffset",function(t){return t?My(n.viewportTopOffset):null}),bottom:r.to("_isStickyToTheLimiter",function(t){return t?My(n.limiterBottomOffset):null}),marginLeft:r.to("_marginLeft")}},children:n.content}).render(),n.setTemplate({tag:"div",attributes:{class:["ck","ck-sticky-panel"]},children:[n._contentPanelPlaceholder,n._contentPanel]}),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"render",value:function(){var t=this;S(Object(b["a"])(e.prototype),"render",this).call(this),this._checkIfShouldBeSticky(),this.listenTo(nl.window,"scroll",function(){t._checkIfShouldBeSticky()}),this.listenTo(this,"change:isActive",function(){t._checkIfShouldBeSticky()})}},{key:"_checkIfShouldBeSticky",value:function(){var t,e=this._panelRect=this._contentPanel.getBoundingClientRect();this.limiterElement?(t=this._limiterRect=this.limiterElement.getBoundingClientRect(),this.isSticky=this.isActive&&t.top<this.viewportTopOffset&&this._panelRect.height+this.limiterBottomOffset<t.height):this.isSticky=!1,this.isSticky?(this._isStickyToTheLimiter=t.bottom<e.height+this.limiterBottomOffset+this.viewportTopOffset,this._hasViewportTopOffset=!this._isStickyToTheLimiter&&!!this.viewportTopOffset,this._marginLeft=this._isStickyToTheLimiter?null:My(-nl.window.scrollX)):(this._isStickyToTheLimiter=!1,this._hasViewportTopOffset=!1,this._marginLeft=null)}}]),e}(Iy),Fy=function(){function t(e){var n=this;if(Object(c["a"])(this,t),Oc()(this,e),e.actions&&e.keystrokeHandler){var r=function(t){var r=e.actions[t];"string"==typeof r&&(r=[r]);var i=!0,o=!1,a=void 0;try{for(var s,u=P()(r);!(i=(s=u.next()).done);i=!0){var c=s.value;e.keystrokeHandler.set(c,function(e,r){n[t](),r()})}}catch(l){o=!0,a=l}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}};for(var i in e.actions)r(i)}}return Object(l["a"])(t,[{key:"focusFirst",value:function(){this._focus(this.first)}},{key:"focusLast",value:function(){this._focus(this.last)}},{key:"focusNext",value:function(){this._focus(this.next)}},{key:"focusPrevious",value:function(){this._focus(this.previous)}},{key:"_focus",value:function(t){t&&t.focus()}},{key:"_getFocusableItem",value:function(t){var e=this.current,n=this.focusables.length;if(!n)return null;if(null===e)return this[1===t?"first":"last"];var r=(e+n+t)%n;do{var i=this.focusables.get(r);if(Vy(i))return i;r=(r+n+t)%n}while(r!==e);return null}},{key:"first",get:function(){return this.focusables.find(Vy)||null}},{key:"last",get:function(){return this.focusables.filter(Vy).slice(-1)[0]||null}},{key:"next",get:function(){return this._getFocusableItem(1)}},{key:"previous",get:function(){return this._getFocusableItem(-1)}},{key:"current",get:function(){var t=this,e=null;return null===this.focusTracker.focusedElement?null:(this.focusables.find(function(n,r){var i=n.element===t.focusTracker.focusedElement;return i&&(e=r),i}),e)}}]),t}();function Vy(t){return!(!t.focus||"none"==nl.window.getComputedStyle(t.element).display)}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var By=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),n.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__separator"]}}),n}return Object(C["a"])(e,t),e}(Iy);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function Uy(t){return t.bindTemplate.to(function(e){e.target===t.element&&e.preventDefault()})}n("7def");
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var qy=function(t){function e(t){var n;Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t));var r=n.bindTemplate;return n.items=n.createCollection(),n.focusTracker=new Hv,n.keystrokes=new Nv,n.set("isVertical",!1),n.set("className"),n._focusCycler=new Fy({focusables:n.items,focusTracker:n.focusTracker,keystrokeHandler:n.keystrokes,actions:{focusPrevious:["arrowleft","arrowup"],focusNext:["arrowright","arrowdown"]}}),n.setTemplate({tag:"div",attributes:{class:["ck","ck-toolbar",r.if("isVertical","ck-toolbar_vertical"),r.to("className")]},children:n.items,on:{mousedown:Uy(Object(O["a"])(Object(O["a"])(n)))}}),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"render",value:function(){var t=this;S(Object(b["a"])(e.prototype),"render",this).call(this);var n=!0,r=!1,i=void 0;try{for(var o,a=P()(this.items);!(n=(o=a.next()).done);n=!0){var s=o.value;this.focusTracker.add(s.element)}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}this.items.on("add",function(e,n){t.focusTracker.add(n.element)}),this.items.on("remove",function(e,n){t.focusTracker.remove(n.element)}),this.keystrokes.listenTo(this.element)}},{key:"focus",value:function(){this._focusCycler.focusFirst()}},{key:"focusLast",value:function(){this._focusCycler.focusLast()}},{key:"fillFromConfig",value:function(t,e){var n=this;t.map(function(t){"|"==t?n.items.add(new By):e.has(t)?n.items.add(e.create(t)):qh["a"].warn("toolbarview-item-unavailable: The requested toolbar item is unavailable.",{name:t})})}}]),e}(Iy),Wy=(n("6134"),function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),n.stickyPanel=new Ly(t),n.toolbar=new qy(t),n.editable=new Dy(t),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"render",value:function(){S(Object(b["a"])(e.prototype),"render",this).call(this),this.stickyPanel.content.add(this.toolbar),this.top.add(this.stickyPanel),this.main.add(this.editable)}},{key:"editableElement",get:function(){return this.editable.element}}]),e}(Ny)),Ky=function(){function t(){Object(c["a"])(this,t),this._replacedElements=[]}return Object(l["a"])(t,[{key:"replace",value:function(t,e){this._replacedElements.push({element:t,newElement:e}),t.style.display="none",e&&t.parentNode.insertBefore(e,t.nextSibling)}},{key:"restore",value:function(){this._replacedElements.forEach(function(t){var e=t.element,n=t.newElement;e.style.display="",n&&n.remove()}),this._replacedElements=[]}}]),t}();
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
function Hy(t){return t instanceof HTMLTextAreaElement?t.value:t.innerHTML}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var zy=function(t){function e(t,n){var r;return Object(c["a"])(this,e),r=Object(m["a"])(this,Object(b["a"])(e).call(this,n)),sl(t)&&(r.sourceElement=t),r._elementReplacer=new Ky,r.data.processor=new qv,r.model.document.createRoot(),r.ui=new Yv(Object(O["a"])(Object(O["a"])(r)),new Wy(r.locale)),Bv(Object(O["a"])(Object(O["a"])(r))),r}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"destroy",value:function(){return this.sourceElement&&this.updateSourceElement(),this._elementReplacer.restore(),this.ui.destroy(),S(Object(b["a"])(e.prototype),"destroy",this).call(this)}},{key:"element",get:function(){return this.ui.view.element}}],[{key:"create",value:function(t,e){var n=this;return new a.a(function(r){var i=new n(t,e);r(i.initPlugins().then(function(){return i.ui.init()}).then(function(){sl(t)&&i._elementReplacer.replace(t,i.element),i.fire("uiReady")}).then(function(){return i.editing.view.attachDomRoot(i.ui.view.editableElement)}).then(function(){var e=sl(t)?Hy(t):t;return i.data.init(e)}).then(function(){i.fire("dataReady"),i.fire("ready")}).then(function(){return i}))})}}]),e}(Dv);oe(zy,Mv),oe(zy,Vv);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
var Gy=function(){function t(e){Object(c["a"])(this,t),this.editor=e}return Object(l["a"])(t,[{key:"destroy",value:function(){this.stopListening()}}]),t}();oe(Gy,vu);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
var Qy=function(){function t(e){Object(c["a"])(this,t),this.files=Yy(e),this._native=e}return Object(l["a"])(t,[{key:"getData",value:function(t){return this._native.getData(t)}},{key:"setData",value:function(t,e){this._native.setData(t,e)}},{key:"types",get:function(){return this._native.types}}]),t}();function Yy(t){var e=t.files?gt()(t.files):[],n=t.items?gt()(t.items):[];return e.length?e:n.filter(function(t){return"file"===t.kind}).map(function(t){return t.getAsFile()})}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Xy=function(t){function e(t){var n;Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t));var r=n.document;function i(t,e){e.preventDefault();var n=e.dropRange?[e.dropRange]:gt()(r.selection.getRanges());r.fire("clipboardInput",{dataTransfer:e.dataTransfer,targetRanges:n})}return n.domEventType=["paste","copy","cut","drop","dragover"],n.listenTo(r,"paste",i,{priority:"low"}),n.listenTo(r,"drop",i,{priority:"low"}),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"onDomEvent",value:function(t){var e={dataTransfer:new Qy(t.clipboardData?t.clipboardData:t.dataTransfer)};"drop"==t.type&&(e.dropRange=Jy(this.view,t)),this.fire(t.type,t,e)}}]),e}(mh);function Jy(t,e){var n,r=e.target.ownerDocument,i=e.clientX,o=e.clientY;return r.caretRangeFromPoint&&r.caretRangeFromPoint(i,o)?n=r.caretRangeFromPoint(i,o):e.rangeParent&&(n=r.createRange(),n.setStart(e.rangeParent,e.rangeOffset),n.collapse(!0)),n?t.domConverter.domRangeToView(n):t.document.selection.getFirstRange()}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function $y(t){return t=t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n\n/g,"</p><p>").replace(/\n/g,"<br>").replace(/^\s/,"&nbsp;").replace(/\s$/,"&nbsp;").replace(/\s\s/g," &nbsp;"),t.indexOf("</p><p>")>-1&&(t="<p>".concat(t,"</p>")),t}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function Zy(t){return t.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,function(t,e){return 1==e.length?" ":e})}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var tg=["figcaption","li"];function eg(t){var e="";if(t.is("text")||t.is("textProxy"))e=t.data;else if(t.is("img")&&t.hasAttribute("alt"))e=t.getAttribute("alt");else{var n=null,r=!0,i=!1,o=void 0;try{for(var a,s=P()(t.getChildren());!(r=(a=s.next()).done);r=!0){var u=a.value,c=eg(u);n&&(n.is("containerElement")||u.is("containerElement"))&&(tg.includes(n.name)||tg.includes(u.name)?e+="\n":e+="\n\n"),e+=c,n=u}}catch(l){i=!0,o=l}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}return e}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var ng=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this,e=this.editor,n=e.model.document,r=e.editing.view,i=r.document;function o(t,r){var o=r.dataTransfer;r.preventDefault();var a=e.data.toView(e.model.getSelectedContent(n.selection));i.fire("clipboardOutput",{dataTransfer:o,content:a,method:t.name})}this._htmlDataProcessor=new qv,r.addObserver(Xy),this.listenTo(i,"clipboardInput",function(t){e.isReadOnly&&t.stop()},{priority:"highest"}),this.listenTo(i,"clipboardInput",function(e,n){var i=n.dataTransfer,o="";i.getData("text/html")?o=Zy(i.getData("text/html")):i.getData("text/plain")&&(o=$y(i.getData("text/plain"))),o=t._htmlDataProcessor.toView(o),t.fire("inputTransformation",{content:o,dataTransfer:i}),r.scrollToTheSelection()},{priority:"low"}),this.listenTo(this,"inputTransformation",function(e,n){if(!n.content.isEmpty){var r=t.editor.data,i=t.editor.model,o=r.toModel(n.content,"$clipboardHolder");if(0==o.childCount)return;i.insertContent(o)}},{priority:"low"}),this.listenTo(i,"copy",o,{priority:"low"}),this.listenTo(i,"cut",function(t,n){e.isReadOnly?n.preventDefault():o(t,n)},{priority:"low"}),this.listenTo(i,"clipboardOutput",function(r,i){i.content.isEmpty||(i.dataTransfer.setData("text/html",t._htmlDataProcessor.toData(i.content)),i.dataTransfer.setData("text/plain",eg(i.content))),"cut"==i.method&&e.model.deleteContent(n.selection)},{priority:"low"})}}],[{key:"pluginName",get:function(){return"Clipboard"}}]),e}(Gy),rg=function(){function t(e){var n=this;Object(c["a"])(this,t),this.editor=e,this.set("value",void 0),this.set("isEnabled",!1),this.decorate("execute"),this.listenTo(this.editor.model.document,"change",function(){n.refresh()}),this.on("execute",function(t){n.isEnabled||t.stop()},{priority:"high"}),this.listenTo(e,"change:isReadOnly",function(t,e,r){r?(n.on("set:isEnabled",ig,{priority:"highest"}),n.isEnabled=!1):(n.off("set:isEnabled",ig),n.refresh())})}return Object(l["a"])(t,[{key:"refresh",value:function(){this.isEnabled=!0}},{key:"execute",value:function(){}},{key:"destroy",value:function(){this.stopListening()}}]),t}();
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function ig(t){t.return=!1,t.stop()}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */oe(rg,vu);var og=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"execute",value:function(){var t=this,e=this.editor.model,n=e.document;e.change(function(r){ag(t.editor.model,r,n.selection,e.schema),t.fire("afterExecute",{writer:r})})}}]),e}(rg);function ag(t,e,n,r){var i=n.isCollapsed,o=n.getFirstRange(),a=o.start.parent,s=o.end.parent;if(r.isLimit(a)||r.isLimit(s))i||a!=s||t.deleteContent(n);else if(i)sg(e,o.start);else{var u=!(o.start.isAtStart&&o.end.isAtEnd),c=a==s;t.deleteContent(n,{leaveUnmerged:u}),u&&(c?sg(e,n.focus):e.setSelection(s,0))}}function sg(t,e){t.split(e),t.setSelection(e.parent.nextSibling,0)}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var ug=function(t){function e(t){var n;Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t));var r=n.document;return r.on("keydown",function(t,e){var i;n.isEnabled&&e.keyCode==ec.enter&&(r.once("enter",function(t){return i=t},{priority:"highest"}),r.fire("enter",new gh(r,e.domEvent,{isSoft:e.shiftKey})),i&&i.stop.called&&t.stop())}),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"observe",value:function(){}}]),e}(yl),cg=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this.editor,e=t.editing.view,n=e.document;e.addObserver(ug),t.commands.add("enter",new og(t)),this.listenTo(n,"enter",function(n,r){r.preventDefault(),r.isSoft||(t.execute("enter"),e.scrollToTheSelection())},{priority:"low"})}}],[{key:"pluginName",get:function(){return"Enter"}}]),e}(Gy),lg=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"execute",value:function(){var t=this,e=this.editor.model,n=e.document;e.change(function(r){fg(e,r,n.selection),t.fire("afterExecute",{writer:r})})}},{key:"refresh",value:function(){var t=this.editor.model,e=t.document;this.isEnabled=hg(t.schema,e.selection)}}]),e}(rg);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function hg(t,e){if(e.rangeCount>1)return!1;var n=e.anchor;if(!n||!t.checkChild(n,"softBreak"))return!1;var r=e.getFirstRange(),i=r.start.parent,o=r.end.parent;return!pg(i,t)&&!pg(o,t)||i===o}function fg(t,e,n){var r=n.isCollapsed,i=n.getFirstRange(),o=i.start.parent,a=i.end.parent,s=o==a;if(r)dg(e,i.end);else{var u=!(i.start.isAtStart&&i.end.isAtEnd);t.deleteContent(n,{leaveUnmerged:u}),s?dg(e,n.focus):u&&e.setSelection(a,0)}}function dg(t,e){var n=t.createElement("softBreak");t.insert(n,e),t.setSelection(n,"after")}function pg(t,e){return!t.is("rootElement")&&(e.isLimit(t)||pg(t.parent,e))}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var vg=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this.editor,e=t.model.schema,n=t.conversion,r=t.editing.view,i=r.document;e.register("softBreak",{allowWhere:"$text"}),n.for("upcast").add(qd({model:"softBreak",view:"br"})),n.for("downcast").add(Qf({model:"softBreak",view:function(t,e){return e.createEmptyElement("br")}})),r.addObserver(ug),t.commands.add("shiftEnter",new lg(t)),this.listenTo(i,"enter",function(e,n){n.preventDefault(),n.isSoft&&(t.execute("shiftEnter"),r.scrollToTheSelection())},{priority:"low"})}}],[{key:"pluginName",get:function(){return"ShiftEnter"}}]),e}(Gy),yg=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;Object(c["a"])(this,t),this.model=e,this.size=0,this.limit=r,this.isLocked=!1,this._changeCallback=function(t,e){"transparent"!=e.type&&e!==n._batch&&n._reset(!0)},this._selectionChangeCallback=function(){n._reset()},this.model.document.on("change",this._changeCallback),this.model.document.selection.on("change:range",this._selectionChangeCallback),this.model.document.selection.on("change:attribute",this._selectionChangeCallback)}return Object(l["a"])(t,[{key:"input",value:function(t){this.size+=t,this.size>=this.limit&&this._reset(!0)}},{key:"lock",value:function(){this.isLocked=!0}},{key:"unlock",value:function(){this.isLocked=!1}},{key:"destroy",value:function(){this.model.document.off("change",this._changeCallback),this.model.document.selection.off("change:range",this._selectionChangeCallback),this.model.document.selection.off("change:attribute",this._selectionChangeCallback)}},{key:"_reset",value:function(t){this.isLocked&&!t||(this._batch=null,this.size=0)}},{key:"batch",get:function(){return this._batch||(this._batch=this.model.createBatch()),this._batch}}]),t}(),gg=function(t){function e(t,n){var r;return Object(c["a"])(this,e),r=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),r._buffer=new yg(t.model,n),r}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"destroy",value:function(){S(Object(b["a"])(e.prototype),"destroy",this).call(this),this._buffer.destroy()}},{key:"execute",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.editor.model,r=n.document,i=e.text||"",o=i.length,a=e.range||r.selection.getFirstRange(),s=e.resultRange;n.enqueueChange(this._buffer.batch,function(e){var n=a.isCollapsed;t._buffer.lock(),n||e.remove(a),i&&e.insertText(i,r.selection.getAttributes(),a.start),s?e.setSelection(s):n&&e.setSelection(a.start.getShiftedBy(o)),t._buffer.unlock(),t._buffer.input(o)})}},{key:"buffer",get:function(){return this._buffer}}]),e}(rg);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
function mg(t){var e=null,n=t.model,r=t.editing.view,i=t.commands.get("input");function o(t){var o=n.document,a=r.document.isComposing,u=e&&e.isEqual(o.selection);e=null,i.isEnabled&&(_g(t)||o.selection.isCollapsed||a&&229===t.keyCode||!a&&229===t.keyCode&&u||s())}function a(){var t=n.document,e=1!==t.selection.rangeCount||t.selection.getFirstRange().isFlat;t.selection.isCollapsed||e||s()}function s(){var t=i.buffer;t.lock(),n.enqueueChange(t.batch,function(){n.deleteContent(n.document.selection)}),t.unlock()}r.document.on("keydown",function(t,e){return o(e)},{priority:"lowest"}),r.document.on("compositionstart",a,{priority:"lowest"}),r.document.on("compositionend",function(){e=n.createSelection(n.document.selection)},{priority:"lowest"})}for(var bg=[nc("arrowUp"),nc("arrowRight"),nc("arrowDown"),nc("arrowLeft"),9,16,17,18,19,20,27,33,34,35,36,45,91,93,144,145,173,174,175,176,177,178,179,255],wg=112;wg<=135;wg++)bg.push(wg);function _g(t){return!!t.ctrlKey||bg.includes(t.keyCode)}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function kg(t,e){var n,r=[],i=0;return t.forEach(function(t){"equal"==t?(o(),i++):"insert"==t?(a("insert")?n.values.push(e[i]):(o(),n={type:"insert",index:i,values:[e[i]]}),i++):a("delete")?n.howMany++:(o(),n={type:"delete",index:i,howMany:1})}),o(),r;function o(){n&&(r.push(n),n=null)}function a(t){return n&&n.type==t}}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function Eg(t){if(0==t.length)return!1;var e=!0,n=!1,r=void 0;try{for(var i,o=P()(t);!(e=(i=o.next()).done);e=!0){var a=i.value;if("children"===a.type&&!Tg(a))return!0}}catch(s){n=!0,r=s}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return!1}function Tg(t){if(t.newChildren.length-t.oldChildren.length==1){var e=Uc(t.oldChildren,t.newChildren,Sg),n=kg(e,t.newChildren);if(!(n.length>1)){var r=n[0];if(r.values[0]&&r.values[0].is("text"))return r}}}function Sg(t,e){return t&&t.is("text")&&e&&e.is("text")?t.data===e.data:t===e}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function Cg(t){t.editing.view.document.on("mutations",function(e,n,r){new Og(t).handle(n,r)})}var Og=function(){function t(e){Object(c["a"])(this,t),this.editor=e,this.editing=this.editor.editing}return Object(l["a"])(t,[{key:"handle",value:function(t,e){if(Eg(t))this._handleContainerChildrenMutations(t,e);else{var n=!0,r=!1,i=void 0;try{for(var o,a=P()(t);!(n=(o=a.next()).done);n=!0){var s=o.value;this._handleTextMutation(s,e),this._handleTextNodeInsertion(s)}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}}},{key:"_handleContainerChildrenMutations",value:function(t,e){var n=Ag(t);if(n){var r=this.editor.editing.view.domConverter,i=r.mapViewToDom(n),o=new ul,a=this.editor.data.toModel(o.domToView(i)).getChild(0),s=this.editor.editing.mapper.toModelElement(n);if(s){var u=gt()(a.getChildren()),c=gt()(s.getChildren()),l=u[u.length-1],h=c[c.length-1];if(l&&l.is("softBreak")&&h&&!h.is("softBreak")&&u.pop(),Ig(u)&&Ig(c)){var f=u.map(function(t){return t.is("text")?t.data:"@"}).join("").replace(/\u00A0/g," "),d=c.map(function(t){return t.is("text")?t.data:"@"}).join("").replace(/\u00A0/g," ");if(d!==f){var p=Uc(d,f),v=xg(p),y=v.firstChangeAt,g=v.insertions,m=v.deletions,b=null;e&&(b=this.editing.mapper.toModelRange(e.getFirstRange()));var w=f.substr(y,g),_=this.editor.model.createRange(this.editor.model.createPositionAt(s,y),this.editor.model.createPositionAt(s,y+m));this.editor.execute("input",{text:w,range:_,resultRange:b})}}}}}},{key:"_handleTextMutation",value:function(t,e){if("text"==t.type){var n=t.newText.replace(/\u00A0/g," "),r=t.oldText.replace(/\u00A0/g," "),i=Uc(r,n),o=xg(i),a=o.firstChangeAt,s=o.insertions,u=o.deletions,c=null;e&&(c=this.editing.mapper.toModelRange(e.getFirstRange()));var l=this.editing.view.createPositionAt(t.node,a),h=this.editing.mapper.toModelPosition(l),f=this.editor.model.createRange(h,h.getShiftedBy(u)),d=n.substr(a,s);this.editor.execute("input",{text:d,range:f,resultRange:c})}}},{key:"_handleTextNodeInsertion",value:function(t){if("children"==t.type){var e=Tg(t),n=this.editing.view.createPositionAt(t.node,e.index),r=this.editing.mapper.toModelPosition(n),i=e.values[0].data;this.editor.execute("input",{text:i.replace(/\u00A0/g," "),range:this.editor.model.createRange(r)})}}}]),t}();function Ag(t){var e=t.map(function(t){return t.node}).reduce(function(t,e){return t.getCommonAncestor(e,{includeSelf:!0})});if(e)return e.getAncestors({includeSelf:!0,parentFirst:!0}).find(function(t){return t.is("containerElement")||t.is("rootElement")})}function Ig(t){return t.every(function(t){return t.is("text")||t.is("softBreak")})}function xg(t){for(var e=null,n=null,r=0;r<t.length;r++){var i=t[r];"equal"!=i&&(e=null===e?r:e,n=r)}for(var o=0,a=0,s=e;s<=n;s++)"insert"!=t[s]&&o++,"delete"!=t[s]&&a++;return{insertions:a,deletions:o,firstChangeAt:e}}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Pg=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this.editor,e=new gg(t,t.config.get("typing.undoStep")||20);t.commands.add("input",e),mg(t),Cg(t)}}],[{key:"pluginName",get:function(){return"Input"}}]),e}(Gy),Ng=function(t){function e(t,n){var r;return Object(c["a"])(this,e),r=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),r.direction=n,r._buffer=new yg(t.model,t.config.get("typing.undoStep")),r}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"execute",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.editor.model,r=n.document;n.enqueueChange(this._buffer.batch,function(i){t._buffer.lock();var o=i.createSelection(r.selection),a=o.isCollapsed;if(o.isCollapsed&&n.modifySelection(o,{direction:t.direction,unit:e.unit}),t._shouldEntireContentBeReplacedWithParagraph(e.sequence||1))t._replaceEntireContentWithParagraph(i);else if(!o.isCollapsed){var s=0;o.getFirstRange().getMinimalFlatRanges().forEach(function(t){s+=Du(t.getWalker({singleCharacters:!0,ignoreElementEnd:!0,shallow:!0}))}),n.deleteContent(o,{doNotResetEntireContent:a}),t._buffer.input(s),i.setSelection(o),t._buffer.unlock()}})}},{key:"_shouldEntireContentBeReplacedWithParagraph",value:function(t){if(t>1)return!1;var e=this.editor.model,n=e.document,r=n.selection,i=e.schema.getLimitElement(r),o=r.isCollapsed&&r.containsEntireContent(i);if(!o)return!1;if(!e.schema.checkChild(i,"paragraph"))return!1;var a=i.getChild(0);return!a||"paragraph"!==a.name}},{key:"_replaceEntireContentWithParagraph",value:function(t){var e=this.editor.model,n=e.document,r=n.selection,i=e.schema.getLimitElement(r),o=t.createElement("paragraph");t.remove(t.createRangeIn(i)),t.insert(o,i),t.setSelection(o,0)}}]),e}(rg),Rg=function(t){function e(t){var n;Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t));var r=t.document,i=0;return r.on("keyup",function(t,e){e.keyCode!=ec.delete&&e.keyCode!=ec.backspace||(i=0)}),r.on("keydown",function(t,e){var n={};if(e.keyCode==ec.delete)n.direction="forward",n.unit="character";else{if(e.keyCode!=ec.backspace)return;n.direction="backward",n.unit="codePoint"}var o,a=Yu.isMac?e.altKey:e.ctrlKey;n.unit=a?"word":n.unit,n.sequence=++i,r.once("delete",function(t){return o=t},{priority:"highest"}),r.fire("delete",new gh(r,e.domEvent,n)),o&&o.stop.called&&t.stop()}),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"observe",value:function(){}}]),e}(yl),Dg=n("0a0d"),jg=n.n(Dg);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
function Mg(t){var e=t.model,n=t.editing.view,r=200,i=null,o=e.createSelection(e.document.selection),a=jg()();function s(t){var n=e.createSelection(t.source);o.isEqual(n)||(i=o,o=n,a=jg()())}function u(t,e){Eg(e)&&Lg(e)&&(c(),t.stop())}function c(){l()&&e.enqueueChange(function(t){t.setSelection(i)}),t.execute("delete")}function l(){return jg()()-a<r&&i&&!i.isCollapsed&&o.isCollapsed&&o.getLastPosition().isEqual(i.getLastPosition())}e.document.selection.on("change",s),n.document.on("mutations",u,{priority:"highest"})}function Lg(t){var e=!0,n=!1,r=void 0;try{for(var i,o=P()(t);!(e=(i=o.next()).done);e=!0){var a=i.value;if("children"===a.type){var s=a.oldChildren,u=a.newChildren;if(Fg(s)){var c=Uc(s,u),l=c.some(function(t){return"delete"===t}),h=c.some(function(t){return"insert"===t});if(l&&!h)return!0}}}}catch(f){n=!0,r=f}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return!1}function Fg(t){return t.every(function(t){return t.is("containerElement")})}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Vg=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this.editor,e=t.editing.view,n=e.document;e.addObserver(Rg),t.commands.add("forwardDelete",new Ng(t,"forward")),t.commands.add("delete",new Ng(t,"backward")),this.listenTo(n,"delete",function(n,r){t.execute("forward"==r.direction?"forwardDelete":"delete",{unit:r.unit,sequence:r.sequence}),r.preventDefault(),e.scrollToTheSelection()}),Mg(t)}}],[{key:"pluginName",get:function(){return"Delete"}}]),e}(Gy),Bg=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,null,[{key:"requires",get:function(){return[Pg,Vg]}},{key:"pluginName",get:function(){return"Typing"}}]),e}(Gy),Ug=(n("20d6"),function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"clone",value:function(){return new e(this.baseVersion)}},{key:"getReversed",value:function(){return new e(this.baseVersion+1)}},{key:"_execute",value:function(){}},{key:"type",get:function(){return"noop"}}],[{key:"className",get:function(){return"NoOperation"}}]),e}(lp)),qg=new It.a;
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function Wg(t,e,n){var r=qg.get(t);r||(r=new It.a,qg.set(t,r)),r.set(e,n)}function Kg(t,e){var n=qg.get(t);return n&&n.has(e)?n.get(e):Hg}function Hg(t){return[t]}function zg(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Kg(t.constructor,e.constructor);try{return t=t.clone(),r(t,e,n)}catch(i){throw qh["a"].error("Error during operation transformation!",i.message),qh["a"].error("Transformed operation",t),qh["a"].error("Operation transformed by",e),qh["a"].error("context.aIsStrong",n.aIsStrong),qh["a"].error("context.aWasUndone",n.aWasUndone),qh["a"].error("context.bWasUndone",n.bWasUndone),qh["a"].error("context.abRelation",n.abRelation),qh["a"].error("context.baRelation",n.baRelation),i}}function Gg(t,e,n){if(t=t.slice(),e=e.slice(),0==t.length||0==e.length)return{operationsA:t,operationsB:e};var r=new Fu.a,i=!0,o=!1,a=void 0;try{for(var s,u=P()(t);!(i=(s=u.next()).done);i=!0){var c=s.value;r.set(c,0)}}catch(A){o=!0,a=A}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}var l={nextBaseVersionA:t[t.length-1].baseVersion+1,nextBaseVersionB:e[e.length-1].baseVersion+1,originalOperationsACount:t.length,originalOperationsBCount:e.length},h=new Qg(n.document,n.useRelations);h.setOriginalOperations(t),h.setOriginalOperations(e);var f=0;while(f<t.length){var d,p,v=t[f],y=r.get(v);if(y!=e.length){var g=e[y],m=zg(v,g,h.getContext(v,g,!0)),b=zg(g,v,h.getContext(g,v,!1));h.updateRelation(v,g),h.setOriginalOperations(m,v),h.setOriginalOperations(b,g);var w=!0,_=!1,k=void 0;try{for(var E,T=P()(m);!(w=(E=T.next()).done);w=!0){var S=E.value;r.set(S,y+b.length)}}catch(A){_=!0,k=A}finally{try{w||null==T.return||T.return()}finally{if(_)throw k}}(d=t).splice.apply(d,[f,1].concat(kt(m))),(p=e).splice.apply(p,[y,1].concat(kt(b)))}else f++}if(n.padWithNoOps){var C=t.length-l.originalOperationsACount,O=e.length-l.originalOperationsBCount;Xg(t,O-C),Xg(e,C-O)}return Yg(t,l.nextBaseVersionB),Yg(e,l.nextBaseVersionA),{operationsA:t,operationsB:e}}var Qg=function(){function t(e,n){Object(c["a"])(this,t),this._history=e.history,this._useRelations=n,this._originalOperations=new It.a,this._relations=new It.a}return Object(l["a"])(t,[{key:"setOriginalOperations",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=e?this._originalOperations.get(e):null,r=!0,i=!1,o=void 0;try{for(var a,s=P()(t);!(r=(a=s.next()).done);r=!0){var u=a.value;this._originalOperations.set(u,n||u)}}catch(c){i=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}},{key:"updateRelation",value:function(t,e){switch(t.constructor){case Sp:switch(e.constructor){case xp:t.targetPosition.isEqual(e.sourcePosition)||e.movedRange.containsPosition(t.targetPosition)?this._setRelation(t,e,"insertAtSource"):t.targetPosition.isEqual(e.deletionPosition)?this._setRelation(t,e,"insertBetween"):t.targetPosition.isAfter(e.sourcePosition)&&this._setRelation(t,e,"moveTargetAfter");break;case Sp:t.targetPosition.isEqual(e.sourcePosition)||t.targetPosition.isBefore(e.sourcePosition)?this._setRelation(t,e,"insertBefore"):this._setRelation(t,e,"insertAfter");break}break;case Pp:switch(e.constructor){case xp:t.splitPosition.isBefore(e.sourcePosition)&&this._setRelation(t,e,"splitBefore");break;case Sp:(t.splitPosition.isEqual(e.sourcePosition)||t.splitPosition.isBefore(e.sourcePosition))&&this._setRelation(t,e,"splitBefore");break}break;case xp:switch(e.constructor){case xp:t.targetPosition.isEqual(e.sourcePosition)||this._setRelation(t,e,"mergeTargetNotMoved"),t.sourcePosition.isEqual(e.sourcePosition)&&this._setRelation(t,e,"mergeSameElement");break;case Pp:t.sourcePosition.isEqual(e.splitPosition)&&this._setRelation(t,e,"splitAtSource")}break}}},{key:"getContext",value:function(t,e,n){return{aIsStrong:n,aWasUndone:this._wasUndone(t),bWasUndone:this._wasUndone(e),abRelation:this._useRelations?this._getRelation(t,e):null,baRelation:this._useRelations?this._getRelation(e,t):null}}},{key:"_wasUndone",value:function(t){var e=this._originalOperations.get(t);return e.wasUndone||this._history.isUndoneOperation(e)}},{key:"_getRelation",value:function(t,e){var n=this._originalOperations.get(e),r=this._history.getUndoneOperation(n);if(!r)return null;var i=this._originalOperations.get(t),o=this._relations.get(i);return o&&o.get(r)||null}},{key:"_setRelation",value:function(t,e,n){var r=this._originalOperations.get(t),i=this._originalOperations.get(e),o=this._relations.get(r);o||(o=new It.a,this._relations.set(r,o)),o.set(i,n)}}]),t}();function Yg(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=P()(t);!(n=(o=a.next()).done);n=!0){var s=o.value;s.baseVersion=e++}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}function Xg(t,e){for(var n=0;n<e;n++)t.push(new Ug(0))}function Jg(t,e,n){var r=t.nodes,i=r.getNode(0).getAttribute(e);if(i==n)return null;var o=new Cf(t.position,t.position.getShiftedBy(t.howMany));return new Ep(o,e,i,n,0)}function $g(t,e){var n=Cf._createFromPositionAndShift(e.sourcePosition,e.howMany),r=null,i=[];n.containsRange(t,!0)?r=t:t.start.hasSameParentAs(n.start)?(i=t.getDifference(n),r=t.getIntersection(n)):i=[t];var o=[],a=!0,s=!1,u=void 0;try{for(var c,l=P()(i);!(a=(c=l.next()).done);a=!0){var h=c.value;h=h._getTransformedByDeletion(e.sourcePosition,e.howMany);var f=e.getMovedRangeStart(),d=h.start.hasSameParentAs(f);h=h._getTransformedByInsertion(f,e.howMany,d),o.push.apply(o,kt(h))}}catch(p){s=!0,u=p}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}return r&&o.push(r._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany,!1)[0]),o}function Zg(t,e){return null===t.targetPosition._getTransformedByDeletion(e.sourcePosition,e.howMany)}function tm(t,e){for(var n=[],r=0;r<t.length;r++){var i=t[r],o=new Sp(i.start,i.end.offset-i.start.offset,e.isEqual(i.end)?i.start:e,0);n.push(o);for(var a=r+1;a<t.length;a++)t[a]=t[a]._getTransformedByMove(o.sourcePosition,o.targetPosition,o.howMany)[0];e=e._getTransformedByMove(o.sourcePosition,o.targetPosition,o.howMany)}return n}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */Wg(Ep,Ep,function(t,e,n){if(t.key===e.key){var r=t.range.getDifference(e.range).map(function(e){return new Ep(e,t.key,t.oldValue,t.newValue,0)}),i=t.range.getIntersection(e.range);return i&&n.aIsStrong&&r.push(new Ep(i,e.key,e.newValue,t.newValue,0)),0==r.length?[new Ug(0)]:r}return[t]}),Wg(Ep,Cp,function(t,e){if(t.range.start.hasSameParentAs(e.position)&&t.range.containsPosition(e.position)){var n=t.range._getTransformedByInsertion(e.position,e.howMany,!e.shouldReceiveAttributes),r=n.map(function(e){return new Ep(e,t.key,t.oldValue,t.newValue,t.baseVersion)});if(e.shouldReceiveAttributes){var i=Jg(e,t.key,t.oldValue);i&&r.unshift(i)}return r}return t.range=t.range._getTransformedByInsertion(e.position,e.howMany,!1)[0],[t]}),Wg(Ep,xp,function(t,e){var n=[];t.range.start.hasSameParentAs(e.deletionPosition)&&(t.range.containsPosition(e.deletionPosition)||t.range.start.isEqual(e.deletionPosition))&&n.push(Cf._createFromPositionAndShift(e.graveyardPosition,1));var r=t.range._getTransformedByMergeOperation(e);return r.isCollapsed||n.push(r),n.map(function(e){return new Ep(e,t.key,t.oldValue,t.newValue,t.baseVersion)})}),Wg(Ep,Sp,function(t,e){var n=$g(t.range,e);return n.map(function(e){return new Ep(e,t.key,t.oldValue,t.newValue,t.baseVersion)})}),Wg(Ep,Pp,function(t,e){if(t.range.end.isEqual(e.insertionPosition))return e.graveyardPosition||t.range.end.offset++,[t];if(t.range.start.hasSameParentAs(e.splitPosition)&&t.range.containsPosition(e.splitPosition)){var n=t.clone();return n.range=new Cf(e.moveTargetPosition.clone(),t.range.end._getCombined(e.splitPosition,e.moveTargetPosition)),t.range.end=e.splitPosition.clone(),t.range.end.stickiness="toPrevious",[t,n]}return t.range=t.range._getTransformedBySplitOperation(e),[t]}),Wg(Cp,Ep,function(t,e){var n=[t];if(t.shouldReceiveAttributes&&t.position.hasSameParentAs(e.range.start)&&e.range.containsPosition(t.position)){var r=Jg(t,e.key,e.newValue);r&&n.push(r)}return n}),Wg(Cp,Cp,function(t,e,n){return t.position.isEqual(e.position)&&n.aIsStrong?[t]:(t.position=t.position._getTransformedByInsertOperation(e),[t])}),Wg(Cp,Sp,function(t,e){return t.position=t.position._getTransformedByMoveOperation(e),[t]}),Wg(Cp,Pp,function(t,e){return t.position=t.position._getTransformedBySplitOperation(e),[t]}),Wg(Cp,xp,function(t,e){return t.position=t.position._getTransformedByMergeOperation(e),[t]}),Wg(Op,Cp,function(t,e){return t.oldRange&&(t.oldRange=t.oldRange._getTransformedByInsertOperation(e)[0]),t.newRange&&(t.newRange=t.newRange._getTransformedByInsertOperation(e)[0]),[t]}),Wg(Op,Op,function(t,e,n){if(t.name==e.name){if(!n.aIsStrong)return[new Ug(0)];t.oldRange=e.newRange?e.newRange.clone():null}return[t]}),Wg(Op,xp,function(t,e){return t.oldRange&&(t.oldRange=t.oldRange._getTransformedByMergeOperation(e)),t.newRange&&(t.newRange=t.newRange._getTransformedByMergeOperation(e)),[t]}),Wg(Op,Sp,function(t,e){return t.oldRange&&(t.oldRange=Cf._createFromRanges(t.oldRange._getTransformedByMoveOperation(e))),t.newRange&&(t.newRange=Cf._createFromRanges(t.newRange._getTransformedByMoveOperation(e))),[t]}),Wg(Op,Pp,function(t,e){return t.oldRange&&(t.oldRange=t.oldRange._getTransformedBySplitOperation(e)),t.newRange&&(t.newRange=t.newRange._getTransformedBySplitOperation(e)),[t]}),Wg(xp,Cp,function(t,e){return t.sourcePosition.hasSameParentAs(e.position)&&(t.howMany+=e.howMany),t.sourcePosition=t.sourcePosition._getTransformedByInsertOperation(e),t.targetPosition=t.targetPosition._getTransformedByInsertOperation(e),[t]}),Wg(xp,xp,function(t,e,n){if(t.sourcePosition.isEqual(e.sourcePosition)&&t.targetPosition.isEqual(e.targetPosition)){if(n.bWasUndone){var r=e.graveyardPosition.path.slice();return r.push(0),t.sourcePosition=new Sf(e.graveyardPosition.root,r),t.howMany=0,[t]}return[new Ug(0)]}if(t.sourcePosition.isEqual(e.sourcePosition)&&!t.targetPosition.isEqual(e.targetPosition)&&!n.bWasUndone&&"splitAtSource"!=n.abRelation){var i="$graveyard"==t.targetPosition.root.rootName,o="$graveyard"==e.targetPosition.root.rootName,a=i&&!o,s=o&&!i,u=s||!a&&n.aIsStrong;if(u){var c=e.targetPosition._getTransformedByMergeOperation(e),l=t.targetPosition._getTransformedByMergeOperation(e);return[new Sp(c,t.howMany,l,0)]}return[new Ug(0)]}return t.sourcePosition.hasSameParentAs(e.targetPosition)&&(t.howMany+=e.howMany),t.sourcePosition=t.sourcePosition._getTransformedByMergeOperation(e),t.targetPosition=t.targetPosition._getTransformedByMergeOperation(e),t.graveyardPosition.isEqual(e.graveyardPosition)&&n.aIsStrong||(t.graveyardPosition=t.graveyardPosition._getTransformedByMergeOperation(e)),[t]}),Wg(xp,Sp,function(t,e,n){var r=Cf._createFromPositionAndShift(e.sourcePosition,e.howMany);return"remove"==e.type&&!n.bWasUndone&&t.deletionPosition.hasSameParentAs(e.sourcePosition)&&r.containsPosition(t.sourcePosition)?[new Ug(0)]:(t.sourcePosition.hasSameParentAs(e.targetPosition)&&(t.howMany+=e.howMany),t.sourcePosition.hasSameParentAs(e.sourcePosition)&&(t.howMany-=e.howMany),t.sourcePosition=t.sourcePosition._getTransformedByMoveOperation(e),t.targetPosition=t.targetPosition._getTransformedByMoveOperation(e),t.graveyardPosition.isEqual(e.targetPosition)||(t.graveyardPosition=t.graveyardPosition._getTransformedByMoveOperation(e)),[t])}),Wg(xp,Pp,function(t,e,n){if(e.graveyardPosition&&(t.graveyardPosition=t.graveyardPosition._getTransformedByDeletion(e.graveyardPosition,1),t.deletionPosition.isEqual(e.graveyardPosition)&&(t.howMany=e.howMany)),t.targetPosition.isEqual(e.splitPosition)){var r=0!=e.howMany,i=e.graveyardPosition&&t.deletionPosition.isEqual(e.graveyardPosition);if(r||i||"mergeTargetNotMoved"==n.abRelation)return t.sourcePosition=t.sourcePosition._getTransformedBySplitOperation(e),[t]}return t.sourcePosition.isEqual(e.splitPosition)&&("mergeSameElement"==n.abRelation||t.sourcePosition.offset>0)?(t.sourcePosition=e.moveTargetPosition.clone(),t.targetPosition=t.targetPosition._getTransformedBySplitOperation(e),[t]):(t.sourcePosition.hasSameParentAs(e.splitPosition)&&(t.howMany=e.splitPosition.offset),t.sourcePosition=t.sourcePosition._getTransformedBySplitOperation(e),t.targetPosition=t.targetPosition._getTransformedBySplitOperation(e),[t])}),Wg(Sp,Cp,function(t,e){var n=Cf._createFromPositionAndShift(t.sourcePosition,t.howMany),r=n._getTransformedByInsertOperation(e,!1)[0];return t.sourcePosition=r.start,t.howMany=r.end.offset-r.start.offset,t.targetPosition.isEqual(e.position)||(t.targetPosition=t.targetPosition._getTransformedByInsertOperation(e)),[t]}),Wg(Sp,Sp,function(t,e,n){var r,i=Cf._createFromPositionAndShift(t.sourcePosition,t.howMany),o=Cf._createFromPositionAndShift(e.sourcePosition,e.howMany),a=n.aIsStrong,s=!n.aIsStrong;if("insertBefore"==n.abRelation||"insertAfter"==n.baRelation?s=!0:"insertAfter"!=n.abRelation&&"insertBefore"!=n.baRelation||(s=!1),r=t.targetPosition.isEqual(e.targetPosition)&&s?t.targetPosition._getTransformedByDeletion(e.sourcePosition,e.howMany):t.targetPosition._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),Zg(t,e)&&Zg(e,t))return[e.getReversed()];var u=i.containsPosition(e.targetPosition);if(u&&i.containsRange(o,!0))return i.start=i.start._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),i.end=i.end._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),tm([i],r);var c=o.containsPosition(t.targetPosition);if(c&&o.containsRange(i,!0))return i.start=i.start._getCombined(e.sourcePosition,e.getMovedRangeStart()),i.end=i.end._getCombined(e.sourcePosition,e.getMovedRangeStart()),tm([i],r);var l=ae(t.sourcePosition.getParentPath(),e.sourcePosition.getParentPath());if("prefix"==l||"extension"==l)return i.start=i.start._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),i.end=i.end._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),tm([i],r);"remove"!=t.type||"remove"==e.type||n.aWasUndone?"remove"==t.type||"remove"!=e.type||n.bWasUndone||(a=!1):a=!0;var h=[],f=i.getDifference(o),d=!0,p=!1,v=void 0;try{for(var y,g=P()(f);!(d=(y=g.next()).done);d=!0){var m=y.value;m.start=m.start._getTransformedByDeletion(e.sourcePosition,e.howMany),m.end=m.end._getTransformedByDeletion(e.sourcePosition,e.howMany);var b="same"==ae(m.start.getParentPath(),e.getMovedRangeStart().getParentPath()),w=m._getTransformedByInsertion(e.getMovedRangeStart(),e.howMany,b);h.push.apply(h,kt(w))}}catch(k){p=!0,v=k}finally{try{d||null==g.return||g.return()}finally{if(p)throw v}}var _=i.getIntersection(o);return null!==_&&a&&(_.start=_.start._getCombined(e.sourcePosition,e.getMovedRangeStart()),_.end=_.end._getCombined(e.sourcePosition,e.getMovedRangeStart()),0===h.length?h.push(_):1==h.length?o.start.isBefore(i.start)||o.start.isEqual(i.start)?h.unshift(_):h.push(_):h.splice(1,0,_)),0===h.length?[new Ug(t.baseVersion)]:tm(h,r)}),Wg(Sp,Pp,function(t,e,n){var r=t.targetPosition.clone();t.targetPosition.isEqual(e.insertionPosition)&&e.graveyardPosition&&"moveTargetAfter"!=n.abRelation||(r=t.targetPosition._getTransformedBySplitOperation(e));var i=Cf._createFromPositionAndShift(t.sourcePosition,t.howMany);if(i.end.isEqual(e.insertionPosition))return e.graveyardPosition||t.howMany++,t.targetPosition=r,[t];if(i.start.hasSameParentAs(e.splitPosition)&&i.containsPosition(e.splitPosition)){var o=new Cf(e.splitPosition,i.end);o=o._getTransformedBySplitOperation(e);var a=[new Cf(i.start,e.splitPosition),o];return tm(a,r)}t.targetPosition.isEqual(e.splitPosition)&&"insertAtSource"==n.abRelation&&(r=e.moveTargetPosition),t.targetPosition.isEqual(e.insertionPosition)&&"insertBetween"==n.abRelation&&(r=t.targetPosition);var s=i._getTransformedBySplitOperation(e),u=[s];if(e.graveyardPosition){var c=i.start.isEqual(e.graveyardPosition)||i.containsPosition(e.graveyardPosition);t.howMany>1&&c&&u.push(Cf._createFromPositionAndShift(e.insertionPosition,1))}return tm(u,r)}),Wg(Sp,xp,function(t,e,n){var r=Cf._createFromPositionAndShift(t.sourcePosition,t.howMany);if(e.deletionPosition.hasSameParentAs(t.sourcePosition)&&r.containsPosition(e.sourcePosition))if("remove"==t.type){if(!n.aWasUndone){var i=[],o=e.graveyardPosition.clone(),a=e.targetPosition.clone();t.howMany>1&&(i.push(new Sp(t.sourcePosition,t.howMany-1,t.targetPosition,0)),o=o._getTransformedByInsertion(t.targetPosition,t.howMany-1),a=a._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany-1));var s=e.deletionPosition._getCombined(t.sourcePosition,t.targetPosition),u=new Sp(o,1,s,0),c=u.getMovedRangeStart().path.slice();c.push(0);var l=new Sf(u.targetPosition.root,c),h=new Sp(a,e.howMany,l,0);return i.push(u),i.push(h),i}}else if(1==t.howMany)return n.bWasUndone?(t.sourcePosition=e.graveyardPosition.clone(),t.targetPosition=t.targetPosition._getTransformedByMergeOperation(e),[t]):[new Ug(0)];var f=Cf._createFromPositionAndShift(t.sourcePosition,t.howMany),d=f._getTransformedByMergeOperation(e);return t.sourcePosition=d.start,t.howMany=d.end.offset-d.start.offset,t.targetPosition=t.targetPosition._getTransformedByMergeOperation(e),[t]}),Wg(Ap,Cp,function(t,e){return t.position=t.position._getTransformedByInsertOperation(e),[t]}),Wg(Ap,xp,function(t,e){return t.position.isEqual(e.deletionPosition)?(t.position=e.graveyardPosition.clone(),t.position.stickiness="toNext",[t]):(t.position=t.position._getTransformedByMergeOperation(e),[t])}),Wg(Ap,Sp,function(t,e){return t.position=t.position._getTransformedByMoveOperation(e),[t]}),Wg(Ap,Ap,function(t,e,n){if(t.position.isEqual(e.position)){if(!n.aIsStrong)return[new Ug(0)];t.oldName=e.newName}return[t]}),Wg(Ap,Pp,function(t,e){var n=t.position.path,r=e.splitPosition.getParentPath();if("same"==ae(n,r)&&!e.graveyardPosition){var i=new Ap(t.position.getShiftedBy(1),t.oldName,t.newName,0);return[t,i]}return t.position=t.position._getTransformedBySplitOperation(e),[t]}),Wg(Ip,Ip,function(t,e,n){if(t.root===e.root&&t.key===e.key){if(!n.aIsStrong||t.newValue===e.newValue)return[new Ug(0)];t.oldValue=e.newValue}return[t]}),Wg(Pp,Cp,function(t,e){return t.splitPosition.hasSameParentAs(e.position)&&t.splitPosition.offset<e.position.offset&&(t.howMany+=e.howMany),t.splitPosition=t.splitPosition._getTransformedByInsertOperation(e),t.insertionPosition=Pp.getInsertionPosition(t.splitPosition),[t]}),Wg(Pp,xp,function(t,e,n){if(!t.graveyardPosition&&!n.bWasUndone&&t.splitPosition.hasSameParentAs(e.sourcePosition)){var r=e.graveyardPosition.path.slice();r.push(0);var i=new Sf(e.graveyardPosition.root,r),o=Pp.getInsertionPosition(new Sf(e.graveyardPosition.root,r)),a=new Pp(i,0,null,0);return a.insertionPosition=o,t.splitPosition=t.splitPosition._getTransformedByMergeOperation(e),t.insertionPosition=Pp.getInsertionPosition(t.splitPosition),t.graveyardPosition=a.insertionPosition.clone(),t.graveyardPosition.stickiness="toNext",[a,t]}return t.splitPosition.hasSameParentAs(e.deletionPosition)&&!t.splitPosition.isAfter(e.deletionPosition)&&t.howMany--,t.splitPosition.hasSameParentAs(e.targetPosition)&&(t.howMany+=e.howMany),t.splitPosition=t.splitPosition._getTransformedByMergeOperation(e),t.insertionPosition=Pp.getInsertionPosition(t.splitPosition),t.graveyardPosition&&(t.graveyardPosition=t.graveyardPosition._getTransformedByMergeOperation(e)),[t]}),Wg(Pp,Sp,function(t,e,n){var r=Cf._createFromPositionAndShift(e.sourcePosition,e.howMany);if(t.graveyardPosition){if(r.start.isEqual(t.graveyardPosition)||r.containsPosition(t.graveyardPosition)){var i=t.splitPosition._getTransformedByMoveOperation(e),o=t.graveyardPosition._getTransformedByMoveOperation(e),a=o.path.slice();a.push(0);var s=new Sf(o.root,a),u=new Sp(i,t.howMany,s,0);return[u]}t.graveyardPosition=t.graveyardPosition._getTransformedByMoveOperation(e)}if(t.splitPosition.hasSameParentAs(e.sourcePosition)&&r.containsPosition(t.splitPosition)){var c=e.howMany-(t.splitPosition.offset-e.sourcePosition.offset);return t.howMany-=c,t.splitPosition.hasSameParentAs(e.targetPosition)&&t.splitPosition.offset<e.targetPosition.offset&&(t.howMany+=e.howMany),t.splitPosition=e.sourcePosition.clone(),t.insertionPosition=Pp.getInsertionPosition(t.splitPosition),[t]}var l=t.splitPosition.isEqual(e.targetPosition);return!l||"insertAtSource"!=n.baRelation&&"splitBefore"!=n.abRelation?(e.sourcePosition.isEqual(e.targetPosition)||(t.splitPosition.hasSameParentAs(e.sourcePosition)&&t.splitPosition.offset<=e.sourcePosition.offset&&(t.howMany-=e.howMany),t.splitPosition.hasSameParentAs(e.targetPosition)&&t.splitPosition.offset<e.targetPosition.offset&&(t.howMany+=e.howMany)),t.splitPosition.stickiness="toNone",t.splitPosition=t.splitPosition._getTransformedByMoveOperation(e),t.splitPosition.stickiness="toNext",t.graveyardPosition?t.insertionPosition=t.insertionPosition._getTransformedByMoveOperation(e):t.insertionPosition=Pp.getInsertionPosition(t.splitPosition),[t]):(t.howMany+=e.howMany,t.splitPosition=t.splitPosition._getTransformedByDeletion(e.sourcePosition,e.howMany),t.insertionPosition=Pp.getInsertionPosition(t.splitPosition),[t])}),Wg(Pp,Pp,function(t,e,n){if(t.splitPosition.isEqual(e.splitPosition)){if(!t.graveyardPosition&&!e.graveyardPosition)return[new Ug(0)];if(t.graveyardPosition&&e.graveyardPosition&&t.graveyardPosition.isEqual(e.graveyardPosition))return[new Ug(0)]}if(t.graveyardPosition&&e.graveyardPosition&&t.graveyardPosition.isEqual(e.graveyardPosition)){var r="$graveyard"==t.splitPosition.root.rootName,i="$graveyard"==e.splitPosition.root.rootName,o=r&&!i,a=i&&!r,s=a||!o&&n.aIsStrong;if(s){var u=[];return e.howMany&&u.push(new Sp(e.moveTargetPosition,e.howMany,e.splitPosition,0)),t.howMany&&u.push(new Sp(t.splitPosition,t.howMany,t.moveTargetPosition,0)),u}return[new Ug(0)]}if(t.graveyardPosition&&(t.graveyardPosition=t.graveyardPosition._getTransformedBySplitOperation(e)),t.splitPosition.isEqual(e.insertionPosition)&&"splitBefore"==n.abRelation)return t.howMany++,[t];if(e.splitPosition.isEqual(t.insertionPosition)&&"splitBefore"==n.baRelation){var c=e.insertionPosition.path.slice();c.push(0);var l=new Sf(e.insertionPosition.root,c),h=new Sp(t.insertionPosition,1,l,0);return[t,h]}return t.splitPosition.hasSameParentAs(e.splitPosition)&&t.splitPosition.offset<e.splitPosition.offset&&(t.howMany-=e.howMany),t.splitPosition=t.splitPosition._getTransformedBySplitOperation(e),t.insertionPosition=Pp.getInsertionPosition(t.splitPosition),[t]});var em=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),n._stack=[],n._createdBatches=new Uh.a,n.refresh(),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"refresh",value:function(){this.isEnabled=this._stack.length>0}},{key:"addBatch",value:function(t){var e=this.editor.model.document.selection,n={ranges:e.hasOwnRange?gt()(e.getRanges()):[],isBackward:e.isBackward};this._stack.push({batch:t,selection:n}),this.refresh()}},{key:"clearStack",value:function(){this._stack=[],this.refresh()}},{key:"_restoreSelection",value:function(t,e,n){var r=this.editor.model,i=r.document,o=[],a=!0,s=!1,u=void 0;try{for(var c,l=P()(t);!(a=(c=l.next()).done);a=!0){var h=c.value,f=nm(h,n),d=f.find(function(t){return t.start.root!=i.graveyard});d&&o.push(d)}}catch(p){s=!0,u=p}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}o.length&&r.change(function(t){t.setSelection(o,{backward:e})})}},{key:"_undo",value:function(t,e){var n=this.editor.model,r=n.document;this._createdBatches.add(e);var i=t.operations.slice().filter(function(t){return t.isDocumentOperation});i.reverse();var o=!0,a=!1,s=void 0;try{for(var u,c=P()(i);!(o=(u=c.next()).done);o=!0){var l=u.value,h=l.baseVersion+1,f=gt()(r.history.getOperations(h)),d=Gg([l.getReversed()],f,{useRelations:!0,document:this.editor.model.document,padWithNoOps:!1}),p=d.operationsA,v=!0,y=!1,g=void 0;try{for(var m,b=P()(p);!(v=(m=b.next()).done);v=!0){var w=m.value;e.addOperation(w),n.applyOperation(w),r.history.setOperationAsUndone(l,w)}}catch(_){y=!0,g=_}finally{try{v||null==b.return||b.return()}finally{if(y)throw g}}}}catch(_){a=!0,s=_}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}}}]),e}(rg);function nm(t,e){var n=t.getTransformedByOperations(e);n.sort(function(t,e){return t.start.isBefore(e.start)?-1:1});for(var r=1;r<n.length;r++){var i=n[r-1],o=n[r];i.end.isTouching(o.start)&&(i.end=o.end,n.splice(r,1),r--)}return n}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var rm=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"execute",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=e?this._stack.findIndex(function(t){return t.batch==e}):this._stack.length-1,r=this._stack.splice(n,1)[0],i=this.editor.model.createBatch();this.editor.model.enqueueChange(i,function(){t._undo(r.batch,i);var e=t.editor.model.document.history.getOperations(r.batch.baseVersion);t._restoreSelection(r.selection.ranges,r.selection.isBackward,e),t.fire("revert",r.batch,i)}),this.refresh()}}]),e}(em),im=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"execute",value:function(){var t=this,e=this._stack.pop(),n=this.editor.model.createBatch();this.editor.model.enqueueChange(n,function(){var r=e.batch.operations[e.batch.operations.length-1],i=r.baseVersion+1,o=t.editor.model.document.history.getOperations(i);t._restoreSelection(e.selection.ranges,e.selection.isBackward,o),t._undo(e.batch,n)}),this.refresh()}}]),e}(em),om=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),n._batchRegistry=new Uh.a,n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this,e=this.editor;this._undoCommand=new rm(e),this._redoCommand=new im(e),e.commands.add("undo",this._undoCommand),e.commands.add("redo",this._redoCommand),this.listenTo(e.model,"applyOperation",function(e,n){var r=n[0];if(r.isDocumentOperation){var i=r.batch;t._batchRegistry.has(i)||"transparent"==i.type||(t._redoCommand._createdBatches.has(i)?t._undoCommand.addBatch(i):t._undoCommand._createdBatches.has(i)||(t._undoCommand.addBatch(i),t._redoCommand.clearStack()),t._batchRegistry.add(i))}},{priority:"highest"}),this.listenTo(this._undoCommand,"revert",function(e,n,r){t._redoCommand.addBatch(r)}),e.keystrokes.set("CTRL+Z","undo"),e.keystrokes.set("CTRL+Y","redo"),e.keystrokes.set("CTRL+SHIFT+Z","redo")}}]),e}(Gy),am=(n("ffa0"),function(t){function e(){var t;Object(c["a"])(this,e),t=Object(m["a"])(this,Object(b["a"])(e).call(this));var n=t.bindTemplate;return t.set("content",""),t.set("viewBox","0 0 20 20"),t.set("fillColor",""),t.setTemplate({tag:"svg",ns:"http://www.w3.org/2000/svg",attributes:{class:["ck","ck-icon"],viewBox:n.to("viewBox")}}),t}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"render",value:function(){var t=this;S(Object(b["a"])(e.prototype),"render",this).call(this),this._updateXMLContent(),this._colorFillPaths(),this.on("change:content",function(){t._updateXMLContent(),t._colorFillPaths()}),this.on("change:fillColor",function(){t._colorFillPaths()})}},{key:"_updateXMLContent",value:function(){if(this.content){var t=(new DOMParser).parseFromString(this.content.trim(),"image/svg+xml"),e=t.querySelector("svg"),n=e.getAttribute("viewBox");n&&(this.viewBox=n),this.element.innerHTML="";while(e.childNodes.length>0)this.element.appendChild(e.childNodes[0])}}},{key:"_colorFillPaths",value:function(){var t=this;this.fillColor&&this.element.querySelectorAll(".ck-icon__fill").forEach(function(e){e.style.fill=t.fillColor})}}]),e}(Iy)),sm=(n("b0d6"),function(t){function e(t){var n;Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),n.set("text",""),n.set("position","s");var r=n.bindTemplate;return n.setTemplate({tag:"span",attributes:{class:["ck","ck-tooltip",r.to("position",function(t){return"ck-tooltip_"+t}),r.if("text","ck-hidden",function(t){return!t.trim()})]},children:[{tag:"span",attributes:{class:["ck","ck-tooltip__text"]},children:[{text:r.to("text")}]}]}),n}return Object(C["a"])(e,t),e}(Iy)),um=(n("43ae"),function(t){function e(t){var n;Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t));var r=n.bindTemplate,i=Mt();return n.set("class"),n.set("labelStyle"),n.set("icon"),n.set("isEnabled",!0),n.set("isOn",!1),n.set("isVisible",!0),n.set("keystroke"),n.set("label"),n.set("tabindex",-1),n.set("tooltip"),n.set("tooltipPosition","s"),n.set("type","button"),n.set("withText",!1),n.children=n.createCollection(),n.tooltipView=n._createTooltipView(),n.labelView=n._createLabelView(i),n.iconView=new am,n.iconView.extendTemplate({attributes:{class:"ck-button__icon"}}),n.bind("_tooltipString").to(Object(O["a"])(Object(O["a"])(n)),"tooltip",Object(O["a"])(Object(O["a"])(n)),"label",Object(O["a"])(Object(O["a"])(n)),"keystroke",n._getTooltipString.bind(Object(O["a"])(Object(O["a"])(n)))),n.setTemplate({tag:"button",attributes:{class:["ck","ck-button",r.to("class"),r.if("isEnabled","ck-disabled",function(t){return!t}),r.if("isVisible","ck-hidden",function(t){return!t}),r.to("isOn",function(t){return t?"ck-on":"ck-off"}),r.if("withText","ck-button_with-text")],type:r.to("type",function(t){return t||"button"}),tabindex:r.to("tabindex"),"aria-labelledby":"ck-editor__aria-label_".concat(i),"aria-disabled":r.if("isEnabled",!0,function(t){return!t}),"aria-pressed":r.if("isOn",!0)},children:n.children,on:{mousedown:r.to(function(t){t.preventDefault()}),click:r.to(function(t){n.isEnabled?n.fire("execute"):t.preventDefault()})}}),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"render",value:function(){S(Object(b["a"])(e.prototype),"render",this).call(this),this.icon&&(this.iconView.bind("content").to(this,"icon"),this.children.add(this.iconView)),this.children.add(this.tooltipView),this.children.add(this.labelView)}},{key:"focus",value:function(){this.element.focus()}},{key:"_createTooltipView",value:function(){var t=new sm;return t.bind("text").to(this,"_tooltipString"),t.bind("position").to(this,"tooltipPosition"),t}},{key:"_createLabelView",value:function(t){var e=new Iy,n=this.bindTemplate;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__label"],style:n.to("labelStyle"),id:"ck-editor__aria-label_".concat(t)},children:[{text:this.bindTemplate.to("label")}]}),e}},{key:"_getTooltipString",value:function(t,e,n){return t?"string"==typeof t?t:(n&&(n=ic(n)),t instanceof Function?t(e,n):"".concat(e).concat(n?" (".concat(n,")"):"")):""}}]),e}(Iy)),cm=n("f945"),lm=n.n(cm),hm=n("332d"),fm=n.n(hm),dm=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this.editor,e=t.t;this._addButton("undo",e("Undo"),"CTRL+Z",lm.a),this._addButton("redo",e("Redo"),"CTRL+Y",fm.a)}},{key:"_addButton",value:function(t,e,n,r){var i=this,o=this.editor;o.ui.componentFactory.add(t,function(a){var s=o.commands.get(t),u=new um(a);return u.set({label:e,icon:r,keystroke:n,tooltip:!0}),u.bind("isEnabled").to(s,"isEnabled"),i.listenTo(u,"execute",function(){return o.execute(t)}),u})}}]),e}(Gy),pm=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,null,[{key:"requires",get:function(){return[om,dm]}},{key:"pluginName",get:function(){return"Undo"}}]),e}(Gy),vm=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,null,[{key:"requires",get:function(){return[ng,cg,vg,Bg,pm]}},{key:"pluginName",get:function(){return"Essentials"}}]),e}(Gy),ym=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){this.set("hasAny",!1),this._actions=new Vu({idProperty:"_id"}),this._actions.delegate("add","remove").to(this)}},{key:"add",value:function(t){if("string"!==typeof t)throw new Nt["b"]("pendingactions-add-invalid-message: The message must be a string.");var e=Pv()(vu);return e.set("message",t),this._actions.add(e),this.hasAny=!0,e}},{key:"remove",value:function(t){this._actions.remove(t),this.hasAny=!!this._actions.length}},{key:Es.a,value:function(){return P()(this._actions)}},{key:"first",get:function(){return this._actions.get(0)}}],[{key:"pluginName",get:function(){return"PendingActions"}}]),e}(Gy),gm=function(){function t(){var e=this;Object(c["a"])(this,t);var n=new window.FileReader;this._reader=n,this.set("loaded",0),n.onprogress=function(t){e.loaded=t.loaded}}return Object(l["a"])(t,[{key:"read",value:function(t){var e=this,n=this._reader;return this.total=t.size,new a.a(function(r,i){n.onload=function(){r(n.result)},n.onerror=function(){i("error")},n.onabort=function(){i("aborted")},e._reader.readAsDataURL(t)})}},{key:"abort",value:function(){this._reader.abort()}},{key:"error",get:function(){return this._reader.error}}]),t}();
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */oe(gm,vu);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
var mm=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this;this.loaders=new Vu,this.loaders.on("add",function(){return t._updatePendingAction()}),this.loaders.on("remove",function(){return t._updatePendingAction()}),this._pendingAction=null,this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",function(t,e){return e?t/e*100:0})}},{key:"getLoader",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=P()(this.loaders);!(e=(i=o.next()).done);e=!0){var a=i.value;if(a.file==t)return a}}catch(s){n=!0,r=s}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return null}},{key:"createLoader",value:function(t){var e=this;if(!this.createUploadAdapter)return qh["a"].error("filerepository-no-upload-adapter: Upload adapter is not defined."),null;var n=new bm(t);return n._adapter=this.createUploadAdapter(n),this.loaders.add(n),n.on("change:uploaded",function(){var t=0,n=!0,r=!1,i=void 0;try{for(var o,a=P()(e.loaders);!(n=(o=a.next()).done);n=!0){var s=o.value;t+=s.uploaded}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}e.uploaded=t}),n.on("change:uploadTotal",function(){var t=0,n=!0,r=!1,i=void 0;try{for(var o,a=P()(e.loaders);!(n=(o=a.next()).done);n=!0){var s=o.value;s.uploadTotal&&(t+=s.uploadTotal)}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}e.uploadTotal=t}),n}},{key:"destroyLoader",value:function(t){var e=t instanceof bm?t:this.getLoader(t);e._destroy(),this.loaders.remove(e)}},{key:"_updatePendingAction",value:function(){var t=this.editor.plugins.get(ym);if(this.loaders.length){if(!this._pendingAction){var e=this.editor.t,n=function(t){return"".concat(e("Upload in progress")," ").concat(Qh()(t),"%.")};this._pendingAction=t.add(n(this.uploadedPercent)),this._pendingAction.bind("message").to(this,"uploadedPercent",n)}}else t.remove(this._pendingAction),this._pendingAction=null}}],[{key:"pluginName",get:function(){return"FileRepository"}},{key:"requires",get:function(){return[ym]}}]),e}(Gy);oe(mm,vu);var bm=function(){function t(e,n){Object(c["a"])(this,t),this.id=Mt(),this.file=e,this._adapter=n,this._reader=new gm,this.set("status","idle"),this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",function(t,e){return e?t/e*100:0}),this.set("uploadResponse",null)}return Object(l["a"])(t,[{key:"read",value:function(){var t=this;if("idle"!=this.status)throw new Nt["b"]("filerepository-read-wrong-status: You cannot call read if the status is different than idle.");return this.status="reading",this._reader.read(this.file).then(function(e){return t.status="idle",e}).catch(function(e){if("aborted"===e)throw t.status="aborted","aborted";throw t.status="error",t._reader.error})}},{key:"upload",value:function(){var t=this;if("idle"!=this.status)throw new Nt["b"]("filerepository-upload-wrong-status: You cannot call upload if the status is different than idle.");return this.status="uploading",this._adapter.upload().then(function(e){return t.uploadResponse=e,t.status="idle",e}).catch(function(e){if("aborted"===t.status)throw"aborted";throw t.status="error",e})}},{key:"abort",value:function(){var t=this.status;this.status="aborted","reading"==t&&this._reader.abort(),"uploading"==t&&this._adapter.abort&&this._adapter.abort(),this._destroy()}},{key:"_destroy",value:function(){this._reader=void 0,this._adapter=void 0,this.data=void 0,this.uploadResponse=void 0,this.file=void 0}}]),t}();oe(bm,vu);n("34ef");
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var wm="ckCsrfToken",_m=40,km="abcdefghijklmnopqrstuvwxyz0123456789";function Em(){var t=Tm(wm);return t&&t.length==_m||(t=Cm(_m),Sm(wm,t)),t}function Tm(t){t=t.toLowerCase();var e=document.cookie.split(";"),n=!0,r=!1,i=void 0;try{for(var o,a=P()(e);!(n=(o=a.next()).done);n=!0){var s=o.value,u=s.split("="),c=decodeURIComponent(u[0].trim().toLowerCase());if(c===t)return decodeURIComponent(u[1])}}catch(l){r=!0,i=l}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return null}function Sm(t,e){document.cookie=encodeURIComponent(t)+"="+encodeURIComponent(e)+";path=/"}function Cm(t){var e="",n=new Uint8Array(t);window.crypto.getRandomValues(n);for(var r=0;r<n.length;r++){var i=km.charAt(n[r]%km.length);e+=Math.random()>.5?i.toUpperCase():i}return e}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Om=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this,e=this.editor.config.get("ckfinder.uploadUrl");e&&(this.editor.plugins.get(mm).createUploadAdapter=function(n){return new Am(n,e,t.editor.t)})}}],[{key:"requires",get:function(){return[mm]}},{key:"pluginName",get:function(){return"CKFinderUploadAdapter"}}]),e}(Gy),Am=function(){function t(e,n,r){Object(c["a"])(this,t),this.loader=e,this.url=n,this.t=r}return Object(l["a"])(t,[{key:"upload",value:function(){var t=this;return new a.a(function(e,n){t._initRequest(),t._initListeners(e,n),t._sendRequest()})}},{key:"abort",value:function(){this.xhr&&this.xhr.abort()}},{key:"_initRequest",value:function(){var t=this.xhr=new XMLHttpRequest;t.open("POST",this.url,!0),t.responseType="json"}},{key:"_initListeners",value:function(t,e){var n=this.xhr,r=this.loader,i=this.t,o=i("Cannot upload file:")+" ".concat(r.file.name,".");n.addEventListener("error",function(){return e(o)}),n.addEventListener("abort",function(){return e()}),n.addEventListener("load",function(){var r=n.response;if(!r||!r.uploaded)return e(r&&r.error&&r.error.message?r.error.message:o);t({default:r.url})}),n.upload&&n.upload.addEventListener("progress",function(t){t.lengthComputable&&(r.uploadTotal=t.total,r.uploaded=t.loaded)})}},{key:"_sendRequest",value:function(){var t=new FormData;t.append("upload",this.loader.file),t.append("ckCsrfToken",Em()),this.xhr.send(t)}}]),t}(),Im=function t(e,n,r){var i;if(Object(c["a"])(this,t),"function"==typeof r)i=r;else{var o=r;i=function(){e.execute(o)}}e.model.document.on("change",function(t,r){if("transparent"!=r.type){var o=gt()(e.model.document.differ.getChanges()),a=o[0];if(1==o.length&&"insert"===a.type&&"$text"==a.name&&1==a.length){var s=a.position.textNode||a.position.nodeAfter;if(s.parent.is("paragraph")){var u=n.exec(s.data);u&&e.model.enqueueChange(function(t){var e=t.createPositionAt(s.parent,0),n=t.createPositionAt(s.parent,u[0].length),r=t.createRange(e,n);t.remove(r),i({match:u})})}}}})},xm=function t(e,n,r){var i,o,a,s;Object(c["a"])(this,t),n instanceof RegExp?i=n:a=n,"string"==typeof r?o=r:s=r,a=a||function(t){var e,n=[],r=[];while(null!==(e=i.exec(t))){if(e&&e.length<4)break;var o=e,a=o.index,s=o["1"],u=o["2"],c=o["3"],l=s+u+c;a+=e[0].length-l.length;var h=[a,a+s.length],f=[a+s.length+u.length,a+s.length+u.length+c.length];n.push(h),n.push(f),r.push([a+s.length,a+s.length+u.length])}return{remove:n,format:r}},s=s||function(t,e){var n=!0,r=!1,i=void 0;try{for(var a,s=P()(e);!(n=(a=s.next()).done);n=!0){var u=a.value;t.setAttribute(o,!0,u)}}catch(c){r=!0,i=c}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}t.removeSelectionAttribute(o)},e.model.document.on("change",function(t,n){if("transparent"!=n.type){var r=e.model.document.selection;if(r.isCollapsed){var i=gt()(e.model.document.differ.getChanges()),u=i[0];if(1==i.length&&"insert"===u.type&&"$text"==u.name&&1==u.length){var c=r.focus.parent,l=Pm(c).slice(0,r.focus.offset),h=a(l),f=Nm(c,h.format,e.model),d=Nm(c,h.remove,e.model);f.length&&d.length&&e.model.enqueueChange(function(t){var n=e.model.schema.getValidRanges(f,o);s(t,n);var r=!0,i=!1,a=void 0;try{for(var u,c=P()(d.reverse());!(r=(u=c.next()).done);r=!0){var l=u.value;t.remove(l)}}catch(h){i=!0,a=h}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}})}}}})};function Pm(t){return gt()(t.getChildren()).reduce(function(t,e){return t+e.data},"")}function Nm(t,e,n){return e.filter(function(t){return void 0!==t[0]&&void 0!==t[1]}).map(function(e){return n.createRange(n.createPositionAt(t,e[0]),n.createPositionAt(t,e[1]))})}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Rm=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"afterInit",value:function(){this._addListAutoformats(),this._addBasicStylesAutoformats(),this._addHeadingAutoformats(),this._addBlockQuoteAutoformats()}},{key:"_addListAutoformats",value:function(){var t=this.editor.commands;t.get("bulletedList")&&new Im(this.editor,/^[*-]\s$/,"bulletedList"),t.get("numberedList")&&new Im(this.editor,/^\d+[.|)]\s$/,"numberedList")}},{key:"_addBasicStylesAutoformats",value:function(){var t=this.editor.commands;t.get("bold")&&(new xm(this.editor,/(\*\*)([^*]+)(\*\*)$/g,"bold"),new xm(this.editor,/(__)([^_]+)(__)$/g,"bold")),t.get("italic")&&(new xm(this.editor,/(?:^|[^*])(\*)([^*_]+)(\*)$/g,"italic"),new xm(this.editor,/(?:^|[^_])(_)([^_]+)(_)$/g,"italic")),t.get("code")&&new xm(this.editor,/(`)([^`]+)(`)$/g,"code")}},{key:"_addHeadingAutoformats",value:function(){var t=this,e=this.editor.commands.get("heading");e&&e.modelElements.filter(function(t){return t.match(/^heading[1-6]$/)}).forEach(function(e){var n=e[7],r=new RegExp("^(#{".concat(n,"})\\s$"));new Im(t.editor,r,function(){t.editor.execute("heading",{value:e})})})}},{key:"_addBlockQuoteAutoformats",value:function(){this.editor.commands.get("blockQuote")&&new Im(this.editor,/^>\s$/,"blockQuote")}}],[{key:"pluginName",get:function(){return"Autoformat"}}]),e}(Gy),Dm=function(t){function e(t,n){var r;return Object(c["a"])(this,e),r=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),r.attributeKey=n,r}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"refresh",value:function(){var t=this.editor.model,e=t.document;this.value=this._getValueFromFirstAllowedNode(),this.isEnabled=t.schema.checkAttributeInSelection(e.selection,this.attributeKey)}},{key:"execute",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.editor.model,r=n.document,i=r.selection,o=void 0===e.forceValue?!this.value:e.forceValue;n.change(function(e){if(i.isCollapsed)o?e.setSelectionAttribute(t.attributeKey,!0):e.removeSelectionAttribute(t.attributeKey);else{var r=n.schema.getValidRanges(i.getRanges(),t.attributeKey),a=!0,s=!1,u=void 0;try{for(var c,l=P()(r);!(a=(c=l.next()).done);a=!0){var h=c.value;o?e.setAttribute(t.attributeKey,o,h):e.removeAttribute(t.attributeKey,h)}}catch(f){s=!0,u=f}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}}})}},{key:"_getValueFromFirstAllowedNode",value:function(){var t=this.editor.model,e=t.schema,n=t.document.selection;if(n.isCollapsed)return n.hasAttribute(this.attributeKey);var r=!0,i=!1,o=void 0;try{for(var a,s=P()(n.getRanges());!(r=(a=s.next()).done);r=!0){var u=a.value,c=!0,l=!1,h=void 0;try{for(var f,d=P()(u.getItems());!(c=(f=d.next()).done);c=!0){var p=f.value;if(e.checkAttribute(p,this.attributeKey))return p.hasAttribute(this.attributeKey)}}catch(v){l=!0,h=v}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}}}catch(v){i=!0,o=v}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return!1}}]),e}(rg),jm="bold",Mm=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this.editor;t.model.schema.extend("$text",{allowAttributes:jm}),t.conversion.attributeToElement({model:jm,view:"strong",upcastAlso:["b",{styles:{"font-weight":"bold"}}]}),t.commands.add(jm,new Dm(t,jm)),t.keystrokes.set("CTRL+B",jm)}}]),e}(Gy),Lm=n("8708"),Fm=n.n(Lm),Vm="bold",Bm=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this,e=this.editor,n=e.t;e.ui.componentFactory.add(Vm,function(r){var i=e.commands.get(Vm),o=new um(r);return o.set({label:n("Bold"),icon:Fm.a,keystroke:"CTRL+B",tooltip:!0}),o.bind("isOn","isEnabled").to(i,"value","isEnabled"),t.listenTo(o,"execute",function(){return e.execute(Vm)}),o})}}]),e}(Gy),Um=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,null,[{key:"requires",get:function(){return[Mm,Bm]}},{key:"pluginName",get:function(){return"Bold"}}]),e}(Gy),qm="italic",Wm=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this.editor;t.model.schema.extend("$text",{allowAttributes:qm}),t.conversion.attributeToElement({model:qm,view:"i",upcastAlso:["em",{styles:{"font-style":"italic"}}]}),t.commands.add(qm,new Dm(t,qm)),t.keystrokes.set("CTRL+I",qm)}}]),e}(Gy),Km=n("1033"),Hm=n.n(Km),zm="italic",Gm=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this,e=this.editor,n=e.t;e.ui.componentFactory.add(zm,function(r){var i=e.commands.get(zm),o=new um(r);return o.set({label:n("Italic"),icon:Hm.a,keystroke:"CTRL+I",tooltip:!0}),o.bind("isOn","isEnabled").to(i,"value","isEnabled"),t.listenTo(o,"execute",function(){return e.execute(zm)}),o})}}]),e}(Gy),Qm=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,null,[{key:"requires",get:function(){return[Wm,Gm]}},{key:"pluginName",get:function(){return"Italic"}}]),e}(Gy);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
function Ym(t){var e=t.next();return e.done?null:e.value}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Xm=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"refresh",value:function(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}},{key:"execute",value:function(){var t=this,e=this.editor.model,n=e.document,r=e.schema,i=gt()(n.selection.getSelectedBlocks());e.change(function(e){if(t.value)t._removeQuote(e,i.filter(Jm));else{var n=i.filter(function(t){return Jm(t)||Zm(r,t)});t._applyQuote(e,n)}})}},{key:"_getValue",value:function(){var t=Ym(this.editor.model.document.selection.getSelectedBlocks());return!(!t||!Jm(t))}},{key:"_checkEnabled",value:function(){if(this.value)return!0;var t=this.editor.model.document.selection,e=this.editor.model.schema,n=Ym(t.getSelectedBlocks());return!!n&&Zm(e,n)}},{key:"_removeQuote",value:function(t,e){$m(t,e).reverse().forEach(function(e){if(e.start.isAtStart&&e.end.isAtEnd)t.unwrap(e.start.parent);else if(e.start.isAtStart){var n=t.createPositionBefore(e.start.parent);t.move(e,n)}else{e.end.isAtEnd||t.split(e.end);var r=t.createPositionAfter(e.end.parent);t.move(e,r)}})}},{key:"_applyQuote",value:function(t,e){var n=[];$m(t,e).reverse().forEach(function(e){var r=Jm(e.start);r||(r=t.createElement("blockQuote"),t.wrap(e,r)),n.push(r)}),n.reverse().reduce(function(e,n){return e.nextSibling==n?(t.merge(t.createPositionAfter(e)),e):n})}}]),e}(rg);function Jm(t){return"blockQuote"==t.parent.name?t.parent:null}function $m(t,e){var n,r=0,i=[];while(r<e.length){var o=e[r],a=e[r+1];n||(n=t.createPositionBefore(o)),a&&o.nextSibling==a||(i.push(t.createRange(n,t.createPositionAfter(o))),n=null),r++}return i}function Zm(t,e){var n=t.checkChild(e.parent,"blockQuote"),r=t.checkChild(["$root","blockQuote"],e);return n&&r}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var tb=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this.editor,e=t.model.schema;t.commands.add("blockQuote",new Xm(t)),e.register("blockQuote",{allowWhere:"$block",allowContentOf:"$root"}),e.addChildCheck(function(t,e){if(t.endsWith("blockQuote")&&"blockQuote"==e.name)return!1}),t.conversion.elementToElement({model:"blockQuote",view:"blockquote"}),t.model.document.registerPostFixer(function(n){var r=t.model.document.differ.getChanges(),i=!0,o=!1,a=void 0;try{for(var s,u=P()(r);!(i=(s=u.next()).done);i=!0){var c=s.value;if("insert"==c.type){var l=c.position.nodeAfter;if(!l)continue;if(l.is("blockQuote")&&l.isEmpty)return n.remove(l),!0;if(l.is("blockQuote")&&!e.checkChild(c.position,l))return n.unwrap(l),!0;if(l.is("element")){var h=n.createRangeIn(l),f=!0,d=!1,p=void 0;try{for(var v,y=P()(h.getItems());!(f=(v=y.next()).done);f=!0){var g=v.value;if(g.is("blockQuote")&&!e.checkChild(n.createPositionBefore(g),g))return n.unwrap(g),!0}}catch(b){d=!0,p=b}finally{try{f||null==y.return||y.return()}finally{if(d)throw p}}}}else if("remove"==c.type){var m=c.position.parent;if(m.is("blockQuote")&&m.isEmpty)return n.remove(m),!0}}}catch(b){o=!0,a=b}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}return!1})}},{key:"afterInit",value:function(){var t=this,e=this.editor,n=e.commands.get("blockQuote");this.listenTo(this.editor.editing.view.document,"enter",function(e,r){var i=t.editor.model.document,o=i.selection.getLastPosition().parent;i.selection.isCollapsed&&o.isEmpty&&n.value&&(t.editor.execute("blockQuote"),t.editor.editing.view.scrollToTheSelection(),r.preventDefault(),e.stop())})}}]),e}(Gy),eb=n("50bd"),nb=n.n(eb),rb=(n("30b7"),function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this,e=this.editor,n=e.t;e.ui.componentFactory.add("blockQuote",function(r){var i=e.commands.get("blockQuote"),o=new um(r);return o.set({label:n("Block quote"),icon:nb.a,tooltip:!0}),o.bind("isOn","isEnabled").to(i,"value","isEnabled"),t.listenTo(o,"execute",function(){return e.execute("blockQuote")}),o})}}]),e}(Gy)),ib=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,null,[{key:"requires",get:function(){return[tb,rb]}},{key:"pluginName",get:function(){return"BlockQuote"}}]),e}(Gy);
/**
 * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
const ob=/^data:(\S*?);base64,/;class ab{constructor(t,e,n){if(!t)throw new Error("File must be provided");if(!e)throw new Error("Token must be provided");if(!n)throw new Error("Api address must be provided");this.file=ub(t)?sb(t):t,this._token=e,this._apiAddress=n}onProgress(t){return this.on("progress",(e,n)=>t(n)),this}onError(t){return this.once("error",(e,n)=>t(n)),this}abort(){this.xhr.abort()}send(){return this._prepareRequest(),this._attachXHRListeners(),this._sendRequest()}_prepareRequest(){const t=new XMLHttpRequest;t.open("POST",this._apiAddress),t.setRequestHeader("Authorization",this._token.value),t.responseType="json",this.xhr=t}_attachXHRListeners(){const t=this,e=this.xhr;function n(e){return()=>t.fire("error",e)}e.addEventListener("error",n("Network Error")),e.addEventListener("abort",n("Abort")),e.upload&&e.upload.addEventListener("progress",t=>{t.lengthComputable&&this.fire("progress",{total:t.total,uploaded:t.loaded})}),e.addEventListener("load",()=>{const t=e.status,n=e.response;if(t<200||t>299)return this.fire("error",n.message||n.error)})}_sendRequest(){const t=new FormData,e=this.xhr;return t.append("file",this.file),new Promise((n,r)=>{e.addEventListener("load",()=>{const t=e.status,i=e.response;return t<200||t>299?i.message?r(new Error(i.message)):r(i.error):n(i)}),e.addEventListener("error",()=>r(new Error("Network Error"))),e.addEventListener("abort",()=>r(new Error("Abort"))),e.send(t)})}}function sb(t,e=512){try{const r=t.match(ob)[1],i=atob(t.replace(ob,"")),o=[];for(let t=0;t<i.length;t+=e){const n=i.slice(t,t+e),r=new Array(n.length);for(let t=0;t<n.length;t++)r[t]=n.charCodeAt(t);o.push(new Uint8Array(r))}return new Blob(o,{type:r})}catch(n){throw new Error("Problem with decoding Base64 image data.")}}function ub(t){if("string"!==typeof t)return!1;const e=t.match(ob);return!(!e||!e.length)}oe(ab,qt);var cb=ab;
/**
 * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */class lb{constructor(t,e){if(!t)throw new Error("Token must be provided");if(!e)throw new Error("Api address must be provided");this._token=t,this._apiAddress=e}upload(t){return new cb(t,this._token,this._apiAddress)}}
/**
 * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */const hb={refreshInterval:36e5,autoRefresh:!0};class fb{constructor(t,e=hb){if(!t)throw new Error("A `tokenUrl` must be provided as the first constructor argument.");this.set("value",e.initValue),this._refresh="function"===typeof t?t:()=>db(t),this._options=Object.assign({},hb,e)}init(){return new Promise((t,e)=>{this._options.autoRefresh&&this._startRefreshing(),this.value?t(this):this._refreshToken().then(t).catch(e)})}_refreshToken(){return this._refresh().then(t=>this.set("value",t)).then(()=>this)}destroy(){this._stopRefreshing()}_startRefreshing(){this._refreshInterval=setInterval(()=>this._refreshToken(),this._options.refreshInterval)}_stopRefreshing(){clearInterval(this._refreshInterval)}static create(t,e=hb){const n=new fb(t,e);return n.init()}}function db(t){return new Promise((e,n)=>{const r=new XMLHttpRequest;r.open("GET",t),r.addEventListener("load",()=>{const t=r.status,i=r.response;return t<200||t>299?n(new Error("Cannot download new token!")):e(i)}),r.addEventListener("error",()=>n(new Error("Network Error"))),r.addEventListener("abort",()=>n(new Error("Abort"))),r.send()})}oe(fb,vu);var pb=fb,vb=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this.editor,n=t.config,r=n.get("cloudServices")||{};for(var i in r)this[i]=r[i];if(this.tokenUrl)return this.token=new e.Token(this.tokenUrl),this.token.init();this.token=null}}],[{key:"pluginName",get:function(){return"CloudServices"}}]),e}(Gy);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */vb.Token=pb;
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
var yb=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this,n=this.editor,r=n.plugins.get(vb),i=r.token,o=r.uploadUrl;i&&(this._uploadGateway=new e._UploadGateway(i,o),n.plugins.get(mm).createUploadAdapter=function(e){return new gb(t._uploadGateway,e)})}}],[{key:"requires",get:function(){return[mm,vb]}}]),e}(Gy),gb=function(){function t(e,n){Object(c["a"])(this,t),this.uploadGateway=e,this.loader=n}return Object(l["a"])(t,[{key:"upload",value:function(){var t=this;return this.fileUploader=this.uploadGateway.upload(this.loader.file),this.fileUploader.on("progress",function(e,n){t.loader.uploadTotal=n.total,t.loader.uploaded=n.uploaded}),this.fileUploader.send()}},{key:"abort",value:function(){this.fileUploader.abort()}}]),t}();yb._UploadGateway=lb;
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
var mb=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),n._observedElements=new Pt.a,n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"observe",value:function(t,e){var n=this,r=this.document.getRoot(e);r.on("change:children",function(e,r){n.view.once("render",function(){return n._updateObservedElements(t,r)})})}},{key:"_updateObservedElements",value:function(t,e){var n=this;if(e.is("element")&&!e.is("attributeElement")){var r=this.view.domConverter.mapViewToDom(e);if(r){var i=!0,o=!1,a=void 0;try{for(var s,u=P()(r.querySelectorAll("img"));!(i=(s=u.next()).done);i=!0){var c=s.value;this._observedElements.has(c)||(this.listenTo(c,"load",function(t,e){return n._fireEvents(e)}),this._observedElements.add(c))}}catch(y){o=!0,a=y}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}var l=!0,h=!1,f=void 0;try{for(var d,p=P()(this._observedElements);!(l=(d=p.next()).done);l=!0){var v=d.value;t.contains(v)||(this.stopListening(v),this._observedElements.delete(v))}}catch(y){h=!0,f=y}finally{try{l||null==p.return||p.return()}finally{if(h)throw f}}}}}},{key:"_fireEvents",value:function(t){this.isEnabled&&(this.document.fire("layoutChanged"),this.document.fire("imageLoaded",t))}},{key:"destroy",value:function(){this._observedElements.clear(),S(Object(b["a"])(e.prototype),"destroy",this).call(this)}}]),e}(yl);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function bb(){return function(e){e.on("element:figure",t)};function t(t,e,n){if(n.consumable.test(e.viewItem,{name:!0,classes:"image"})){var r=gt()(e.viewItem.getChildren()).find(function(t){return t.is("img")});if(r&&r.hasAttribute("src")&&n.consumable.test(r,{name:!0})){var i=n.convertItem(r,e.modelCursor),o=Ym(i.modelRange.getItems());o&&(n.convertChildren(e.viewItem,n.writer.createPositionAt(o,0)),e.modelRange=i.modelRange,e.modelCursor=i.modelCursor)}}}}function wb(){return function(e){e.on("attribute:srcset:image",t)};function t(t,e,n){if(n.consumable.consume(e.item,t.name)){var r=n.writer,i=n.mapper.toViewElement(e.item),o=i.getChild(0);if(null===e.attributeNewValue){var a=e.attributeOldValue;a.data&&(r.removeAttribute("srcset",o),r.removeAttribute("sizes",o),a.width&&r.removeAttribute("width",o))}else{var s=e.attributeNewValue;s.data&&(r.setAttribute("srcset",s.data,o),r.setAttribute("sizes","100vw",o),s.width&&r.setAttribute("width",s.width,o))}}}}function _b(t){return function(n){n.on("attribute:".concat(t,":image"),e)};function e(t,e,n){if(n.consumable.consume(e.item,t.name)){var r=n.writer,i=n.mapper.toViewElement(e.item),o=i.getChild(0);null!==e.attributeNewValue?r.setAttribute(e.attributeKey,e.attributeNewValue,o):r.removeAttribute(e.attributeKey,o)}}}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var kb=function(){function t(){Object(c["a"])(this,t),this._stack=[]}return Object(l["a"])(t,[{key:"add",value:function(t,e){var n=this._stack,r=n[0];this._insertDescriptor(t);var i=n[0];r===i||Eb(r,i)||this.fire("change:top",{oldDescriptor:r,newDescriptor:i,writer:e})}},{key:"remove",value:function(t,e){var n=this._stack,r=n[0];this._removeDescriptor(t);var i=n[0];r===i||Eb(r,i)||this.fire("change:top",{oldDescriptor:r,newDescriptor:i,writer:e})}},{key:"_insertDescriptor",value:function(t){var e=this._stack,n=e.findIndex(function(e){return e.id===t.id});if(!Eb(t,e[n])){n>-1&&e.splice(n,1);var r=0;while(e[r]&&Tb(e[r],t))r++;e.splice(r,0,t)}}},{key:"_removeDescriptor",value:function(t){var e=this._stack,n=e.findIndex(function(e){return e.id===t});n>-1&&e.splice(n,1)}}]),t}();function Eb(t,e){return t&&e&&t.priority==e.priority&&Sb(t.classes)==Sb(e.classes)}function Tb(t,e){return t.priority>e.priority||!(t.priority<e.priority)&&Sb(t.classes)>Sb(e.classes)}function Sb(t){return pt()(t)?t.sort().join(","):t}oe(kb,qt);var Cb=n("700e"),Ob=n.n(Cb),Ab=ft()("isWidget"),Ib=ft()("label"),xb="ck-widget",Pb="ck-widget_selected";function Nb(t){return!!t.is("element")&&!!t.getCustomProperty(Ab)}function Rb(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Yu.isEdge||e.setAttribute("contenteditable","false",t),e.addClass(xb,t),e.setCustomProperty(Ab,!0,t),t.getFillerOffset=Vb,n.label&&jb(t,n.label,e),n.hasSelectionHandler&&Bb(t,e),Db(t,e,function(t,e,n){return n.addClass(r(e.classes),t)},function(t,e,n){return n.removeClass(r(e.classes),t)}),t;function r(t){return pt()(t)?t:[t]}}function Db(t,e,n,r){var i=new kb;i.on("change:top",function(e,i){i.oldDescriptor&&r(t,i.oldDescriptor,i.writer),i.newDescriptor&&n(t,i.newDescriptor,i.writer)}),e.setCustomProperty("addHighlight",function(t,e,n){return i.add(e,n)},t),e.setCustomProperty("removeHighlight",function(t,e,n){return i.remove(e,n)},t)}function jb(t,e,n){n.setCustomProperty(Ib,e,t)}function Mb(t){var e=t.getCustomProperty(Ib);return e?"function"==typeof e?e():e:""}function Lb(t,e){return e.addClass(["ck-editor__editable","ck-editor__nested-editable"],t),Yu.isEdge||(e.setAttribute("contenteditable",t.isReadOnly?"false":"true",t),t.on("change:isReadOnly",function(n,r,i){e.setAttribute("contenteditable",i?"false":"true",t)})),t.on("change:isFocused",function(n,r,i){i?e.addClass("ck-editor__nested-editable_focused",t):e.removeClass("ck-editor__nested-editable_focused",t)}),t}function Fb(t,e){var n=t.getSelectedElement();if(n)return e.createPositionAfter(n);var r=t.getSelectedBlocks().next().value;if(r){if(r.isEmpty)return e.createPositionAt(r,0);var i=e.createPositionAfter(r);return t.focus.isTouching(i)?i:e.createPositionBefore(r)}return t.focus}function Vb(){return null}function Bb(t,e){var n=e.createUIElement("div",{class:"ck ck-widget__selection-handler"},function(t){var e=this.toDomElement(t),n=new am;return n.set("content",Ob.a),n.render(),e.appendChild(n.element),e});e.insert(e.createPositionAt(t,0),n),e.addClass(["ck-widget_selectable"],t)}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Ub=ft()("isImage");function qb(t,e,n){return e.setCustomProperty(Ub,!0,t),Rb(t,e,{label:r});function r(){var e=t.getChild(0),r=e.getAttribute("alt");return r?"".concat(r," ").concat(n):n}}function Wb(t){return!!t.getCustomProperty(Ub)&&Nb(t)}function Kb(t){var e=t.getSelectedElement();return!(!e||!Wb(e))}function Hb(t){return!!t&&t.is("image")}function zb(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.createElement("image",n),i=Fb(e.document.selection,e);e.insertContent(r,i),r.parent&&t.setSelection(r,"on")}function Gb(t){var e=t.schema,n=t.document.selection;return Qb(n,e,t)&&Yb(n,e)}function Qb(t,e,n){var r=Xb(t,n);return e.checkChild(r,"image")}function Yb(t,e){var n=t.getSelectedElement(),r=!!n&&e.isObject(n),i=!!kt(t.focus.getAncestors()).find(function(t){return e.isObject(t)});return!r&&!i}function Xb(t,e){var n=Fb(t,e),r=n.parent;return r.is("$root")||(r=r.parent),r}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Jb=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"refresh",value:function(){this.isEnabled=Gb(this.editor.model)}},{key:"execute",value:function(t){var e=this.editor.model;e.change(function(n){var r=pt()(t.source)?t.source:[t.source],i=!0,o=!1,a=void 0;try{for(var s,u=P()(r);!(i=(s=u.next()).done);i=!0){var c=s.value;zb(n,e,{src:c})}}catch(l){o=!0,a=l}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}})}}]),e}(rg),$b=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this.editor,e=t.model.schema,n=t.t,r=t.conversion;t.editing.view.addObserver(mb),e.register("image",{isObject:!0,isBlock:!0,allowWhere:"$block",allowAttributes:["alt","src","srcset"]}),r.for("dataDowncast").add(Qf({model:"image",view:function(t,e){return Zb(e)}})),r.for("editingDowncast").add(Qf({model:"image",view:function(t,e){return qb(Zb(e),e,n("image widget"))}})),r.for("downcast").add(_b("src")).add(_b("alt")).add(wb()),r.for("upcast").add(qd({view:{name:"img",attributes:{src:!0}},model:function(t,e){return e.createElement("image",{src:t.getAttribute("src")})}})).add(Kd({view:{name:"img",key:"alt"},model:"alt"})).add(Kd({view:{name:"img",key:"srcset"},model:{key:"srcset",value:function(t){var e={data:t.getAttribute("srcset")};return t.hasAttribute("width")&&(e.width=t.getAttribute("width")),e}}})).add(bb()),t.commands.add("imageInsert",new Jb(t))}}]),e}(Gy);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function Zb(t){var e=t.createEmptyElement("img"),n=t.createContainerElement("figure",{class:"image"});return t.insert(t.createPositionAt(n,0),e),n}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var tw=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),n.domEventType="mousedown",n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"onDomEvent",value:function(t){this.fire(t.type,t)}}]),e}(mh),ew=(n("fecc"),rc("Ctrl+A")),nw=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this,e=this.editor.editing.view,n=e.document;this._previouslySelected=new Pt.a,this.editor.editing.downcastDispatcher.on("selection",function(e,n,r){t._clearPreviouslySelectedWidgets(r.writer);var i=r.writer,o=i.document.selection,a=o.getSelectedElement(),s=null,u=!0,c=!1,l=void 0;try{for(var h,f=P()(o.getRanges());!(u=(h=f.next()).done);u=!0){var d=h.value,p=!0,v=!1,y=void 0;try{for(var g,m=P()(d);!(p=(g=m.next()).done);p=!0){var b=g.value,w=b.item;Nb(w)&&!aw(w,s)&&(i.addClass(Pb,w),t._previouslySelected.add(w),s=w,w==a&&i.setSelection(o.getRanges(),{fake:!0,label:Mb(a)}))}}catch(_){v=!0,y=_}finally{try{p||null==m.return||m.return()}finally{if(v)throw y}}}}catch(_){c=!0,l=_}finally{try{u||null==f.return||f.return()}finally{if(c)throw l}}},{priority:"low"}),e.addObserver(tw),this.listenTo(n,"mousedown",function(){return t._onMousedown.apply(t,arguments)}),this.listenTo(n,"keydown",function(){return t._onKeydown.apply(t,arguments)},{priority:"high"}),this.listenTo(n,"delete",function(e,n){t._handleDelete("forward"==n.direction)&&(n.preventDefault(),e.stop())},{priority:"high"})}},{key:"_onMousedown",value:function(t,e){var n=this.editor,r=n.editing.view,i=r.document,o=e.target;if(!ow(o)&&(Nb(o)||(o=o.findAncestor(Nb),o))){e.preventDefault(),i.isFocused||r.focus();var a=n.editing.mapper.toModelElement(o);this._setSelectionOverElement(a)}}},{key:"_onKeydown",value:function(t,e){var n=e.keyCode,r=n==ec.delete||n==ec.arrowdown||n==ec.arrowright,i=!1;rw(n)?i=this._handleArrowKeys(r):iw(e)?i=this._selectAllNestedEditableContent()||this._selectAllContent():n===ec.enter&&(i=this._handleEnterKey(e.shiftKey)),i&&(e.preventDefault(),t.stop())}},{key:"_handleDelete",value:function(t){var e=this;if(!this.editor.isReadOnly){var n=this.editor.model.document,r=n.selection;if(r.isCollapsed){var i=this._getObjectElementNextToSelection(t);return i?(this.editor.model.change(function(t){var n=r.anchor.parent;while(n.isEmpty){var o=n;n=o.parent,t.remove(o)}e._setSelectionOverElement(i)}),!0):void 0}}}},{key:"_handleArrowKeys",value:function(t){var e=this.editor.model,n=e.schema,r=e.document,i=r.selection,o=i.getSelectedElement();if(o&&n.isObject(o)){var a=t?i.getLastPosition():i.getFirstPosition(),s=n.getNearestSelectionRange(a,t?"forward":"backward");return s&&e.change(function(t){t.setSelection(s)}),!0}if(i.isCollapsed){var u=this._getObjectElementNextToSelection(t);return u&&n.isObject(u)?(this._setSelectionOverElement(u),!0):void 0}}},{key:"_handleEnterKey",value:function(t){var e=this.editor.model,n=e.document.selection,r=n.getSelectedElement();if(r&&e.schema.isObject(r))return e.change(function(e){var n=e.createElement("paragraph");e.insert(n,r,t?"before":"after"),e.setSelection(n,"in")}),!0}},{key:"_selectAllNestedEditableContent",value:function(){var t=this.editor.model,e=t.document.selection,n=t.schema.getLimitElement(e);return e.getFirstRange().root!=n&&(t.change(function(t){t.setSelection(t.createRangeIn(n))}),!0)}},{key:"_selectAllContent",value:function(){var t=this.editor.model,e=this.editor.editing,n=e.view,r=n.document,i=r.selection,o=i.getSelectedElement();if(o&&Nb(o)){var a=e.mapper.toModelElement(o.parent);return t.change(function(t){t.setSelection(t.createRangeIn(a))}),!0}return!1}},{key:"_setSelectionOverElement",value:function(t){this.editor.model.change(function(e){e.setSelection(e.createRangeOn(t))})}},{key:"_getObjectElementNextToSelection",value:function(t){var e=this.editor.model,n=e.schema,r=e.document.selection,i=e.createSelection(r);e.modifySelection(i,{direction:t?"forward":"backward"});var o=t?i.focus.nodeBefore:i.focus.nodeAfter;return o&&n.isObject(o)?o:null}},{key:"_clearPreviouslySelectedWidgets",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=P()(this._previouslySelected);!(e=(i=o.next()).done);e=!0){var a=i.value;t.removeClass(Pb,a)}}catch(s){n=!0,r=s}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}this._previouslySelected.clear()}}],[{key:"pluginName",get:function(){return"Widget"}}]),e}(Gy);function rw(t){return t==ec.arrowright||t==ec.arrowleft||t==ec.arrowup||t==ec.arrowdown}function iw(t){return nc(t)==ew}function ow(t){while(t){if(t&&t.is("editableElement")&&!t.is("rootElement"))return!0;t=t.parent}return!1}function aw(t,e){return!!e&&gt()(t.getAncestors()).includes(e)}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var sw=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"refresh",value:function(){var t=this.editor.model.document.selection.getSelectedElement();this.isEnabled=Hb(t),Hb(t)&&t.hasAttribute("alt")?this.value=t.getAttribute("alt"):this.value=!1}},{key:"execute",value:function(t){var e=this.editor.model,n=e.document.selection.getSelectedElement();e.change(function(e){e.setAttribute("alt",t.newValue,n)})}}]),e}(rg),uw=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){this.editor.commands.add("imageTextAlternative",new sw(this.editor))}}]),e}(Gy);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
function cw(t){var e=t.emitter,n=t.activator,r=t.callback,i=t.contextElements;e.listenTo(document,"mousedown",function(t,e){var o=e.target;if(n()){var a=!0,s=!1,u=void 0;try{for(var c,l=P()(i);!(a=(c=l.next()).done);a=!0){var h=c.value;if(h.contains(o))return}}catch(f){s=!0,u=f}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}r()}})}n("d842");
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var lw=function(t){function e(t,n){var r;Object(c["a"])(this,e),r=Object(m["a"])(this,Object(b["a"])(e).call(this,t));var i="ck-input-".concat(Mt()),o="ck-status-".concat(Mt());r.set("label"),r.set("value"),r.set("isReadOnly",!1),r.set("errorText",null),r.set("infoText",null),r.labelView=r._createLabelView(i),r.inputView=r._createInputView(n,i,o),r.statusView=r._createStatusView(o),r.bind("_statusText").to(Object(O["a"])(Object(O["a"])(r)),"errorText",Object(O["a"])(Object(O["a"])(r)),"infoText",function(t,e){return t||e});var a=r.bindTemplate;return r.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-input",a.if("isReadOnly","ck-disabled")]},children:[r.labelView,r.inputView,r.statusView]}),r}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"_createLabelView",value:function(t){var e=new Py(this.locale);return e.for=t,e.bind("text").to(this,"label"),e}},{key:"_createInputView",value:function(t,e,n){var r=this,i=new t(this.locale,n);return i.id=e,i.ariaDesribedById=n,i.bind("value").to(this),i.bind("isReadOnly").to(this),i.bind("hasError").to(this,"errorText",function(t){return!!t}),i.on("input",function(){r.errorText=null}),i}},{key:"_createStatusView",value:function(t){var e=new Iy(this.locale),n=this.bindTemplate;return e.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-input__status",n.if("errorText","ck-labeled-input__status_error"),n.if("_statusText","ck-hidden",function(t){return!t})],id:t},children:[{text:n.to("_statusText")}]}),e}},{key:"select",value:function(){this.inputView.select()}},{key:"focus",value:function(){this.inputView.focus()}}]),e}(Iy),hw=(n("3d1d"),function(t){function e(t){var n;Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),n.set("value"),n.set("id"),n.set("placeholder"),n.set("isReadOnly",!1),n.set("hasError",!1),n.set("ariaDesribedById");var r=n.bindTemplate;return n.setTemplate({tag:"input",attributes:{type:"text",class:["ck","ck-input","ck-input-text",r.if("hasError","ck-error")],id:r.to("id"),placeholder:r.to("placeholder"),readonly:r.to("isReadOnly"),"aria-invalid":r.if("hasError",!0),"aria-describedby":r.to("ariaDesribedById")},on:{input:r.to("input")}}),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"render",value:function(){var t=this;S(Object(b["a"])(e.prototype),"render",this).call(this);var n=function(e){t.element.value=e||0===e?e:""};n(this.value),this.on("change:value",function(t,e,r){n(r)})}},{key:"select",value:function(){this.element.select()}},{key:"focus",value:function(){this.element.focus()}}]),e}(Iy));
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
function fw(t){var e=t.view;e.listenTo(e.element,"submit",function(t,n){n.preventDefault(),e.fire("submit")},{useCapture:!0})}var dw=n("18ce"),pw=n.n(dw),vw=n("8ef8"),yw=n.n(vw),gw=(n("6649"),function(t){function e(t){var n;Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t));var r=n.locale.t;return n.focusTracker=new Hv,n.keystrokes=new Nv,n.labeledInput=n._createLabeledInputView(),n.saveButtonView=n._createButton(r("Save"),pw.a,"ck-button-save"),n.saveButtonView.type="submit",n.cancelButtonView=n._createButton(r("Cancel"),yw.a,"ck-button-cancel","cancel"),n._focusables=new Xv,n._focusCycler=new Fy({focusables:n._focusables,focusTracker:n.focusTracker,keystrokeHandler:n.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),n.setTemplate({tag:"form",attributes:{class:["ck","ck-text-alternative-form"],tabindex:"-1"},children:[n.labeledInput,n.saveButtonView,n.cancelButtonView]}),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"render",value:function(){var t=this;S(Object(b["a"])(e.prototype),"render",this).call(this),this.keystrokes.listenTo(this.element),fw({view:this}),[this.labeledInput,this.saveButtonView,this.cancelButtonView].forEach(function(e){t._focusables.add(e),t.focusTracker.add(e.element)})}},{key:"_createButton",value:function(t,e,n,r){var i=new um(this.locale);return i.set({label:t,icon:e,tooltip:!0}),i.extendTemplate({attributes:{class:n}}),r&&i.delegate("execute").to(this,r),i}},{key:"_createLabeledInputView",value:function(){var t=this.locale.t,e=new lw(this.locale,hw);return e.label=t("Text alternative"),e.inputView.placeholder=t("Text alternative"),e}}]),e}(Iy));
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
function mw(t){while(t&&"html"!=t.tagName.toLowerCase()){if("static"!=nl.window.getComputedStyle(t).position)return t;t=t.parentElement}return null}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function bw(t){var e=t.element,n=t.target,r=t.positions,i=t.limiter,o=t.fitInViewport;Be(n)&&(n=n()),Be(i)&&(i=i());var a,s,u=mw(e.parentElement),c=new Jh(e),l=new Jh(n);if(i||o){var h=i&&new Jh(i).getVisible(),f=o&&new Jh(nl.window),d=_w(r,l,c,h,f)||ww(r[0],l,c),p=Ot(d,2);s=p[0],a=p[1]}else{var v=ww(r[0],l,c),y=Ot(v,2);s=y[0],a=y[1]}var g=kw(a),m=g.left,b=g.top;if(u){var w=kw(new Jh(u)),_=Yh(u);m-=w.left,b-=w.top,m+=u.scrollLeft,b+=u.scrollTop,m-=_.left,b-=_.top}return{left:m,top:b,name:s}}function ww(t,e,n){var r=t(e,n),i=r.left,o=r.top,a=r.name;return[a,n.clone().moveTo(i,o)]}function _w(t,e,n,r,i){var o,a,s=0,u=0,c=n.getArea();return t.some(function(t){var l,h,f=ww(t,e,n),d=Ot(f,2),p=d[0],v=d[1];if(r)if(i){var y=r.getIntersection(i);l=y?y.getIntersectionArea(v):0}else l=r.getIntersectionArea(v);function g(){u=h,s=l,o=v,a=p}return i&&(h=i.getIntersectionArea(v)),i&&!r?h>u&&g():!i&&r?l>s&&g():h>u&&l>=s?g():h>=u&&l>s&&g(),l===c}),o?[a,o]:null}function kw(t){var e=t.left,n=t.top,r=nl.window,i=r.scrollX,o=r.scrollY;return{left:e+i,top:n+o}}n("1af3");
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Ew=jy("px"),Tw=nl.document.body,Sw=function(t){function e(t){var n;Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t));var r=n.bindTemplate;return n.set("top",0),n.set("left",0),n.set("position","arrow_nw"),n.set("isVisible",!1),n.set("withArrow",!0),n.set("className"),n.content=n.createCollection(),n.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-panel",r.to("position",function(t){return"ck-balloon-panel_".concat(t)}),r.if("isVisible","ck-balloon-panel_visible"),r.if("withArrow","ck-balloon-panel_with-arrow"),r.to("className")],style:{top:r.to("top",Ew),left:r.to("left",Ew)}},children:n.content}),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"show",value:function(){this.isVisible=!0}},{key:"hide",value:function(){this.isVisible=!1}},{key:"attachTo",value:function(t){this.show();var n=e.defaultPositions,r=Oc()({},{element:this.element,positions:[n.southArrowNorth,n.southArrowNorthWest,n.southArrowNorthEast,n.northArrowSouth,n.northArrowSouthWest,n.northArrowSouthEast],limiter:Tw,fitInViewport:!0},t),i=e._getOptimalPosition(r),o=i.top,a=i.left,s=i.name;Oc()(this,{top:o,left:a,position:s})}},{key:"pin",value:function(t){var e=this;this.unpin(),this._pinWhenIsVisibleCallback=function(){e.isVisible?e._startPinning(t):e._stopPinning()},this._startPinning(t),this.listenTo(this,"change:isVisible",this._pinWhenIsVisibleCallback)}},{key:"unpin",value:function(){this._pinWhenIsVisibleCallback&&(this._stopPinning(),this.stopListening(this,"change:isVisible",this._pinWhenIsVisibleCallback),this._pinWhenIsVisibleCallback=null,this.hide())}},{key:"_startPinning",value:function(t){var e=this;this.attachTo(t);var n=Cw(t.target),r=t.limiter?Cw(t.limiter):Tw;this.listenTo(nl.document,"scroll",function(i,o){var a=o.target,s=n&&a.contains(n),u=r&&a.contains(r);!s&&!u&&n&&r||e.attachTo(t)},{useCapture:!0}),this.listenTo(nl.window,"resize",function(){e.attachTo(t)})}},{key:"_stopPinning",value:function(){this.stopListening(nl.document,"scroll"),this.stopListening(nl.window,"resize")}}]),e}(Iy);function Cw(t){return sl(t)?t:zh(t)?t.commonAncestorContainer:"function"==typeof t?Cw(t()):null}function Ow(t,e){return t.top-e.height-Sw.arrowVerticalOffset}function Aw(t){return t.bottom+Sw.arrowVerticalOffset}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */Sw.arrowHorizontalOffset=25,Sw.arrowVerticalOffset=10,Sw._getOptimalPosition=bw,Sw.defaultPositions={northArrowSouth:function(t,e){return{top:Ow(t,e),left:t.left+t.width/2-e.width/2,name:"arrow_s"}},northArrowSouthEast:function(t,e){return{top:Ow(t,e),left:t.left+t.width/2-e.width+Sw.arrowHorizontalOffset,name:"arrow_se"}},northArrowSouthWest:function(t,e){return{top:Ow(t,e),left:t.left+t.width/2-Sw.arrowHorizontalOffset,name:"arrow_sw"}},northWestArrowSouth:function(t,e){return{top:Ow(t,e),left:t.left-e.width/2,name:"arrow_s"}},northWestArrowSouthWest:function(t,e){return{top:Ow(t,e),left:t.left-Sw.arrowHorizontalOffset,name:"arrow_sw"}},northWestArrowSouthEast:function(t,e){return{top:Ow(t,e),left:t.left-e.width+Sw.arrowHorizontalOffset,name:"arrow_se"}},northEastArrowSouth:function(t,e){return{top:Ow(t,e),left:t.right-e.width/2,name:"arrow_s"}},northEastArrowSouthEast:function(t,e){return{top:Ow(t,e),left:t.right-e.width+Sw.arrowHorizontalOffset,name:"arrow_se"}},northEastArrowSouthWest:function(t,e){return{top:Ow(t,e),left:t.right-Sw.arrowHorizontalOffset,name:"arrow_sw"}},southArrowNorth:function(t,e){return{top:Aw(t,e),left:t.left+t.width/2-e.width/2,name:"arrow_n"}},southArrowNorthEast:function(t,e){return{top:Aw(t,e),left:t.left+t.width/2-e.width+Sw.arrowHorizontalOffset,name:"arrow_ne"}},southArrowNorthWest:function(t,e){return{top:Aw(t,e),left:t.left+t.width/2-Sw.arrowHorizontalOffset,name:"arrow_nw"}},southWestArrowNorth:function(t,e){return{top:Aw(t,e),left:t.left-e.width/2,name:"arrow_n"}},southWestArrowNorthWest:function(t,e){return{top:Aw(t,e),left:t.left-Sw.arrowHorizontalOffset,name:"arrow_nw"}},southWestArrowNorthEast:function(t,e){return{top:Aw(t,e),left:t.left-e.width+Sw.arrowHorizontalOffset,name:"arrow_ne"}},southEastArrowNorth:function(t,e){return{top:Aw(t,e),left:t.right-e.width/2,name:"arrow_n"}},southEastArrowNorthEast:function(t,e){return{top:Aw(t,e),left:t.right-e.width+Sw.arrowHorizontalOffset,name:"arrow_ne"}},southEastArrowNorthWest:function(t,e){return{top:Aw(t,e),left:t.right-Sw.arrowHorizontalOffset,name:"arrow_nw"}}};var Iw=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this;this.view=new Sw,this.positionLimiter=function(){var e=t.editor.editing.view,n=e.document,r=n.selection.editableElement;return r?e.domConverter.mapViewToDom(r.root):null},this._stack=new It.a,this.editor.ui.view.body.add(this.view),this.editor.ui.focusTracker.add(this.view.element)}},{key:"hasView",value:function(t){return this._stack.has(t)}},{key:"add",value:function(t){if(this.hasView(t.view))throw new Nt["b"]("contextualballoon-add-view-exist: Cannot add configuration of the same view twice.");this.visibleView&&this.view.content.remove(this.visibleView),this._stack.set(t.view,t),this._show(t)}},{key:"remove",value:function(t){if(!this.hasView(t))throw new Nt["b"]("contextualballoon-remove-view-not-exist: Cannot remove configuration of not existing view.");if(this.visibleView===t){this.view.content.remove(t),this._stack.delete(t);var e=gt()(this._stack.values()).pop();e?this._show(e):this.view.hide()}else this._stack.delete(t)}},{key:"updatePosition",value:function(t){t&&(this._stack.get(this.visibleView).position=t),this.view.pin(this._getBalloonPosition())}},{key:"_show",value:function(t){var e=t.view,n=t.balloonClassName,r=void 0===n?"":n;this.view.className=r,this.view.content.add(e),this.view.pin(this._getBalloonPosition())}},{key:"_getBalloonPosition",value:function(){var t=gt()(this._stack.values()).pop().position;return t&&!t.limiter&&(t=Oc()({},t,{limiter:this.positionLimiter})),t}},{key:"visibleView",get:function(){var t=this._stack.get(this.view.content.get(0));return t?t.view:null}}],[{key:"pluginName",get:function(){return"ContextualBalloon"}}]),e}(Gy),xw=n("546e"),Pw=n.n(xw);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
function Nw(t){var e=t.plugins.get("ContextualBalloon");if(Kb(t.editing.view.document.selection)){var n=Rw(t);e.updatePosition(n)}}function Rw(t){var e=t.editing.view,n=Sw.defaultPositions;return{target:e.domConverter.viewToDom(e.document.selection.getSelectedElement()),positions:[n.northArrowSouth,n.northArrowSouthWest,n.northArrowSouthEast,n.southArrowNorth,n.southArrowNorthWest,n.southArrowNorthEast]}}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Dw=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){this._createButton(),this._createForm()}},{key:"_createButton",value:function(){var t=this,e=this.editor,n=e.t;e.ui.componentFactory.add("imageTextAlternative",function(r){var i=e.commands.get("imageTextAlternative"),o=new um(r);return o.set({label:n("Change image text alternative"),icon:Pw.a,tooltip:!0}),o.bind("isEnabled").to(i,"isEnabled"),t.listenTo(o,"execute",function(){return t._showForm()}),o})}},{key:"_createForm",value:function(){var t=this,e=this.editor,n=e.editing.view,r=n.document;this._balloon=this.editor.plugins.get("ContextualBalloon"),this._form=new gw(e.locale),this._form.render(),this.listenTo(this._form,"submit",function(){e.execute("imageTextAlternative",{newValue:t._form.labeledInput.inputView.element.value}),t._hideForm(!0)}),this.listenTo(this._form,"cancel",function(){t._hideForm(!0)}),this._form.keystrokes.set("Esc",function(e,n){t._hideForm(!0),n()}),this.listenTo(e.ui,"update",function(){Kb(r.selection)?t._isVisible&&Nw(e):t._hideForm(!0)}),cw({emitter:this._form,activator:function(){return t._isVisible},contextElements:[this._form.element],callback:function(){return t._hideForm()}})}},{key:"_showForm",value:function(){if(!this._isVisible){var t=this.editor,e=t.commands.get("imageTextAlternative"),n=this._form.labeledInput;this._balloon.hasView(this._form)||this._balloon.add({view:this._form,position:Rw(t)}),n.value=n.inputView.element.value=e.value||"",this._form.labeledInput.select()}}},{key:"_hideForm",value:function(t){this._isVisible&&(this._balloon.remove(this._form),t&&this.editor.editing.view.focus())}},{key:"_isVisible",get:function(){return this._balloon.visibleView==this._form}}],[{key:"requires",get:function(){return[Iw]}}]),e}(Gy),jw=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,null,[{key:"requires",get:function(){return[uw,Dw]}},{key:"pluginName",get:function(){return"ImageTextAlternative"}}]),e}(Gy),Mw=(n("92bd"),function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,null,[{key:"requires",get:function(){return[$b,nw,jw]}},{key:"pluginName",get:function(){return"Image"}}]),e}(Gy)),Lw=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),n.buttonView=new um(t),n._fileInputView=new Fw(t),n._fileInputView.bind("acceptedType").to(Object(O["a"])(Object(O["a"])(n))),n._fileInputView.bind("allowMultipleFiles").to(Object(O["a"])(Object(O["a"])(n))),n._fileInputView.delegate("done").to(Object(O["a"])(Object(O["a"])(n))),n.setTemplate({tag:"span",attributes:{class:"ck-file-dialog-button"},children:[n.buttonView,n._fileInputView]}),n.buttonView.on("execute",function(){n._fileInputView.open()}),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"focus",value:function(){this.buttonView.focus()}}]),e}(Iy),Fw=function(t){function e(t){var n;Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),n.set("acceptedType"),n.set("allowMultipleFiles",!1);var r=n.bindTemplate;return n.setTemplate({tag:"input",attributes:{class:["ck-hidden"],type:"file",tabindex:"-1",accept:r.to("acceptedType"),multiple:r.to("allowMultipleFiles")},on:{change:r.to(function(){n.element&&n.element.files&&n.element.files.length&&n.fire("done",n.element.files),n.element.value=""})}}),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"open",value:function(){this.element.click()}}]),e}(Iy),Vw=n("1414"),Bw=n.n(Vw);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
function Uw(t){var e=/^image\/(jpeg|png|gif|bmp)$/;return e.test(t.type)}function qw(t){return new a.a(function(e){fetch(t.getAttribute("src")).then(function(t){return t.blob()}).then(function(n){var r=Kw(n,t.getAttribute("src")),i=r.replace("image/",""),o="image.".concat(i),a=Hw(n,o,r);e({image:t,file:a})}).catch(function(){e({image:t,file:null})})})}function Ww(t){return!(!t.is("element","img")||!t.getAttribute("src"))&&(t.getAttribute("src").match(/^data:image\/\w+;base64,/g)||t.getAttribute("src").match(/^blob:/g))}function Kw(t,e){return t.type?t.type:e.match(/data:(image\/\w+);base64/)?e.match(/data:(image\/\w+);base64/)[1].toLowerCase():"image/jpeg"}function Hw(t,e,n){try{return new File([t],e,{type:n})}catch(r){return null}}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var zw=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this.editor,e=t.t;t.ui.componentFactory.add("imageUpload",function(n){var r=new Lw(n),i=t.commands.get("imageUpload");return r.set({acceptedType:"image/*",allowMultipleFiles:!0}),r.buttonView.set({label:e("Insert image"),icon:Bw.a,tooltip:!0}),r.buttonView.bind("isEnabled").to(i),r.on("done",function(e,n){var r=gt()(n).filter(Uw);r.length&&t.execute("imageUpload",{file:r})}),r})}}]),e}(Gy),Gw=n("3879"),Qw=n.n(Gw),Yw=(n("8030"),n("bcf9"),n("5f69"),function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),n.placeholder="data:image/svg+xml;utf8,"+encodeURIComponent(Qw.a),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this,e=this.editor;e.editing.downcastDispatcher.on("attribute:uploadStatus:image",function(){return t.uploadStatusChange.apply(t,arguments)})}},{key:"uploadStatusChange",value:function(t,e,n){var r=this.editor,i=e.item,o=i.getAttribute("uploadId");if(n.consumable.consume(e.item,t.name)){var a=r.plugins.get(mm),s=o?e.attributeNewValue:null,u=this.placeholder,c=r.editing.mapper.toViewElement(i),l=n.writer;if("reading"==s)return $w(c,l),void t_(u,c,l);if("uploading"==s){var h=a.loaders.get(o);return $w(c,l),void(h?(e_(c,l),n_(c,l,h,r.editing.view)):t_(u,c,l))}"complete"==s&&a.loaders.get(o)&&!Yu.isEdge&&i_(c,l,r.editing.view),r_(c,l),e_(c,l),Zw(c,l)}}}]),e}(Gy)),Xw=ft()("progress-bar"),Jw=ft()("placeholder");function $w(t,e){t.hasClass("ck-appear")||e.addClass("ck-appear",t)}function Zw(t,e){e.removeClass("ck-appear",t)}function t_(t,e,n){e.hasClass("ck-image-upload-placeholder")||n.addClass("ck-image-upload-placeholder",e);var r=e.getChild(0);r.getAttribute("src")!==t&&n.setAttribute("src",t,r),s_(e,Jw)||n.insert(n.createPositionAfter(r),a_(n))}function e_(t,e){t.hasClass("ck-image-upload-placeholder")&&e.removeClass("ck-image-upload-placeholder",t),u_(t,e,Jw)}function n_(t,e,n,r){var i=o_(e);e.insert(e.createPositionAt(t,"end"),i),n.on("change:uploadedPercent",function(t,e,n){r.change(function(t){t.setStyle("width",n+"%",i)})})}function r_(t,e){u_(t,e,Xw)}function i_(t,e,n){var r=e.createUIElement("div",{class:"ck-image-upload-complete-icon"});e.insert(e.createPositionAt(t,"end"),r),setTimeout(function(){n.change(function(t){return t.remove(t.createRangeOn(r))})},3e3)}function o_(t){var e=t.createUIElement("div",{class:"ck-progress-bar"});return t.setCustomProperty(Xw,!0,e),e}function a_(t){var e=t.createUIElement("div",{class:"ck-upload-placeholder-loader"});return t.setCustomProperty(Jw,!0,e),e}function s_(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=P()(t.getChildren());!(n=(o=a.next()).done);n=!0){var s=o.value;if(s.getCustomProperty(e))return s}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}function u_(t,e,n){var r=s_(t,n);r&&e.remove(e.createRangeOn(r))}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var c_=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){this.on("show:warning",function(t,e){window.alert(e.message)},{priority:"lowest"})}},{key:"showSuccess",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._showNotification({message:t,type:"success",namespace:e.namespace,title:e.title})}},{key:"showInfo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._showNotification({message:t,type:"info",namespace:e.namespace,title:e.title})}},{key:"showWarning",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._showNotification({message:t,type:"warning",namespace:e.namespace,title:e.title})}},{key:"_showNotification",value:function(t){var e="show:".concat(t.type)+(t.namespace?":".concat(t.namespace):"");this.fire(e,{message:t.message,type:t.type,title:t.title||""})}}],[{key:"pluginName",get:function(){return"Notification"}}]),e}(Gy),l_=function(){function t(){Object(c["a"])(this,t)}return Object(l["a"])(t,[{key:"createDocumentFragment",value:function(t){return new hc(t)}},{key:"createElement",value:function(t,e,n){return new Ps(t,e,n)}},{key:"createText",value:function(t){return new bs(t)}},{key:"clone",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t._clone(e)}},{key:"appendChild",value:function(t,e){return e._appendChild(t)}},{key:"insertChild",value:function(t,e,n){return n._insertChild(t,e)}},{key:"removeChildren",value:function(t,e,n){return n._removeChildren(t,e)}},{key:"remove",value:function(t){var e=t.parent;return e?this.removeChildren(e.getChildIndex(t),1,e):[]}},{key:"replace",value:function(t,e){var n=t.parent;if(n){var r=n.getChildIndex(t);return this.removeChildren(r,1,n),this.insertChild(r,e,n),!0}return!1}},{key:"rename",value:function(t,e){var n=new Ps(t,e.getAttributes(),e.getChildren());return this.replace(e,n)?n:null}},{key:"setAttribute",value:function(t,e,n){n._setAttribute(t,e)}},{key:"removeAttribute",value:function(t,e){e._removeAttribute(t)}},{key:"addClass",value:function(t,e){e._addClass(t)}},{key:"removeClass",value:function(t,e){e._removeClass(t)}},{key:"setStyle",value:function(t,e,n){ct(t)&&void 0===n&&(n=e),n._setStyle(t,e)}},{key:"removeStyle",value:function(t,e){e._removeStyle(t)}},{key:"setCustomProperty",value:function(t,e,n){n._setCustomProperty(t,e)}},{key:"removeCustomProperty",value:function(t,e){return e._removeCustomProperty(t)}},{key:"createPositionAt",value:function(t,e){return Pu._createAt(t,e)}},{key:"createPositionAfter",value:function(t){return Pu._createAfter(t)}},{key:"createPositionBefore",value:function(t){return Pu._createBefore(t)}},{key:"createRange",value:function(t,e){return new Nu(t,e)}},{key:"createRangeOn",value:function(t){return Nu._createOn(t)}},{key:"createRangeIn",value:function(t){return Nu._createIn(t)}},{key:"createSelection",value:function(t,e,n){return new ju(t,e,n)}}]),t}(),h_=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"refresh",value:function(){this.isEnabled=Gb(this.editor.model)}},{key:"execute",value:function(t){var e=this.editor,n=e.model,r=e.plugins.get(mm);n.change(function(e){var i=pt()(t.file)?t.file:[t.file],o=!0,a=!1,s=void 0;try{for(var u,c=P()(i);!(o=(u=c.next()).done);o=!0){var l=u.value;f_(e,n,r,l)}}catch(h){a=!0,s=h}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}})}}]),e}(rg);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function f_(t,e,n,r){var i=n.createLoader(r);i&&zb(t,e,{uploadId:i.id})}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var d_=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this,e=this.editor,n=e.model.document,r=e.model.schema,i=e.conversion,o=e.plugins.get(mm);r.extend("image",{allowAttributes:["uploadId","uploadStatus"]}),e.commands.add("imageUpload",new h_(e)),i.for("upcast").add(Kd({view:{name:"img",key:"uploadId"},model:"uploadId"})),this.listenTo(e.editing.view.document,"clipboardInput",function(t,n){if(!p_(n.dataTransfer)){var r=gt()(n.dataTransfer.files).filter(function(t){return!!t&&Uw(t)}),i=n.targetRanges.map(function(t){return e.editing.mapper.toModelRange(t)});e.model.change(function(n){n.setSelection(i),r.length&&(t.stop(),e.model.enqueueChange("default",function(){e.execute("imageUpload",{file:r})}))})}}),this.listenTo(e.plugins.get("Clipboard"),"inputTransformation",function(t,n){var r=gt()(e.editing.view.createRangeIn(n.content)).filter(function(t){return Ww(t.item)&&!t.item.getAttribute("uploadProcessed")}).map(function(t){return qw(t.item)});r.length&&(t.stop(),a.a.all(r).then(function(t){var r=new l_,i=!0,a=!1,s=void 0;try{for(var u,c=P()(t);!(i=(u=c.next()).done);i=!0){var l=u.value;if(l.file){r.setAttribute("uploadProcessed",!0,l.image);var h=o.createLoader(l.file);h&&(r.setAttribute("src","",l.image),r.setAttribute("uploadId",h.id,l.image))}else r.remove(l.image)}}catch(f){a=!0,s=f}finally{try{i||null==c.return||c.return()}finally{if(a)throw s}}e.plugins.get("Clipboard").fire("inputTransformation",n)}))}),e.editing.view.document.on("dragover",function(t,e){e.preventDefault()}),n.on("change",function(){var e=n.differ.getChanges({includeChangesInGraveyard:!0}),r=!0,i=!1,a=void 0;try{for(var s,u=P()(e);!(r=(s=u.next()).done);r=!0){var c=s.value;if("insert"==c.type&&"image"==c.name){var l=c.position.nodeAfter,h="$graveyard"==c.position.root.rootName,f=l.getAttribute("uploadId");if(!f)continue;var d=o.loaders.get(f);if(!d)continue;h?d.abort():"idle"==d.status&&t._readAndUpload(d,l)}}}catch(p){i=!0,a=p}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}})}},{key:"_readAndUpload",value:function(t,e){var n=this,r=this.editor,i=r.model,o=r.locale.t,a=r.plugins.get(mm),s=r.plugins.get(c_);return i.enqueueChange("transparent",function(t){t.setAttribute("uploadStatus","reading",e)}),t.read().then(function(n){var o=r.editing.mapper.toViewElement(e),a=o.getChild(0),s=t.upload();return r.editing.view.change(function(t){t.setAttribute("src",n,a)}),i.enqueueChange("transparent",function(t){t.setAttribute("uploadStatus","uploading",e)}),s}).then(function(t){i.enqueueChange("transparent",function(r){r.setAttributes({uploadStatus:"complete",src:t.default},e),n._parseAndSetSrcsetAttributeOnImage(t,e,r)}),u()}).catch(function(n){if("error"!==t.status&&"aborted"!==t.status)throw n;"error"==t.status&&s.showWarning(n,{title:o("Upload failed"),namespace:"upload"}),u(),i.enqueueChange("transparent",function(t){t.remove(e)})});function u(){i.enqueueChange("transparent",function(t){t.removeAttribute("uploadId",e),t.removeAttribute("uploadStatus",e)}),a.destroyLoader(t)}}},{key:"_parseAndSetSrcsetAttributeOnImage",value:function(t,e,n){var r=0,i=I()(t).filter(function(t){var e=Qh()(t,10);if(!isNaN(e))return r=Math.max(r,e),!0}).map(function(e){return"".concat(t[e]," ").concat(e,"w")}).join(", ");""!=i&&n.setAttribute("srcset",{data:i,width:r},e)}}],[{key:"requires",get:function(){return[mm,c_]}}]),e}(Gy);function p_(t){return gt()(t.types).includes("text/html")&&""!==t.getData("text/html")}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var v_=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,null,[{key:"pluginName",get:function(){return"ImageUpload"}},{key:"requires",get:function(){return[d_,zw,Yw]}}]),e}(Gy),y_=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,null,[{key:"requires",get:function(){return[yb,Mw,v_]}},{key:"pluginName",get:function(){return"EasyImage"}}]),e}(Gy),g_=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"refresh",value:function(){var t=this.editor.model,e=t.document,n=Ym(e.selection.getSelectedBlocks());this.value=!!n&&n.is("paragraph"),this.isEnabled=!!n&&m_(n,t.schema)}},{key:"execute",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.editor.model,n=e.document;e.change(function(r){var i=(t.selection||n.selection).getSelectedBlocks(),o=!0,a=!1,s=void 0;try{for(var u,c=P()(i);!(o=(u=c.next()).done);o=!0){var l=u.value;!l.is("paragraph")&&m_(l,e.schema)&&r.rename(l,"paragraph")}}catch(h){a=!0,s=h}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}})}}]),e}(rg);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function m_(t,e){return e.checkChild(t.parent,"paragraph")&&!e.isObject(t)}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var b_=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this,n=this.editor,r=n.model,i=n.data;n.commands.add("paragraph",new g_(n)),r.schema.register("paragraph",{inheritAllFrom:"$block"}),n.conversion.elementToElement({model:"paragraph",view:"p"}),i.upcastDispatcher.on("element",function(t,n,r){var i=r.writer;if(r.consumable.test(n.viewItem,{name:n.viewItem.name}))if(e.paragraphLikeElements.has(n.viewItem.name)){if(n.viewItem.isEmpty)return;var o=i.createElement("paragraph"),a=r.splitToAllowedParent(o,n.modelCursor);if(!a)return;i.insert(o,a.position);var s=r.convertChildren(n.viewItem,i.createPositionAt(o,0)),u=s.modelRange;n.modelRange=i.createRange(i.createPositionBefore(o),u.end),n.modelCursor=n.modelRange.end}else __(n.viewItem,n.modelCursor,r.schema)&&(n=Oc()(n,w_(n.viewItem,n.modelCursor,r)))},{priority:"low"}),i.upcastDispatcher.on("text",function(t,e,n){e.modelRange||__(e.viewItem,e.modelCursor,n.schema)&&(e=Oc()(e,w_(e.viewItem,e.modelCursor,n)))},{priority:"lowest"}),r.document.registerPostFixer(function(e){return t._autoparagraphEmptyRoots(e)}),n.on("dataReady",function(){r.enqueueChange("transparent",function(e){return t._autoparagraphEmptyRoots(e)})},{priority:"lowest"})}},{key:"_autoparagraphEmptyRoots",value:function(t){var e=this.editor.model,n=!0,r=!1,i=void 0;try{for(var o,a=P()(e.document.getRootNames());!(n=(o=a.next()).done);n=!0){var s=o.value,u=e.document.getRoot(s);if(u.isEmpty&&"$graveyard"!=u.rootName&&e.schema.checkChild(u,"paragraph"))return t.insertElement("paragraph",u),!0}}catch(c){r=!0,i=c}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}}],[{key:"pluginName",get:function(){return"Paragraph"}}]),e}(Gy);function w_(t,e,n){var r=n.writer.createElement("paragraph");return n.writer.insert(r,e),n.convertItem(t,n.writer.createPositionAt(r,0))}function __(t,e,n){var r=n.createContext(e);return!!n.checkChild(r,"paragraph")&&!!n.checkChild(r.push("paragraph"),t)}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */b_.paragraphLikeElements=new Pt.a(["blockquote","dd","div","dt","h1","h2","h3","h4","h5","h6","li","p","td"]);var k_=function(t){function e(t,n){var r;return Object(c["a"])(this,e),r=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),r.modelElements=n,r}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"refresh",value:function(){var t=this,e=Ym(this.editor.model.document.selection.getSelectedBlocks());this.value=!!e&&this.modelElements.includes(e.name)&&e.name,this.isEnabled=!!e&&this.modelElements.some(function(n){return E_(e,n,t.editor.model.schema)})}},{key:"execute",value:function(t){var e=this.editor.model,n=e.document,r=t.value;e.change(function(t){var i=gt()(n.selection.getSelectedBlocks()).filter(function(t){return E_(t,r,e.schema)}),o=!0,a=!1,s=void 0;try{for(var u,c=P()(i);!(o=(u=c.next()).done);o=!0){var l=u.value;l.is(r)||t.rename(l,r)}}catch(h){a=!0,s=h}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}})}}]),e}(rg);function E_(t,e,n){return n.checkChild(t.parent,e)&&!n.isObject(t)}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var T_="paragraph",S_=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),t.config.define("heading",{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h2",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h3",title:"Heading 2",class:"ck-heading_heading2"},{model:"heading3",view:"h4",title:"Heading 3",class:"ck-heading_heading3"}]}),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this.editor,e=t.config.get("heading.options"),n=[],r=!0,i=!1,o=void 0;try{for(var a,s=P()(e);!(r=(a=s.next()).done);r=!0){var u=a.value;u.model!==T_&&(t.model.schema.register(u.model,{inheritAllFrom:"$block"}),t.conversion.elementToElement(u),n.push(u.model))}}catch(c){i=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}this._addDefaultH1Conversion(t),t.commands.add("heading",new k_(t,n))}},{key:"afterInit",value:function(){var t=this.editor,e=t.commands.get("enter"),n=t.config.get("heading.options");e&&this.listenTo(e,"afterExecute",function(e,r){var i=t.model.document.selection.getFirstPosition().parent,o=n.some(function(t){return i.is(t.model)});o&&!i.is(T_)&&0===i.childCount&&r.writer.rename(i,T_)})}},{key:"_addDefaultH1Conversion",value:function(t){t.conversion.for("upcast").add(qd({model:"heading1",view:"h1",converterPriority:Ft.get("low")+1}))}}],[{key:"requires",get:function(){return[b_]}}]),e}(Gy),C_=function t(e,n){Object(c["a"])(this,t),n&&lu(this,n),e&&this.set(e)};oe(C_,vu);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
var O_=function(t){function e(t){var n;Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t));var r=n.bindTemplate;return n.set("isVisible",!1),n.set("position","se"),n.children=n.createCollection(),n.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-dropdown__panel",r.to("position",function(t){return"ck-dropdown__panel_".concat(t)}),r.if("isVisible","ck-dropdown__panel-visible")]},children:n.children,on:{selectstart:r.to(function(t){return t.preventDefault()})}}),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"focus",value:function(){this.children.length&&this.children.first.focus()}},{key:"focusLast",value:function(){if(this.children.length){var t=this.children.last;"function"===typeof t.focusLast?t.focusLast():t.focus()}}}]),e}(Iy),A_=(n("0a06"),function(t){function e(t,n,r){var i;Object(c["a"])(this,e),i=Object(m["a"])(this,Object(b["a"])(e).call(this,t));var o=i.bindTemplate;return i.buttonView=n,i.panelView=r,i.set("isOpen",!1),i.set("isEnabled",!0),i.set("class"),i.set("panelPosition","auto"),i.focusTracker=new Hv,i.keystrokes=new Nv,i.setTemplate({tag:"div",attributes:{class:["ck","ck-dropdown",o.to("class"),o.if("isEnabled","ck-disabled",function(t){return!t})]},children:[n,r]}),n.extendTemplate({attributes:{class:["ck-dropdown__button"]}}),i}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"render",value:function(){var t=this;S(Object(b["a"])(e.prototype),"render",this).call(this),this.listenTo(this.buttonView,"open",function(){t.isOpen=!t.isOpen}),this.panelView.bind("isVisible").to(this,"isOpen"),this.on("change:isOpen",function(){if(t.isOpen)if("auto"===t.panelPosition){var n=e.defaultPanelPositions;t.panelView.position=bw({element:t.panelView.element,target:t.buttonView.element,fitInViewport:!0,positions:[n.southEast,n.southWest,n.northEast,n.northWest]}).name}else t.panelView.position=t.panelPosition}),this.keystrokes.listenTo(this.element),this.focusTracker.add(this.element);var n=function(e,n){t.isOpen&&(t.buttonView.focus(),t.isOpen=!1,n())};this.keystrokes.set("arrowdown",function(e,n){t.buttonView.isEnabled&&!t.isOpen&&(t.isOpen=!0,n())}),this.keystrokes.set("arrowright",function(e,n){t.isOpen&&n()}),this.keystrokes.set("arrowleft",n),this.keystrokes.set("esc",n)}},{key:"focus",value:function(){this.buttonView.focus()}}]),e}(Iy));A_.defaultPanelPositions={southEast:function(t){return{top:t.bottom,left:t.left,name:"se"}},southWest:function(t,e){return{top:t.bottom,left:t.left-e.width+t.width,name:"sw"}},northEast:function(t,e){return{top:t.top-e.height,left:t.left,name:"ne"}},northWest:function(t,e){return{top:t.bottom-e.height,left:t.left-e.width+t.width,name:"nw"}}};var I_=n("4ca4"),x_=n.n(I_),P_=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),n.arrowView=n._createArrowView(),n.extendTemplate({attributes:{"aria-haspopup":!0}}),n.delegate("execute").to(Object(O["a"])(Object(O["a"])(n)),"open"),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"render",value:function(){S(Object(b["a"])(e.prototype),"render",this).call(this),this.children.add(this.arrowView)}},{key:"_createArrowView",value:function(){var t=new am;return t.content=x_.a,t.extendTemplate({attributes:{class:"ck-dropdown__arrow"}}),t}}]),e}(um),N_=(n("3a7f"),function(t){function e(){var t;return Object(c["a"])(this,e),t=Object(m["a"])(this,Object(b["a"])(e).call(this)),t.items=t.createCollection(),t.focusTracker=new Hv,t.keystrokes=new Nv,t._focusCycler=new Fy({focusables:t.items,focusTracker:t.focusTracker,keystrokeHandler:t.keystrokes,actions:{focusPrevious:"arrowup",focusNext:"arrowdown"}}),t.setTemplate({tag:"ul",attributes:{class:["ck","ck-reset","ck-list"]},children:t.items}),t}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"render",value:function(){var t=this;S(Object(b["a"])(e.prototype),"render",this).call(this);var n=!0,r=!1,i=void 0;try{for(var o,a=P()(this.items);!(n=(o=a.next()).done);n=!0){var s=o.value;this.focusTracker.add(s.element)}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}this.items.on("add",function(e,n){t.focusTracker.add(n.element)}),this.items.on("remove",function(e,n){t.focusTracker.remove(n.element)}),this.keystrokes.listenTo(this.element)}},{key:"focus",value:function(){this._focusCycler.focusFirst()}},{key:"focusLast",value:function(){this._focusCycler.focusLast()}}]),e}(Iy)),R_=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),n.children=n.createCollection(),n.setTemplate({tag:"li",attributes:{class:["ck","ck-list__item"]},children:n.children}),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"focus",value:function(){this.children.first.focus()}}]),e}(Iy),D_=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),n.setTemplate({tag:"li",attributes:{class:["ck","ck-list__separator"]}}),n}return Object(C["a"])(e,t),e}(Iy),j_=(n("ff23"),function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),n.toggleSwitchView=n._createToggleView(),n.extendTemplate({attributes:{class:"ck-switchbutton"}}),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"render",value:function(){S(Object(b["a"])(e.prototype),"render",this).call(this),this.children.add(this.toggleSwitchView)}},{key:"_createToggleView",value:function(){var t=new Iy;return t.setTemplate({tag:"span",attributes:{class:["ck","ck-button__toggle"]},children:[{tag:"span",attributes:{class:["ck","ck-button__toggle__inner"]}}]}),t}}]),e}(um));n("2a21"),n("f5e9");
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
function M_(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:P_,n=new e(t),r=new O_(t),i=new A_(t,n,r);return n.bind("isEnabled").to(i),n instanceof P_?n.bind("isOn").to(i,"isOpen"):n.arrowView.bind("isOn").to(i,"isOpen"),V_(i),i}function L_(t,e){var n=t.toolbarView=new qy;t.extendTemplate({attributes:{class:["ck-toolbar-dropdown"]}}),e.map(function(t){return n.items.add(t)}),t.panelView.children.add(n),n.items.delegate("execute").to(t)}function F_(t,e){var n=t.locale,r=t.listView=new N_(n);r.items.bindTo(e).using(function(t){var e=t.type,r=t.model;if("separator"===e)return new D_(n);if("button"===e||"switchbutton"===e){var i,o,a=new R_(n);return o="button"===e?new um(n):new j_(n),(i=o).bind.apply(i,kt(I()(r))).to(r),o.delegate("execute").to(a),a.children.add(o),a}}),t.panelView.children.add(r),r.items.delegate("execute").to(t)}function V_(t){B_(t),U_(t),q_(t)}function B_(t){t.on("render",function(){cw({emitter:t,activator:function(){return t.isOpen},callback:function(){t.isOpen=!1},contextElements:[t.element]})})}function U_(t){t.on("execute",function(e){e.source instanceof j_||(t.isOpen=!1)})}function q_(t){t.keystrokes.set("arrowdown",function(e,n){t.isOpen&&(t.panelView.focus(),n())}),t.keystrokes.set("arrowup",function(e,n){t.isOpen&&(t.panelView.focusLast(),n())})}function W_(t){var e=t.t,n={Paragraph:e("Paragraph"),"Heading 1":e("Heading 1"),"Heading 2":e("Heading 2"),"Heading 3":e("Heading 3")};return t.config.get("heading.options").map(function(t){var e=n[t.title];return e&&e!=t.title&&(t=Oc()({},t,{title:e})),t})}n("8b56");
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var K_=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this,e=this.editor,n=e.t,r=W_(e),i=n("Choose heading"),o=n("Heading");e.ui.componentFactory.add("heading",function(n){var a={},s=new Vu,u=e.commands.get("heading"),c=e.commands.get("paragraph"),l=[u],h=!0,f=!1,d=void 0;try{for(var p,v=function(){var t=p.value,e={type:"button",model:new C_({label:t.title,class:t.class,withText:!0})};"paragraph"===t.model?(e.model.bind("isOn").to(c,"value"),e.model.set("commandName","paragraph"),l.push(c)):(e.model.bind("isOn").to(u,"value",function(e){return e===t.model}),e.model.set({commandName:"heading",commandValue:t.model})),s.add(e),a[t.model]=t.title},y=P()(r);!(h=(p=y.next()).done);h=!0)v()}catch(m){f=!0,d=m}finally{try{h||null==y.return||y.return()}finally{if(f)throw d}}var g=M_(n);return F_(g,s),g.buttonView.set({isOn:!1,withText:!0,tooltip:o}),g.extendTemplate({attributes:{class:["ck-heading-dropdown"]}}),g.bind("isEnabled").toMany(l,"isEnabled",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.some(function(t){return t})}),g.buttonView.bind("label").to(u,"value",c,"value",function(t,e){var n=t||e&&"paragraph";return a[n]?a[n]:i}),t.listenTo(g,"execute",function(t){e.execute(t.source.commandName,t.source.commandValue?{value:t.source.commandValue}:void 0),e.editing.view.focus()}),g})}}]),e}(Gy),H_=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,null,[{key:"requires",get:function(){return[S_,K_]}},{key:"pluginName",get:function(){return"Heading"}}]),e}(Gy),z_=(n("507e"),new Fu.a);function G_(t,e,n,r){var i=t.document;z_.has(i)||(z_.set(i,new It.a),i.registerPostFixer(function(t){return Q_(i,t)})),z_.get(i).set(e,{placeholderText:n,checkFunction:r}),t.render()}function Q_(t,e){var n=z_.get(t),r=!1,i=!0,o=!1,a=void 0;try{for(var s,u=P()(n);!(i=(s=u.next()).done);i=!0){var c=Ot(s.value,2),l=c[0],h=c[1];Y_(e,l,h)&&(r=!0)}}catch(f){o=!0,a=f}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}return r}function Y_(t,e,n){var r=e.document,i=n.placeholderText,o=!1;if(!r)return!1;e.getAttribute("data-placeholder")!==i&&(t.setAttribute("data-placeholder",i,e),o=!0);var a=r.selection,s=a.anchor,u=n.checkFunction;if(u&&!u())return e.hasClass("ck-placeholder")&&(t.removeClass("ck-placeholder",e),o=!0),o;var c=!gt()(e.getChildren()).some(function(t){return!t.is("uiElement")});return!r.isFocused&&c?(e.hasClass("ck-placeholder")||(t.addClass("ck-placeholder",e),o=!0),o):(c&&s&&s.parent!==e?e.hasClass("ck-placeholder")||(t.addClass("ck-placeholder",e),o=!0):e.hasClass("ck-placeholder")&&(t.removeClass("ck-placeholder",e),o=!0),o)}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var X_=ft()("imageCaption");function J_(t,e){return function(n){var r=n.createEditableElement("figcaption");return n.setCustomProperty(X_,!0,r),G_(t,r,e),Lb(r,n)}}function $_(t){var e=!0,n=!1,r=void 0;try{for(var i,o=P()(t.getChildren());!(e=(i=o.next()).done);e=!0){var a=i.value;if(a&&a.is("caption"))return a}}catch(s){n=!0,r=s}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return null}function Z_(t){var e=t.parent;return"figcaption"==t.name&&e&&"figure"==e.name&&e.hasClass("image")?{name:!0}:null}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var tk=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this,e=this.editor,n=e.editing.view,r=e.model.schema,i=e.data,o=e.editing,a=e.t;r.register("caption",{allowIn:"image",allowContentOf:"$block",isLimit:!0}),e.model.document.registerPostFixer(function(e){return t._insertMissingModelCaptionElement(e)}),e.conversion.for("upcast").add(qd({view:Z_,model:"caption"}));var s=function(t){return t.createContainerElement("figcaption")};i.downcastDispatcher.on("insert:caption",ek(s,!1));var u=J_(n,a("Enter image caption"));o.downcastDispatcher.on("insert:caption",ek(u)),o.downcastDispatcher.on("insert",this._fixCaptionVisibility(function(t){return t.item}),{priority:"high"}),o.downcastDispatcher.on("remove",this._fixCaptionVisibility(function(t){return t.position.parent}),{priority:"high"}),n.document.registerPostFixer(function(e){return t._updateCaptionVisibility(e)})}},{key:"_updateCaptionVisibility",value:function(t){var e,n=this.editor.editing.mapper,r=this._lastSelectedCaption,i=this.editor.model.document.selection,o=i.getSelectedElement();if(o&&o.is("image")){var a=$_(o);e=n.toViewElement(a)}var s=i.getFirstPosition(),u=rk(s.parent);if(u&&(e=n.toViewElement(u)),e)return r?r===e?ok(e,t):(ik(r,t),this._lastSelectedCaption=e,ok(e,t)):(this._lastSelectedCaption=e,ok(e,t));if(r){var c=ik(r,t);return this._lastSelectedCaption=null,c}return!1}},{key:"_fixCaptionVisibility",value:function(t){var e=this;return function(n,r,i){var o=t(r),a=rk(o),s=e.editor.editing.mapper,u=i.writer;if(a){var c=s.toViewElement(a);c&&(a.childCount?u.removeClass("ck-hidden",c):u.addClass("ck-hidden",c))}}}},{key:"_insertMissingModelCaptionElement",value:function(t){var e=this.editor.model,n=e.document.differ.getChanges(),r=!0,i=!1,o=void 0;try{for(var a,s=P()(n);!(r=(a=s.next()).done);r=!0){var u=a.value;if("insert"==u.type&&"image"==u.name){var c=u.position.nodeAfter;if(!$_(c))return t.appendElement("caption",c),!0}}}catch(l){i=!0,o=l}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}}]),e}(Gy);function ek(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(n,r,i){var o=r.item;if((o.childCount||e)&&Hb(o.parent)){if(!i.consumable.consume(r.item,"insert"))return;var a=i.mapper.toViewElement(r.range.start.parent),s=t(i.writer),u=i.writer;o.childCount||u.addClass("ck-hidden",s),nk(s,r.item,a,i)}}}function nk(t,e,n,r){var i=r.writer.createPositionAt(n,"end");r.writer.insert(i,t),r.mapper.bindElements(e,t)}function rk(t){var e=t.getAncestors({includeSelf:!0}),n=e.find(function(t){return"caption"==t.name});return n&&n.parent&&"image"==n.parent.name?n:null}function ik(t,e){return!t.childCount&&!t.hasClass("ck-hidden")&&(e.addClass("ck-hidden",t),!0)}function ok(t,e){return!!t.hasClass("ck-hidden")&&(e.removeClass("ck-hidden",t),!0)}n("c44c");
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var ak=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,null,[{key:"requires",get:function(){return[tk]}},{key:"pluginName",get:function(){return"ImageCaption"}}]),e}(Gy),sk=function(t){function e(t,n){var r;return Object(c["a"])(this,e),r=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),r._defaultStyle=!1,r.styles=n.reduce(function(t,e){return t[e.name]=e,e.isDefault&&(r._defaultStyle=e.name),t},{}),r}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"refresh",value:function(){var t=this.editor.model.document.selection.getSelectedElement();if(this.isEnabled=Hb(t),t)if(t.hasAttribute("imageStyle")){var e=t.getAttribute("imageStyle");this.value=!!this.styles[e]&&e}else this.value=this._defaultStyle;else this.value=!1}},{key:"execute",value:function(t){var e=this,n=t.value,r=this.editor.model,i=r.document.selection.getSelectedElement();r.change(function(t){e.styles[n].isDefault?t.removeAttribute("imageStyle",i):t.setAttribute("imageStyle",n,i)})}}]),e}(rg);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
function uk(t){return function(e,n,r){if(r.consumable.consume(n.item,e.name)){var i=lk(n.attributeNewValue,t),o=lk(n.attributeOldValue,t),a=r.mapper.toViewElement(n.item),s=r.writer;o&&s.removeClass(o.className,a),i&&s.addClass(i.className,a)}}}function ck(t){var e=t.filter(function(t){return!t.isDefault});return function(t,n,r){if(n.modelRange){var i=n.viewItem,o=Ym(n.modelRange.getItems());if(r.schema.checkAttribute(o,"imageStyle")){var a=!0,s=!1,u=void 0;try{for(var c,l=P()(e);!(a=(c=l.next()).done);a=!0){var h=c.value;r.consumable.consume(i,{classes:h.className})&&r.writer.setAttribute("imageStyle",h.name,o)}}catch(f){s=!0,u=f}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}}}}}function lk(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=P()(e);!(n=(o=a.next()).done);n=!0){var s=o.value;if(s.name===t)return s}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}var hk=n("660d"),fk=n.n(hk),dk=n("1a1b"),pk=n.n(dk),vk=n("0524"),yk=n.n(vk),gk=n("0db1"),mk=n.n(gk),bk={full:{name:"full",title:"Full size image",icon:fk.a,isDefault:!0},side:{name:"side",title:"Side image",icon:mk.a,className:"image-style-side"},alignLeft:{name:"alignLeft",title:"Left aligned image",icon:pk.a,className:"image-style-align-left"},alignCenter:{name:"alignCenter",title:"Centered image",icon:yk.a,className:"image-style-align-center"},alignRight:{name:"alignRight",title:"Right aligned image",icon:mk.a,className:"image-style-align-right"}},wk={full:fk.a,left:pk.a,right:mk.a,center:yk.a};function _k(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map(kk).map(function(t){return Oc()({},t)})}function kk(t){if("string"==typeof t){var e=t;bk[e]?t=Oc()({},bk[e]):(qh["a"].warn("image-style-not-found: There is no such image style of given name.",{name:e}),t={name:e})}else if(bk[t.name]){var n=bk[t.name],r=Oc()({},t);for(var i in n)t.hasOwnProperty(i)||(r[i]=n[i]);t=r}return"string"==typeof t.icon&&wk[t.icon]&&(t.icon=wk[t.icon]),t}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Ek=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this.editor,e=t.model.schema,n=t.data,r=t.editing;t.config.define("image.styles",["full","side"]);var i=_k(t.config.get("image.styles"));e.extend("image",{allowAttributes:"imageStyle"});var o=uk(i);r.downcastDispatcher.on("attribute:imageStyle:image",o),n.downcastDispatcher.on("attribute:imageStyle:image",o),n.upcastDispatcher.on("element:figure",ck(i),{priority:"low"}),t.commands.add("imageStyle",new sk(t,i))}}],[{key:"requires",get:function(){return[$b]}},{key:"pluginName",get:function(){return"ImageStyleEditing"}}]),e}(Gy),Tk=(n("7201"),function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this.editor,e=t.config.get("image.styles"),n=Sk(_k(e),this.localizedDefaultStylesTitles),r=!0,i=!1,o=void 0;try{for(var a,s=P()(n);!(r=(a=s.next()).done);r=!0){var u=a.value;this._createButton(u)}}catch(c){i=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}},{key:"_createButton",value:function(t){var e=this,n=this.editor,r="imageStyle:".concat(t.name);n.ui.componentFactory.add(r,function(r){var i=n.commands.get("imageStyle"),o=new um(r);return o.set({label:t.title,icon:t.icon,tooltip:!0}),o.bind("isEnabled").to(i,"isEnabled"),o.bind("isOn").to(i,"value",function(e){return e===t.name}),e.listenTo(o,"execute",function(){return n.execute("imageStyle",{value:t.name})}),o})}},{key:"localizedDefaultStylesTitles",get:function(){var t=this.editor.t;return{"Full size image":t("Full size image"),"Side image":t("Side image"),"Left aligned image":t("Left aligned image"),"Centered image":t("Centered image"),"Right aligned image":t("Right aligned image")}}}]),e}(Gy));function Sk(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=P()(t);!(n=(o=a.next()).done);n=!0){var s=o.value;e[s.title]&&(s.title=e[s.title])}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Ck=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,null,[{key:"requires",get:function(){return[Ek,Tk]}},{key:"pluginName",get:function(){return"ImageStyle"}}]),e}(Gy),Ok=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this,e=this.editor,n=e.plugins.get("BalloonToolbar");n&&this.listenTo(n,"show",function(t){Pk(e.editing.view.document.selection)&&t.stop()},{priority:"high"}),this._toolbars=new It.a,this._balloon=this.editor.plugins.get("ContextualBalloon"),this.listenTo(e.ui,"update",function(){t._updateToolbarsVisibility()}),this.listenTo(e.ui.focusTracker,"change:isFocused",function(){t._updateToolbarsVisibility()},{priority:"low"})}},{key:"register",value:function(t,e){var n=e.items,r=e.visibleWhen,i=e.balloonClassName,o=void 0===i?"ck-toolbar-container":i,a=this.editor,s=new qy;if(this._toolbars.has(t))throw new Nt["b"]("widget-toolbar-duplicated: Toolbar with the given id was already added.",{toolbarId:t});s.fillFromConfig(n,a.ui.componentFactory),this._toolbars.set(t,{view:s,visibleWhen:r,balloonClassName:o})}},{key:"_updateToolbarsVisibility",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=P()(this._toolbars.values());!(t=(r=i.next()).done);t=!0){var o=r.value;this.editor.ui.focusTracker.isFocused&&o.visibleWhen(this.editor.editing.view.document.selection)?this._showToolbar(o):this._hideToolbar(o)}}catch(a){e=!0,n=a}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}},{key:"_hideToolbar",value:function(t){this._isToolbarVisible(t)&&this._balloon.remove(t.view)}},{key:"_showToolbar",value:function(t){this._isToolbarVisible(t)?Ak(this.editor):this._balloon.hasView(t.view)||this._balloon.add({view:t.view,position:Ik(this.editor),balloonClassName:t.balloonClassName})}},{key:"_isToolbarVisible",value:function(t){return this._balloon.visibleView==t.view}}],[{key:"requires",get:function(){return[Iw]}},{key:"pluginName",get:function(){return"WidgetToolbarRepository"}}]),e}(Gy);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function Ak(t){var e=t.plugins.get("ContextualBalloon"),n=Ik(t);e.updatePosition(n)}function Ik(t){var e=t.editing.view,n=Sw.defaultPositions,r=xk(e.document.selection);return{target:e.domConverter.viewToDom(r),positions:[n.northArrowSouth,n.northArrowSouthWest,n.northArrowSouthEast,n.southArrowNorth,n.southArrowNorthWest,n.southArrowNorthEast]}}function xk(t){var e=t.getSelectedElement();if(e&&Nb(e))return e;var n=t.getFirstPosition(),r=n.parent;while(r){if(r.is("element")&&Nb(r))return r;r=r.parent}}function Pk(t){var e=t.getSelectedElement();return!(!e||!Nb(e))}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Nk=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"afterInit",value:function(){var t=this.editor,e=t.plugins.get(Ok);e.register("image",{items:t.config.get("image.toolbar")||[],visibleWhen:Kb})}}],[{key:"requires",get:function(){return[Ok]}},{key:"pluginName",get:function(){return"ImageToolbar"}}]),e}(Gy);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function Rk(t,e,n){return n.createRange(Dk(t,e,!0,n),Dk(t,e,!1,n))}function Dk(t,e,n,r){var i=t.textNode||(n?t.nodeBefore:t.nodeAfter),o=null;while(i&&i.getAttribute("linkHref")==e)o=i,i=n?i.previousSibling:i.nextSibling;return o?r.createPositionAt(o,n?"before":"after"):t}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var jk=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"refresh",value:function(){var t=this.editor.model,e=t.document;this.value=e.selection.getAttribute("linkHref"),this.isEnabled=t.schema.checkAttributeInSelection(e.selection,"linkHref")}},{key:"execute",value:function(t){var e=this.editor.model,n=e.document.selection;e.change(function(r){if(n.isCollapsed){var i=n.getFirstPosition();if(n.hasAttribute("linkHref")){var o=Rk(n.getFirstPosition(),n.getAttribute("linkHref"),e);r.setAttribute("linkHref",t,o),r.setSelection(o)}else if(""!==t){var a=pf(n.getAttributes());a.set("linkHref",t);var s=r.createText(t,a);r.insert(s,i),r.setSelection(r.createRangeOn(s))}}else{var u=e.schema.getValidRanges(n.getRanges(),"linkHref"),c=!0,l=!1,h=void 0;try{for(var f,d=P()(u);!(c=(f=d.next()).done);c=!0){var p=f.value;r.setAttribute("linkHref",t,p)}}catch(v){l=!0,h=v}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}}})}}]),e}(rg),Mk=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"refresh",value:function(){this.isEnabled=this.editor.model.document.selection.hasAttribute("linkHref")}},{key:"execute",value:function(){var t=this.editor.model,e=t.document.selection;t.change(function(n){var r=e.isCollapsed?[Rk(e.getFirstPosition(),e.getAttribute("linkHref"),t)]:e.getRanges(),i=!0,o=!1,a=void 0;try{for(var s,u=P()(r);!(i=(s=u.next()).done);i=!0){var c=s.value;n.removeAttribute("linkHref",c)}}catch(l){o=!0,a=l}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}})}}]),e}(rg),Lk=ft()("linkElement"),Fk=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Vk=/^(?:(?:https?|ftps?|mailto):|[^a-z]|[a-z+.-]+(?:[^a-z+.:-]|$))/i;
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function Bk(t){return t.is("attributeElement")&&!!t.getCustomProperty(Lk)}function Uk(t,e){var n=e.createAttributeElement("a",{href:t},{priority:5});return e.setCustomProperty(Lk,!0,n),n}function qk(t){return t=String(t),Wk(t)?t:"#"}function Wk(t){var e=t.replace(Fk,"");return e.match(Vk)}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function Kk(t,e,n,r){var i=new Hk(e,n,r),o=e.document.selection;n.listenTo(t.document,"keydown",function(t,e){if(o.isCollapsed&&!(e.shiftKey||e.altKey||e.ctrlKey)){var n=e.keyCode==ec.arrowright,r=e.keyCode==ec.arrowleft;if(n||r){var a,s=o.getFirstPosition();a=n?i.handleForwardMovement(s,e):i.handleBackwardMovement(s,e),a&&t.stop()}}},{priority:Ft.get("high")+1})}var Hk=function(){function t(e,n,r){var i=this;Object(c["a"])(this,t),this.model=e,this.attribute=r,this._modelSelection=e.document.selection,this._overrideUid=null,this._isNextGravityRestorationSkipped=!1,n.listenTo(this._modelSelection,"change:range",function(t,e){i._isNextGravityRestorationSkipped?i._isNextGravityRestorationSkipped=!1:i._isGravityOverridden&&(!e.directChange&&zk(i._modelSelection.getFirstPosition(),r)||i._restoreGravity())})}return Object(l["a"])(t,[{key:"handleForwardMovement",value:function(t,e){var n=this.attribute;if(!this._isGravityOverridden&&(!t.isAtStart||!this._hasSelectionAttribute))return Yk(t,n)&&this._hasSelectionAttribute?(this._preventCaretMovement(e),this._removeSelectionAttribute(),!0):Gk(t,n)?(this._preventCaretMovement(e),this._overrideGravity(),!0):Qk(t,n)&&this._hasSelectionAttribute?(this._preventCaretMovement(e),this._overrideGravity(),!0):void 0}},{key:"handleBackwardMovement",value:function(t,e){var n=this.attribute;return this._isGravityOverridden?Yk(t,n)&&this._hasSelectionAttribute?(this._preventCaretMovement(e),this._restoreGravity(),this._removeSelectionAttribute(),!0):(this._preventCaretMovement(e),this._restoreGravity(),t.isAtStart&&this._removeSelectionAttribute(),!0):Yk(t,n)&&!this._hasSelectionAttribute?(this._preventCaretMovement(e),this._setSelectionAttributeFromTheNodeBefore(t),!0):t.isAtEnd&&Qk(t,n)?this._hasSelectionAttribute?void(Xk(t,n)&&(this._skipNextAutomaticGravityRestoration(),this._overrideGravity())):(this._preventCaretMovement(e),this._setSelectionAttributeFromTheNodeBefore(t),!0):t.isAtStart?this._hasSelectionAttribute?(this._removeSelectionAttribute(),this._preventCaretMovement(e),!0):void 0:void(Xk(t,n)&&(this._skipNextAutomaticGravityRestoration(),this._overrideGravity()))}},{key:"_overrideGravity",value:function(){this._overrideUid=this.model.change(function(t){return t.overrideSelectionGravity()})}},{key:"_restoreGravity",value:function(){var t=this;this.model.change(function(e){e.restoreSelectionGravity(t._overrideUid),t._overrideUid=null})}},{key:"_preventCaretMovement",value:function(t){t.preventDefault()}},{key:"_removeSelectionAttribute",value:function(){var t=this;this.model.change(function(e){e.removeSelectionAttribute(t.attribute)})}},{key:"_setSelectionAttributeFromTheNodeBefore",value:function(t){var e=this,n=this.attribute;this.model.change(function(r){r.setSelectionAttribute(e.attribute,t.nodeBefore.getAttribute(n))})}},{key:"_skipNextAutomaticGravityRestoration",value:function(){this._isNextGravityRestorationSkipped=!0}},{key:"_isGravityOverridden",get:function(){return!!this._overrideUid}},{key:"_hasSelectionAttribute",get:function(){return this._modelSelection.hasAttribute(this.attribute)}}]),t}();function zk(t,e){return Gk(t,e)||Qk(t,e)}function Gk(t,e){var n=t.nodeBefore,r=t.nodeAfter,i=!!n&&n.hasAttribute(e),o=!!r&&r.hasAttribute(e);return o&&(!i||n.getAttribute(e)!==r.getAttribute(e))}function Qk(t,e){var n=t.nodeBefore,r=t.nodeAfter,i=!!n&&n.hasAttribute(e),o=!!r&&r.hasAttribute(e);return i&&(!o||n.getAttribute(e)!==r.getAttribute(e))}function Yk(t,e){var n=t.nodeBefore,r=t.nodeAfter,i=!!n&&n.hasAttribute(e),o=!!r&&r.hasAttribute(e);if(o&&i)return r.getAttribute(e)!==n.getAttribute(e)}function Xk(t,e){return zk(t.getShiftedBy(-1),e)}n("356b");
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var Jk="ck-link_selected",$k=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this.editor;t.model.schema.extend("$text",{allowAttributes:"linkHref"}),t.conversion.for("dataDowncast").add(Yf({model:"linkHref",view:Uk})),t.conversion.for("editingDowncast").add(Yf({model:"linkHref",view:function(t,e){return Uk(qk(t),e)}})),t.conversion.for("upcast").add(Wd({view:{name:"a",attributes:{href:!0}},model:{key:"linkHref",value:function(t){return t.getAttribute("href")}}})),t.commands.add("link",new jk(t)),t.commands.add("unlink",new Mk(t)),Kk(t.editing.view,t.model,this,"linkHref"),this._setupLinkHighlight()}},{key:"_setupLinkHighlight",value:function(){var t=this.editor,e=t.editing.view,n=new Pt.a;e.document.registerPostFixer(function(e){var r=t.model.document.selection;if(r.hasAttribute("linkHref")){var i=Rk(r.getFirstPosition(),r.getAttribute("linkHref"),t.model),o=t.editing.mapper.toViewRange(i),a=!0,s=!1,u=void 0;try{for(var c,l=P()(o.getItems());!(a=(c=l.next()).done);a=!0){var h=c.value;h.is("a")&&(e.addClass(Jk,h),n.add(h))}}catch(f){s=!0,u=f}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}}}),t.conversion.for("editingDowncast").add(function(t){function r(){e.change(function(t){var e=!0,r=!1,i=void 0;try{for(var o,a=P()(n.values());!(e=(o=a.next()).done);e=!0){var s=o.value;t.removeClass(Jk,s),n.delete(s)}}catch(u){r=!0,i=u}finally{try{e||null==a.return||a.return()}finally{if(r)throw i}}})}t.on("insert",r,{priority:"highest"}),t.on("remove",r,{priority:"highest"}),t.on("attribute",r,{priority:"highest"}),t.on("selection",r,{priority:"highest"})})}}]),e}(Gy),Zk=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),n.domEventType="click",n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"onDomEvent",value:function(t){this.fire(t.type,t)}}]),e}(mh),tE=(n("18ea"),function(t){function e(t){var n;Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t));var r=t.t;return n.focusTracker=new Hv,n.keystrokes=new Nv,n.urlInputView=n._createUrlInput(),n.saveButtonView=n._createButton(r("Save"),pw.a,"ck-button-save"),n.saveButtonView.type="submit",n.cancelButtonView=n._createButton(r("Cancel"),yw.a,"ck-button-cancel","cancel"),n._focusables=new Xv,n._focusCycler=new Fy({focusables:n._focusables,focusTracker:n.focusTracker,keystrokeHandler:n.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),n.setTemplate({tag:"form",attributes:{class:["ck","ck-link-form"],tabindex:"-1"},children:[n.urlInputView,n.saveButtonView,n.cancelButtonView]}),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"render",value:function(){var t=this;S(Object(b["a"])(e.prototype),"render",this).call(this),fw({view:this});var n=[this.urlInputView,this.saveButtonView,this.cancelButtonView];n.forEach(function(e){t._focusables.add(e),t.focusTracker.add(e.element)}),this.keystrokes.listenTo(this.element)}},{key:"focus",value:function(){this._focusCycler.focusFirst()}},{key:"_createUrlInput",value:function(){var t=this.locale.t,e=new lw(this.locale,hw);return e.label=t("Link URL"),e.inputView.placeholder="https://example.com",e}},{key:"_createButton",value:function(t,e,n,r){var i=new um(this.locale);return i.set({label:t,icon:e,tooltip:!0}),i.extendTemplate({attributes:{class:n}}),r&&i.delegate("execute").to(this,r),i}}]),e}(Iy)),eE=n("1805"),nE=n.n(eE),rE=n("2609"),iE=n.n(rE),oE=(n("2260"),function(t){function e(t){var n;Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t));var r=t.t;return n.focusTracker=new Hv,n.keystrokes=new Nv,n.previewButtonView=n._createPreviewButton(),n.unlinkButtonView=n._createButton(r("Unlink"),nE.a,"unlink"),n.editButtonView=n._createButton(r("Edit link"),iE.a,"edit"),n.set("href"),n._focusables=new Xv,n._focusCycler=new Fy({focusables:n._focusables,focusTracker:n.focusTracker,keystrokeHandler:n.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),n.setTemplate({tag:"div",attributes:{class:["ck","ck-link-actions"],tabindex:"-1"},children:[n.previewButtonView,n.editButtonView,n.unlinkButtonView]}),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"render",value:function(){var t=this;S(Object(b["a"])(e.prototype),"render",this).call(this);var n=[this.previewButtonView,this.editButtonView,this.unlinkButtonView];n.forEach(function(e){t._focusables.add(e),t.focusTracker.add(e.element)}),this.keystrokes.listenTo(this.element)}},{key:"focus",value:function(){this._focusCycler.focusFirst()}},{key:"_createButton",value:function(t,e,n){var r=new um(this.locale);return r.set({label:t,icon:e,tooltip:!0}),r.delegate("execute").to(this,n),r}},{key:"_createPreviewButton",value:function(){var t=new um(this.locale),e=this.bindTemplate,n=this.t;return t.set({withText:!0,tooltip:n("Open link in new tab")}),t.extendTemplate({attributes:{class:["ck","ck-link-actions__preview"],href:e.to("href",function(t){return t&&qk(t)}),target:"_blank"}}),t.bind("label").to(this,"href",function(t){return t||n("This link has no URL")}),t.bind("isEnabled").to(this,"href",function(t){return!!t}),t.template.tag="a",t.template.eventListeners={},t}}]),e}(Iy)),aE=n("77bd"),sE=n.n(aE),uE="Ctrl+K",cE=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this.editor;t.editing.view.addObserver(Zk),this.actionsView=this._createActionsView(),this.formView=this._createFormView(),this._balloon=t.plugins.get(Iw),this._createToolbarLinkButton(),this._enableUserBalloonInteractions()}},{key:"_createActionsView",value:function(){var t=this,e=this.editor,n=new oE(e.locale),r=e.commands.get("link"),i=e.commands.get("unlink");return n.bind("href").to(r,"value"),n.editButtonView.bind("isEnabled").to(r),n.unlinkButtonView.bind("isEnabled").to(i),this.listenTo(n,"edit",function(){t._addFormView()}),this.listenTo(n,"unlink",function(){e.execute("unlink"),t._hideUI()}),n.keystrokes.set("Esc",function(e,n){t._hideUI(),n()}),n.keystrokes.set(uE,function(e,n){t._addFormView(),n()}),n}},{key:"_createFormView",value:function(){var t=this,e=this.editor,n=new tE(e.locale),r=e.commands.get("link");return n.urlInputView.bind("value").to(r,"value"),n.urlInputView.bind("isReadOnly").to(r,"isEnabled",function(t){return!t}),n.saveButtonView.bind("isEnabled").to(r),this.listenTo(n,"submit",function(){e.execute("link",n.urlInputView.inputView.element.value),t._removeFormView()}),this.listenTo(n,"cancel",function(){t._removeFormView()}),n.keystrokes.set("Esc",function(e,n){t._removeFormView(),n()}),n}},{key:"_createToolbarLinkButton",value:function(){var t=this,e=this.editor,n=e.commands.get("link"),r=e.t;e.keystrokes.set(uE,function(e,r){r(),n.isEnabled&&t._showUI()}),e.ui.componentFactory.add("link",function(e){var i=new um(e);return i.isEnabled=!0,i.label=r("Link"),i.icon=sE.a,i.keystroke=uE,i.tooltip=!0,i.bind("isOn","isEnabled").to(n,"value","isEnabled"),t.listenTo(i,"execute",function(){return t._showUI()}),i})}},{key:"_enableUserBalloonInteractions",value:function(){var t=this,e=this.editor.editing.view.document;this.listenTo(e,"click",function(){var e=t._getSelectedLinkElement();e&&t._showUI()}),this.editor.keystrokes.set("Tab",function(e,n){t._areActionsVisible&&!t.actionsView.focusTracker.isFocused&&(t.actionsView.focus(),n())},{priority:"high"}),this.editor.keystrokes.set("Esc",function(e,n){t._isUIVisible&&(t._hideUI(),n())}),cw({emitter:this.formView,activator:function(){return t._isUIVisible},contextElements:[this._balloon.view.element],callback:function(){return t._hideUI()}})}},{key:"_addActionsView",value:function(){this._areActionsInPanel||this._balloon.add({view:this.actionsView,position:this._getBalloonPositionData()})}},{key:"_addFormView",value:function(){if(!this._isFormInPanel){var t=this.editor,e=t.commands.get("link");this._balloon.add({view:this.formView,position:this._getBalloonPositionData()}),this.formView.urlInputView.select(),this.formView.urlInputView.inputView.element.value=e.value||""}}},{key:"_removeFormView",value:function(){this._isFormInPanel&&(this._balloon.remove(this.formView),this.editor.editing.view.focus())}},{key:"_showUI",value:function(){var t=this.editor,e=t.commands.get("link");e.isEnabled&&(this._getSelectedLinkElement()?this._areActionsVisible?this._addFormView():this._addActionsView():(this._addActionsView(),this._addFormView()),this._startUpdatingUI())}},{key:"_hideUI",value:function(){if(this._isUIInPanel){var t=this.editor;this.stopListening(t.ui,"update"),this._removeFormView(),this._balloon.remove(this.actionsView),t.editing.view.focus()}}},{key:"_startUpdatingUI",value:function(){var t=this,e=this.editor,n=e.editing.view.document,r=this._getSelectedLinkElement(),i=o();function o(){return n.selection.focus.getAncestors().reverse().find(function(t){return t.is("element")})}this.listenTo(e.ui,"update",function(){var e=t._getSelectedLinkElement(),n=o();r&&!e||!r&&n!==i?t._hideUI():t._balloon.updatePosition(t._getBalloonPositionData()),r=e,i=n})}},{key:"_getBalloonPositionData",value:function(){var t=this.editor.editing.view,e=t.document,n=this._getSelectedLinkElement(),r=n?t.domConverter.mapViewToDom(n):t.domConverter.viewRangeToDom(e.selection.getFirstRange());return{target:r}}},{key:"_getSelectedLinkElement",value:function(){var t=this.editor.editing.view,e=t.document.selection;if(e.isCollapsed)return lE(e.getFirstPosition());var n=e.getFirstRange().getTrimmed(),r=lE(n.start),i=lE(n.end);return r&&r==i&&t.createRangeIn(r).getTrimmed().isEqual(n)?r:null}},{key:"_isFormInPanel",get:function(){return this._balloon.hasView(this.formView)}},{key:"_areActionsInPanel",get:function(){return this._balloon.hasView(this.actionsView)}},{key:"_areActionsVisible",get:function(){return this._balloon.visibleView===this.actionsView}},{key:"_isUIInPanel",get:function(){return this._isFormInPanel||this._areActionsInPanel}},{key:"_isUIVisible",get:function(){var t=this._balloon.visibleView;return t==this.formView||this._areActionsVisible}}],[{key:"requires",get:function(){return[Iw]}}]),e}(Gy);function lE(t){return t.getAncestors().find(function(t){return Bk(t)})}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var hE=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,null,[{key:"requires",get:function(){return[$k,cE]}},{key:"pluginName",get:function(){return"Link"}}]),e}(Gy),fE=function(t){function e(t,n){var r;return Object(c["a"])(this,e),r=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),r.type="bulleted"==n?"bulleted":"numbered",r}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"refresh",value:function(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}},{key:"execute",value:function(){var t=this,e=this.editor.model,n=e.document,r=gt()(n.selection.getSelectedBlocks()).filter(function(t){return pE(t,e.schema)}),i=!0===this.value;e.change(function(e){if(i){var n=r[r.length-1].nextSibling,o=Number.POSITIVE_INFINITY,a=[];while(n&&"listItem"==n.name&&0!==n.getAttribute("listIndent")){var s=n.getAttribute("listIndent");s<o&&(o=s);var u=s-o;a.push({element:n,listIndent:u}),n=n.nextSibling}a=a.reverse();var c=!0,l=!1,h=void 0;try{for(var f,d=P()(a);!(c=(f=d.next()).done);c=!0){var p=f.value;e.setAttribute("listIndent",p.listIndent,p.element)}}catch(A){l=!0,h=A}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}}if(!i){var v=Number.POSITIVE_INFINITY,y=!0,g=!1,m=void 0;try{for(var b,w=P()(r);!(y=(b=w.next()).done);y=!0){var _=b.value;_.is("listItem")&&_.getAttribute("listIndent")<v&&(v=_.getAttribute("listIndent"))}}catch(A){g=!0,m=A}finally{try{y||null==w.return||w.return()}finally{if(g)throw m}}v=0===v?1:v,dE(r,!0,v),dE(r,!1,v)}var k=!0,E=!1,T=void 0;try{for(var S,C=P()(r.reverse());!(k=(S=C.next()).done);k=!0){var O=S.value;i&&"listItem"==O.name?e.rename(O,"paragraph"):i||"listItem"==O.name?i||"listItem"!=O.name||O.getAttribute("listType")==t.type||e.setAttribute("listType",t.type,O):(e.setAttributes({listType:t.type,listIndent:0},O),e.rename(O,"listItem"))}}catch(A){E=!0,T=A}finally{try{k||null==C.return||C.return()}finally{if(E)throw T}}})}},{key:"_getValue",value:function(){var t=Ym(this.editor.model.document.selection.getSelectedBlocks());return!!t&&t.is("listItem")&&t.getAttribute("listType")==this.type}},{key:"_checkEnabled",value:function(){if(this.value)return!0;var t=this.editor.model.document.selection,e=this.editor.model.schema,n=Ym(t.getSelectedBlocks());return!!n&&pE(n,e)}}]),e}(rg);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function dE(t,e,n){var r=e?t[0]:t[t.length-1];if(r.is("listItem")){var i=r[e?"previousSibling":"nextSibling"],o=r.getAttribute("listIndent");while(i&&i.is("listItem")&&i.getAttribute("listIndent")>=n)o>i.getAttribute("listIndent")&&(o=i.getAttribute("listIndent")),i.getAttribute("listIndent")==o&&t[e?"unshift":"push"](i),i=i[e?"previousSibling":"nextSibling"]}}function pE(t,e){return e.checkChild(t.parent,"listItem")&&!e.isObject(t)}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var vE=function(t){function e(t,n){var r;return Object(c["a"])(this,e),r=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),r._indentBy="forward"==n?1:-1,r}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"refresh",value:function(){this.isEnabled=this._checkEnabled()}},{key:"execute",value:function(){var t=this,e=this.editor.model,n=e.document,r=gt()(n.selection.getSelectedBlocks());e.change(function(e){var n=r[r.length-1],i=n.nextSibling;while(i&&"listItem"==i.name&&i.getAttribute("listIndent")>n.getAttribute("listIndent"))r.push(i),i=i.nextSibling;t._indentBy<0&&(r=r.reverse());var o=!0,a=!1,s=void 0;try{for(var u,c=P()(r);!(o=(u=c.next()).done);o=!0){var l=u.value,h=l.getAttribute("listIndent")+t._indentBy;h<0?e.rename(l,"paragraph"):e.setAttribute("listIndent",h,l)}}catch(f){a=!0,s=f}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}})}},{key:"_checkEnabled",value:function(){var t=Ym(this.editor.model.document.selection.getSelectedBlocks());if(!t||!t.is("listItem"))return!1;if(this._indentBy>0){var e=t.getAttribute("listIndent"),n=t.getAttribute("listType"),r=t.previousSibling;while(r&&r.is("listItem")&&r.getAttribute("listIndent")>=e){if(r.getAttribute("listIndent")==e)return r.getAttribute("listType")==n;r=r.previousSibling}return!1}return!0}}]),e}(rg);
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function yE(t){var e=t.createContainerElement("li");return e.getFillerOffset=gE,e}function gE(){var t=!this.isEmpty&&("ul"==this.getChild(0).name||"ol"==this.getChild(0).name);return this.isEmpty||t?0:Ls.call(this)}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function mE(t){return function(e,n,r){var i=r.consumable;if(i.test(n.item,"insert")&&i.test(n.item,"attribute:listType")&&i.test(n.item,"attribute:listIndent")){i.consume(n.item,"insert"),i.consume(n.item,"attribute:listType"),i.consume(n.item,"attribute:listIndent");var o=n.item,a=PE(o,r);jE(o,a,r,t)}}}function bE(t){return function(e,n,r){var i=r.mapper.toViewPosition(n.position).getLastMatchingPosition(function(t){return!t.item.is("li")}),o=i.nodeAfter,a=r.writer;a.breakContainer(a.createPositionBefore(o)),a.breakContainer(a.createPositionAfter(o));var s=o.parent,u=s.previousSibling,c=a.createRangeOn(s),l=a.remove(c);u&&u.nextSibling&&DE(a,u,u.nextSibling);var h=r.mapper.toModelElement(o);ME(h.getAttribute("listIndent")+1,n.position,c.start,o,r,t);var f=!0,d=!1,p=void 0;try{for(var v,y=P()(a.createRangeIn(l).getItems());!(f=(v=y.next()).done);f=!0){var g=v.value;r.mapper.unbindViewElement(g)}}catch(m){d=!0,p=m}finally{try{f||null==y.return||y.return()}finally{if(d)throw p}}e.stop()}}function wE(t,e,n){if(n.consumable.consume(e.item,"attribute:listType")){var r=n.mapper.toViewElement(e.item),i=n.writer;i.breakContainer(i.createPositionBefore(r)),i.breakContainer(i.createPositionAfter(r));var o=r.parent,a="numbered"==e.attributeNewValue?"ol":"ul";o=i.rename(a,o),DE(i,o,o.nextSibling),DE(i,o.previousSibling,o);var s=!0,u=!1,c=void 0;try{for(var l,h=P()(e.item.getChildren());!(s=(l=h.next()).done);s=!0){var f=l.value;n.consumable.consume(f,"insert")}}catch(d){u=!0,c=d}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}}}function _E(t){return function(e,n,r){if(r.consumable.consume(n.item,"attribute:listIndent")){var i=r.mapper.toViewElement(n.item),o=r.writer;o.breakContainer(o.createPositionBefore(i)),o.breakContainer(o.createPositionAfter(i));var a=i.parent,s=a.previousSibling,u=o.createRangeOn(a);o.remove(u),s&&s.nextSibling&&DE(o,s,s.nextSibling),ME(n.attributeOldValue+1,n.range.start,u.start,i,r,t),jE(n.item,i,r,t);var c=!0,l=!1,h=void 0;try{for(var f,d=P()(n.item.getChildren());!(c=(f=d.next()).done);c=!0){var p=f.value;r.consumable.consume(p,"insert")}}catch(v){l=!0,h=v}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}}}}function kE(t,e,n){if("listItem"!=e.item.name){var r=n.mapper.toViewPosition(e.range.start),i=n.writer,o=[];while("ul"==r.parent.name||"ol"==r.parent.name){if(r=i.breakContainer(r),"li"!=r.parent.name)break;var a=r,s=i.createPositionAt(r.parent,"end");if(!a.isEqual(s)){var u=i.remove(i.createRange(a,s));o.push(u)}r=i.createPositionAfter(r.parent)}if(o.length>0){for(var c=0;c<o.length;c++){var l=r.nodeBefore,h=i.insert(r,o[c]);if(r=h.end,c>0){var f=DE(i,l,l.nextSibling);f&&f.parent==l&&r.offset--}}DE(i,r.nodeBefore,r.nodeAfter)}}}function EE(t,e,n){var r=n.mapper.toViewPosition(e.position),i=r.nodeBefore,o=r.nodeAfter;DE(n.writer,i,o)}function TE(t,e,n){if(n.consumable.consume(e.viewItem,{name:!0})){var r=n.writer,i=this.conversionApi.store,o=r.createElement("listItem");i.indent=i.indent||0,r.setAttribute("listIndent",i.indent,o);var a=e.viewItem.parent&&"ol"==e.viewItem.parent.name?"numbered":"bulleted";r.setAttribute("listType",a,o),i.indent++;var s=n.splitToAllowedParent(o,e.modelCursor);if(!s)return;r.insert(o,s.position);var u=NE(o,e.viewItem.getChildren(),n);i.indent--,e.modelRange=r.createRange(e.modelCursor,u),s.cursorParent?e.modelCursor=r.createPositionAt(s.cursorParent,0):e.modelCursor=e.modelRange.end}}function SE(t,e,n){if(n.consumable.test(e.viewItem,{name:!0})){var r=gt()(e.viewItem.getChildren()),i=!0,o=!1,a=void 0;try{for(var s,u=P()(r);!(i=(s=u.next()).done);i=!0){var c=s.value;c.is("li")||c._remove()}}catch(l){o=!0,a=l}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}}}function CE(t,e,n){if(n.consumable.test(e.viewItem,{name:!0})){if(0===e.viewItem.childCount)return;var r=kt(e.viewItem.getChildren()),i=!1,o=!0,a=!0,s=!1,u=void 0;try{for(var c,l=P()(r);!(a=(c=l.next()).done);a=!0){var h=c.value;!i||h.is("ul")||h.is("ol")||h._remove(),h.is("text")?(o&&(h._data=h.data.replace(/^\s+/,"")),(!h.nextSibling||h.nextSibling.is("ul")||h.nextSibling.is("ol"))&&(h._data=h.data.replace(/\s+$/,""))):(h.is("ul")||h.is("ol"))&&(i=!0),o=!1}}catch(f){s=!0,u=f}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}}}function OE(t){return function(e,n){if(!n.isPhantom){var r=n.modelPosition.nodeBefore;if(r&&r.is("listItem")){var i=n.mapper.toViewElement(r),o=i.getAncestors().find(function(t){return t.is("ul")||t.is("ol")}),a=t.createPositionAt(i,0).getWalker(),s=!0,u=!1,c=void 0;try{for(var l,h=P()(a);!(s=(l=h.next()).done);s=!0){var f=l.value;if("elementStart"==f.type&&f.item.is("li")){n.viewPosition=f.previousPosition;break}if("elementEnd"==f.type&&f.item==o){n.viewPosition=f.nextPosition;break}}}catch(d){u=!0,c=d}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}}}}}function AE(t){return function(e,n){var r=n.viewPosition,i=r.parent,o=n.mapper;if("ul"==i.name||"ol"==i.name){if(r.isAtEnd){var a=o.toModelElement(r.nodeBefore),s=o.getModelLength(r.nodeBefore);n.modelPosition=t.createPositionBefore(a).getShiftedBy(s)}else{var u=o.toModelElement(r.nodeAfter);n.modelPosition=t.createPositionBefore(u)}e.stop()}else if("li"==i.name&&r.nodeBefore&&("ul"==r.nodeBefore.name||"ol"==r.nodeBefore.name)){var c=o.toModelElement(i),l=1,h=r.nodeBefore;while(h&&(h.is("ul")||h.is("ol")))l+=o.getModelLength(h),h=h.previousSibling;n.modelPosition=t.createPositionBefore(c).getShiftedBy(l),e.stop()}}}function IE(t,e){var n=t.document.differ.getChanges(),r=new It.a,i=!1,o=!0,a=!1,s=void 0;try{for(var u,c=P()(n);!(o=(u=c.next()).done);o=!0){var l=u.value;if("insert"==l.type&&"listItem"==l.name)b(l.position);else if("insert"==l.type&&"listItem"!=l.name){if("$text"!=l.name){var h=l.position.nodeAfter;h.hasAttribute("listIndent")&&(e.removeAttribute("listIndent",h),i=!0),h.hasAttribute("listType")&&(e.removeAttribute("listType",h),i=!0)}var f=l.position.getShiftedBy(l.length);b(f)}else"remove"==l.type&&"listItem"==l.name?b(l.position):"attribute"==l.type&&"listIndent"==l.attributeKey?b(l.range.start):"attribute"==l.type&&"listType"==l.attributeKey&&b(l.range.start)}}catch(k){a=!0,s=k}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}var d=!0,p=!1,v=void 0;try{for(var y,g=P()(r.values());!(d=(y=g.next()).done);d=!0){var m=y.value;w(m),_(m)}}catch(k){p=!0,v=k}finally{try{d||null==g.return||g.return()}finally{if(p)throw v}}return i;function b(t){var e=t.nodeBefore;if(e&&e.is("listItem")){var n=e;if(r.has(n))return;while(n.previousSibling&&n.previousSibling.is("listItem"))if(n=n.previousSibling,r.has(n))return;r.set(t.nodeBefore,n)}else{var i=t.nodeAfter;i&&i.is("listItem")&&r.set(i,i)}}function w(t){var n=0,r=null;while(t&&t.is("listItem")){var o=t.getAttribute("listIndent");if(o>n){var a=void 0;null===r?(r=o-n,a=n):(r>o&&(r=o),a=o-r),e.setAttribute("listIndent",a,t),i=!0}else r=null,n=t.getAttribute("listIndent")+1;t=t.nextSibling}}function _(t){var n=[],r=null;while(t&&t.is("listItem")){var o=t.getAttribute("listIndent");if(r&&r.getAttribute("listIndent")>o&&(n=n.slice(0,o+1)),0!=o)if(n[o]){var a=n[o];t.getAttribute("listType")!=a&&(e.setAttribute("listType",a,t),i=!0)}else n[o]=t.getAttribute("listType");r=t,t=t.nextSibling}}}function xE(t,e){var n,r=Ot(e,2),i=r[0],o=r[1],a=i.is("documentFragment")?i.getChild(0):i;if(n=o?this.createSelection(o):this.document.selection,a&&a.is("listItem")){var s=n.getFirstPosition(),u=null;if(s.parent.is("listItem")?u=s.parent:s.nodeBefore&&s.nodeBefore.is("listItem")&&(u=s.nodeBefore),u){var c=u.getAttribute("listIndent");if(c>0)while(a&&a.is("listItem"))a._setAttribute("listIndent",a.getAttribute("listIndent")+c),a=a.nextSibling}}}function PE(t,e){var n=e.mapper,r=e.writer,i="numbered"==t.getAttribute("listType")?"ol":"ul",o=yE(r),a=r.createContainerElement(i,null);return r.insert(r.createPositionAt(a,0),o),n.bindElements(t,o),o}function NE(t,e,n){var r=n.writer,i=t,o=r.createPositionAfter(t),a=!0,s=!1,u=void 0;try{for(var c,l=P()(e);!(a=(c=l.next()).done);a=!0){var h=c.value;if("ul"==h.name||"ol"==h.name)o=n.convertItem(h,o).modelCursor;else{var f=n.convertItem(h,r.createPositionAt(i,"end")),d=f.modelRange.start.nodeAfter;o=f.modelCursor,d&&d.is("element")&&!n.schema.checkChild(i,d.name)&&(i=o.parent,!i.is("listItem")&&i.nextSibling&&i.nextSibling.is("listItem")&&(i=i.nextSibling,o=r.createPositionAt(i,"end")))}}}catch(p){s=!0,u=p}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}return o}function RE(t,e){var n=!!e.sameIndent,r=!!e.smallerIndent,i=e.listIndent,o=t;while(o&&"listItem"==o.name){var a=o.getAttribute("listIndent");if(n&&i==a||r&&i>a)return o;o=o.previousSibling}return null}function DE(t,e,n){return e&&n&&("ul"==e.name||"ol"==e.name)&&e.name==n.name?t.mergeContainers(t.createPositionAfter(e)):null}function jE(t,e,n,r){var i=e.parent,o=n.mapper,a=n.writer,s=o.toViewPosition(r.createPositionBefore(t)),u=RE(t.previousSibling,{sameIndent:!0,smallerIndent:!0,listIndent:t.getAttribute("listIndent")}),c=t.previousSibling;if(u&&u.getAttribute("listIndent")==t.getAttribute("listIndent")){var l=o.toViewElement(u);s=a.breakContainer(a.createPositionAfter(l))}else s=c&&"listItem"==c.name?o.toViewPosition(r.createPositionAt(c,"end")):o.toViewPosition(r.createPositionBefore(t));if(s=LE(s),a.insert(s,i),c&&"listItem"==c.name){var h=o.toViewElement(c),f=a.createRange(a.createPositionAt(h,0),s),d=f.getWalker({ignoreElementEnd:!0}),p=!0,v=!1,y=void 0;try{for(var g,m=P()(d);!(p=(g=m.next()).done);p=!0){var b=g.value;if(b.item.is("li")){var w=a.breakContainer(a.createPositionBefore(b.item)),_=b.item.parent,k=a.createPositionAt(e,"end");DE(a,k.nodeBefore,k.nodeAfter),a.move(a.createRangeOn(_),k),d.position=w}}}catch(R){v=!0,y=R}finally{try{p||null==m.return||m.return()}finally{if(v)throw y}}}else{var E=i.nextSibling;if(E&&(E.is("ul")||E.is("ol"))){var T=null,S=!0,C=!1,O=void 0;try{for(var A,I=P()(E.getChildren());!(S=(A=I.next()).done);S=!0){var x=A.value,N=o.toModelElement(x);if(!(N&&N.getAttribute("listIndent")>t.getAttribute("listIndent")))break;T=x}}catch(R){C=!0,O=R}finally{try{S||null==I.return||I.return()}finally{if(C)throw O}}T&&(a.breakContainer(a.createPositionAfter(T)),a.move(a.createRangeOn(T.parent),a.createPositionAt(e,"end")))}}DE(a,i,i.nextSibling),DE(a,i.previousSibling,i)}function ME(t,e,n,r,i,o){var a,s=RE(e.nodeBefore,{sameIndent:!0,smallerIndent:!0,listIndent:t,foo:"b"}),u=i.mapper,c=i.writer,l=s?s.getAttribute("listIndent"):null;if(s)if(l==t){var h=u.toViewElement(s).parent;a=c.createPositionAfter(h)}else{var f=o.createPositionAt(s,"end");a=u.toViewPosition(f)}else a=n;a=LE(a);for(var d=kt(r.getChildren()),p=0;p<d.length;p++){var v=d[p];(v.is("ul")||v.is("ol"))&&(a=c.move(c.createRangeOn(v),a).end,DE(c,v,v.nextSibling),DE(c,v.previousSibling,v))}}function LE(t){return t.getLastMatchingPosition(function(t){return t.item.is("uiElement")})}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var FE=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this,e=this.editor;e.model.schema.register("listItem",{inheritAllFrom:"$block",allowAttributes:["listType","listIndent"]});var n=e.data,r=e.editing;e.model.document.registerPostFixer(function(t){return IE(e.model,t)}),r.mapper.registerViewToModelLength("li",VE),n.mapper.registerViewToModelLength("li",VE),r.mapper.on("modelToViewPosition",OE(r.view)),r.mapper.on("viewToModelPosition",AE(e.model)),n.mapper.on("modelToViewPosition",OE(r.view)),r.downcastDispatcher.on("insert",kE,{priority:"high"}),r.downcastDispatcher.on("insert:listItem",mE(e.model)),n.downcastDispatcher.on("insert",kE,{priority:"high"}),n.downcastDispatcher.on("insert:listItem",mE(e.model)),r.downcastDispatcher.on("attribute:listType:listItem",wE),n.downcastDispatcher.on("attribute:listType:listItem",wE),r.downcastDispatcher.on("attribute:listIndent:listItem",_E(e.model)),n.downcastDispatcher.on("attribute:listIndent:listItem",_E(e.model)),r.downcastDispatcher.on("remove:listItem",bE(e.model)),r.downcastDispatcher.on("remove",EE,{priority:"low"}),n.downcastDispatcher.on("remove:listItem",bE(e.model)),n.downcastDispatcher.on("remove",EE,{priority:"low"}),n.upcastDispatcher.on("element:ul",SE,{priority:"high"}),n.upcastDispatcher.on("element:ol",SE,{priority:"high"}),n.upcastDispatcher.on("element:li",CE,{priority:"high"}),n.upcastDispatcher.on("element:li",TE),e.model.on("insertContent",xE,{priority:"high"}),e.commands.add("numberedList",new fE(e,"numbered")),e.commands.add("bulletedList",new fE(e,"bulleted")),e.commands.add("indentList",new vE(e,"forward")),e.commands.add("outdentList",new vE(e,"backward"));var i=this.editor.editing.view.document;this.listenTo(i,"enter",function(e,n){var r=t.editor.model.document,i=r.selection.getLastPosition().parent;r.selection.isCollapsed&&"listItem"==i.name&&i.isEmpty&&(t.editor.execute("outdentList"),n.preventDefault(),e.stop())}),this.listenTo(i,"delete",function(e,n){if("backward"===n.direction){var r=t.editor.model.document.selection;if(r.isCollapsed){var i=r.getFirstPosition();if(i.isAtStart){var o=i.parent;if("listItem"===o.name){var a=o.previousSibling&&"listItem"===o.previousSibling.name;a||(t.editor.execute("outdentList"),n.preventDefault(),e.stop())}}}}},{priority:"high"});var o=function(e){return function(n,r){var i=t.editor.commands.get(e);i.isEnabled&&(t.editor.execute(e),r())}};this.editor.keystrokes.set("Tab",o("indentList")),this.editor.keystrokes.set("Shift+Tab",o("outdentList"))}}],[{key:"requires",get:function(){return[b_]}}]),e}(Gy);function VE(t){var e=1,n=!0,r=!1,i=void 0;try{for(var o,a=P()(t.getChildren());!(n=(o=a.next()).done);n=!0){var s=o.value;if("ul"==s.name||"ol"==s.name){var u=!0,c=!1,l=void 0;try{for(var h,f=P()(s.getChildren());!(u=(h=f.next()).done);u=!0){var d=h.value;e+=VE(d)}}catch(p){c=!0,l=p}finally{try{u||null==f.return||f.return()}finally{if(c)throw l}}}}}catch(p){r=!0,i=p}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}var BE=n("dde1"),UE=n.n(BE),qE=n("7eec"),WE=n.n(qE),KE=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this.editor.t;this._addButton("numberedList",t("Numbered List"),UE.a),this._addButton("bulletedList",t("Bulleted List"),WE.a)}},{key:"_addButton",value:function(t,e,n){var r=this,i=this.editor;i.ui.componentFactory.add(t,function(o){var a=i.commands.get(t),s=new um(o);return s.set({label:e,icon:n,tooltip:!0}),s.bind("isOn","isEnabled").to(a,"value","isEnabled"),r.listenTo(s,"execute",function(){return i.execute(t)}),s})}}]),e}(Gy),HE=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,null,[{key:"requires",get:function(){return[FE,KE]}},{key:"pluginName",get:function(){return"List"}}]),e}(Gy),zE=["left","right","center","justify"];function GE(t){return zE.includes(t)}function QE(t){return"left"===t}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var YE="alignment",XE=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"refresh",value:function(){var t=Ym(this.editor.model.document.selection.getSelectedBlocks());this.isEnabled=!!t&&this._canBeAligned(t),this.value=this.isEnabled&&t.hasAttribute("alignment")?t.getAttribute("alignment"):"left"}},{key:"execute",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.editor,r=n.model,i=r.document,o=e.value;r.change(function(e){var n=gt()(i.selection.getSelectedBlocks()).filter(function(e){return t._canBeAligned(e)}),r=n[0].getAttribute("alignment"),a=QE(o)||r===o||!o;a?JE(n,e):$E(n,e,o)})}},{key:"_canBeAligned",value:function(t){return this.editor.model.schema.checkAttribute(t,YE)}}]),e}(rg);function JE(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=P()(t);!(n=(o=a.next()).done);n=!0){var s=o.value;e.removeAttribute(YE,s)}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}function $E(t,e,n){var r=!0,i=!1,o=void 0;try{for(var a,s=P()(t);!(r=(a=s.next()).done);r=!0){var u=a.value;e.setAttribute(YE,n,u)}}catch(c){i=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var ZE=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),t.config.define("alignment",{options:kt(zE)}),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this.editor,e=t.model.schema,n=t.config.get("alignment.options").filter(GE);e.extend("$block",{allowAttributes:"alignment"});var r=tT(n.filter(function(t){return!QE(t)}));t.conversion.attributeToAttribute(r),t.commands.add("alignment",new XE(t))}}]),e}(Gy);function tT(t){var e={model:{key:"alignment",values:t.slice()},view:{}},n=!0,r=!1,i=void 0;try{for(var o,a=P()(t);!(n=(o=a.next()).done);n=!0){var s=o.value;e.view[s]={key:"style",value:{"text-align":s}}}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}var eT=n("e005"),nT=n.n(eT),rT=n("c20e"),iT=n.n(rT),oT=n("2b8e"),aT=n.n(oT),sT=n("82b5"),uT=n.n(sT),cT=new It.a([["left",nT.a],["right",iT.a],["center",aT.a],["justify",uT.a]]),lT=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this,e=this.editor,n=e.ui.componentFactory,r=e.t,i=e.config.get("alignment.options");i.filter(GE).forEach(function(e){return t._addButton(e)}),n.add("alignment",function(t){var e=M_(t),o=i.map(function(t){return n.create("alignment:".concat(t))});L_(e,o),e.buttonView.set({label:r("Text alignment"),tooltip:!0}),e.toolbarView.isVertical=!0,e.extendTemplate({attributes:{class:"ck-alignment-dropdown"}});var a=nT.a;return e.buttonView.bind("icon").toMany(o,"isOn",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e.findIndex(function(t){return t});return r<0?a:o[r].icon}),e.bind("isEnabled").toMany(o,"isEnabled",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.some(function(t){return t})}),e})}},{key:"_addButton",value:function(t){var e=this,n=this.editor;n.ui.componentFactory.add("alignment:".concat(t),function(r){var i=n.commands.get("alignment"),o=new um(r);return o.set({label:e.localizedOptionTitles[t],icon:cT.get(t),tooltip:!0}),o.bind("isEnabled").to(i),o.bind("isOn").to(i,"value",function(e){return e===t}),e.listenTo(o,"execute",function(){n.execute("alignment",{value:t}),n.editing.view.focus()}),o})}},{key:"localizedOptionTitles",get:function(){var t=this.editor.t;return{left:t("Align left"),right:t("Align right"),center:t("Align center"),justify:t("Justify")}}}],[{key:"pluginName",get:function(){return"AlignmentUI"}}]),e}(Gy),hT=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,null,[{key:"requires",get:function(){return[ZE,lT]}},{key:"pluginName",get:function(){return"Alignment"}}]),e}(Gy),fT=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"refresh",value:function(){var t=this.editor.model,e=t.document;this.value=e.selection.getAttribute("highlight"),this.isEnabled=t.schema.checkAttributeInSelection(e.selection,"highlight")}},{key:"execute",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.editor.model,r=n.document,i=r.selection,o=e.value;n.change(function(e){var r=n.schema.getValidRanges(i.getRanges(),"highlight");if(i.isCollapsed){var a=i.getFirstPosition();if(i.hasAttribute("highlight")){var s=function(e){return e.item.hasAttribute("highlight")&&e.item.getAttribute("highlight")===t.value},u=a.getLastMatchingPosition(s,{direction:"backward"}),c=a.getLastMatchingPosition(s),l=e.createRange(u,c);o&&t.value!==o?(e.setAttribute("highlight",o,l),e.setSelectionAttribute("highlight",o)):(e.removeAttribute("highlight",l),e.removeSelectionAttribute("highlight"))}else o&&e.setSelectionAttribute("highlight",o)}else{var h=!0,f=!1,d=void 0;try{for(var p,v=P()(r);!(h=(p=v.next()).done);h=!0){var y=p.value;o?e.setAttribute("highlight",o,y):e.removeAttribute("highlight",y)}}catch(g){f=!0,d=g}finally{try{h||null==v.return||v.return()}finally{if(f)throw d}}}})}}]),e}(rg),dT=function(t){function e(t){var n;return Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t)),t.config.define("highlight",{options:[{model:"yellowMarker",class:"marker-yellow",title:"Yellow marker",color:"var(--ck-highlight-marker-yellow)",type:"marker"},{model:"greenMarker",class:"marker-green",title:"Green marker",color:"var(--ck-highlight-marker-green)",type:"marker"},{model:"pinkMarker",class:"marker-pink",title:"Pink marker",color:"var(--ck-highlight-marker-pink)",type:"marker"},{model:"blueMarker",class:"marker-blue",title:"Blue marker",color:"var(--ck-highlight-marker-blue)",type:"marker"},{model:"redPen",class:"pen-red",title:"Red pen",color:"var(--ck-highlight-pen-red)",type:"pen"},{model:"greenPen",class:"pen-green",title:"Green pen",color:"var(--ck-highlight-pen-green)",type:"pen"}]}),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this.editor;t.model.schema.extend("$text",{allowAttributes:"highlight"});var e=t.config.get("highlight.options");t.conversion.attributeToElement(pT(e)),t.commands.add("highlight",new fT(t))}}]),e}(Gy);function pT(t){var e={model:{key:"highlight",values:[]},view:{}},n=!0,r=!1,i=void 0;try{for(var o,a=P()(t);!(n=(o=a.next()).done);n=!0){var s=o.value;e.model.values.push(s.model),e.view[s.model]={name:"mark",classes:s.class}}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}var vT=n("42b5"),yT=n.n(vT),gT=n("e4d7"),mT=n.n(gT),bT=n("91fd"),wT=n.n(bT),_T=(n("74fe"),function(t){function e(t){var n;Object(c["a"])(this,e),n=Object(m["a"])(this,Object(b["a"])(e).call(this,t));var r=n.bindTemplate;return n.set("icon"),n.set("isEnabled",!0),n.set("isOn",!1),n.set("isVisible",!0),n.set("keystroke"),n.set("label"),n.set("tabindex",-1),n.set("tooltip"),n.set("tooltipPosition","s"),n.set("type","button"),n.set("withText",!1),n.children=n.createCollection(),n.actionView=n._createActionView(),n.arrowView=n._createArrowView(),n.keystrokes=new Nv,n.focusTracker=new Hv,n.setTemplate({tag:"div",attributes:{class:["ck","ck-splitbutton",r.if("isVisible","ck-hidden",function(t){return!t}),n.arrowView.bindTemplate.if("isOn","ck-splitbutton_open")]},children:n.children}),n}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"render",value:function(){var t=this;S(Object(b["a"])(e.prototype),"render",this).call(this),this.children.add(this.actionView),this.children.add(this.arrowView),this.focusTracker.add(this.actionView.element),this.focusTracker.add(this.arrowView.element),this.keystrokes.listenTo(this.element),this.keystrokes.set("arrowright",function(e,n){t.focusTracker.focusedElement===t.actionView.element&&(t.arrowView.focus(),n())}),this.keystrokes.set("arrowleft",function(e,n){t.focusTracker.focusedElement===t.arrowView.element&&(t.actionView.focus(),n())})}},{key:"focus",value:function(){this.actionView.focus()}},{key:"_createActionView",value:function(){var t=new um;return t.bind("icon","isEnabled","isOn","keystroke","label","tabindex","tooltip","tooltipPosition","type","withText").to(this),t.extendTemplate({attributes:{class:"ck-splitbutton__action"}}),t.delegate("execute").to(this),t}},{key:"_createArrowView",value:function(){var t=new um;return t.icon=x_.a,t.extendTemplate({attributes:{class:"ck-splitbutton__arrow","aria-haspopup":!0}}),t.bind("isEnabled").to(this),t.delegate("execute").to(this,"open"),t}}]),e}(Iy)),kT=(n("955a"),function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,[{key:"init",value:function(){var t=this.editor.config.get("highlight.options"),e=!0,n=!1,r=void 0;try{for(var i,o=P()(t);!(e=(i=o.next()).done);e=!0){var a=i.value;this._addHighlighterButton(a)}}catch(s){n=!0,r=s}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}this._addRemoveHighlightButton(),this._addDropdown(t)}},{key:"_addRemoveHighlightButton",value:function(){var t=this.editor.t;this._addButton("removeHighlight",t("Remove highlight"),wT.a)}},{key:"_addHighlighterButton",value:function(t){var e=this.editor.commands.get("highlight");function n(n){n.bind("isEnabled").to(e,"isEnabled"),n.bind("isOn").to(e,"value",function(e){return e===t.model}),n.iconView.fillColor=t.color}this._addButton("highlight:"+t.model,t.title,TT(t.type),t.model,n)}},{key:"_addButton",value:function(t,e,n,r){var i=this,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},a=this.editor;a.ui.componentFactory.add(t,function(t){var s=new um(t),u=i.localizedOptionTitles[e]?i.localizedOptionTitles[e]:e;return s.set({label:u,icon:n,tooltip:!0}),s.on("execute",function(){a.execute("highlight",{value:r}),a.editing.view.focus()}),o(s),s})}},{key:"_addDropdown",value:function(t){var e=this,n=this.editor,r=n.t,i=n.ui.componentFactory,o=t[0],a=t.reduce(function(t,e){return t[e.model]=e,t},{});i.add("highlight",function(s){var u=n.commands.get("highlight"),c=M_(s,_T),l=c.buttonView;l.set({tooltip:r("Highlight"),lastExecuted:o.model,commandValue:o.model}),l.bind("icon").to(u,"value",function(t){return TT(f(t,"type"))}),l.bind("color").to(u,"value",function(t){return f(t,"color")}),l.bind("commandValue").to(u,"value",function(t){return f(t,"model")}),l.bind("isOn").to(u,"value",function(t){return!!t}),l.delegate("execute").to(c);var h=t.map(function(t){var n=i.create("highlight:"+t.model);return e.listenTo(n,"execute",function(){return c.buttonView.set({lastExecuted:t.model})}),n});function f(t,e){var n=t&&t!==l.lastExecuted?t:l.lastExecuted;return a[n][e]}return c.bind("isEnabled").toMany(h,"isEnabled",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.some(function(t){return t})}),h.push(new By),h.push(i.create("removeHighlight")),L_(c,h),ET(c),l.on("execute",function(){n.execute("highlight",{value:l.commandValue}),n.editing.view.focus()}),c})}},{key:"localizedOptionTitles",get:function(){var t=this.editor.t;return{"Yellow marker":t("Yellow marker"),"Green marker":t("Green marker"),"Pink marker":t("Pink marker"),"Blue marker":t("Blue marker"),"Red pen":t("Red pen"),"Green pen":t("Green pen")}}}],[{key:"pluginName",get:function(){return"HighlightUI"}}]),e}(Gy));function ET(t){var e=t.buttonView.actionView;e.iconView.bind("fillColor").to(t.buttonView,"color")}function TT(t){return"marker"===t?yT.a:mT.a}
/**
 * @license Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */var ST=function(t){function e(){return Object(c["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(C["a"])(e,t),Object(l["a"])(e,null,[{key:"requires",get:function(){return[dT,kT]}},{key:"pluginName",get:function(){return"Highlight"}}]),e}(Gy),CT={data:function(){return{editor:zy,editorData:"<p>Content of the editor.</p>",editorConfig:{plugins:[vm,Om,Rm,Um,Qm,ib,y_,H_,Mw,ak,Ck,Nk,v_,hE,HE,b_,hT,ST],toolbar:{items:["heading","|","alignment","bold","italic","link","bulletedList","numberedList","imageUpload","blockQuote","undo","redo","highlight"]},image:{toolbar:["imageStyle:full","imageStyle:side","|","imageTextAlternative"]},extraPlugins:[g]}}},methods:{show:function(){console.log(this.editorData)}}},OT=CT,AT=(n("8a8f"),n("2877")),IT=Object(AT["a"])(OT,r,i,!1,null,"67f65a3d",null);IT.options.__file="About.vue";e["default"]=IT.exports},f945:function(t,e){t.exports='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5.042 9.367l2.189 1.837a.75.75 0 0 1-.965 1.149l-3.788-3.18a.747.747 0 0 1-.21-.284.75.75 0 0 1 .17-.945L6.23 4.762a.75.75 0 1 1 .964 1.15L4.863 7.866h8.917A.75.75 0 0 1 14 7.9a4 4 0 1 1-1.477 7.718l.344-1.489a2.5 2.5 0 1 0 1.094-4.73l.008-.032H5.042z"/></svg>'},fa2b:function(t,e,n){n("c207"),n("1654"),n("6c1c"),n("07d8"),n("74be"),n("c6fb"),n("57e3"),t.exports=n("584a").Set},fa3a:function(t,e,n){n("68f7")("WeakMap")},fbb0:function(t,e,n){"use strict";n.r(e),n.d(e,"__extends",function(){return i}),n.d(e,"__assign",function(){return o}),n.d(e,"__rest",function(){return a}),n.d(e,"__decorate",function(){return s}),n.d(e,"__param",function(){return u}),n.d(e,"__metadata",function(){return c}),n.d(e,"__awaiter",function(){return l}),n.d(e,"__generator",function(){return h}),n.d(e,"__exportStar",function(){return f}),n.d(e,"__values",function(){return d}),n.d(e,"__read",function(){return p}),n.d(e,"__spread",function(){return v}),n.d(e,"__await",function(){return y}),n.d(e,"__asyncGenerator",function(){return g}),n.d(e,"__asyncDelegator",function(){return m}),n.d(e,"__asyncValues",function(){return b}),n.d(e,"__makeTemplateObject",function(){return w}),n.d(e,"__importStar",function(){return _}),n.d(e,"__importDefault",function(){return k});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};function a(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&(n[r[i]]=t[r[i]])}return n}function s(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}function u(t,e){return function(n,r){e(n,r,t)}}function c(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)}function l(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})}function h(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return u([t,e])}}function u(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}function f(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}function d(t){var e="function"===typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function p(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{while((void 0===e||e-- >0)&&!(r=o.next()).done)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}return a}function v(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(p(arguments[e]));return t}function y(t){return this instanceof y?(this.v=t,this):new y(t)}function g(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(t){i[t]&&(r[t]=function(e){return new Promise(function(n,r){o.push([t,e,n,r])>1||s(t,e)})})}function s(t,e){try{u(i[t](e))}catch(n){h(o[0][3],n)}}function u(t){t.value instanceof y?Promise.resolve(t.value.v).then(c,l):h(o[0][2],t)}function c(t){s("next",t)}function l(t){s("throw",t)}function h(t,e){t(e),o.shift(),o.length&&s(o[0][0],o[0][1])}}function m(t){var e,n;return e={},r("next"),r("throw",function(t){throw t}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){t[r]&&(e[r]=function(e){return(n=!n)?{value:y(t[r](e)),done:"return"===r}:i?i(e):e})}}function b(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator];return e?e.call(t):"function"===typeof d?d(t):t[Symbol.iterator]()}function w(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function _(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function k(t){return t&&t.__esModule?t:{default:t}}},fde4:function(t,e,n){n("bf90");var r=n("584a").Object;t.exports=function(t,e){return r.getOwnPropertyDescriptor(t,e)}},fdef:function(t,e){t.exports="\t\n\v\f\r \u2028\u2029\ufeff"},fe1e:function(t,e,n){n("7075")("Map")},fecc:function(t,e,n){},ff23:function(t,e,n){},ffa0:function(t,e,n){}}]);
//# sourceMappingURL=about.c25b2ede.js.map